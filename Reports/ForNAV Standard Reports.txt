OBJECT Table 70000 ForNAV Setup
{
  OBJECT-PROPERTIES
  {
    Date=09-08-17;
    Time=13:16:07;
    Modified=Yes;
    Version List=FORNAVCTP5;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10         }
    { 9   ;   ;Localization        ;Option        ;OnValidate=BEGIN
                                                                IF Localization = Localization::"North America" THEN
                                                                  "VAT Amount Specification" := "VAT Amount Specification"::"N/A. (Sales Tax)";
                                                              END;

                                                   OptionString=World Wide,North America,Other }
    { 10  ;   ;VAT Amount Specification;Option    ;OptionString=Multiple Lines,Always,Never,N/A. (Sales Tax) }
    { 20  ;   ;Logo                ;BLOB           }
    { 60  ;   ;Document Watermark  ;BLOB           }
    { 61  ;   ;List Report Watermark;BLOB          }
    { 70  ;   ;Payment Note        ;Text250        }
    { 80  ;   ;Legal Conditions    ;Text250        }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE InitSetup@1000000000();
    BEGIN
      IF GET THEN
        EXIT;

      INIT;
      INSERT;
    END;

    PROCEDURE ReplaceReportSelection@1(HideDialog@1000 : Boolean);
    VAR
      DoYouWantToQst@1001 : TextConst 'ENU=Do you want to replace the current reports with the ForNAV reports?';
      ReplaceReportSel@1002 : Codeunit 70029;
    BEGIN
      IF NOT HideDialog THEN
        IF NOT CONFIRM(DoYouWantToQst, TRUE) THEN
          EXIT;

      ReplaceReportSel.RUN;
    END;

    PROCEDURE RunTest@2();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"ForNAV Test Runner");
    END;

    PROCEDURE DesignTemplate@1000000003();
    VAR
      Template@1000 : Report 70527;
    BEGIN
      Template.RUNMODAL;
    END;

    PROCEDURE DesignSalesTemplate@3();
    VAR
      SalesTemplate@1000 : Report 70529;
    BEGIN
      SalesTemplate.RUNMODAL;
    END;

    PROCEDURE DesignPurchaseTemplate@1000000001();
    VAR
      PurchaseTemplate@1000 : Report 70528;
    BEGIN
      PurchaseTemplate.RUNMODAL;
    END;

    PROCEDURE ImportWatermarkFromClientFile@21(Which@1000 : Integer) : Boolean;
    VAR
      TempBlob@1000000001 : TEMPORARY Record 99008535;
      FileMgt@1000000000 : Codeunit 419;
      FileName@1001 : Text;
    BEGIN
      FileName := FileMgt.BLOBImport(TempBlob,'');

      IF FileName <> '' THEN BEGIN
        CASE Which OF
          FIELDNO(Logo):
            Logo := TempBlob.Blob;
          FIELDNO("Document Watermark"):
            "Document Watermark" := TempBlob.Blob;
          FIELDNO("List Report Watermark"):
            "List Report Watermark" := TempBlob.Blob;
        END;
        EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    PROCEDURE GetLegalConditions@1000000002(LanguageCode@1000000001 : Code[10]) : Text;
    VAR
      LegalCondTranslation@1000000000 : Record 70001;
    BEGIN
      IF LegalCondTranslation.GET(LanguageCode) THEN
        EXIT(LegalCondTranslation."Legal Conditions");

      EXIT("Legal Conditions");
    END;

    PROCEDURE CheckLocalizationBasedOnTables@5();
    VAR
      DetectLocalization@1001 : Codeunit 70005;
    BEGIN
      DetectLocalization.CheckLocalizationBasedOnTables(Rec);
    END;

    PROCEDURE ValidateCurrentLocalization@4() : Boolean;
    VAR
      DetectLocalization@1001 : Codeunit 70005;
    BEGIN
      EXIT(DetectLocalization.ValidateCurrentLocalization(Rec));
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70001 ForNAV Legal Cond. Translation
{
  OBJECT-PROPERTIES
  {
    Date=14-07-17;
    Time=10:55:28;
    Version List=FORNAVCTP5;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 2   ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=ENU=Language Code }
    { 80  ;   ;Legal Conditions    ;Text250        }
  }
  KEYS
  {
    {    ;Language Code                           ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70220 ForNAV Accounts Receivb.Buffer
{
  OBJECT-PROPERTIES
  {
    Date=05-09-17;
    Time=17:00:00;
    Modified=Yes;
    Version List=VAM1,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 10  ;   ;Entry No.           ;Integer       ;CaptionML=ENU=Entry No. }
    { 20  ;   ;Type                ;Option        ;CaptionML=ENU=Type;
                                                   OptionCaptionML=ENU=Customer Entry,CustomerTotals,Grand Totals (LCY), Currency Totals Entry;
                                                   OptionString=CustomerEntry,CustomerTotals,GrandTotalsLCY,CurrencyTotals }
    { 30  ;   ;Customer No.        ;Code20        ;TableRelation=Customer;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Customer No. }
    { 35  ;   ;Customer Credit Limit (LCY);Decimal;CaptionML=ENU=Customer Credit Limit (LCY) }
    { 40  ;   ;Currency Code       ;Code10        ;CaptionML=ENU=Currency Code }
    { 42  ;   ;Original Currency Code;Code10      ;CaptionML=ENU=Original Currency Code }
    { 45  ;   ;Customer to Currency Groupping;Code31;
                                                   CaptionML=ENU=Customer to Currency Groupping }
    { 50  ;   ;Document Type       ;Option        ;CaptionML=ENU=Document Type;
                                                   OptionCaptionML=ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 60  ;   ;Document No.        ;Code20        ;CaptionML=ENU=Document No. }
    { 65  ;   ;Document Date       ;Date          ;CaptionML=ENU=Document Date }
    { 70  ;   ;Posting Date        ;Date          ;CaptionML=ENU=Posting Date }
    { 80  ;   ;Due Date            ;Date          ;CaptionML=ENU=Due Date }
    { 90  ;   ;Amount              ;Decimal       ;CaptionML=ENU=Amount }
    { 95  ;   ;Amount (LCY)        ;Decimal       ;CaptionML=ENU=Amount (LCY) }
    { 100 ;   ;Balance             ;Decimal       ;CaptionML=ENU=Balance }
    { 105 ;   ;Balance (LCY)       ;Decimal       ;CaptionML=ENU=Balance (LCY) }
    { 110 ;   ;Amount - Interval 1 ;Decimal       ;CaptionML=ENU=Amount - Interval 1 }
    { 115 ;   ;Amount - Interval 1 (LCY);Decimal  ;CaptionML=ENU=Amount - Interval 1 (LCY) }
    { 120 ;   ;Amount - Interval 2 ;Decimal       ;CaptionML=ENU=Amount - Interval 2 }
    { 125 ;   ;Amount - Interval 2 (LCY);Decimal  ;CaptionML=ENU=Amount - Interval 2 (LCY) }
    { 130 ;   ;Amount - Interval 3 ;Decimal       ;CaptionML=ENU=Amount - Interval 3 }
    { 135 ;   ;Amount - Interval 3 (LCY);Decimal  ;CaptionML=ENU=Amount - Interval 3 (LCY) }
    { 140 ;   ;Amount - Interval 4 ;Decimal       ;CaptionML=ENU=Amount - Interval 4 }
    { 145 ;   ;Amount - Interval 4 (LCY);Decimal  ;CaptionML=ENU=Amount - Interval 4 (LCY) }
    { 150 ;   ;Amount - Interval 5 ;Decimal       ;CaptionML=ENU=Amount - Interval 5 }
    { 155 ;   ;Amount - Interval 5 (LCY);Decimal  ;CaptionML=ENU=Amount - Interval 5 (LCY) }
    { 160 ;   ;New Page            ;Boolean       ;CaptionML=ENU=New Page }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Customer to Currency Groupping           }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70221 ForNAV Accounts Payables Buff.
{
  OBJECT-PROPERTIES
  {
    Date=05-09-17;
    Time=17:00:00;
    Modified=Yes;
    Version List=VAM1,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Accounts Payables Buffer;
  }
  FIELDS
  {
    { 10  ;   ;Entry No.           ;Integer       ;CaptionML=ENU=Entry No. }
    { 20  ;   ;Type                ;Option        ;CaptionML=ENU=Type;
                                                   OptionCaptionML=ENU=Vendor Entry,VendorTotals,Grand Totals (LCY), Currency Totals Entry;
                                                   OptionString=VendorEntry,VendorTotals,GrandTotalsLCY,CurrencyTotals }
    { 30  ;   ;Vendor No.          ;Code20        ;TableRelation=Vendor;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Vendor No. }
    { 40  ;   ;Currency Code       ;Code10        ;CaptionML=ENU=Currency Code }
    { 42  ;   ;Original Currency Code;Code10      ;CaptionML=ENU=Original Currency Code }
    { 45  ;   ;Vendor to Currency Groupping;Code31;CaptionML=ENU=Customer to Currency Groupping }
    { 50  ;   ;Document Type       ;Option        ;CaptionML=ENU=Document Type;
                                                   OptionCaptionML=ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 60  ;   ;Document No.        ;Code20        ;CaptionML=ENU=Document No. }
    { 65  ;   ;Document Date       ;Date          ;CaptionML=ENU=Document Date }
    { 70  ;   ;Posting Date        ;Date          ;CaptionML=ENU=Posting Date }
    { 80  ;   ;Due Date            ;Date          ;CaptionML=ENU=Due Date }
    { 90  ;   ;Amount              ;Decimal       ;CaptionML=ENU=Amount }
    { 95  ;   ;Amount (LCY)        ;Decimal       ;CaptionML=ENU=Amount (LCY) }
    { 100 ;   ;Balance             ;Decimal       ;CaptionML=ENU=Balance }
    { 105 ;   ;Balance (LCY)       ;Decimal       ;CaptionML=ENU=Balance (LCY) }
    { 110 ;   ;Amount - Interval 1 ;Decimal       ;CaptionML=ENU=Amount - Interval 1 }
    { 115 ;   ;Amount - Interval 1 (LCY);Decimal  ;CaptionML=ENU=Amount - Interval 1 (LCY) }
    { 120 ;   ;Amount - Interval 2 ;Decimal       ;CaptionML=ENU=Amount - Interval 2 }
    { 125 ;   ;Amount - Interval 2 (LCY);Decimal  ;CaptionML=ENU=Amount - Interval 2 (LCY) }
    { 130 ;   ;Amount - Interval 3 ;Decimal       ;CaptionML=ENU=Amount - Interval 3 }
    { 135 ;   ;Amount - Interval 3 (LCY);Decimal  ;CaptionML=ENU=Amount - Interval 3 (LCY) }
    { 140 ;   ;Amount - Interval 4 ;Decimal       ;CaptionML=ENU=Amount - Interval 4 }
    { 145 ;   ;Amount - Interval 4 (LCY);Decimal  ;CaptionML=ENU=Amount - Interval 4 (LCY) }
    { 150 ;   ;Amount - Interval 5 ;Decimal       ;CaptionML=ENU=Amount - Interval 5 }
    { 155 ;   ;Amount - Interval 5 (LCY);Decimal  ;CaptionML=ENU=Amount - Interval 5 (LCY) }
    { 160 ;   ;New Page            ;Boolean       ;CaptionML=ENU=New Page }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Vendor to Currency Groupping             }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70900 ForNAV Captions
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    DataPerCompany=No;
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10         }
    { 2   ;   ;Unit Price          ;Boolean       ;CaptionML=[ENU=Unit Price;
                                                              ESM=Precio unitario;
                                                              FRC=Prix unitaire;
                                                              ENC=Unit Price] }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70998 ForNAV Sales Tax Buffer
{
  OBJECT-PROPERTIES
  {
    Date=17-07-17;
    Time=15:23:01;
    Modified=Yes;
    Version List=FORNAVCTP5;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10         }
    { 2   ;   ;Exempt Amount       ;Decimal        }
    { 3   ;   ;Taxable Amount      ;Decimal        }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70999 ForNAV Document Line Buffer
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Version List=FORNAVCTP3;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;VAT %               ;Decimal       ;CaptionML=[ENU=VAT %;
                                                              NLD=Btw %];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 2   ;   ;VAT Base            ;Decimal       ;CaptionML=[ENU=VAT Base;
                                                              NLD=Basisbedrag btw];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 3   ;   ;VAT Amount          ;Decimal       ;CaptionML=[ENU=VAT Amount;
                                                              NLD=Btw-bedrag];
                                                   AutoFormatType=1 }
    { 4   ;   ;Amount Including VAT;Decimal       ;CaptionML=[ENU=Amount Including VAT;
                                                              NLD=Bedrag incl. btw];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5   ;   ;VAT Identifier      ;Code10        ;CaptionML=[ENU=VAT Identifier;
                                                              NLD=Btw-identificatie];
                                                   Editable=No }
    { 6   ;   ;Line Amount         ;Decimal       ;CaptionML=[ENU=Line Amount;
                                                              NLD=Regelbedrag];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 7   ;   ;Inv. Disc. Base Amount;Decimal     ;CaptionML=[ENU=Inv. Disc. Base Amount;
                                                              NLD=Basisbedrag factuurkorting];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 8   ;   ;Invoice Discount Amount;Decimal    ;CaptionML=[ENU=Invoice Discount Amount;
                                                              NLD=Bedrag factuurkorting];
                                                   AutoFormatType=1 }
    { 9   ;   ;VAT Calculation Type;Option        ;CaptionML=[ENU=VAT Calculation Type;
                                                              NLD=Btw-berekening];
                                                   OptionCaptionML=[ENU=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                                    NLD=Normaal,Verlegging,Volledig,Sales tax];
                                                   OptionString=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                   Editable=No }
    { 10  ;   ;Tax Group Code      ;Code10        ;TableRelation="Tax Group";
                                                   CaptionML=[ENU=Tax Group Code;
                                                              NLD=Tax Group Code];
                                                   Editable=No }
    { 11  ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NLD=Aantal];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 12  ;   ;Modified            ;Boolean       ;CaptionML=[ENU=Modified;
                                                              NLD=Gewijzigd] }
    { 13  ;   ;Use Tax             ;Boolean       ;CaptionML=[ENU=Use Tax;
                                                              NLD=Use Tax] }
    { 14  ;   ;Calculated VAT Amount;Decimal      ;CaptionML=[ENU=Calculated VAT Amount;
                                                              NLD=Berekend btw-bedrag];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 15  ;   ;VAT Difference      ;Decimal       ;CaptionML=[ENU=VAT Difference;
                                                              NLD=Btw-verschil];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 16  ;   ;Positive            ;Boolean       ;CaptionML=[ENU=Positive;
                                                              NLD=Positief] }
    { 17  ;   ;Includes Prepayment ;Boolean       ;CaptionML=[ENU=Includes Prepayment;
                                                              NLD=Inclusief vooruitbetaling] }
    { 18  ;   ;VAT Clause Code     ;Code10        ;TableRelation="VAT Clause";
                                                   CaptionML=[ENU=VAT Clause Code;
                                                              NLD=Code btw-clausule] }
    { 19  ;   ;Tax Category        ;Code10        ;CaptionML=[ENU=Tax Category;
                                                              NLD=Belastingcategorie] }
    { 70000;  ;Line No.            ;Integer        }
    { 70001;  ;Amount              ;Decimal        }
    { 70002;  ;Allow Invoice Disc. ;Boolean        }
    { 70003;  ;Inv. Discount Amount;Decimal        }
  }
  KEYS
  {
    {    ;Line No.                                ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE CreateForRecRef@1000000000(VAR RecRef@1000000000 : RecordRef);
    VAR
      Fld@1000000002 : Record 2000000041;
    BEGIN
      FindAndSetField(RecRef, 'Line No.', 70000);

      Fld.SETRANGE(TableNo, DATABASE::"ForNAV Document Line Buffer");
      Fld.SETFILTER("No.", '<>70000');
      Fld.FINDSET;
      REPEAT
        FindAndSetField(RecRef, Fld.FieldName, Fld."No.");
      UNTIL Fld.NEXT = 0;
    END;

    LOCAL PROCEDURE FindAndSetField@1000000004(VAR RecRef@1000000003 : RecordRef;FieldName@1000000002 : Text;FieldNo@1000000004 : Integer);
    VAR
      FldRef@1000000001 : FieldRef;
      Fld@1000000000 : Record 2000000041;
      ThisRecRef@1000000006 : RecordRef;
      ThisFld@1000000005 : FieldRef;
    BEGIN
      Fld.SETRANGE(TableNo, RecRef.NUMBER);
      Fld.SETRANGE(FieldName, FieldName);
      IF NOT Fld.FINDFIRST THEN
        EXIT;

      FldRef := RecRef.FIELD(Fld."No.");

      ThisRecRef.GETTABLE(Rec);
      ThisFld := ThisRecRef.FIELD(FieldNo);
      ThisFld.VALUE := FldRef.VALUE;

      ThisRecRef.SETTABLE(Rec);
      IF FieldNo = 70000 THEN
        INSERT
      ELSE
        MODIFY;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Report 70000 ForNAV VAT Order Confirmation
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Objedn vka;
               DAN=Ordre;
               DEU=Auftrag;
               ENU=Order;
               FIN=Tilaus;
               FRA=Commande;
               ISL=P”ntun;
               ITA=Ordine;
               NLD=Order;
               NOR=Ordre;
               SVE=Order;
               DES=Auftrag;
               ENG=Order;
               ESM=Pedido;
               FRB=Commande;
               ITS=Ordine;
               NLB=Order;
               DEA=Auftrag;
               ENA=Order;
               ESN=Pedido;
               FRC=Commande;
               ENC=Order;
               FRS=Commande;
               ENZ=Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Order));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=ENU=No. of Copies;
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>384fc2cb-777f-428c-89ab-68908e2a47a6</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>7773fc49-d108-4ce4-9117-c39eebdce5a7</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70001 ForNAV VAT Sales Invoice
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP5,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Faktura;
               DAN=Faktura;
               DEU=Rechnung;
               ENU=Invoice;
               FIN=Lasku;
               FRA=Facture;
               ISL=Reikningur;
               ITA=Fattura;
               NLD=Factuur;
               NOR=Faktura;
               SVE=Faktura;
               DES=Rechnung;
               ENG=Invoice;
               ESM=Factura;
               FRB=Facture;
               ITS=Fattura;
               NLB=Factuur;
               DEA=Rechnung;
               ENA=Invoice;
               ESN=Factura;
               FRC=Facture;
               ENC=Invoice;
               FRS=Facture;
               ENZ=Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  //ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000 : Text;Operation@1001 : Text;GroupTotalFieldNo@1002 : Integer);
    VAR
      CurrRecRef@1003 : RecordRef;
      NextRecRef@1004 : RecordRef;
      CurrKeyRef@1005 : KeyRef;
      NextKeyRef@1006 : KeyRef;
      FieldIndex@1007 : Integer;
      GroupFieldIndex@1008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>99a71924-5a77-4f00-8ce5-663f6c0bcad1</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>c6cc08ea-3577-4021-ae9c-0961aec3a829</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70002 ForNAV VAT Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Dobropis;
               DAN=Kreditnota;
               DEU=Gutschrift;
               ENU=Credit Memo;
               FIN=Hyvityslasku;
               FRA=Avoir;
               ISL=Kreditreikningur;
               ITA=Nota credito;
               NLD=Creditnota;
               NOR=Kreditnota;
               SVE=Kreditnota;
               DES=Gutschrift;
               ENG=Credit Memo;
               ESM=Nota de cr‚dito;
               FRB=Avoir;
               ITS=Nota credito;
               NLB=Creditnota;
               DEA=Gutschrift;
               ENA=CR/Adj Note;
               ESN=Abono;
               FRC=Note de cr‚dit;
               ENC=Credit Memo;
               FRS=Avoir;
               ENZ=Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table114;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table115;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=ENU=No. of Copies;
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000 : Text;Operation@1001 : Text;GroupTotalFieldNo@1002 : Integer);
    VAR
      CurrRecRef@1003 : RecordRef;
      NextRecRef@1004 : RecordRef;
      CurrKeyRef@1005 : KeyRef;
      NextKeyRef@1006 : KeyRef;
      FieldIndex@1007 : Integer;
      GroupFieldIndex@1008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>14d680d8-041a-4440-baf5-791cede8ca88</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>a16a3f3a-3695-46fe-a6c0-42e178b407cc</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70003 ForNAV Sales Shipment
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Prodejn¡ dod vka;
               DAN=Salgsleverance;
               DEU=Verkaufslieferung;
               ENU=Sales Shipment;
               FIN=Myyntitoimitus;
               FRA=Exp‚dition vente;
               ISL=S”luafhending;
               ITA=Spedizione vendita;
               NLD=Verkoopverzending;
               NOR=Fûlgeseddel;
               SVE=Utleverans;
               DES=Verkaufslieferung;
               ENG=Sales Shipment;
               ESM=Remisi¢n de venta;
               FRB=Exp‚dition vente;
               ITS=Spedizione vendita;
               NLB=Verkoopverzending;
               DEA=Verkaufslieferung;
               ENA=Sales Shipment;
               ESN=Albar n de venta;
               FRC=Livraison de vente;
               ENC=Sales Shipment;
               FRS=Exp‚dition vente;
               ENZ=Sales Shipment];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table110;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table111;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
      "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000 : Text;Operation@1001 : Text;GroupTotalFieldNo@1002 : Integer);
    VAR
      CurrRecRef@1003 : RecordRef;
      NextRecRef@1004 : RecordRef;
      CurrKeyRef@1005 : KeyRef;
      NextKeyRef@1006 : KeyRef;
      FieldIndex@1007 : Integer;
      GroupFieldIndex@1008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>71c42de7-bd96-4668-89a4-dd12cad22b80</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>99dd1e6e-46d8-4f3a-ad2e-b751d967267d</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70004 ForNAV VAT Sales Quote
{
  OBJECT-PROPERTIES
  {
    Date=01-08-17;
    Time=09:58:55;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=ENU=Quote;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000 : Text;Operation@1001 : Text;GroupTotalFieldNo@1002 : Integer);
    VAR
      CurrRecRef@1003 : RecordRef;
      NextRecRef@1004 : RecordRef;
      CurrKeyRef@1005 : KeyRef;
      NextKeyRef@1006 : KeyRef;
      FieldIndex@1007 : Integer;
      GroupFieldIndex@1008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>5p0AAO1de3PbuHb/vzP9Dqw6re25ujIBEgC5G90dP5KNp47tazvJzu10PHyANm9oUaWoJL5tZ/pp+sH6SQrwJT5ACRQp29vdZOJYFInH73cAnHNwcPjmp++PgfKVRgs/nE1HYKKOFDpzQtef3U9Hy9j7ozH66U9//3dvfokj65rOwyhenFtP4TK+oZFvBf7faKSsfv1UFKRP4ATx0iqXRsqF9Uino6ykd2F0YX0dKSfhLI7C4PZpzr47pV/ffp9HdLGYlCqdfDwrfYRjpeW2r7yacV6rMlXyloyVk2UQLyPKrs3okj0SjJWrpR34zr/Qp9vwC+V3u8SxDGpAlXg61VXW/lN/MQ+sp7TdvMFHn5RPR7fKjRXQhfLnZRjTkVLpT9FjOFHZXwAxK+bS/it14otwOiKqquoj5Z1PA/cztRl4X32HfoyC6eghjuc/HB7OrK8u/foDUXXjkFV3eHlqxdbhSfg4t2ZP+3sn15cXH2/+Capns5hGMytmlVkB+3weu5O9g5FyZd3T99S/f4hZG0yiplc++278wC4A3qsPVnTvzxbTkaYyZAD/AbMfrGmMjunoiJM6Vsx5PFacByu6ofGU4zH3WSFIzzv9ceazm2/pLH5YXHpHH/wg8B8paxjr8+wqouldH6wFu3TjRP48LmBMIbyljwxghiITM0V5c2zN3EXyK/twFtNHkMnMe2q5vNSKsKSIc3z4rfxZJmL0G+/vFY2uqRNG7nQUR0tG0okVOAnqrNtHj+FyFitnMydYclnnlI7TiyPlNoytIL8Tq2MMRsrPUbicV77QGBZZvZ+sqNrG/Itbyw7Y5eQ/Ddeuf/Lpt+no5vL69uzi5/2LcHKgfH7/9vrt/mnoLB8ZoErSx5PLi5vb/UTQDg5WRZz7sy/TEWfh39/5AQOX18168uG8cjVvLSt+fBUuYt7XU442w3HuU/YNYKSeMZAgf2pBY47dxfLRplEOXMJjXm/O4SjjqEZZibZr6iUoCQhLccroSpDL+1wgWIjZseV8OQmDkDXnmAl1QuTs5iFK+u9ZwYJduWKfmIx9v5w5nHfehep3l7O3bJJ7Sr9Ie5WJJBuVyWAVyuS43qyjIAi/pRC8jaIwWuSl3fj3bCSy6WU6cgzdIbZOPdOhLtE84gFIdA+x6x4kQKOWhU3i8IfSysUIpCP43XRkaGwaUVUwKkHMQM5gXVSuVsHXheDf0u/xcfh9VBlXd6dLmsrFDZvIWa2akdQKdX2MzInJ/rDSzkMnmW7eBaHFZABoIPnKMMYKJumv+fRxQ+9Dqnw8GyvGPOYXI5qzGDBGywzzBh0FDEDe/enog++6Ab3mvWcohNHfku/YopFe4XdPR//73/9TtJiLJpudElEv92mS31GDiIF0Ez8FlElGGPnxUwoWGikfFzRtfCY6yeei3auLtQZnXxzWmThMqBDxA9MqsQw/J8soSifRu5uYjRgrck+sOWdhccfG8FPBGFuuxnypqZHEZnWE1RZaqiQksKZlNjFdtWNSb8ckeUYKZdJEWYwbFOGmpYUYHeQ66cF5GH5Zzhd3V9YTp+yWRo+LU7pIxjHrQFnoGYTJaIMQCOQdMjSJlkg6Qfj5ZL214a2yX+73pO1xKcrM3QwMTUSwnlbJ16T+DGfiuWIXJtSqGGQkq7hJsaquKDaFBI+VBQdpehwG7mayG/QVrepOXf6oFG0ASPImpkcX0YOyomFXeooZq7HMlDlpYWPt0rIFG5sXjkqbuy0jQOsFOxLBjrOiu6znNdgz5aKO/RrQ06Xd1AYbBNU2yGJffkiOANmFXEwAFhFAsqKlFmwhAZcRu3YRbsJ+B3NPUbMk4vn9cmAL1vMOYBMR2EZWdOdVvgCbGXPX9N5fMCM/0a9lYB96khG0QZKA5pNyVMiu02IqDBEVZlo03Ho5Plku4vCRRoKluI2HweedRhvkFt76Y1IkwH6Lrik05tSs7O1X3dIIaLES4ETTmDUHxkqbqbAZa6E0X4TKH5S9H5Q99l92Q4exIH5ajop+CzFQhVxkljXsvBQnDqTF3bEfBHdxeOS63HVZYQUmqpAGjabhwX10iRWOsSEeF52sjttwfk69OHHOxpnFwa5VLJD0hiaxaT8m9X6s51P8kByNu7LLhYY5yCxzKGeapy7Zs5kXRo8JXxWuO5IMNDUzPQdnOzMn19BdNzjXENvsdYXkbuzK6g9d2RW6D0DmP4BSqkXJ8VJfvta4WlTx/Nlt3Wp4CNLR2DI8+RrXvraV/DbdlrId2f1AaPiDzPLXxKrGle9w5+r6sZfd1GLQVPYuMh4J+yIfasjY3juTV8yKTTbO/hKGj2eP1r3QzhGMn7wAKWI00B1zoTUPMnNek1IsSsPhKulZhiEUjwWA1DXDYUdOshbAVyMguUUOZVn1oSsVQgsfZCa+1kWvyJbTXFEtK3lIyEnivtygYA/PTKYICFrbqjQ075XjbFe6gtApADKvgNbZKyDUBfUye2t8YimJz77b0sWe3dKC1XalDAjdDCDzM2id/QxC+owVfXo6wNqdzJnTExjaWCF6TvbzcbnZJdTJCaTtSlMQ+iRA5pTQuzglxP7PDlucCLzAzCnvNO3uJtVlPRVdSav6MN4cCvapmzuj5V1RXayOvAvDuBozkF5ZHytwxXigZ7PjMGYrSb5Z3xYSsC6MoBl0IBVAkLexFB+AXAdQZFmGw/4i07RM1dYAslUVWRASDLBGXBs4tfiAvKQiLgAidYuQAHFARtfZDheDCCQ6tC40huR2nRuj4oTO0p6uhkV+6cMyiP1zf1ZQlg6Uf/3nf/x++iP7cfSjSLt+CGf0IlSUf5gqe3vKT0qbBVu4nfIn/qDsKanzaV2xPyizZRCMlbWNeHv3wfID+SZk969tQXZPVv/a6t8zPYrLcwcQikfWtqG4SwqFhmYg35zmo3m7xA1r3i/VwrPjowv5RiV3r8UnuUOq5pvPZ+9uT0K3C0erZ9Y2YnVb2pJVO/5tsvrdSyLG9r3lLJl2lP2vVnCg/EdE2bw1U9iHH//rYPLX0J/t7yn/qewdiNaj30fi7yPx95H47CNRTuXThSrfUNFsOhrOZw6r+oXY1wpMgYKBV77Ws9gKfKePupFqFz/T+JzeWwHrnOsnbO8f/Cia/MQ3ynGDe3MDZRVvWFe8tYwbrlhJBFjnn66siLWKxw7nMauVAGnuQG5ESKdVCOOjydr46CIomkcy81L4L7V4aIYkZU1yBJHYabh0uZDpu7O356f7aSniKGreNa2mY9eDnRsKttidcBy6T2XbhfdgwS9uMF+Gt0hKNZeMEoJd19JNVcWmq5mOoxPiqR5yEcQqs35NCwPXZFdrRkmpsMIuwapA5FtMkwZ6ZgWgRA5qeP5ynV3dMEGkO9oEYVz1/QtawNpwHX4Tta3ePmZyldvHnhK3LvliRezn7DSGOkGYmCqAmp79Im5OChkNhHgJ2wXE7eBllFucRAKs2iW0zgrfA7+31HITG5DoBKsQmho0kGgG5HUk+/tddrGYILPZ/1sRSv8QfrtcxvNlnJXHptXLZJX9ZAVLur/He7h3oEynyhr4EoREYd6wx0RbKVy4IDYIyhZHVLe72wiqRvdKMlV5KKcMTpCBIYIaANgwiY5bCas8XmWjO74CJWMzjPXt2gaM2c4tqusYbTD+eWnNYtYoeQxXTzRlXtd0bACTsFF2HFizL3+hUZiLawumq+K6ef76wt9Hj2jyUt+rbfCSbdsiIskLPy4Weh+otUg2TGXJqT1WZwipGma/AMJDZFsIqRXxvKwYg7JS381tsJJt7CJTkhX+49RfOPz825UTy/PSeLA5djRsGAjpfJtFduw0Su1DVmU9OX2aWY++s8h0Wlb35L21yOuaTrejl2sfA9Jb3yFu0JttFmPZRZ+LPmux03HAZY80KSVENQEySQdKS+U968jDwy739Y3gBjXZnjCWXe7zM6eyvOT356SACTA1jJBqQB2qKjCxPCfFeddnJaSPE6JJSH1rt/z9OgV6nfb25rDFGmh7SGhrZ18lOxbMqFs+zjIA0FZHBcVBBs2DtIldMvwpWnnTMq+7ZFwaqkGhh7DqucyOxLZDsUFUZHpA9RyAdUyJBqBniIzLxnFYfn59a/sSEwFO0lZmcnReuM1VAjrkW+cLBnOy5djP3MSGoLkDGJ3K0TIO3/GD++sHcScbFMtqG/XY9Ls2ma1BuTmuUmi64omh6tBUiYmwppk6j9dp7CO2TJH1aPTGZJk2rRFNnbd4g63befYkYk2jQOr5DFoiq3zUDqKtTM022uVZFpu95kQ3EESGgXXNhCo/B7Ad3ZXiX5h3sRozIO+yFjiR1WyqvOfmcH/Sm3Z6PsA1E7AZGmpbE95qs6e0NqPoBXSvtKR8dc2zj/QTALHaNKAAyJr6RNYFUxUAbgBc5uZ3fylocQjkooABYv+gyg/FbScL690Fr0AgxI6eAQVC1stAZH0/VYGoGfntIlGPqZMXklbvRC4myAAQ6JrOQ862E5NNroqtBOV5vRdE7JwSRgIOKF6yXg6ynVpZOBx2IVgC70ghUqqOdUKQvrWW2e4qeflZxxDrn7uWFVm3i7GdUpo6QsqC0nOBErCaZRzjwSH7pdOstSPHEd++fsrDSA72So4ebYJVg01Y7I8BATS2lq9tWzLwzNZd9nauAz+rM6mlk+mxo5K7pr2nog51dlFJZFtqOZMUWbNF0/9UuvzsoQ2Vukv+J9sGgCDPNSyiQkSQrdm2YyPHtk3PpkA3LIsgi+8dVfxPleJW/qc+8Q1817xR+Ov1P/FJptHc1+p/MrbTQy/CuxaZ7eduAqqmY0QA2toEeXl3kyFWDV/A3WRspwWW3U29WV7rbsLEIIZBNH6u5lfvbjJ37maUdTeZ22l0hbupN+m/GndTL753rlrJepfM7dyLFW9Nf9JlvUuvyLnUi/6dOxdlfUnmds7Fui+pVQCewZeEfsOuJFPslHwtriRzOw1x5UragVz9Zl1J5su4HWVdSaaswnkRqq/LQ6QZTHxMPQkF+m15iBL7+P+9iwioYDc+oqrFBVS5tEDsDn+2pO5d5jnNo8ry9EBmmqmEGMIsQXop59mG1FmSx7k251QoYu7WhsV14EOcKkhexNpNorIpBFSp5EANQurJy4A4ORCASN1MAp/DxoqYiix9fFZ99xzy+YMdkBck/GkHuGmDbPCKrk9R3pL2h6sIzVwVpcsv4xYVJKIwbZs4qu7aqsP0DERVg1uztodd18UedIjumZphU5FbtJGNwmTjGOuQbO8bBWpdPetxgFSXE/dflbALFKY+03tdwemBtrbKqdOSDU5XN6L9aud30De8v21+3zD9rE3BD+qOsbYsOclO5gvNPJW6SzOPpuq2SwmwsY1sYFsGhJTaTEiAB7EFNYNaQLctKAoIbubBUVGSQcsUnAaUnnvkXmmQfUSryQWo+RtDINCamb74iqrrmQIkerPWOtEvvzriIhTnf0pxZ9eW80n51g7SLdBeekwrfBctbdrNgzWnYliTr6p7W0iIXTVpJ38qLYaP/vQoeZZjsPh8E0c0dh5ye+dods9PmJuCPbsUEV5m3nSU1VE+qt5DX5N7XUAzzSyWVZ619GuCxwpMhMyEPDpvowkqELP2OTMz/rrPmhKv+lmBKfIPV9QtudcBNME0Ni5NJRSNdKhCybclVaAp3iX36ej2j1XQNqG65tEOeAuy8LXjLXLIVl/xIpVer4k32Yh3+rbBnvJ6s7STZBNdFa/iOXlgRTn924EV+SIrL3GRS+PfBNaUAxbo6WqoifNJVoFtnLCoI70OygTH7k6ibnxtV0kHcsW2u7wbReRPrLwzRu5VAXJ6ttplMhtWEoo1ojxZdZrZurAiTuQrz4rITVd5ucyQCf5BmZU8o2jrAO24xjDcb63v7QvJ2sFTPNgB+k7Ldj1D60abpjo9vjlsvDu0oQ1kWkDaWyZGaY+GTVUExnisjaEgX1GtQlHiIsijJdZkLuJvCz5zWfW+59NozD/yV9Eug0Q2kpe8jhlT6StmFT6LjRkBCrvE39jqx/5XKv3eV95Dnu4++QNGiSUWRlb0JHKpb8xlBKDYR1BPZsS69CKpjIp6S6YlMx514lFDR0iFtgWgCygxVM1mgDjYQYZmOrZFvZppWRQ1SBojoBV5gmIuEC272jJJzgZLXQT4OlBqE3uspVnPnbwINF5A0L7XhuSPyjNKV8Ou3A2d8C0yZBIV6CZEmjCTUWXgT2pl9d2nEr1cYLhYOdB4i0A7nrgTnrUUH9sBmRTSG0FJz38VQdmoM9DI6d+OIOmWLaWewGErFMsF9UZScsGvIikbzwUa6fXbkTQ6yeIgQJbK6Y2jpP1dxVE2MAo00t2342h2wvHYWtD+KKal9MVQlJS+T/jPa80BAviBw+5JQEBL9vbmKQzGyAvlACnVXNLKXGwBB1oWEy0KDaRiTYUQey5yXIgtz9YtEzoerOe8LxVW6GWkj16m6xUdqGWWl0o+O5xipqO6YtbSrmdXzHTZZbAUu772NEqHwLgh1bdG/uohlTld/NoaGWdFUW43/a6RY1aCFjAcLf21wAYfg+iEuvg9NN2JkFYTkeyiXCICDkTEYMpkMwp5KJUIid8x050QaW0TyVqSJUK04UbGDvgYUENF2/u6q3RIK61I1hAt0aEPR8cAqm2DjGEUXbS9g7tKxevWfTcfLgZI7IhvxrEw7F8oiqVUc0ml9RzsuDYFmuNhNtMBk5q6ptsQE09FFiUaU3Kp6eGmStuIYOnlakSkoj22HHF4XlcjMuoabUuznl2jlUmJG+cXxDpT8upkoVm9ar6pY6RhbBJdRSrUkxQ5PaeMliSzL3AWF0gnni1N66QNy7GyZm6X0XcgNjRDQ7oOAUbweZ1nLelld6hySmeWLWFv9MW+TbUpQy/OL78zd1tLHtkd6pZY9mxiCXlzAOQFWkxXkR9Mb8FyWcf6qJCvR2+pSkbbXnW5J5nyW1BwEljLRb99atGOdF6saDca4fW70Xx/ebvtZNh7OxnLvRun6OFLbSqXay87MaHmmKbDdDoEHKIRC2seW9u1xKkJqONZNrE0nqK1rvGVCxxG62sk293uPZ5AUi/sH7a/8S1bBUzlRBhJ5BcP/BJ+2zbzdS9HPj6mJQNv18MAfTcQePpdmQ2EtllrZTfW73iT1rOoT2ugOhuowtiv1RFyJljhMnLo2+/zKB9qJw/U+VK8qji7sXzufD8VWDY/pYFjNLO8C0B5lam8f5y51GNrm1vGgWNYbnwZkXI/31xThy1ZxW3lkcUjUi/CNO9gWxTYqs6KXsxzciaPpvg0IvRrj+UqHbcO8sdA9bHidXLJoaugUjlb7opevDn8JY6sNA5scW49hcv4hvJjBmxwR3/6Pw==</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>faa5eff5-f4d7-4edf-b4e1-2c2c612c9ec2</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>7ee724cd-0a5b-4700-89ab-8a507dbec863</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70050 ForNAV Tax Order Confirmation
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Objedn vka;
               DAN=Ordre;
               DEU=Auftrag;
               ENU=Order;
               FIN=Tilaus;
               FRA=Commande;
               ISL=P”ntun;
               ITA=Ordine;
               NLD=Order;
               NOR=Ordre;
               SVE=Order;
               DES=Auftrag;
               ENG=Order;
               ESM=Pedido;
               FRB=Commande;
               ITS=Ordine;
               NLB=Order;
               DEA=Auftrag;
               ENA=Order;
               ESN=Pedido;
               FRC=Commande;
               ENC=Order;
               FRS=Commande;
               ENZ=Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Order));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=ENU=No. of Copies;
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>97489070-53f9-440d-9fc4-e4d9b427378d</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>8dbbb35d-3390-4317-8863-4b25d74cc2de</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70051 ForNAV Tax Sales Invoice
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Faktura;
               DAN=Faktura;
               DEU=Rechnung;
               ENU=Invoice;
               FIN=Lasku;
               FRA=Facture;
               ISL=Reikningur;
               ITA=Fattura;
               NLD=Factuur;
               NOR=Faktura;
               SVE=Faktura;
               DES=Rechnung;
               ENG=Invoice;
               ESM=Factura;
               FRB=Facture;
               ITS=Fattura;
               NLB=Factuur;
               DEA=Rechnung;
               ENA=Invoice;
               ESN=Factura;
               FRC=Facture;
               ENC=Invoice;
               FRS=Facture;
               ENZ=Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      //CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000 : Text;Operation@1001 : Text;GroupTotalFieldNo@1002 : Integer);
    VAR
      CurrRecRef@1003 : RecordRef;
      NextRecRef@1004 : RecordRef;
      CurrKeyRef@1005 : KeyRef;
      NextKeyRef@1006 : KeyRef;
      FieldIndex@1007 : Integer;
      GroupFieldIndex@1008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>7d983b08-124e-4213-92ba-8ee2828a299e</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>35c00885-982d-4fa2-b408-975535d83143</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70052 ForNAV Tax Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Dobropis;
               DAN=Kreditnota;
               DEU=Gutschrift;
               ENU=Credit Memo;
               FIN=Hyvityslasku;
               FRA=Avoir;
               ISL=Kreditreikningur;
               ITA=Nota credito;
               NLD=Creditnota;
               NOR=Kreditnota;
               SVE=Kreditnota;
               DES=Gutschrift;
               ENG=Credit Memo;
               ESM=Nota de cr‚dito;
               FRB=Avoir;
               ITS=Nota credito;
               NLB=Creditnota;
               DEA=Gutschrift;
               ENA=CR/Adj Note;
               ESN=Abono;
               FRC=Note de cr‚dit;
               ENC=Credit Memo;
               FRS=Avoir;
               ENZ=Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table114;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table115;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=ENU=No. of Copies;
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>393aac84-921a-4c38-b040-020b2e431ba1</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>19d2df28-e73c-4841-9847-42315e635e5c</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70054 ForNAV Tax Sales Quote
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=17:48:05;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=ENU=Quote;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>f4e77128-5230-40e9-94b1-ecc38f657eae</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>cf8c714b-f93b-44a8-83e4-e159a6f0a1ac</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70100 ForNAV VAT Purchase Order
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ objedn vka;
               DAN=Kûbsordre;
               DEU=Einkaufsbestellung;
               ENU=Purchase Order;
               FIN=Ostotilaus;
               FRA=Commande achat;
               ISL=Innkaupap”ntun;
               ITA=Ordine acquisto;
               NLD=Inkooporder;
               NOR=Bestilling;
               SVE=Ink”psorder;
               DES=Einkaufsbestellung;
               ENG=Purchase Order;
               ESM=Pedido compra;
               FRB=Commande achat;
               ITS=Ordine acquisto;
               NLB=Inkooporder;
               DEA=Einkaufsbestellung;
               ENA=Purchase Order;
               ESN=Pedido compra;
               FRC=Bon de commande;
               ENC=Purchase Order;
               FRS=Commande achat;
               ENZ=Purchase Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>6390a597-99f1-4b57-8d65-fe917545f389</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>38e634da-13b0-474f-8a34-69defc0715cd</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70101 ForNAV VAT Purchase Invoice
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ faktura;
               DAN=Kûbsfaktura;
               DEU=Einkaufsrechnung;
               ENU=Purchase Invoice;
               FIN=Ostolasku;
               FRA=Facture achat;
               ISL=Innkaupareikningur;
               ITA=Fattura acquisto;
               NLD=Inkoopfactuur;
               NOR=Kjûpsfaktura;
               SVE=Ink”psfaktura;
               DES=Einkaufsrechnung;
               ENG=Purchase Invoice;
               ESM=Factura compra;
               FRB=Facture achat;
               ITS=Fattura acquisto;
               NLB=Inkoopfactuur;
               DEA=Einkaufsrechnung;
               ENA=Purchase Invoice;
               ESN=Factura compra;
               FRC=Facture achat;
               ENC=Purchase Invoice;
               FRS=Facture achat;
               ENZ=Purchase Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000 : Text;Operation@1001 : Text;GroupTotalFieldNo@1002 : Integer);
    VAR
      CurrRecRef@1003 : RecordRef;
      NextRecRef@1004 : RecordRef;
      CurrKeyRef@1005 : KeyRef;
      NextKeyRef@1006 : KeyRef;
      FieldIndex@1007 : Integer;
      GroupFieldIndex@1008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>9ae64c6b-6ca8-4035-8100-30462231b866</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>b0b6355f-4c8f-4992-bd72-d3b927c313cf</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70102 ForNAV VAT Purchase Cr. Memo
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ dobropis;
               DAN=Kûbskreditnota;
               DEU=Einkaufsgutschrift;
               ENU=Purchase Credit Memo;
               FIN=Ostohyvityslasku;
               FRA=Avoir achat;
               ISL=Innkaupakreditreikningur;
               ITA=Nota credito acquisto;
               NLD=Inkoopcreditnota;
               NOR=Kjûpskreditnota;
               SVE=Ink”pskreditnota;
               DES=Einkaufsgutschrift;
               ENG=Purchase Credit Memo;
               ESM=Nota cr‚dito compra;
               FRB=Avoir achat;
               ITS=Nota credito acquisto;
               NLB=Inkoopcreditnota;
               DEA=Einkaufsgutschrift;
               ENA=Purchase CR/Adj Note;
               ESN=Abono compra;
               FRC=Note de cr‚dit d'achat;
               ENC=Purchase Credit Memo;
               FRS=Avoir achat;
               ENZ=Purchase Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table124;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table125;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000 : Text;Operation@1001 : Text;GroupTotalFieldNo@1002 : Integer);
    VAR
      CurrRecRef@1003 : RecordRef;
      NextRecRef@1004 : RecordRef;
      CurrKeyRef@1005 : KeyRef;
      NextKeyRef@1006 : KeyRef;
      FieldIndex@1007 : Integer;
      GroupFieldIndex@1008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>66770840-dd11-4218-8fb5-3ff9f4d55394</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>1a7fb42d-9761-4fcf-b4f0-688a7d813c3f</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70104 ForNAV VAT Purchase Quote
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ popt vka;
               DAN=Kûbsrekvisition;
               DEU=Einkaufsanfrage;
               ENU=Purchase Quote;
               FIN=Ostotarjous;
               FRA=Demande de prix;
               ISL=Innkaupabei÷ni;
               ITA=Offerta acquisto;
               NLD=Inkoopofferte;
               NOR=Forespûrsel;
               SVE=Ink”psoffert;
               DES=Einkaufsofferte;
               ENG=Purchase Quote;
               ESM=Cotizaci¢n compra;
               FRB=Demande de prix;
               ITS=Offerta acquisto;
               NLB=Inkoopofferte;
               DEA=Einkaufsanfrage;
               ENA=Purchase Quote;
               ESN=Oferta compra;
               FRC=Devis d'achat;
               ENC=Purchase Quote;
               FRS=Demande de prix;
               ENZ=Purchase Quote];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000 : Text;Operation@1001 : Text;GroupTotalFieldNo@1002 : Integer);
    VAR
      CurrRecRef@1003 : RecordRef;
      NextRecRef@1004 : RecordRef;
      CurrKeyRef@1005 : KeyRef;
      NextKeyRef@1006 : KeyRef;
      FieldIndex@1007 : Integer;
      GroupFieldIndex@1008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>70f1f9be-337d-4d36-a94a-34d4cfcff67f</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>a95ddc0c-6c0a-4d88-aff8-97a4fb95aede</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70150 ForNAV Tax Purchase Order
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ objedn vka;
               DAN=Kûbsordre;
               DEU=Einkaufsbestellung;
               ENU=Purchase Order;
               FIN=Ostotilaus;
               FRA=Commande achat;
               ISL=Innkaupap”ntun;
               ITA=Ordine acquisto;
               NLD=Inkooporder;
               NOR=Bestilling;
               SVE=Ink”psorder;
               DES=Einkaufsbestellung;
               ENG=Purchase Order;
               ESM=Pedido compra;
               FRB=Commande achat;
               ITS=Ordine acquisto;
               NLB=Inkooporder;
               DEA=Einkaufsbestellung;
               ENA=Purchase Order;
               ESN=Pedido compra;
               FRC=Bon de commande;
               ENC=Purchase Order;
               FRS=Commande achat;
               ENZ=Purchase Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>0591fed3-91a4-4565-bfdf-6193991c9837</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>7a6070df-4c01-4229-baf7-66ddbe1d86c7</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70151 ForNAV Tax Purchase Invoice
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ faktura;
               DAN=Kûbsfaktura;
               DEU=Einkaufsrechnung;
               ENU=Purchase Invoice;
               FIN=Ostolasku;
               FRA=Facture achat;
               ISL=Innkaupareikningur;
               ITA=Fattura acquisto;
               NLD=Inkoopfactuur;
               NOR=Kjûpsfaktura;
               SVE=Ink”psfaktura;
               DES=Einkaufsrechnung;
               ENG=Purchase Invoice;
               ESM=Factura compra;
               FRB=Facture achat;
               ITS=Fattura acquisto;
               NLB=Inkoopfactuur;
               DEA=Einkaufsrechnung;
               ENA=Purchase Invoice;
               ESN=Factura compra;
               FRC=Facture achat;
               ENC=Purchase Invoice;
               FRS=Facture achat;
               ENZ=Purchase Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>6f5412ae-6e7d-4eaf-bf3b-88e76e0a1274</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>630e5c81-e5a0-4ced-bdaf-40d3e5a0bb80</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70152 ForNAV Tax Purchase Cr. Memo
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ dobropis;
               DAN=Kûbskreditnota;
               DEU=Einkaufsgutschrift;
               ENU=Purchase Credit Memo;
               FIN=Ostohyvityslasku;
               FRA=Avoir achat;
               ISL=Innkaupakreditreikningur;
               ITA=Nota credito acquisto;
               NLD=Inkoopcreditnota;
               NOR=Kjûpskreditnota;
               SVE=Ink”pskreditnota;
               DES=Einkaufsgutschrift;
               ENG=Purchase Credit Memo;
               ESM=Nota cr‚dito compra;
               FRB=Avoir achat;
               ITS=Nota credito acquisto;
               NLB=Inkoopcreditnota;
               DEA=Einkaufsgutschrift;
               ENA=Purchase CR/Adj Note;
               ESN=Abono compra;
               FRC=Note de cr‚dit d'achat;
               ENC=Purchase Credit Memo;
               FRS=Avoir achat;
               ENZ=Purchase Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table124;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table125;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>33b9bbe4-8f77-4651-a684-dab5780889da</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>1c70083f-39db-4234-9bf5-26a7a2562ab6</rd:ReportID>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Fields>
        <Field Name="HasDiscount">
          <DataField>HasDiscount</DataField>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70154 ForNAV Tax Purchase Quote
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ popt vka;
               DAN=Kûbsrekvisition;
               DEU=Einkaufsanfrage;
               ENU=Purchase Quote;
               FIN=Ostotarjous;
               FRA=Demande de prix;
               ISL=Innkaupabei÷ni;
               ITA=Offerta acquisto;
               NLD=Inkoopofferte;
               NOR=Forespûrsel;
               SVE=Ink”psoffert;
               DES=Einkaufsofferte;
               ENG=Purchase Quote;
               ESM=Cotizaci¢n compra;
               FRB=Demande de prix;
               ITS=Offerta acquisto;
               NLB=Inkoopofferte;
               DEA=Einkaufsanfrage;
               ENA=Purchase Quote;
               ESN=Oferta compra;
               FRC=Devis d'achat;
               ENC=Purchase Quote;
               FRS=Demande de prix;
               ENZ=Purchase Quote];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               OnPostDataItem=BEGIN
                                UpdateNoPrinted;
                              END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      IF NOT CurrReport.PREVIEW THEN
        EXIT;
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>405759bf-ea2f-4b28-bb71-bea88db74a3d</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>0f390ca0-d70a-4290-af4f-ce142113fc26</rd:ReportID>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Fields>
        <Field Name="HasDiscount">
          <DataField>HasDiscount</DataField>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70201 ForNAV Customer Top 10 List
{
  OBJECT-PROPERTIES
  {
    Date=01-08-17;
    Time=10:25:32;
    Modified=Yes;
    Version List=FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=ENU=Customer Top 10 List;
    OnInitReport=BEGIN
                                                                                                                              ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;                    ;
               DataItemTable=Table18;
               DataItemTableView=SORTING(Net Change (LCY))
                                 ORDER(Descending);
               OnAfterGetRecord=BEGIN
                                  i += 1;
                                  IF i = NoOfRecordsToPrint THEN
                                    CurrReport.BREAK;
                                END;

               ReqFilterFields=No.,Name,Customer Posting Group,Country/Region Code,Date Filter;
               CalcFields=Balance (LCY),Net Change (LCY) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   IF NoOfRecordsToPrint = 0 THEN
                     NoOfRecordsToPrint := 10;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Mo§nosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 1   ;2   ;Field     ;
                  CaptionML=ENU=Quantity;
                  ToolTipML=ENU=Specifies the number of customers that will be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfRecordsToPrint }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      NoOfRecordsToPrint@1000 : Integer;
      i@1001 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>f791f994-7bee-4307-8181-9aff4c97830d</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>0111578a-8881-4f05-a837-221cb19a785a</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70202 ForNAV Vendor Top 10 List
{
  OBJECT-PROPERTIES
  {
    Date=01-08-17;
    Time=10:28:36;
    Modified=Yes;
    Version List=FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=ENU=Customer Top 10 List;
    OnInitReport=BEGIN
                                                                                                                              ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;                    ;
               DataItemTable=Table23;
               DataItemTableView=SORTING(Net Change (LCY))
                                 ORDER(Descending);
               OnAfterGetRecord=BEGIN
                                  i += 1;
                                  IF i = NoOfRecordsToPrint THEN
                                    CurrReport.BREAK;
                                END;

               ReqFilterFields=No.,Name,Vendor Posting Group,Country/Region Code,Date Filter;
               CalcFields=Balance (LCY),Net Change (LCY) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   IF NoOfRecordsToPrint = 0 THEN
                     NoOfRecordsToPrint := 10;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Mo§nosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 1   ;2   ;Field     ;
                  CaptionML=ENU=Quantity;
                  ToolTipML=ENU=Specifies the number of customers that will be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfRecordsToPrint }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      NoOfRecordsToPrint@1000 : Integer;
      i@1001 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>8b16f5df-a310-4d83-bb98-786d693b7f03</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>b688741a-60ed-446a-b56e-467ff5a3a5a2</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70206 ForNAV Trial Balance
{
  OBJECT-PROPERTIES
  {
    Date=05-09-17;
    Time=17:00:00;
    Modified=Yes;
    Version List=FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Trial Balance;
    OnInitReport=BEGIN
                   ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);
                   ReportForNav.Init;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  CASE NumColumns OF
                    0:
                      ERROR(Text000);
                    1,2:
                      IF RoundTo = RoundTo::Pennies THEN
                        LineType := LineType::"9-Point"
                      ELSE
                        LineType := LineType::"9-Point Rounded";
                    3:
                      IF RoundTo = RoundTo::Pennies THEN
                        LineType := LineType::"8-Point"
                      ELSE
                        LineType := LineType::"9-Point Rounded";
                    4:
                      IF RoundTo = RoundTo::Pennies THEN
                        LineType := LineType::"8-Point"
                      ELSE
                        LineType := LineType::"8-Point Rounded";
                    5,6:
                      IF RoundTo = RoundTo::Pennies THEN
                        LineType := LineType::"7-Point"
                      ELSE
                        LineType := LineType::"7-Point Rounded";
                    7,8:
                      IF (RoundTo = RoundTo::Pennies) THEN
                        ERROR(Text001)
                      ELSE
                        LineType := LineType::"7-Point Rounded";
                    ELSE
                      ERROR(Text002);
                  END;
                  CASE LineType OF
                    LineType::"9-Point",LineType::"9-Point Rounded":
                      BEGIN
                        MaxDescWidth := 67;
                        PointSize := 9;
                      END;
                    LineType::"8-Point",LineType::"8-Point Rounded":
                      BEGIN
                        MaxDescWidth := 52;
                        PointSize := 8;
                      END;
                    LineType::"7-Point",LineType::"7-Point Rounded":
                      BEGIN
                        MaxDescWidth := 33;
                        PointSize := 7;
                      END;
                    ELSE
                      ERROR(Text003);
                  END;
                  FromDate := "G/L Account".GETRANGEMIN("Date Filter");
                  ToDate := "G/L Account".GETRANGEMAX("Date Filter");
                  PriorFromDate := CALCDATE('<-1Y>',FromDate + 1) - 1;
                  PriorToDate := CALCDATE('<-1Y>',ToDate + 1) - 1;
                  "G/L Account".SETRANGE("Date Filter");
                  CLEAR(PeriodText);
                  CLEAR(ColumnHead);
                  IF ColumnFlags[7] THEN BEGIN
                    PeriodText := 'As of ' + FORMAT(ToDate,0,4);
                    IF ColumnFlags[9] THEN BEGIN
                      IF Show = Show::Budget THEN
                        PeriodText := 'Actual vs Budget a' + DELSTR(PeriodText,1,1)
                      ELSE
                        PeriodText := PeriodText + ' and ' + FORMAT(DATE2DMY(PriorToDate,3));
                    END;
                  END ELSE
                    IF ColumnFlags[9] THEN BEGIN
                      IF Show = Show::Budget THEN
                        PeriodText := 'Budget as of ' + FORMAT(ToDate,0,4)
                      ELSE
                        PeriodText := 'As of ' + FORMAT(PriorToDate,0,4);
                    END ELSE
                      IF ColumnFlags[1] THEN BEGIN
                        PeriodText := 'Changes ';
                        IF ColumnFlags[3] AND (Show = Show::Budget) THEN
                          PeriodText := PeriodText + 'and Budgeted Changes ';
                        PeriodText := PeriodText + 'from '
                          + FORMAT(FromDate,0,4)
                          + ' to '
                          + FORMAT(ToDate,0,4);
                        IF ColumnFlags[3] AND (Show = Show::"Last Year") THEN
                          PeriodText := PeriodText + ' and from '
                            + FORMAT(PriorFromDate,0,4)
                            + ' to '
                            + FORMAT(PriorToDate,0,4);
                      END ELSE
                        IF ColumnFlags[3] THEN BEGIN
                          IF Show = Show::Budget THEN
                            PeriodText := 'Budgeted '
                          ELSE
                            PeriodText := '';
                          PeriodText := PeriodText + 'Changes from ';
                          IF Show = Show::Budget THEN
                            PeriodText := PeriodText + FORMAT(FromDate,0,4)
                              + ' to '
                              + FORMAT(ToDate,0,4)
                          ELSE
                            PeriodText := PeriodText + FORMAT(PriorFromDate,0,4)
                              + ' to '
                              + FORMAT(PriorToDate,0,4);
                        END;
                  IF UseAddRptCurr THEN BEGIN
                    GLSetup.GET;
                    Currency.GET(GLSetup."Additional Reporting Currency");
                    SubTitle := STRSUBSTNO(Text004,Currency.Description);
                  END;
                  { Column Headings }
                  IF Show = Show::Budget THEN
                    ColumnHead[3] := Text005
                  ELSE
                    ColumnHead[3] := Text006;
                  ColumnHead[9] := ColumnHead[3];
                  ColumnHead[5] := Text007;
                  ColumnHead[6] := Text008;
                  ColumnHead[11] := Text009;
                  ColumnHead[12] := Text010;
                  ColumnHead[1] := Text011;
                  ColumnHead[7] := Text012;
                  ColumnHead[3] := ColumnHead[3] + Text011;
                  ColumnHead[9] := ColumnHead[9] + Text012;
                  IF RoundTo = RoundTo::Thousands THEN
                    FOR i := 1 TO 12 DO
                      IF i MOD 2 = 1 THEN
                        ColumnHead[i] := ColumnHead[i] + Text013;
                  CompressColumns(ColumnHead);
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 6710;    ;DataItem;                    ;
               DataItemTable=Table15;
               DataItemTableView=SORTING(No.);
               PrintOnlyIfDetail=Yes;
               OnPreDataItem=BEGIN
                               IF ISEMPTY THEN
                                 ERROR(MissingGLAccountErr);
                             END;

               OnAfterGetRecord=BEGIN
                                  CLEAR(DescriptionLine2);
                                  CLEAR(DescriptionLine1);
                                  CLEAR(WorkAmount);
                                  IF ("Account Type" = "Account Type"::Posting) OR
                                     (Totaling <> '')
                                  THEN BEGIN
                                    SETRANGE("Date Filter",FromDate,ToDate);
                                    IF UseAddRptCurr THEN BEGIN
                                      CALCFIELDS("Additional-Currency Net Change","Add.-Currency Balance at Date");
                                      WorkAmount[1] := "Additional-Currency Net Change";
                                      WorkAmount[7] := "Add.-Currency Balance at Date";
                                    END ELSE BEGIN
                                      CALCFIELDS("Net Change","Balance at Date");
                                      WorkAmount[1] := "Net Change";
                                      WorkAmount[7] := "Balance at Date";
                                    END;
                                    IF Show = Show::Budget THEN BEGIN
                                      CALCFIELDS("Budgeted Amount","Budget at Date");
                                      WorkAmount[3] := "Budgeted Amount";
                                      WorkAmount[9] := "Budget at Date";
                                    END ELSE BEGIN
                                      SETRANGE("Date Filter",PriorFromDate,PriorToDate);
                                      IF UseAddRptCurr THEN BEGIN
                                        CALCFIELDS("Additional-Currency Net Change","Add.-Currency Balance at Date");
                                        WorkAmount[3] := "Additional-Currency Net Change";
                                        WorkAmount[9] := "Add.-Currency Balance at Date";
                                      END ELSE BEGIN
                                        CALCFIELDS("Net Change","Balance at Date");
                                        WorkAmount[3] := "Net Change";
                                        WorkAmount[9] := "Balance at Date";
                                      END;
                                    END;
                                    IF ColumnFlags[5] OR ColumnFlags[6] THEN
                                      WorkAmount[5] := WorkAmount[1] - WorkAmount[3];
                                    IF ColumnFlags[6] AND (WorkAmount[3] <> 0.0) THEN
                                      WorkAmount[6] := WorkAmount[5] / WorkAmount[3] * 100.0;
                                    IF ColumnFlags[11] OR ColumnFlags[12] THEN
                                      WorkAmount[11] := WorkAmount[7] - WorkAmount[9];
                                    IF ColumnFlags[12] AND (WorkAmount[9] <> 0.0) THEN
                                      WorkAmount[12] := WorkAmount[11] / WorkAmount[9] * 100.0;
                                  END;
                                  DescriptionLine2 := PADSTR('',Indentation) + Name;
                                  ForNAVTrialBalanceParagrHandl.SplitPrintLine(DescriptionLine2,DescriptionLine1,MaxDescWidth,PointSize);
                                  IF NumbersToPrint THEN BEGIN
                                    FOR i := 1 TO 12 DO BEGIN
                                      IF RoundTo = RoundTo::Dollars THEN
                                        WorkAmount[i] := ROUND(WorkAmount[i],1)
                                      ELSE
                                        IF RoundTo = RoundTo::Thousands THEN BEGIN
                                          IF i MOD 2 = 0 THEN
                                            WorkAmount[i] := ROUND(WorkAmount[i],1)
                                          ELSE
                                            WorkAmount[i] := ROUND(WorkAmount[i] / 1000,1);
                                        END ELSE
                                          WorkAmount[i] := ROUND(WorkAmount[i],0.01);
                                    END;
                                    { now format the strings }
                                    FOR i := 1 TO 12 DO BEGIN
                                      PrintAmount[i] := FORMAT(WorkAmount[i]);
                                      IF RoundTo = RoundTo::Pennies THEN BEGIN
                                        j := STRPOS(PrintAmount[i],'.');
                                        IF j = 0 THEN
                                          PrintAmount[i] := PrintAmount[i] + '.00'
                                        ELSE
                                          IF j = STRLEN(PrintAmount[i]) - 1 THEN
                                            PrintAmount[i] := PrintAmount[i] + '0';
                                      END;
                                      IF i MOD 2 = 0 THEN
                                        PrintAmount[i] := PrintAmount[i] + '%';
                                    END;
                                    CompressColumns(PrintAmount);
                                  END;
                                END;

               ReqFilterFields=No.,Account Type,Date Filter,Global Dimension 1 Filter,Global Dimension 2 Filter,Budget Filter }

    { 1008;1   ;Column  ;PeriodText          ;
               IncludeCaption=No;
               SourceExpr=PeriodText }

    { 1020003;1;Column  ;UseAddRptCurr       ;
               IncludeCaption=No;
               SourceExpr=UseAddRptCurr }

    { 1020004;1;Column  ;PageGroupNo         ;
               IncludeCaption=No;
               SourceExpr=PageGroupNo }

    { 1   ;1   ;Column  ;AddCurrSubTitle     ;
               IncludeCaption=No;
               SourceExpr=SubTitle }

    { 1000000000;1;Column;LineType           ;
               IncludeCaption=No;
               SourceExpr=LineType }

    { 12  ;1   ;Column  ;ColumnHead1         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[1] }

    { 13  ;1   ;Column  ;ColumnHead2         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[2] }

    { 43  ;1   ;Column  ;ColumnHead3         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[3] }

    { 88  ;1   ;Column  ;ColumnHead4         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[4] }

    { 196 ;1   ;Column  ;ColumnHead5         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[5] }

    { 197 ;1   ;Column  ;ColumnHead6         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[6] }

    { 204 ;1   ;Column  ;ColumnHead7         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[7] }

    { 205 ;1   ;Column  ;ColumnHead8         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[8] }

    { 8412;1   ;DataItem;BlankLineCounter    ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number);
               OnPreDataItem=BEGIN
                               SETRANGE(Number,1,"G/L Account"."No. of Blank Lines");
                             END;
                              }

    { 5444;1   ;DataItem;                    ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number)
                                 WHERE(Number=CONST(1));
               OnPostDataItem=BEGIN
                                IF "G/L Account"."New Page" THEN
                                  PageGroupNo := PageGroupNo + 1;
                              END;
                               }

    { 1000000001;2;Column;NumbersToPrint     ;
               IncludeCaption=No;
               SourceExpr=NumbersToPrint }

    { 14  ;2   ;Column  ;DescriptionLine1    ;
               IncludeCaption=No;
               SourceExpr=DescriptionLine1 }

    { 15  ;2   ;Column  ;DescriptionLine2    ;
               IncludeCaption=No;
               SourceExpr=DescriptionLine2 }

    { 8   ;2   ;Column  ;PrintAmt1           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[1] }

    { 9   ;2   ;Column  ;PrintAmt2           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[2] }

    { 28  ;2   ;Column  ;PrintAmt3           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[3] }

    { 55  ;2   ;Column  ;PrintAmt4           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[4] }

    { 105 ;2   ;Column  ;PrintAmt5           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[5] }

    { 106 ;2   ;Column  ;PrintAmt6           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[6] }

    { 114 ;2   ;Column  ;PrintAmt7           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[7] }

    { 115 ;2   ;Column  ;PrintAmt8           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[8] }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1020001;0;Container ;
                  ContainerType=ContentArea }

      { 1020000;1;Group     ;
                  CaptionML=ENU=Options }

      { 4   ;2   ;Field     ;
                  Name=ShowComaprison;
                  CaptionML=ENU=Show Comparison;
                  ToolTipML=ENU=Specifies if figures either from the prior year or for the defined budget are included.;
                  OptionCaptionML=ENU=Last Year,Budget;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Show }

      { 19  ;2   ;Group     ;
                  CaptionML=ENU=Select Report Columns }

      { 8   ;3   ;Field     ;
                  Name=ActualChange;
                  CaptionML=ENU=Actual Changes;
                  ToolTipML=ENU=Specifies that a column is added that shows the actual net change.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[1];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 9   ;3   ;Field     ;
                  Name=ComparisonChanges;
                  CaptionML=ENU=Comparison Changes;
                  ToolTipML=ENU=Specifies if you want to include the net changes from the selected period.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[3];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 10  ;3   ;Field     ;
                  CaptionML=ENU=Variance in Changes;
                  ToolTipML=ENU=Specifies if you want to include a column that shows the change variance. The variance is calculated by subtracting the budget or prior year amounts over the period defined from the actual amounts.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[5];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 14  ;3   ;Field     ;
                  CaptionML=ENU=% Variance in Changes;
                  ToolTipML=ENU=Specifies that a column is inserted that shows the percentage of variance in balances. The variance is calculated by dividing the variance by the actual amounts.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[6];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 16  ;3   ;Field     ;
                  Name=ActualBalances;
                  CaptionML=ENU=Actual Balances;
                  ToolTipML=ENU=Specifies that a column is added that shows the actual balance.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[7];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 17  ;3   ;Field     ;
                  Name=ComparisonBalances;
                  CaptionML=ENU=Comparison Balances;
                  ToolTipML=ENU=Specifies if you want to include the balance from the selected period.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[9];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 18  ;3   ;Field     ;
                  CaptionML=ENU=Variance in Balances;
                  ToolTipML=ENU=Specifies if you want to include a column that shows the balance variance. The variance is calculated by subtracting the budget or prior year amounts over the period defined from the actual amounts.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[11];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 22  ;3   ;Field     ;
                  CaptionML=ENU=% Variance in Balances;
                  ToolTipML=ENU=Specifies that a column is inserted that shows the percentage of variance in balances. The variance is calculated by dividing the variance by the actual amounts.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[12];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 24  ;2   ;Field     ;
                  CaptionML=ENU=Round to;
                  ToolTipML=ENU=Specifies if you want the results in the report to be rounded to the nearest penny (hundredth of a unit), dollar (unit), or thousand dollars (units). The results are in US dollars, unless you use an additional reporting currency.;
                  OptionCaptionML=ENU=Pennies,Dollars,Thousands;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=RoundTo;
                  OnValidate=BEGIN
                               IF RoundTo = RoundTo::Thousands THEN
                                 ThousandsRoundToOnValidate;
                               IF RoundTo = RoundTo::Dollars THEN
                                 DollarsRoundToOnValidate;
                               IF RoundTo = RoundTo::Pennies THEN
                                 PenniesRoundToOnValidate;
                             END;
                              }

      { 1   ;2   ;Field     ;
                  CaptionML=ENU=Skip Accounts with all zero Amounts;
                  ToolTipML=ENU=Specifies if you want the report to be generated with all of the accounts, including those with zero amounts. Otherwise, those accounts will be excluded.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=SkipZeros;
                  MultiLine=Yes }

      { 2   ;2   ;Field     ;
                  Name=UseAdditionalReportingCurrency;
                  CaptionML=ENU=Use Additional Reporting Currency;
                  ToolTipML=ENU=Specifies if you want all amounts to be printed by using the additional reporting currency. If you do not select the check box, then all amounts will be printed in US dollars.;
                  ApplicationArea=#Suite;
                  SourceExpr=UseAddRptCurr;
                  MultiLine=Yes }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      GLSetup@1001 : Record 98;
      Currency@1002 : Record 4;
      ForNAVTrialBalanceParagrHandl@1003 : Codeunit 70206;
      PeriodText@1004 : Text[120];
      SubTitle@1006 : Text[132];
      SkipZeros@1007 : Boolean;
      UseAddRptCurr@1008 : Boolean;
      Show@1009 : 'Last Year,Budget';
      RoundTo@1010 : 'Pennies,Dollars,Thousands';
      LineType@1011 : '9-Point,9-Point Rounded,8-Point,8-Point Rounded,7-Point,7-Point Rounded';
      ColumnFlags@1012 : ARRAY [12] OF Boolean;
      ColumnHead@1013 : ARRAY [12] OF Text[50];
      PrintAmount@1014 : ARRAY [12] OF Text[30];
      WorkAmount@1015 : ARRAY [12] OF Decimal;
      FromDate@1016 : Date;
      ToDate@1017 : Date;
      PriorFromDate@1018 : Date;
      PriorToDate@1019 : Date;
      DescriptionLine2@1020 : Text[80];
      DescriptionLine1@1021 : Text[80];
      MaxDescWidth@1023 : Integer;
      PointSize@1024 : Integer;
      j@1025 : Integer;
      i@1026 : Integer;
      Text000@1027 : TextConst 'ENU=You must select at least one Report Column.';
      Text001@1028 : TextConst 'ENU=If you want more than 6 Report Columns you must round to Dollars or Thousands.';
      Text002@1029 : TextConst 'ENU=You may select a maximum of 8 Report Columns.';
      Text003@1030 : TextConst 'ENU=Wrong columns layout. Contact you system administrator or contact support service for further assistance.';
      Text004@1031 : TextConst 'ENU=Amounts are in %1';
      Text005@1032 : TextConst 'ENU="Budgeted, "';
      Text006@1033 : TextConst 'ENU="Last Year, "';
      Text007@1034 : TextConst 'ENU=Change Variance';
      Text008@1035 : TextConst 'ENU=Change % Variance';
      Text009@1036 : TextConst 'ENU=Balance Variance';
      Text010@1037 : TextConst 'ENU=Balance % Variance';
      Text011@1038 : TextConst 'ENU=Net Change';
      Text012@1039 : TextConst 'ENU=Balance';
      Text013@1040 : TextConst 'ENU=" (Thousands)"';
      Text101@1480019 : TextConst 'ENU=Data';
      Text102@1480018 : TextConst 'ENU=Trial Balance';
      Text103@1480017 : TextConst 'ENU=Company Name';
      Text104@1480016 : TextConst 'ENU=Report No.';
      Text105@1480015 : TextConst 'ENU=Report Name';
      Text106@1480014 : TextConst 'ENU=User ID';
      Text107@1480013 : TextConst 'ENU=Date / Time';
      Text108@1480012 : TextConst 'ENU=G/L Account Filters';
      Text109@1480011 : TextConst 'ENU=Sub-Title';
      Text110@1480010 : TextConst 'ENU=Amounts are in';
      Text111@1480009 : TextConst 'ENU=our Functional Currency';
      PageGroupNo@1020001 : Integer;
      MissingGLAccountErr@1020000 : TextConst 'ENU=No G/L account exists within the specified filter.';
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    PROCEDURE NumColumns@7() NumCol@1000 : Integer;
    VAR
      i@1001 : Integer;
    BEGIN
      NumCol := 0;
      FOR i := 1 TO ARRAYLEN(ColumnFlags) DO
        IF ColumnFlags[i] THEN
          NumCol := NumCol + 1;
      EXIT(NumCol);
    END;

    PROCEDURE TestNumColumns@14();
    BEGIN
      IF NumColumns > 8 THEN
        ERROR(Text002);
      IF (NumColumns > 6) AND (RoundTo = RoundTo::Pennies) THEN
        ERROR(Text001);
    END;

    PROCEDURE NumbersToPrint@12() : Boolean;
    VAR
      i@1000 : Integer;
    BEGIN
      IF ("G/L Account"."Account Type" <> "G/L Account"."Account Type"::Posting) AND
         ("G/L Account".Totaling = '')
      THEN
        EXIT(FALSE);
      IF ("G/L Account"."Account Type" = "G/L Account"."Account Type"::Posting) AND SkipZeros THEN BEGIN
        FOR i := 1 TO ARRAYLEN(ColumnFlags) DO
          IF (WorkAmount[i] <> 0.0) AND ColumnFlags[i] THEN
            EXIT(TRUE);
        EXIT(FALSE);
      END;
      EXIT(TRUE);
    END;

    PROCEDURE CompressColumns@8(VAR StringArray@1000 : ARRAY [12] OF Text[30]);
    VAR
      i@1001 : Integer;
      j@1002 : Integer;
    BEGIN
      j := 0;
      FOR i := 1 TO ARRAYLEN(ColumnFlags) DO
        IF ColumnFlags[i] THEN BEGIN
          j := j + 1;
          StringArray[j] := StringArray[i];
        END;
      FOR i := j + 1 TO ARRAYLEN(ColumnFlags) DO
        StringArray[i] := '';
    END;

    LOCAL PROCEDURE PenniesRoundToOnValidate@19010648();
    BEGIN
      TestNumColumns;
    END;

    LOCAL PROCEDURE DollarsRoundToOnValidate@19009557();
    BEGIN
      TestNumColumns;
    END;

    LOCAL PROCEDURE ThousandsRoundToOnValidate@19005369();
    BEGIN
      TestNumColumns;
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

      This report is based on 10022 Trial Balance.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>06252b2a-e5d0-49c6-8b36-1df8245e269c</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>213e0cbb-b476-4613-9d9a-5fb6067d2c45</rd:ReportID>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Fields>
        <Field Name="PeriodText">
          <DataField>PeriodText</DataField>
        </Field>
        <Field Name="UseAddRptCurr">
          <DataField>UseAddRptCurr</DataField>
        </Field>
        <Field Name="PageGroupNo">
          <DataField>PageGroupNo</DataField>
        </Field>
        <Field Name="AddCurrSubTitle">
          <DataField>AddCurrSubTitle</DataField>
        </Field>
        <Field Name="LineType">
          <DataField>LineType</DataField>
        </Field>
        <Field Name="ColumnHead1">
          <DataField>ColumnHead1</DataField>
        </Field>
        <Field Name="ColumnHead2">
          <DataField>ColumnHead2</DataField>
        </Field>
        <Field Name="ColumnHead3">
          <DataField>ColumnHead3</DataField>
        </Field>
        <Field Name="ColumnHead4">
          <DataField>ColumnHead4</DataField>
        </Field>
        <Field Name="ColumnHead5">
          <DataField>ColumnHead5</DataField>
        </Field>
        <Field Name="ColumnHead6">
          <DataField>ColumnHead6</DataField>
        </Field>
        <Field Name="ColumnHead7">
          <DataField>ColumnHead7</DataField>
        </Field>
        <Field Name="ColumnHead8">
          <DataField>ColumnHead8</DataField>
        </Field>
        <Field Name="NumbersToPrint">
          <DataField>NumbersToPrint</DataField>
        </Field>
        <Field Name="DescriptionLine1">
          <DataField>DescriptionLine1</DataField>
        </Field>
        <Field Name="DescriptionLine2">
          <DataField>DescriptionLine2</DataField>
        </Field>
        <Field Name="PrintAmt1">
          <DataField>PrintAmt1</DataField>
        </Field>
        <Field Name="PrintAmt2">
          <DataField>PrintAmt2</DataField>
        </Field>
        <Field Name="PrintAmt3">
          <DataField>PrintAmt3</DataField>
        </Field>
        <Field Name="PrintAmt4">
          <DataField>PrintAmt4</DataField>
        </Field>
        <Field Name="PrintAmt5">
          <DataField>PrintAmt5</DataField>
        </Field>
        <Field Name="PrintAmt6">
          <DataField>PrintAmt6</DataField>
        </Field>
        <Field Name="PrintAmt7">
          <DataField>PrintAmt7</DataField>
        </Field>
        <Field Name="PrintAmt8">
          <DataField>PrintAmt8</DataField>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70215 ForNAV Salesperson-Commission
{
  OBJECT-PROPERTIES
  {
    Date=05-09-17;
    Time=17:00:00;
    Modified=Yes;
    Version List=FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Salesperson - Commission;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 3065;    ;DataItem;                    ;
               DataItemTable=Table13;
               DataItemTableView=SORTING(Code);
               PrintOnlyIfDetail=Yes;
               OnPreDataItem=BEGIN
                               ReportForNav.GetDataItem('Salesperson_Purchaser').NewPagePerRecord := PrintOnlyOnePerPage;
                             END;

               ReqFilterFields=Code }

    { 25  ;1   ;Column  ;SalesCommissionAmt  ;
               IncludeCaption=No;
               SourceExpr=SalesCommissionAmt;
               AutoFormatType=1 }

    { 26  ;1   ;Column  ;ProfitCommissionAmt ;
               IncludeCaption=No;
               SourceExpr=ProfitCommissionAmt;
               AutoFormatType=1 }

    { 1   ;1   ;Column  ;PrintOnlyOnePerPage ;
               IncludeCaption=No;
               SourceExpr=PrintOnlyOnePerPage }

    { 8503;1   ;DataItem;                    ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Salesperson Code,Posting Date)
                                 WHERE(Document Type=FILTER(Invoice|Credit Memo));
               OnAfterGetRecord=VAR
                                  CostCalcMgt@1000 : Codeunit 5836;
                                BEGIN
                                  SalesCommissionAmt := ROUND("Sales (LCY)" * "Salesperson/Purchaser"."Commission %" / 100);
                                  ProfitCommissionAmt := ROUND("Profit (LCY)" * "Salesperson/Purchaser"."Commission %" / 100);
                                END;

               ReqFilterFields=Posting Date;
               DataItemLink=Salesperson Code=FIELD(Code) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1   ;2   ;Field     ;
                  CaptionML=ENU=New Page per Person;
                  ToolTipML=ENU=Specifies if each person's information is printed on a new page if you have chosen two or more persons to be included in the report.;
                  ApplicationArea=#Suite;
                  SourceExpr=PrintOnlyOnePerPage }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ProfitCommissionAmt@1004 : Decimal;
      SalesCommissionAmt@1005 : Decimal;
      PrintOnlyOnePerPage@1006 : Boolean;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Salesperson_Purchaser': WITH "Salesperson/Purchaser" DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Cust. Ledger Entry"."Sales (LCY)");
                ReportForNav.AddTotal(DataItemId,1,"Cust. Ledger Entry"."Profit (LCY)");
                ReportForNav.AddTotal(DataItemId,2,ProfitCommissionAmt);
                ReportForNav.AddTotal(DataItemId,3,SalesCommissionAmt);
              END;
           'Restore': BEGIN
                 "Cust. Ledger Entry"."Sales (LCY)" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Cust. Ledger Entry"."Profit (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 ProfitCommissionAmt := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 SalesCommissionAmt := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;  'CustLedgerEntry': WITH "Cust. Ledger Entry" DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Sales (LCY)");
                ReportForNav.AddTotal(DataItemId,1,"Profit (LCY)");
                ReportForNav.AddTotal(DataItemId,2,"Sales (LCY)");
                ReportForNav.AddTotal(DataItemId,3,"Profit (LCY)");
                ReportForNav.AddTotal(DataItemId,4,ProfitCommissionAmt);
                ReportForNav.AddTotal(DataItemId,5,SalesCommissionAmt);
              END;
           'Restore': BEGIN
                 "Sales (LCY)" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Profit (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Sales (LCY)" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Profit (LCY)" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 ProfitCommissionAmt := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
                 SalesCommissionAmt := ReportForNav.RestoreTotal(DataItemId,5,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>3243c513-b722-471a-a004-9f1c0e28be42</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>78c925f1-e53a-4158-b4f9-a068e996eebc</rd:ReportID>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Fields>
        <Field Name="SalesCommissionAmt">
          <DataField>SalesCommissionAmt</DataField>
        </Field>
        <Field Name="SalesCommissionAmtFormat">
          <DataField>SalesCommissionAmtFormat</DataField>
        </Field>
        <Field Name="ProfitCommissionAmt">
          <DataField>ProfitCommissionAmt</DataField>
        </Field>
        <Field Name="ProfitCommissionAmtFormat">
          <DataField>ProfitCommissionAmtFormat</DataField>
        </Field>
        <Field Name="PrintOnlyOnePerPage">
          <DataField>PrintOnlyOnePerPage</DataField>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70220 ForNAV Aged Accounts Receivbl.
{
  OBJECT-PROPERTIES
  {
    Date=05-09-17;
    Time=17:00:00;
    Modified=Yes;
    Version List=FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Aged Accounts Receivable;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   LoadWatermark;
                 END;

    OnPreReport=VAR
                  CaptionManagement@1000 : Codeunit 42;
                BEGIN
                  GLSetup.GET;
                  CalcDates;
                  CreateHeadings;
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 5   ;    ;DataItem;                    ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number);
               MaxIteration=1 }

    { 6836;1   ;DataItem;Customer            ;
               DataItemTable=Table18;
               OnAfterGetRecord=BEGIN
                                  TempCurrency.RESET;
                                  TempCurrency.DELETEALL;
                                  TempCustLedgEntry.RESET;
                                  TempCustLedgEntry.DELETEALL;
                                  SortingID += 1;
                                END;

               ReqFilterFields=No. }

    { 108 ;2   ;Column  ;FormatEndingDate    ;
               IncludeCaption=No;
               SourceExpr=STRSUBSTNO(Text006,FORMAT(EndingDate,0,4)) }

    { 110 ;2   ;Column  ;PostingDate         ;
               IncludeCaption=No;
               SourceExpr=STRSUBSTNO(Text007,SELECTSTR(AgingBy + 1,Text009)) }

    { 128 ;2   ;Column  ;PrintAmountInCustCurr;
               IncludeCaption=No;
               SourceExpr=PrintAmountInCustCurr }

    { 130 ;2   ;Column  ;AgingByDueDate      ;
               IncludeCaption=No;
               SourceExpr=AgingBy = AgingBy::"Due Date" }

    { 1   ;2   ;Column  ;AgedOverdueAmtCptn  ;
               IncludeCaption=No;
               SourceExpr=AgedOverdueAmtCptnLbl }

    { 131 ;2   ;Column  ;PrintDetails        ;
               IncludeCaption=No;
               SourceExpr=PrintDetails }

    { 1000000003;2;Column;ShowCustContactInfo;
               SourceExpr=ShowCustContactInfo }

    { 2   ;2   ;Column  ;HeaderText1         ;
               IncludeCaption=No;
               SourceExpr=HeaderText[1] }

    { 3   ;2   ;Column  ;HeaderText2         ;
               IncludeCaption=No;
               SourceExpr=HeaderText[2] }

    { 4   ;2   ;Column  ;HeaderText3         ;
               IncludeCaption=No;
               SourceExpr=HeaderText[3] }

    { 6   ;2   ;Column  ;HeaderText4         ;
               IncludeCaption=No;
               SourceExpr=HeaderText[4] }

    { 8   ;2   ;Column  ;HeaderText5         ;
               IncludeCaption=No;
               SourceExpr=HeaderText[5] }

    { 1000000002;2;Column;HeaderText6        ;
               IncludeCaption=No;
               SourceExpr=HeaderText[6] }

    { 8503;2   ;DataItem;                    ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Customer No.,Posting Date,Currency Code)
                                 WHERE(Open=FILTER(Yes));
               OnPreDataItem=BEGIN
                               SETRANGE("Posting Date",EndingDate + 1,DMY2DATE(31,12,9999));
                             END;

               OnAfterGetRecord=VAR
                                  CustLedgEntry@1000 : Record 21;
                                BEGIN
                                  CustLedgEntry.SETCURRENTKEY("Closed by Entry No.");
                                  CustLedgEntry.SETRANGE("Closed by Entry No.","Entry No.");
                                  CustLedgEntry.SETRANGE("Posting Date",0D,EndingDate);
                                  IF CustLedgEntry.FINDSET(FALSE,FALSE) THEN
                                    REPEAT
                                      InsertTemp(CustLedgEntry);
                                    UNTIL CustLedgEntry.NEXT = 0;
                                  IF "Closed by Entry No." <> 0 THEN BEGIN
                                    CustLedgEntry.SETRANGE("Closed by Entry No.","Closed by Entry No.");
                                    IF CustLedgEntry.FINDSET(FALSE,FALSE) THEN
                                      REPEAT
                                        InsertTemp(CustLedgEntry);
                                      UNTIL CustLedgEntry.NEXT = 0;
                                  END;
                                  CustLedgEntry.RESET;
                                  CustLedgEntry.SETRANGE("Entry No.","Closed by Entry No.");
                                  CustLedgEntry.SETRANGE("Posting Date",0D,EndingDate);
                                  IF CustLedgEntry.FINDSET(FALSE,FALSE) THEN
                                    REPEAT
                                      InsertTemp(CustLedgEntry);
                                    UNTIL CustLedgEntry.NEXT = 0;
                                  CurrReport.SKIP;
                                END;

               DataItemLink=Customer No.=FIELD(No.) }

    { 1000000001;2;DataItem;                 ;
               DataItemTable=Table379;
               DataItemTableView=SORTING(Customer No.,Posting Date,Entry Type,Currency Code)
                                 WHERE(Entry Type=CONST(Application));
               OnPreDataItem=BEGIN
                               //apc - optimization
                                SETRANGE("Posting Date",0D,EndingDate);
                               //apc - end
                             END;

               OnAfterGetRecord=BEGIN
                                  //apc - optimization
                                  OpenCustLedgEntry.RESET;
                                  IF NOT OpenCustLedgEntry.GET("Cust. Ledger Entry No.") THEN
                                    CurrReport.SKIP;

                                  IF OpenCustLedgEntry.Open THEN
                                    CurrReport.SKIP;

                                  OpenCustLedgEntry.SETRANGE("Date Filter",0D,EndingDate);
                                  OpenCustLedgEntry.CALCFIELDS("Remaining Amount");
                                  IF OpenCustLedgEntry."Remaining Amount" <> 0 THEN
                                    InsertTemp(OpenCustLedgEntry);

                                  CurrReport.SKIP;    //  this fools the system into thinking that no details "printed"...yet
                                  //apc - end
                                END;

               DataItemLink=Customer No.=FIELD(No.) }

    { 1473;2   ;DataItem;OpenCustLedgEntry   ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Customer No.,Open,Positive,Due Date,Currency Code)
                                 WHERE(Open=FILTER(Yes));
               OnPreDataItem=BEGIN
                               IF AgingBy = AgingBy::"Posting Date" THEN BEGIN
                                 SETRANGE("Posting Date",0D,EndingDate);
                                 SETRANGE("Date Filter",0D,EndingDate);
                               END;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF AgingBy = AgingBy::"Posting Date" THEN BEGIN
                                    CALCFIELDS("Remaining Amt. (LCY)");
                                    IF "Remaining Amt. (LCY)" = 0 THEN
                                      CurrReport.SKIP;
                                  END;
                                  InsertTemp(OpenCustLedgEntry);
                                  CurrReport.SKIP;
                                END;

               DataItemLink=Customer No.=FIELD(No.) }

    { 6523;2   ;DataItem;CurrencyLoop        ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number)
                                 WHERE(Number=FILTER(1..));
               PrintOnlyIfDetail=Yes;
               OnPreDataItem=BEGIN
                               NumberOfCurrencies := 0;
                             END;

               OnAfterGetRecord=BEGIN
                                  LCYCurrency := FALSE;
                                  IF Number = 1 THEN BEGIN
                                    IF NOT TempCurrency.FINDSET(FALSE,FALSE) THEN
                                      CurrReport.BREAK;
                                  END ELSE
                                    IF TempCurrency.NEXT = 0 THEN
                                      CurrReport.BREAK;
                                  IF TempCurrency.Code <> '' THEN
                                    CurrencyCode := TempCurrency.Code
                                  ELSE BEGIN
                                    CurrencyCode := GLSetup."LCY Code";
                                    LCYCurrency := TRUE;
                                  END;
                                  NumberOfCurrencies := NumberOfCurrencies + 1;
                                END;
                                 }

    { 7725;3   ;DataItem;TempCustLedgEntryLoop;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number)
                                 WHERE(Number=FILTER(1..));
               OnPreDataItem=BEGIN
                               IF  PrintAmountInCustCurr THEN BEGIN
                                 IF (CurrencyCode = '') OR (CurrencyCode = GLSetup."LCY Code") THEN
                                   TempCustLedgEntry.SETFILTER("Currency Code",'%1|%2',CurrencyCode,'')
                                 ELSE
                                   TempCustLedgEntry.SETRANGE("Currency Code",CurrencyCode);
                               END;
                             END;

               OnAfterGetRecord=VAR
                                  PeriodIndex@1001 : Integer;
                                BEGIN
                                  IF Number = 1 THEN BEGIN
                                    IF NOT TempCustLedgEntry.FINDSET(FALSE,FALSE) THEN
                                      CurrReport.BREAK;
                                  END ELSE
                                    IF TempCustLedgEntry.NEXT = 0 THEN
                                      CurrReport.BREAK;

                                  AccountsReceivblBuffer.INIT;
                                  AccountsReceivblBuffer."Entry No." := TempCustLedgEntry."Entry No.";
                                  AccountsReceivblBuffer.Type := AccountsReceivblBuffer.Type::CustomerEntry;
                                  AccountsReceivblBuffer."Customer No." := TempCustLedgEntry."Customer No.";
                                  AccountsReceivblBuffer."Customer Credit Limit (LCY)" := Customer."Credit Limit (LCY)";
                                  AccountsReceivblBuffer."Currency Code" := CurrencyCode;
                                  AccountsReceivblBuffer."Original Currency Code" := TempCustLedgEntry."Currency Code";
                                  AccountsReceivblBuffer."Customer to Currency Groupping" := FORMAT(SortingID) + ' ' + CurrencyCode;
                                  AccountsReceivblBuffer."Document No." := TempCustLedgEntry."Document No.";
                                  AccountsReceivblBuffer."Document Type" := TempCustLedgEntry."Document Type";
                                  AccountsReceivblBuffer."Document Date" := TempCustLedgEntry."Document Date";
                                  AccountsReceivblBuffer."Posting Date" := TempCustLedgEntry."Posting Date";
                                  AccountsReceivblBuffer."Due Date" := TempCustLedgEntry."Due Date";
                                  AccountsReceivblBuffer."New Page" := NewPagePercustomer;
                                  DetailedCustomerLedgerEntry.SETRANGE("Cust. Ledger Entry No.",TempCustLedgEntry."Entry No.");
                                  IF DetailedCustomerLedgerEntry.FINDSET(FALSE,FALSE) THEN
                                    REPEAT
                                      IF (DetailedCustomerLedgerEntry."Entry Type" =
                                          DetailedCustomerLedgerEntry."Entry Type"::"Initial Entry") AND
                                         (TempCustLedgEntry."Posting Date" > EndingDate) AND
                                         (AgingBy <> AgingBy::"Posting Date")
                                      THEN BEGIN
                                        IF TempCustLedgEntry."Document Date" <= EndingDate THEN
                                          DetailedCustomerLedgerEntry."Posting Date" :=
                                            TempCustLedgEntry."Document Date"
                                        ELSE
                                          IF (TempCustLedgEntry."Due Date" <= EndingDate) AND
                                             (AgingBy = AgingBy::"Due Date")
                                          THEN
                                            DetailedCustomerLedgerEntry."Posting Date" :=
                                              TempCustLedgEntry."Due Date";
                                      END;
                                      IF (DetailedCustomerLedgerEntry."Posting Date" <= EndingDate) OR
                                         (TempCustLedgEntry.Open AND
                                          (AgingBy = AgingBy::"Due Date") AND
                                          (TempCustLedgEntry."Due Date" > EndingDate) AND
                                          (TempCustLedgEntry."Posting Date" <= EndingDate))
                                      THEN BEGIN
                                        IF DetailedCustomerLedgerEntry."Entry Type" IN
                                           [DetailedCustomerLedgerEntry."Entry Type"::"Initial Entry",
                                            DetailedCustomerLedgerEntry."Entry Type"::"Unrealized Loss",
                                            DetailedCustomerLedgerEntry."Entry Type"::"Unrealized Gain",
                                            DetailedCustomerLedgerEntry."Entry Type"::"Realized Loss",
                                            DetailedCustomerLedgerEntry."Entry Type"::"Realized Gain",
                                            DetailedCustomerLedgerEntry."Entry Type"::"Payment Discount",
                                            DetailedCustomerLedgerEntry."Entry Type"::"Payment Discount (VAT Excl.)",
                                            DetailedCustomerLedgerEntry."Entry Type"::"Payment Discount (VAT Adjustment)",
                                            DetailedCustomerLedgerEntry."Entry Type"::"Payment Tolerance",
                                            DetailedCustomerLedgerEntry."Entry Type"::"Payment Discount Tolerance",
                                            DetailedCustomerLedgerEntry."Entry Type"::"Payment Tolerance (VAT Excl.)",
                                            DetailedCustomerLedgerEntry."Entry Type"::"Payment Tolerance (VAT Adjustment)",
                                            DetailedCustomerLedgerEntry."Entry Type"::"Payment Discount Tolerance (VAT Excl.)",
                                            DetailedCustomerLedgerEntry."Entry Type"::"Payment Discount Tolerance (VAT Adjustment)"]
                                        THEN BEGIN
                                          IF NOT PrintAmountInCustCurr THEN
                                            AccountsReceivblBuffer.Amount += DetailedCustomerLedgerEntry."Amount (LCY)"
                                          ELSE
                                            AccountsReceivblBuffer.Amount += DetailedCustomerLedgerEntry.Amount;
                                          AccountsReceivblBuffer."Amount (LCY)" += DetailedCustomerLedgerEntry."Amount (LCY)";
                                        END;
                                        IF DetailedCustomerLedgerEntry."Posting Date" <= EndingDate THEN BEGIN
                                          IF NOT PrintAmountInCustCurr THEN
                                            AccountsReceivblBuffer.Balance += DetailedCustomerLedgerEntry."Amount (LCY)"
                                          ELSE
                                            AccountsReceivblBuffer.Balance += DetailedCustomerLedgerEntry.Amount;
                                          AccountsReceivblBuffer."Balance (LCY)" += DetailedCustomerLedgerEntry."Amount (LCY)";
                                        END;
                                      END;
                                    UNTIL DetailedCustomerLedgerEntry.NEXT = 0;

                                  IF AccountsReceivblBuffer.Balance = 0 THEN
                                    CurrReport.SKIP;
                                  CASE AgingBy OF
                                    AgingBy::"Due Date":
                                      PeriodIndex := GetPeriodIndex(AccountsReceivblBuffer."Due Date");
                                    AgingBy::"Posting Date":
                                      PeriodIndex := GetPeriodIndex(AccountsReceivblBuffer."Posting Date");
                                    AgingBy::"Document Date":
                                      BEGIN
                                        IF AccountsReceivblBuffer."Document Date" > EndingDate THEN BEGIN
                                          AccountsReceivblBuffer.Balance := 0;
                                          AccountsReceivblBuffer."Balance (LCY)" := 0;
                                          AccountsReceivblBuffer."Document Date" := AccountsReceivblBuffer."Posting Date";
                                        END;
                                        PeriodIndex := GetPeriodIndex(AccountsReceivblBuffer."Document Date");
                                      END;
                                  END;

                                  CASE PeriodIndex OF
                                    1: BEGIN
                                        AccountsReceivblBuffer."Amount - Interval 1" := AccountsReceivblBuffer.Balance;
                                        AccountsReceivblBuffer."Amount - Interval 1 (LCY)" := AccountsReceivblBuffer."Balance (LCY)";
                                       END;
                                    2: BEGIN
                                          AccountsReceivblBuffer."Amount - Interval 2" := AccountsReceivblBuffer.Balance;
                                          AccountsReceivblBuffer."Amount - Interval 2 (LCY)" := AccountsReceivblBuffer."Balance (LCY)";
                                         END;
                                    3: BEGIN
                                          AccountsReceivblBuffer."Amount - Interval 3" := AccountsReceivblBuffer.Balance;
                                          AccountsReceivblBuffer."Amount - Interval 3 (LCY)" := AccountsReceivblBuffer."Balance (LCY)";
                                         END;
                                    4: BEGIN
                                          AccountsReceivblBuffer."Amount - Interval 4" := AccountsReceivblBuffer.Balance;
                                          AccountsReceivblBuffer."Amount - Interval 4 (LCY)" := AccountsReceivblBuffer."Balance (LCY)";
                                         END;
                                    5: BEGIN
                                          AccountsReceivblBuffer."Amount - Interval 5" := AccountsReceivblBuffer.Balance;
                                          AccountsReceivblBuffer."Amount - Interval 5 (LCY)" := AccountsReceivblBuffer."Balance (LCY)";
                                         END;
                                  END;
                                  AccountsReceivblBuffer.INSERT;

                                  IF  PrintAmountInCustCurr THEN
                                    UpdateCurrencyTotals(AccountsReceivblBuffer);
                                END;
                                 }

    { 70220;1  ;DataItem;AccountsReceivblBuffer;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Customer to Currency Groupping);
               Temporary=Yes }

    { 1000000000;1;DataItem;CurrencyTotalsBuffer;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Entry No.)
                                 WHERE(Type=FILTER(CurrencyTotals));
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   IF EndingDate = 0D THEN
                     EndingDate := WORKDATE;
                 END;

    }
    CONTROLS
    {
      { 4   ;0   ;Container ;
                  ContainerType=ContentArea }

      { 2   ;1   ;Group     ;
                  CaptionML=ENU=Options }

      { 1   ;2   ;Field     ;
                  Name=AgedAsOf;
                  CaptionML=ENU=Aged As Of;
                  ToolTipML=ENU=Specifies the date that you want the aging calculated for.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=EndingDate }

      { 3   ;2   ;Field     ;
                  Name=Agingby;
                  CaptionML=ENU=Aging by;
                  ToolTipML=ENU=Specifies if the aging will be calculated from the due date, the posting date, or the document date.;
                  OptionCaptionML=ENU=Due Date,Posting Date,Document Date;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=AgingBy }

      { 7   ;2   ;Field     ;
                  Name=PeriodLength;
                  CaptionML=ENU=Period Length;
                  ToolTipML=ENU=Specifies the length of each period, for example, enter "1M" for one month.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=PeriodLength }

      { 9   ;2   ;Field     ;
                  Name=AmountsinLCY;
                  CaptionML=ENU=Print Amounts in Customer's Currency;
                  ToolTipML=ENU=Specifies if you want the report in customer's currencies. Report totals calculated in LCY.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=PrintAmountInCustCurr }

      { 11  ;2   ;Field     ;
                  Name=PrintDetails;
                  CaptionML=ENU=Print Details;
                  ToolTipML=ENU=Specifies if you want the report to show the detailed entries that add up the total balance for each customer.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=PrintDetails }

      { 15  ;2   ;Field     ;
                  Name=HeadingType;
                  CaptionML=ENU=Heading Type;
                  ToolTipML=ENU=Specifies if the column heading for the report periods will indicate a date interval or the number of days overdue.;
                  OptionCaptionML=ENU=Date Interval,Number of Days;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=HeadingType }

      { 13  ;2   ;Field     ;
                  Name=perCustomer;
                  CaptionML=ENU=New Page per Customer;
                  ToolTipML=ENU=Specifies if each customer's information is printed on a new page if you have chosen two or more customers to be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NewPagePercustomer }

      { 1000000000;2;Field  ;
                  CaptionML=ENU=Show Customer's Contact Information;
                  ToolTipML=ENU=Specifies if you want to have customer's contact information next to customer name.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ShowCustContactInfo }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
    { 74  ;BalanceCaption      ;CaptionML=ENU=Balance }
    { 747 ;AgedOverdueAmounts  ;CaptionML=ENU=Aged Overdue Amounts }
    { 742 ;AmnsInLCY           ;CaptionML=ENU=All Amounts in LCY. }
  }
  CODE
  {
    VAR
      GLSetup@1011 : Record 98;
      TempCustLedgEntry@1009 : TEMPORARY Record 21;
      AgedCustLedgEntry@1022 : ARRAY [6] OF Record 21;
      TempCurrency@1010 : TEMPORARY Record 4;
      DetailedCustomerLedgerEntry@1102601000 : Record 379;
      PrintAmountInCustCurr@1012 : Boolean;
      EndingDate@1001 : Date;
      AgingBy@1002 : 'Due Date,Posting Date,Document Date';
      PeriodLength@1003 : DateFormula;
      PrintDetails@1015 : Boolean;
      HeadingType@1019 : 'Date Interval,Number of Days';
      NewPagePercustomer@1027 : Boolean;
      ShowCustContactInfo@1000000003 : Boolean;
      PeriodStartDate@1004 : ARRAY [5] OF Date;
      PeriodEndDate@1005 : ARRAY [5] OF Date;
      HeaderText@1006 : ARRAY [6] OF Text[30];
      Text000@1007 : TextConst 'ENU=Not Due';
      Text001@1008 : TextConst 'ENU=Before';
      CurrencyCode@1016 : Code[10];
      Text002@1020 : TextConst 'ENU=days';
      Text003@1021 : TextConst 'ENU=More than';
      Text004@1017 : TextConst 'ENU=Aged by %1';
      Text005@1023 : TextConst 'ENU=Total for %1';
      Text006@1024 : TextConst 'ENU=Aged as of %1';
      Text007@1025 : TextConst 'ENU=Aged by %1';
      SortingID@1000000002 : Integer;
      NumberOfCurrencies@1028 : Integer;
      Text009@1031 : TextConst 'ENU=Due Date,Posting Date,Document Date';
      Text010@1032 : TextConst 'ENU=The Date Formula %1 cannot be used. Try to restate it. E.g. 1M+CM instead of CM+1M.';
      LCYCurrency@1000000000 : Boolean;
      Text032@1059 : TextConst '@@@=Negating the period length: %1 is the period length;ENU=-%1';
      AgedOverdueAmtCptnLbl@2837 : TextConst 'ENU=Aged Overdue Amounts';
      DocumentCurrencyCptn@1000000001 : TextConst 'ENU=Doc. Curr.';
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE CalcDates@5();
    VAR
      i@1000 : Integer;
      PeriodLength2@1001 : DateFormula;
    BEGIN
      EVALUATE(PeriodLength2,STRSUBSTNO(Text032,PeriodLength));
      IF AgingBy = AgingBy::"Due Date" THEN BEGIN
        PeriodEndDate[1] := DMY2DATE(31,12,9999);
        PeriodStartDate[1] := EndingDate + 1;
      END ELSE BEGIN
        PeriodEndDate[1] := EndingDate;
        PeriodStartDate[1] := CALCDATE(PeriodLength2,EndingDate + 1);
      END;
      FOR i := 2 TO ARRAYLEN(PeriodEndDate) DO BEGIN
        PeriodEndDate[i] := PeriodStartDate[i - 1] - 1;
        PeriodStartDate[i] := CALCDATE(PeriodLength2,PeriodEndDate[i] + 1);
      END;
      PeriodStartDate[i] := 0D;
      FOR i := 1 TO ARRAYLEN(PeriodEndDate) DO
        IF PeriodEndDate[i] < PeriodStartDate[i] THEN
          ERROR(Text010,PeriodLength);
    END;

    LOCAL PROCEDURE CreateHeadings@10();
    VAR
      i@1000 : Integer;
    BEGIN
      IF NOT PrintAmountInCustCurr THEN
        HeaderText[6] := DocumentCurrencyCptn
      ELSE
        HeaderText[6] := '';
      IF AgingBy = AgingBy::"Due Date" THEN BEGIN
        HeaderText[1] := Text000;
        i := 2;
      END ELSE
        i := 1;
      WHILE i < ARRAYLEN(PeriodEndDate) DO BEGIN
        IF HeadingType = HeadingType::"Date Interval" THEN
          HeaderText[i] := STRSUBSTNO('%1\..%2',PeriodStartDate[i],PeriodEndDate[i])
        ELSE
          HeaderText[i] :=
            STRSUBSTNO('%1 - %2 %3',EndingDate - PeriodEndDate[i] + 1,EndingDate - PeriodStartDate[i] + 1,Text002);
        i := i + 1;
      END;
      IF HeadingType = HeadingType::"Date Interval" THEN
        HeaderText[i] := STRSUBSTNO('%1 \%2',Text001,PeriodStartDate[i - 1])
      ELSE
        HeaderText[i] := STRSUBSTNO('%1 \%2 %3',Text003,EndingDate - PeriodStartDate[i - 1] + 1,Text002);
    END;

    LOCAL PROCEDURE InsertTemp@1(VAR CustLedgEntry@1040000 : Record 21);
    VAR
      Currency@1000 : Record 4;
    BEGIN
      WITH TempCustLedgEntry DO BEGIN
        IF GET(CustLedgEntry."Entry No.") THEN
          EXIT;
        TempCustLedgEntry := CustLedgEntry;
        INSERT;
        IF NOT PrintAmountInCustCurr THEN BEGIN
          CLEAR(TempCurrency);
          IF TempCurrency.INSERT THEN;
          EXIT;
        END;
        IF TempCurrency.GET("Currency Code") THEN
          EXIT;
        IF TempCurrency.GET('') AND ("Currency Code" = GLSetup."LCY Code") THEN
          EXIT;
        IF TempCurrency.GET(GLSetup."LCY Code") AND ("Currency Code" = '') THEN
          EXIT;
        IF "Currency Code" <> '' THEN
          Currency.GET("Currency Code")
        ELSE BEGIN
          CLEAR(Currency);
        END;
        TempCurrency := Currency;
        TempCurrency.INSERT;
      END;
    END;

    LOCAL PROCEDURE GetPeriodIndex@8(Date@1040000 : Date) : Integer;
    VAR
      i@1000 : Integer;
    BEGIN
      FOR i := 1 TO ARRAYLEN(PeriodEndDate) DO
        IF Date IN [PeriodStartDate[i]..PeriodEndDate[i]] THEN
          EXIT(i);
    END;

    LOCAL PROCEDURE UpdateCurrencyTotals@7(VAR ForNAVAccountsReceivbBufferParam@1000000000 : TEMPORARY Record 70220);
    VAR
      i@1000 : Integer;
    BEGIN
      CurrencyTotalsBuffer.RESET;
      CurrencyTotalsBuffer.SETRANGE("Currency Code", ForNAVAccountsReceivbBufferParam."Currency Code");
      IF NOT CurrencyTotalsBuffer.FINDFIRST THEN BEGIN
        IF LCYCurrency THEN
          CurrencyTotalsBuffer."Entry No." := 0
        ELSE
          CurrencyTotalsBuffer."Entry No." := CalcCurrencyEntryNo(ForNAVAccountsReceivbBufferParam."Currency Code");
        CurrencyTotalsBuffer.Type := CurrencyTotalsBuffer.Type::CurrencyTotals;
        CurrencyTotalsBuffer."Currency Code" := ForNAVAccountsReceivbBufferParam."Currency Code";
        CurrencyTotalsBuffer.Amount := ForNAVAccountsReceivbBufferParam.Amount;
        CurrencyTotalsBuffer.Balance := ForNAVAccountsReceivbBufferParam.Balance;
        CurrencyTotalsBuffer."Amount - Interval 1" := ForNAVAccountsReceivbBufferParam."Amount - Interval 1";
        CurrencyTotalsBuffer."Amount - Interval 2" := ForNAVAccountsReceivbBufferParam."Amount - Interval 2";
        CurrencyTotalsBuffer."Amount - Interval 3" := ForNAVAccountsReceivbBufferParam."Amount - Interval 3";
        CurrencyTotalsBuffer."Amount - Interval 4" := ForNAVAccountsReceivbBufferParam."Amount - Interval 4";
        CurrencyTotalsBuffer."Amount - Interval 5" := ForNAVAccountsReceivbBufferParam."Amount - Interval 5";
        CurrencyTotalsBuffer.INSERT;
      END ELSE BEGIN
        CurrencyTotalsBuffer.Amount += ForNAVAccountsReceivbBufferParam.Amount;
        CurrencyTotalsBuffer.Balance += ForNAVAccountsReceivbBufferParam.Balance;
        CurrencyTotalsBuffer."Amount - Interval 1" += ForNAVAccountsReceivbBufferParam."Amount - Interval 1";
        CurrencyTotalsBuffer."Amount - Interval 2" += ForNAVAccountsReceivbBufferParam."Amount - Interval 2";
        CurrencyTotalsBuffer."Amount - Interval 3" += ForNAVAccountsReceivbBufferParam."Amount - Interval 3";
        CurrencyTotalsBuffer."Amount - Interval 4" += ForNAVAccountsReceivbBufferParam."Amount - Interval 4";
        CurrencyTotalsBuffer."Amount - Interval 5" += ForNAVAccountsReceivbBufferParam."Amount - Interval 5";
        CurrencyTotalsBuffer.MODIFY;
      END;
    END;

    PROCEDURE InitializeRequest@11(NewEndingDate@1000 : Date;NewAgingBy@1001 : Option;NewPeriodLength@1002 : DateFormula;NewPrintAmountInCustCurr@1003 : Boolean;NewPrintDetails@1004 : Boolean;NewHeadingType@1005 : Option;NewPagePercust@1006 : Boolean);
    BEGIN
      EndingDate := NewEndingDate;
      AgingBy := NewAgingBy;
      PeriodLength := NewPeriodLength;
      PrintAmountInCustCurr := NewPrintAmountInCustCurr;
      PrintDetails := NewPrintDetails;
      HeadingType := NewHeadingType;
      NewPagePercustomer := NewPagePercust;
    END;

    LOCAL PROCEDURE CalcCurrencyEntryNo@1000000000(CurrencyCode@1000000000 : Code[10]) : Integer;
    VAR
      Currency@1000000001 : Record 4;
    BEGIN
      Currency.SETFILTER(Code,'..%1',CurrencyCode);
      EXIT(Currency.COUNT);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'AccountsReceivblBuffer': WITH AccountsReceivblBuffer DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Amount - Interval 1");
                ReportForNav.AddTotal(DataItemId,1,"Amount - Interval 1 (LCY)");
                ReportForNav.AddTotal(DataItemId,2,"Amount - Interval 2");
                ReportForNav.AddTotal(DataItemId,3,"Amount - Interval 2 (LCY)");
                ReportForNav.AddTotal(DataItemId,4,"Amount - Interval 3");
                ReportForNav.AddTotal(DataItemId,5,"Amount - Interval 3 (LCY)");
                ReportForNav.AddTotal(DataItemId,6,"Amount - Interval 4");
                ReportForNav.AddTotal(DataItemId,7,"Amount - Interval 4 (LCY)");
                ReportForNav.AddTotal(DataItemId,8,"Amount - Interval 5");
                ReportForNav.AddTotal(DataItemId,9,"Amount - Interval 5 (LCY)");
                ReportForNav.AddTotal(DataItemId,10,"Amount (LCY)");
                ReportForNav.AddTotal(DataItemId,11,Balance);
                ReportForNav.AddTotal(DataItemId,12,"Balance (LCY)");
                ReportForNav.AddTotal(DataItemId,13,Amount);
                ReportForNav.AddTotal(DataItemId,14,Balance);
                ReportForNav.AddTotal(DataItemId,15,"Amount - Interval 1");
                ReportForNav.AddTotal(DataItemId,16,"Amount - Interval 2");
                ReportForNav.AddTotal(DataItemId,17,"Amount - Interval 3");
                ReportForNav.AddTotal(DataItemId,18,"Amount - Interval 4");
                ReportForNav.AddTotal(DataItemId,19,"Amount - Interval 5");
              END;
           'Restore': BEGIN
                 "Amount - Interval 1" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount - Interval 1 (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Amount - Interval 2" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Amount - Interval 2 (LCY)" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Amount - Interval 3" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
                 "Amount - Interval 3 (LCY)" := ReportForNav.RestoreTotal(DataItemId,5,GroupTotalFieldNo);
                 "Amount - Interval 4" := ReportForNav.RestoreTotal(DataItemId,6,GroupTotalFieldNo);
                 "Amount - Interval 4 (LCY)" := ReportForNav.RestoreTotal(DataItemId,7,GroupTotalFieldNo);
                 "Amount - Interval 5" := ReportForNav.RestoreTotal(DataItemId,8,GroupTotalFieldNo);
                 "Amount - Interval 5 (LCY)" := ReportForNav.RestoreTotal(DataItemId,9,GroupTotalFieldNo);
                 "Amount (LCY)" := ReportForNav.RestoreTotal(DataItemId,10,GroupTotalFieldNo);
                 Balance := ReportForNav.RestoreTotal(DataItemId,11,GroupTotalFieldNo);
                 "Balance (LCY)" := ReportForNav.RestoreTotal(DataItemId,12,GroupTotalFieldNo);
                 Amount := ReportForNav.RestoreTotal(DataItemId,13,GroupTotalFieldNo);
                 Balance := ReportForNav.RestoreTotal(DataItemId,14,GroupTotalFieldNo);
                 "Amount - Interval 1" := ReportForNav.RestoreTotal(DataItemId,15,GroupTotalFieldNo);
                 "Amount - Interval 2" := ReportForNav.RestoreTotal(DataItemId,16,GroupTotalFieldNo);
                 "Amount - Interval 3" := ReportForNav.RestoreTotal(DataItemId,17,GroupTotalFieldNo);
                 "Amount - Interval 4" := ReportForNav.RestoreTotal(DataItemId,18,GroupTotalFieldNo);
                 "Amount - Interval 5" := ReportForNav.RestoreTotal(DataItemId,19,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>98d561f9-a2dc-4e17-9d7d-fe729864e1a0</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="BalanceCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>BalanceCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>BalanceCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="AgedOverdueAmounts">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>AgedOverdueAmounts</Value>
        </Values>
      </DefaultValue>
      <Prompt>AgedOverdueAmounts</Prompt>
    </ReportParameter>
    <ReportParameter Name="AmnsInLCY">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>AmnsInLCY</Value>
        </Values>
      </DefaultValue>
      <Prompt>AmnsInLCY</Prompt>
    </ReportParameter>
  </ReportParameters>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>2925bd52-7b73-45fc-8f61-dd06153cf1e5</rd:ReportID>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Fields>
        <Field Name="FormatEndingDate">
          <DataField>FormatEndingDate</DataField>
        </Field>
        <Field Name="PostingDate">
          <DataField>PostingDate</DataField>
        </Field>
        <Field Name="PrintAmountInCustCurr">
          <DataField>PrintAmountInCustCurr</DataField>
        </Field>
        <Field Name="AgingByDueDate">
          <DataField>AgingByDueDate</DataField>
        </Field>
        <Field Name="AgedOverdueAmtCptn">
          <DataField>AgedOverdueAmtCptn</DataField>
        </Field>
        <Field Name="PrintDetails">
          <DataField>PrintDetails</DataField>
        </Field>
        <Field Name="ShowCustContactInfo">
          <DataField>ShowCustContactInfo</DataField>
        </Field>
        <Field Name="HeaderText1">
          <DataField>HeaderText1</DataField>
        </Field>
        <Field Name="HeaderText2">
          <DataField>HeaderText2</DataField>
        </Field>
        <Field Name="HeaderText3">
          <DataField>HeaderText3</DataField>
        </Field>
        <Field Name="HeaderText4">
          <DataField>HeaderText4</DataField>
        </Field>
        <Field Name="HeaderText5">
          <DataField>HeaderText5</DataField>
        </Field>
        <Field Name="HeaderText6">
          <DataField>HeaderText6</DataField>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70221 ForNAV Aged Accounts Payable
{
  OBJECT-PROPERTIES
  {
    Date=05-09-17;
    Time=17:00:00;
    Modified=Yes;
    Version List=FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Aged Accounts Payable;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   LoadWatermark;
                 END;

    OnPreReport=VAR
                  CaptionManagement@1000 : Codeunit 42;
                BEGIN
                  GLSetup.GET;
                  CalcDates;
                  CreateHeadings;
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 5   ;    ;DataItem;                    ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number);
               MaxIteration=1 }

    { 6836;1   ;DataItem;Vendor              ;
               DataItemTable=Table23;
               OnAfterGetRecord=BEGIN
                                  TempCurrency.RESET;
                                  TempCurrency.DELETEALL;
                                  TempVendLedgEntry.RESET;
                                  TempVendLedgEntry.DELETEALL;
                                  SordingID += 1;
                                END;

               ReqFilterFields=No. }

    { 108 ;2   ;Column  ;FormatEndingDate    ;
               IncludeCaption=No;
               SourceExpr=STRSUBSTNO(Text006,FORMAT(EndingDate,0,4)) }

    { 110 ;2   ;Column  ;PostingDate         ;
               IncludeCaption=No;
               SourceExpr=STRSUBSTNO(Text007,SELECTSTR(AgingBy + 1,Text009)) }

    { 128 ;2   ;Column  ;PrintAmountInVendCurr;
               IncludeCaption=No;
               SourceExpr=PrintAmountInVendCurr }

    { 130 ;2   ;Column  ;AgingByDueDate      ;
               IncludeCaption=No;
               SourceExpr=AgingBy = AgingBy::"Due Date" }

    { 1   ;2   ;Column  ;AgedOverdueAmtCptn  ;
               IncludeCaption=No;
               SourceExpr=AgedOverdueAmtCptnLbl }

    { 131 ;2   ;Column  ;PrintDetails        ;
               IncludeCaption=No;
               SourceExpr=PrintDetails }

    { 2   ;2   ;Column  ;HeaderText1         ;
               IncludeCaption=No;
               SourceExpr=HeaderText[1] }

    { 3   ;2   ;Column  ;HeaderText2         ;
               IncludeCaption=No;
               SourceExpr=HeaderText[2] }

    { 4   ;2   ;Column  ;HeaderText3         ;
               IncludeCaption=No;
               SourceExpr=HeaderText[3] }

    { 6   ;2   ;Column  ;HeaderText4         ;
               IncludeCaption=No;
               SourceExpr=HeaderText[4] }

    { 8   ;2   ;Column  ;HeaderText5         ;
               IncludeCaption=No;
               SourceExpr=HeaderText[5] }

    { 1000000002;2;Column;HeaderText6        ;
               IncludeCaption=No;
               SourceExpr=HeaderText[6] }

    { 8503;2   ;DataItem;                    ;
               DataItemTable=Table25;
               DataItemTableView=SORTING(Vendor No.,Posting Date,Currency Code)
                                 WHERE(Open=FILTER(Yes));
               OnPreDataItem=BEGIN
                               SETRANGE("Posting Date",EndingDate + 1,DMY2DATE(31,12,9999));
                             END;

               OnAfterGetRecord=VAR
                                  VendLedgEntry@1000 : Record 25;
                                BEGIN
                                  VendLedgEntry.SETCURRENTKEY("Closed by Entry No.");
                                  VendLedgEntry.SETRANGE("Closed by Entry No.","Entry No.");
                                  VendLedgEntry.SETRANGE("Posting Date",0D,EndingDate);
                                  IF VendLedgEntry.FINDSET(FALSE,FALSE) THEN
                                    REPEAT
                                      InsertTemp(VendLedgEntry);
                                    UNTIL VendLedgEntry.NEXT = 0;
                                  IF "Closed by Entry No." <> 0 THEN BEGIN
                                    VendLedgEntry.SETRANGE("Closed by Entry No.","Closed by Entry No.");
                                    IF VendLedgEntry.FINDSET(FALSE,FALSE) THEN
                                      REPEAT
                                        InsertTemp(VendLedgEntry);
                                      UNTIL VendLedgEntry.NEXT = 0;
                                  END;
                                  VendLedgEntry.RESET;
                                  VendLedgEntry.SETRANGE("Entry No.","Closed by Entry No.");
                                  VendLedgEntry.SETRANGE("Posting Date",0D,EndingDate);
                                  IF VendLedgEntry.FINDSET(FALSE,FALSE) THEN
                                    REPEAT
                                      InsertTemp(VendLedgEntry);
                                    UNTIL VendLedgEntry.NEXT = 0;
                                  CurrReport.SKIP;
                                END;

               DataItemLink=Vendor No.=FIELD(No.) }

    { 1000000001;2;DataItem;                 ;
               DataItemTable=Table380;
               DataItemTableView=SORTING(Vendor No.,Posting Date,Entry Type,Currency Code)
                                 WHERE(Entry Type=CONST(Application));
               OnPreDataItem=BEGIN
                                SETRANGE("Posting Date",0D,EndingDate);
                             END;

               OnAfterGetRecord=BEGIN
                                  OpenVendLedgEntry.RESET;
                                  IF NOT OpenVendLedgEntry.GET("Vendor Ledger Entry No.") THEN
                                    CurrReport.SKIP;

                                  IF OpenVendLedgEntry.Open THEN
                                    CurrReport.SKIP;

                                  OpenVendLedgEntry.SETRANGE("Date Filter",0D,EndingDate);
                                  OpenVendLedgEntry.CALCFIELDS("Remaining Amount");
                                  IF OpenVendLedgEntry."Remaining Amount" <> 0 THEN
                                    InsertTemp(OpenVendLedgEntry);

                                  CurrReport.SKIP;
                                END;

               DataItemLink=Vendor No.=FIELD(No.) }

    { 1473;2   ;DataItem;OpenVendLedgEntry   ;
               DataItemTable=Table25;
               DataItemTableView=SORTING(Vendor No.,Open,Positive,Due Date,Currency Code)
                                 WHERE(Open=FILTER(Yes));
               OnPreDataItem=BEGIN
                               IF AgingBy = AgingBy::"Posting Date" THEN BEGIN
                                 SETRANGE("Posting Date",0D,EndingDate);
                                 SETRANGE("Date Filter",0D,EndingDate);
                               END;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF AgingBy = AgingBy::"Posting Date" THEN BEGIN
                                    CALCFIELDS("Remaining Amt. (LCY)");
                                    IF "Remaining Amt. (LCY)" = 0 THEN
                                      CurrReport.SKIP;
                                  END;
                                  InsertTemp(OpenVendLedgEntry);
                                  CurrReport.SKIP;
                                END;

               DataItemLink=Vendor No.=FIELD(No.) }

    { 6523;2   ;DataItem;CurrencyLoop        ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number)
                                 WHERE(Number=FILTER(1..));
               PrintOnlyIfDetail=Yes;
               OnPreDataItem=BEGIN
                               NumberOfCurrencies := 0;
                             END;

               OnAfterGetRecord=BEGIN
                                  LCYCurrency := FALSE;
                                  IF Number = 1 THEN BEGIN
                                    IF NOT TempCurrency.FINDSET(FALSE,FALSE) THEN
                                      CurrReport.BREAK;
                                  END ELSE
                                    IF TempCurrency.NEXT = 0 THEN
                                      CurrReport.BREAK;
                                  IF TempCurrency.Code <> '' THEN
                                    CurrencyCode := TempCurrency.Code
                                  ELSE BEGIN
                                    CurrencyCode := GLSetup."LCY Code";
                                    LCYCurrency := TRUE;
                                  END;
                                  NumberOfCurrencies := NumberOfCurrencies + 1;
                                END;
                                 }

    { 7725;3   ;DataItem;TempVendLedgEntryLoop;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number)
                                 WHERE(Number=FILTER(1..));
               OnPreDataItem=BEGIN
                               IF  PrintAmountInVendCurr THEN BEGIN
                                 IF (CurrencyCode = '') OR (CurrencyCode = GLSetup."LCY Code") THEN
                                   TempVendLedgEntry.SETFILTER("Currency Code",'%1|%2',CurrencyCode,'')
                                 ELSE
                                   TempVendLedgEntry.SETRANGE("Currency Code",CurrencyCode);
                               END;
                             END;

               OnAfterGetRecord=VAR
                                  PeriodIndex@1001 : Integer;
                                BEGIN
                                  IF Number = 1 THEN BEGIN
                                    IF NOT TempVendLedgEntry.FINDSET(FALSE,FALSE) THEN
                                      CurrReport.BREAK;
                                  END ELSE
                                    IF TempVendLedgEntry.NEXT = 0 THEN
                                      CurrReport.BREAK;
                                  AccountsPayableBuffer.INIT;
                                  AccountsPayableBuffer."Entry No." := TempVendLedgEntry."Entry No.";
                                  AccountsPayableBuffer.Type := AccountsPayableBuffer.Type::VendorEntry;
                                  AccountsPayableBuffer."Vendor No." := TempVendLedgEntry."Vendor No.";
                                  AccountsPayableBuffer."Currency Code" := CurrencyCode;
                                  AccountsPayableBuffer."Original Currency Code" := TempVendLedgEntry."Currency Code";
                                  AccountsPayableBuffer."Vendor to Currency Groupping" := FORMAT(SordingID) + ' ' + CurrencyCode;
                                  AccountsPayableBuffer."Document No." := TempVendLedgEntry."Document No.";
                                  AccountsPayableBuffer."Document Type" := TempVendLedgEntry."Document Type";
                                  AccountsPayableBuffer."Document Date" := TempVendLedgEntry."Document Date";
                                  AccountsPayableBuffer."Posting Date" := TempVendLedgEntry."Posting Date";
                                  AccountsPayableBuffer."Due Date" := TempVendLedgEntry."Due Date";
                                  AccountsPayableBuffer."New Page" := NewPagePerVendor;
                                  DetailedVendorLedgerEntry.SETRANGE("Vendor Ledger Entry No.",TempVendLedgEntry."Entry No.");
                                  IF DetailedVendorLedgerEntry.FINDSET(FALSE,FALSE) THEN
                                    REPEAT
                                      IF (DetailedVendorLedgerEntry."Entry Type" =
                                          DetailedVendorLedgerEntry."Entry Type"::"Initial Entry") AND
                                         (TempVendLedgEntry."Posting Date" > EndingDate) AND
                                         (AgingBy <> AgingBy::"Posting Date")
                                      THEN BEGIN
                                        IF TempVendLedgEntry."Document Date" <= EndingDate THEN
                                          DetailedVendorLedgerEntry."Posting Date" :=
                                            TempVendLedgEntry."Document Date"
                                        ELSE
                                          IF (TempVendLedgEntry."Due Date" <= EndingDate) AND
                                             (AgingBy = AgingBy::"Due Date")
                                          THEN
                                            DetailedVendorLedgerEntry."Posting Date" :=
                                              TempVendLedgEntry."Due Date";
                                      END;
                                      IF (DetailedVendorLedgerEntry."Posting Date" <= EndingDate) OR
                                         (TempVendLedgEntry.Open AND
                                          (AgingBy = AgingBy::"Due Date") AND
                                          (TempVendLedgEntry."Due Date" > EndingDate) AND
                                          (TempVendLedgEntry."Posting Date" <= EndingDate))
                                      THEN BEGIN
                                        IF DetailedVendorLedgerEntry."Entry Type" IN
                                           [DetailedVendorLedgerEntry."Entry Type"::"Initial Entry",
                                            DetailedVendorLedgerEntry."Entry Type"::"Unrealized Loss",
                                            DetailedVendorLedgerEntry."Entry Type"::"Unrealized Gain",
                                            DetailedVendorLedgerEntry."Entry Type"::"Realized Loss",
                                            DetailedVendorLedgerEntry."Entry Type"::"Realized Gain",
                                            DetailedVendorLedgerEntry."Entry Type"::"Payment Discount",
                                            DetailedVendorLedgerEntry."Entry Type"::"Payment Discount (VAT Excl.)",
                                            DetailedVendorLedgerEntry."Entry Type"::"Payment Discount (VAT Adjustment)",
                                            DetailedVendorLedgerEntry."Entry Type"::"Payment Tolerance",
                                            DetailedVendorLedgerEntry."Entry Type"::"Payment Discount Tolerance",
                                            DetailedVendorLedgerEntry."Entry Type"::"Payment Tolerance (VAT Excl.)",
                                            DetailedVendorLedgerEntry."Entry Type"::"Payment Tolerance (VAT Adjustment)",
                                            DetailedVendorLedgerEntry."Entry Type"::"Payment Discount Tolerance (VAT Excl.)",
                                            DetailedVendorLedgerEntry."Entry Type"::"Payment Discount Tolerance (VAT Adjustment)"]
                                        THEN BEGIN
                                          IF NOT PrintAmountInVendCurr THEN
                                            AccountsPayableBuffer.Amount -=DetailedVendorLedgerEntry."Amount (LCY)"
                                          ELSE
                                            AccountsPayableBuffer.Amount -=DetailedVendorLedgerEntry.Amount;
                                          AccountsPayableBuffer."Amount (LCY)" -=DetailedVendorLedgerEntry."Amount (LCY)";
                                        END;
                                        IF DetailedVendorLedgerEntry."Posting Date" <= EndingDate THEN BEGIN
                                          IF NOT PrintAmountInVendCurr THEN
                                            AccountsPayableBuffer.Balance -=DetailedVendorLedgerEntry."Amount (LCY)"
                                          ELSE
                                            AccountsPayableBuffer.Balance -=DetailedVendorLedgerEntry.Amount;
                                          AccountsPayableBuffer."Balance (LCY)" -=DetailedVendorLedgerEntry."Amount (LCY)";
                                        END;
                                      END;
                                    UNTIL DetailedVendorLedgerEntry.NEXT = 0;

                                  IF AccountsPayableBuffer.Balance = 0 THEN
                                    CurrReport.SKIP;
                                  CASE AgingBy OF
                                    AgingBy::"Due Date":
                                      PeriodIndex := GetPeriodIndex(AccountsPayableBuffer."Due Date");
                                    AgingBy::"Posting Date":
                                      PeriodIndex := GetPeriodIndex(AccountsPayableBuffer."Posting Date");
                                    AgingBy::"Document Date":
                                      BEGIN
                                        IF AccountsPayableBuffer."Document Date" > EndingDate THEN BEGIN
                                          AccountsPayableBuffer.Balance := 0;
                                          AccountsPayableBuffer."Balance (LCY)" := 0;
                                          AccountsPayableBuffer."Document Date" := AccountsPayableBuffer."Posting Date";
                                        END;
                                        PeriodIndex := GetPeriodIndex(AccountsPayableBuffer."Document Date");
                                      END;
                                  END;

                                  CASE PeriodIndex OF
                                    1: BEGIN
                                        AccountsPayableBuffer."Amount - Interval 1" := AccountsPayableBuffer.Balance;
                                        AccountsPayableBuffer."Amount - Interval 1 (LCY)" := AccountsPayableBuffer."Balance (LCY)";
                                       END;
                                    2: BEGIN
                                          AccountsPayableBuffer."Amount - Interval 2" := AccountsPayableBuffer.Balance;
                                          AccountsPayableBuffer."Amount - Interval 2 (LCY)" := AccountsPayableBuffer."Balance (LCY)";
                                         END;
                                    3: BEGIN
                                          AccountsPayableBuffer."Amount - Interval 3" := AccountsPayableBuffer.Balance;
                                          AccountsPayableBuffer."Amount - Interval 3 (LCY)" := AccountsPayableBuffer."Balance (LCY)";
                                         END;
                                    4: BEGIN
                                          AccountsPayableBuffer."Amount - Interval 4" := AccountsPayableBuffer.Balance;
                                          AccountsPayableBuffer."Amount - Interval 4 (LCY)" := AccountsPayableBuffer."Balance (LCY)";
                                         END;
                                    5: BEGIN
                                          AccountsPayableBuffer."Amount - Interval 5" := AccountsPayableBuffer.Balance;
                                          AccountsPayableBuffer."Amount - Interval 5 (LCY)" := AccountsPayableBuffer."Balance (LCY)";
                                         END;
                                  END;
                                  AccountsPayableBuffer.INSERT;

                                  IF  PrintAmountInVendCurr THEN
                                    UpdateCurrencyTotals(AccountsPayableBuffer);
                                END;
                                 }

    { 70220;1  ;DataItem;AccountsPayableBuffer;
               DataItemTable=Table70221;
               DataItemTableView=SORTING(Vendor to Currency Groupping);
               Temporary=Yes }

    { 1000000000;1;DataItem;CurrencyTotalsBuffer;
               DataItemTable=Table70221;
               DataItemTableView=SORTING(Entry No.);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   IF EndingDate = 0D THEN
                     EndingDate := WORKDATE;
                 END;

    }
    CONTROLS
    {
      { 4   ;0   ;Container ;
                  ContainerType=ContentArea }

      { 2   ;1   ;Group     ;
                  CaptionML=ENU=Options }

      { 1   ;2   ;Field     ;
                  Name=AgedAsOf;
                  CaptionML=ENU=Aged As Of;
                  ToolTipML=ENU=Specifies the date that you want the aging calculated for.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=EndingDate }

      { 3   ;2   ;Field     ;
                  Name=Agingby;
                  CaptionML=ENU=Aging by;
                  ToolTipML=ENU=Specifies if the aging will be calculated from the due date, the posting date, or the document date.;
                  OptionCaptionML=ENU=Due Date,Posting Date,Document Date;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=AgingBy }

      { 7   ;2   ;Field     ;
                  Name=PeriodLength;
                  CaptionML=ENU=Period Length;
                  ToolTipML=ENU=Specifies the length of each period, for example, enter "1M" for one month.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=PeriodLength }

      { 9   ;2   ;Field     ;
                  Name=AmountsinLCY;
                  CaptionML=ENU=Print Amounts in Vendor's Currency;
                  ToolTipML=ENU=Specifies if you want the report in vendor's currencies. Report totals calculated in LCY.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=PrintAmountInVendCurr }

      { 11  ;2   ;Field     ;
                  Name=PrintDetails;
                  CaptionML=ENU=Print Details;
                  ToolTipML=ENU=Specifies if you want the report to show the detailed entries that add up the total balance for each Vendor.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=PrintDetails }

      { 15  ;2   ;Field     ;
                  Name=HeadingType;
                  CaptionML=ENU=Heading Type;
                  ToolTipML=ENU=Specifies if the column heading for the three periods will indicate a date interval or the number of days overdue.;
                  OptionCaptionML=ENU=Date Interval,Number of Days;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=HeadingType }

      { 13  ;2   ;Field     ;
                  Name=perVendor;
                  CaptionML=ENU=New Page per Vendor;
                  ToolTipML=ENU=Specifies if each Vendor's information is printed on a new page if you have chosen two or more Vendors to be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NewPagePerVendor }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
    { 74  ;BalanceCaption      ;CaptionML=ENU=Balance }
    { 747 ;AgedOverdueAmounts  ;CaptionML=ENU=Aged Overdue Amounts }
    { 742 ;AmnsInLCY           ;CaptionML=ENU=All Amounts in LCY. }
  }
  CODE
  {
    VAR
      GLSetup@1011 : Record 98;
      TempVendLedgEntry@1009 : TEMPORARY Record 25;
      AgedVendLedgEntry@1022 : ARRAY [6] OF Record 25;
      TempCurrency@1010 : TEMPORARY Record 4;
      DetailedVendorLedgerEntry@1102601000 : Record 380;
      PrintAmountInVendCurr@1012 : Boolean;
      EndingDate@1001 : Date;
      AgingBy@1002 : 'Due Date,Posting Date,Document Date';
      PeriodLength@1003 : DateFormula;
      PrintDetails@1015 : Boolean;
      HeadingType@1019 : 'Date Interval,Number of Days';
      NewPagePerVendor@1027 : Boolean;
      PeriodStartDate@1004 : ARRAY [5] OF Date;
      PeriodEndDate@1005 : ARRAY [5] OF Date;
      HeaderText@1006 : ARRAY [6] OF Text[30];
      Text000@1007 : TextConst 'ENU=Not Due';
      Text001@1008 : TextConst 'ENU=Before';
      CurrencyCode@1016 : Code[10];
      Text002@1020 : TextConst 'ENU=days';
      Text003@1021 : TextConst 'ENU=More than';
      Text004@1017 : TextConst 'ENU=Aged by %1';
      Text005@1023 : TextConst 'ENU=Total for %1';
      Text006@1024 : TextConst 'ENU=Aged as of %1';
      Text007@1025 : TextConst 'ENU=Aged by %1';
      NumberOfCurrencies@1028 : Integer;
      Text009@1031 : TextConst 'ENU=Due Date,Posting Date,Document Date';
      Text010@1032 : TextConst 'ENU=The Date Formula %1 cannot be used. Try to restate it. E.g. 1M+CM instead of CM+1M.';
      LCYCurrency@1000000000 : Boolean;
      Text032@1059 : TextConst '@@@=Negating the period length: %1 is the period length;ENU=-%1';
      AgedOverdueAmtCptnLbl@2837 : TextConst 'ENU=Aged Overdue Amounts';
      DocumentCurrencyCptn@1000000001 : TextConst 'ENU=Doc. Curr.';
      SordingID@1000000002 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE CalcDates@5();
    VAR
      i@1000 : Integer;
      PeriodLength2@1001 : DateFormula;
    BEGIN
      EVALUATE(PeriodLength2,STRSUBSTNO(Text032,PeriodLength));
      IF AgingBy = AgingBy::"Due Date" THEN BEGIN
        PeriodEndDate[1] := DMY2DATE(31,12,9999);
        PeriodStartDate[1] := EndingDate + 1;
      END ELSE BEGIN
        PeriodEndDate[1] := EndingDate;
        PeriodStartDate[1] := CALCDATE(PeriodLength2,EndingDate + 1);
      END;
      FOR i := 2 TO ARRAYLEN(PeriodEndDate) DO BEGIN
        PeriodEndDate[i] := PeriodStartDate[i - 1] - 1;
        PeriodStartDate[i] := CALCDATE(PeriodLength2,PeriodEndDate[i] + 1);
      END;
      PeriodStartDate[i] := 0D;
      FOR i := 1 TO ARRAYLEN(PeriodEndDate) DO
        IF PeriodEndDate[i] < PeriodStartDate[i] THEN
          ERROR(Text010,PeriodLength);
    END;

    LOCAL PROCEDURE CreateHeadings@10();
    VAR
      i@1000 : Integer;
    BEGIN
      IF NOT PrintAmountInVendCurr THEN
        HeaderText[6] := DocumentCurrencyCptn
      ELSE
        HeaderText[6] := '';
      IF AgingBy = AgingBy::"Due Date" THEN BEGIN
        HeaderText[1] := Text000;
        i := 2;
      END ELSE
        i := 1;
      WHILE i < ARRAYLEN(PeriodEndDate) DO BEGIN
        IF HeadingType = HeadingType::"Date Interval" THEN
          HeaderText[i] := STRSUBSTNO('%1\..%2',PeriodStartDate[i],PeriodEndDate[i])
        ELSE
          HeaderText[i] :=
            STRSUBSTNO('%1 - %2 %3',EndingDate - PeriodEndDate[i] + 1,EndingDate - PeriodStartDate[i] + 1,Text002);
        i := i + 1;
      END;
      IF HeadingType = HeadingType::"Date Interval" THEN
        HeaderText[i] := STRSUBSTNO('%1 \%2',Text001,PeriodStartDate[i - 1])
      ELSE
        HeaderText[i] := STRSUBSTNO('%1 \%2 %3',Text003,EndingDate - PeriodStartDate[i - 1] + 1,Text002);
    END;

    LOCAL PROCEDURE InsertTemp@1(VAR VendLedgEntry@1040000 : Record 25);
    VAR
      Currency@1000 : Record 4;
    BEGIN
      WITH TempVendLedgEntry DO BEGIN
        IF GET(VendLedgEntry."Entry No.") THEN
          EXIT;
        TempVendLedgEntry := VendLedgEntry;
        INSERT;
        IF NOT PrintAmountInVendCurr THEN BEGIN
          CLEAR(TempCurrency);
          IF TempCurrency.INSERT THEN;
          EXIT;
        END;
        IF TempCurrency.GET("Currency Code") THEN
          EXIT;
        IF TempCurrency.GET('') AND ("Currency Code" = GLSetup."LCY Code") THEN
          EXIT;
        IF TempCurrency.GET(GLSetup."LCY Code") AND ("Currency Code" = '') THEN
          EXIT;
        IF "Currency Code" <> '' THEN
          Currency.GET("Currency Code")
        ELSE BEGIN
          CLEAR(Currency);
        END;
        TempCurrency := Currency;
        TempCurrency.INSERT;
      END;
    END;

    LOCAL PROCEDURE GetPeriodIndex@8(Date@1040000 : Date) : Integer;
    VAR
      i@1000 : Integer;
    BEGIN
      FOR i := 1 TO ARRAYLEN(PeriodEndDate) DO
        IF Date IN [PeriodStartDate[i]..PeriodEndDate[i]] THEN
          EXIT(i);
    END;

    LOCAL PROCEDURE UpdateCurrencyTotals@7(VAR ForNAVAccountsReceivbBufferParam@1000000000 : TEMPORARY Record 70221);
    VAR
      i@1000 : Integer;
    BEGIN
      CurrencyTotalsBuffer.RESET;
      CurrencyTotalsBuffer.SETRANGE("Currency Code", ForNAVAccountsReceivbBufferParam."Currency Code");
      IF NOT CurrencyTotalsBuffer.FINDFIRST THEN BEGIN
        IF LCYCurrency THEN
          CurrencyTotalsBuffer."Entry No." := 0
        ELSE
          CurrencyTotalsBuffer."Entry No." := CalcCurrencyEntryNo(ForNAVAccountsReceivbBufferParam."Currency Code");
        CurrencyTotalsBuffer.Type := CurrencyTotalsBuffer.Type::CurrencyTotals;
        CurrencyTotalsBuffer."Currency Code" := ForNAVAccountsReceivbBufferParam."Currency Code";
        CurrencyTotalsBuffer.Amount := ForNAVAccountsReceivbBufferParam.Amount;
        CurrencyTotalsBuffer.Balance := ForNAVAccountsReceivbBufferParam.Balance;
        CurrencyTotalsBuffer."Amount - Interval 1" := ForNAVAccountsReceivbBufferParam."Amount - Interval 1";
        CurrencyTotalsBuffer."Amount - Interval 2" := ForNAVAccountsReceivbBufferParam."Amount - Interval 2";
        CurrencyTotalsBuffer."Amount - Interval 3" := ForNAVAccountsReceivbBufferParam."Amount - Interval 3";
        CurrencyTotalsBuffer."Amount - Interval 4" := ForNAVAccountsReceivbBufferParam."Amount - Interval 4";
        CurrencyTotalsBuffer."Amount - Interval 5" := ForNAVAccountsReceivbBufferParam."Amount - Interval 5";
        CurrencyTotalsBuffer.INSERT;
      END ELSE BEGIN
        CurrencyTotalsBuffer.Amount += ForNAVAccountsReceivbBufferParam.Amount;
        CurrencyTotalsBuffer.Balance += ForNAVAccountsReceivbBufferParam.Balance;
        CurrencyTotalsBuffer."Amount - Interval 1" += ForNAVAccountsReceivbBufferParam."Amount - Interval 1";
        CurrencyTotalsBuffer."Amount - Interval 2" += ForNAVAccountsReceivbBufferParam."Amount - Interval 2";
        CurrencyTotalsBuffer."Amount - Interval 3" += ForNAVAccountsReceivbBufferParam."Amount - Interval 3";
        CurrencyTotalsBuffer."Amount - Interval 4" += ForNAVAccountsReceivbBufferParam."Amount - Interval 4";
        CurrencyTotalsBuffer."Amount - Interval 5" += ForNAVAccountsReceivbBufferParam."Amount - Interval 5";
        CurrencyTotalsBuffer.MODIFY;
      END;
    END;

    PROCEDURE InitializeRequest@11(NewEndingDate@1000 : Date;NewAgingBy@1001 : Option;NewPeriodLength@1002 : DateFormula;NewPrintAmountInVendCurr@1003 : Boolean;NewPrintDetails@1004 : Boolean;NewHeadingType@1005 : Option;NewPagePerVend@1006 : Boolean);
    BEGIN
      EndingDate := NewEndingDate;
      AgingBy := NewAgingBy;
      PeriodLength := NewPeriodLength;
      PrintAmountInVendCurr := NewPrintAmountInVendCurr;
      PrintDetails := NewPrintDetails;
      HeadingType := NewHeadingType;
      NewPagePerVendor := NewPagePerVend;
    END;

    LOCAL PROCEDURE CalcCurrencyEntryNo@1000000000(CurrencyCode@1000000000 : Code[10]) : Integer;
    VAR
      Currency@1000000001 : Record 4;
    BEGIN
      Currency.SETFILTER(Code,'..%1',CurrencyCode);
      EXIT(Currency.COUNT);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'AccountsPayableBuffer': WITH AccountsPayableBuffer DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Amount - Interval 1");
                ReportForNav.AddTotal(DataItemId,1,"Amount - Interval 1 (LCY)");
                ReportForNav.AddTotal(DataItemId,2,"Amount - Interval 2");
                ReportForNav.AddTotal(DataItemId,3,"Amount - Interval 2 (LCY)");
                ReportForNav.AddTotal(DataItemId,4,"Amount - Interval 3");
                ReportForNav.AddTotal(DataItemId,5,"Amount - Interval 3 (LCY)");
                ReportForNav.AddTotal(DataItemId,6,"Amount - Interval 4");
                ReportForNav.AddTotal(DataItemId,7,"Amount - Interval 4 (LCY)");
                ReportForNav.AddTotal(DataItemId,8,"Amount - Interval 5");
                ReportForNav.AddTotal(DataItemId,9,"Amount - Interval 5 (LCY)");
                ReportForNav.AddTotal(DataItemId,10,"Amount (LCY)");
                ReportForNav.AddTotal(DataItemId,11,Balance);
                ReportForNav.AddTotal(DataItemId,12,"Balance (LCY)");
                ReportForNav.AddTotal(DataItemId,13,Amount);
                ReportForNav.AddTotal(DataItemId,14,Balance);
                ReportForNav.AddTotal(DataItemId,15,"Amount - Interval 1");
                ReportForNav.AddTotal(DataItemId,16,"Amount - Interval 2");
                ReportForNav.AddTotal(DataItemId,17,"Amount - Interval 3");
                ReportForNav.AddTotal(DataItemId,18,"Amount - Interval 4");
                ReportForNav.AddTotal(DataItemId,19,"Amount - Interval 5");
              END;
           'Restore': BEGIN
                 "Amount - Interval 1" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount - Interval 1 (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Amount - Interval 2" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Amount - Interval 2 (LCY)" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Amount - Interval 3" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
                 "Amount - Interval 3 (LCY)" := ReportForNav.RestoreTotal(DataItemId,5,GroupTotalFieldNo);
                 "Amount - Interval 4" := ReportForNav.RestoreTotal(DataItemId,6,GroupTotalFieldNo);
                 "Amount - Interval 4 (LCY)" := ReportForNav.RestoreTotal(DataItemId,7,GroupTotalFieldNo);
                 "Amount - Interval 5" := ReportForNav.RestoreTotal(DataItemId,8,GroupTotalFieldNo);
                 "Amount - Interval 5 (LCY)" := ReportForNav.RestoreTotal(DataItemId,9,GroupTotalFieldNo);
                 "Amount (LCY)" := ReportForNav.RestoreTotal(DataItemId,10,GroupTotalFieldNo);
                 Balance := ReportForNav.RestoreTotal(DataItemId,11,GroupTotalFieldNo);
                 "Balance (LCY)" := ReportForNav.RestoreTotal(DataItemId,12,GroupTotalFieldNo);
                 Amount := ReportForNav.RestoreTotal(DataItemId,13,GroupTotalFieldNo);
                 Balance := ReportForNav.RestoreTotal(DataItemId,14,GroupTotalFieldNo);
                 "Amount - Interval 1" := ReportForNav.RestoreTotal(DataItemId,15,GroupTotalFieldNo);
                 "Amount - Interval 2" := ReportForNav.RestoreTotal(DataItemId,16,GroupTotalFieldNo);
                 "Amount - Interval 3" := ReportForNav.RestoreTotal(DataItemId,17,GroupTotalFieldNo);
                 "Amount - Interval 4" := ReportForNav.RestoreTotal(DataItemId,18,GroupTotalFieldNo);
                 "Amount - Interval 5" := ReportForNav.RestoreTotal(DataItemId,19,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>b14bb99a-3980-4d7a-be8f-38f12632c6c8</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="BalanceCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>BalanceCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>BalanceCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="AgedOverdueAmounts">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>AgedOverdueAmounts</Value>
        </Values>
      </DefaultValue>
      <Prompt>AgedOverdueAmounts</Prompt>
    </ReportParameter>
    <ReportParameter Name="AmnsInLCY">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>AmnsInLCY</Value>
        </Values>
      </DefaultValue>
      <Prompt>AmnsInLCY</Prompt>
    </ReportParameter>
  </ReportParameters>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>aa23a08a-06e7-4c13-bedc-16ea1fc7fe65</rd:ReportID>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Fields>
        <Field Name="FormatEndingDate">
          <DataField>FormatEndingDate</DataField>
        </Field>
        <Field Name="PostingDate">
          <DataField>PostingDate</DataField>
        </Field>
        <Field Name="PrintAmountInVendCurr">
          <DataField>PrintAmountInVendCurr</DataField>
        </Field>
        <Field Name="AgingByDueDate">
          <DataField>AgingByDueDate</DataField>
        </Field>
        <Field Name="AgedOverdueAmtCptn">
          <DataField>AgedOverdueAmtCptn</DataField>
        </Field>
        <Field Name="PrintDetails">
          <DataField>PrintDetails</DataField>
        </Field>
        <Field Name="HeaderText1">
          <DataField>HeaderText1</DataField>
        </Field>
        <Field Name="HeaderText2">
          <DataField>HeaderText2</DataField>
        </Field>
        <Field Name="HeaderText3">
          <DataField>HeaderText3</DataField>
        </Field>
        <Field Name="HeaderText4">
          <DataField>HeaderText4</DataField>
        </Field>
        <Field Name="HeaderText5">
          <DataField>HeaderText5</DataField>
        </Field>
        <Field Name="HeaderText6">
          <DataField>HeaderText6</DataField>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70248 ForNAV Cust./Item Statistics
{
  OBJECT-PROPERTIES
  {
    Date=05-09-17;
    Time=17:00:00;
    Modified=Yes;
    Version List=FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Customer/Item Statistics;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  CompanyInformation.GET;
                  FilterString := Customer.GETFILTERS;
                  FilterString2 := "Value Entry".GETFILTERS;
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 6836;    ;DataItem;                    ;
               DataItemTable=Table18;
               PrintOnlyIfDetail=Yes;
               OnPreDataItem=BEGIN
                               ReportForNav.GetDataItem('Customer').NewPagePerRecord := OnlyOnePerPage;
                             END;

               ReqFilterFields=No.,Search Name,Customer Posting Group }

    { 1   ;1   ;Column  ;Profit              ;
               IncludeCaption=No;
               SourceExpr=Profit }

    { 1000000000;1;Column;OnlyOnePerPage     ;
               IncludeCaption=No;
               SourceExpr=OnlyOnePerPage }

    { 1000000001;1;Column;ShowCustContactInfo;
               IncludeCaption=No;
               SourceExpr=ShowCustContactInfo }

    { 8894;1   ;DataItem;                    ;
               DataItemTable=Table5802;
               DataItemTableView=SORTING(Source Type,Source No.,Item Ledger Entry Type,Item No.,Posting Date)
                                 WHERE(Source Type=CONST(Customer),
                                       Item Ledger Entry Type=CONST(Sale),
                                       Expected Cost=CONST(No));
               OnPreDataItem=BEGIN
                               CLEAR(ValueEntryTotalForItem);
                               ProfitTotalForItem := 0;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF ValueEntryTotalForItem."Item No." <> "Item No." THEN BEGIN
                                    "CalculateProfit%";
                                    CLEAR(ValueEntryTotalForItem);
                                    ProfitTotalForItem := 0;
                                    IF NOT Item.GET("Item No.") THEN BEGIN
                                      Item.Description := Text000;
                                      Item."Base Unit of Measure" := '';
                                    END;
                                  END;
                                  Profit := "Sales Amount (Actual)" + "Cost Amount (Actual)";
                                  "Discount Amount" := -"Discount Amount";
                                  ValueEntryTotalForItem."Item No." := "Item No.";
                                  ValueEntryTotalForItem."Invoiced Quantity" += "Invoiced Quantity";
                                  ValueEntryTotalForItem."Sales Amount (Actual)" += "Sales Amount (Actual)";
                                  ValueEntryTotalForItem."Discount Amount" += "Discount Amount";
                                  ProfitTotalForItem += Profit;
                                END;

               ReqFilterFields=Item No.,Inventory Posting Group,Posting Date;
               DataItemLink=Source No.=FIELD(No.),
                            Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Code=FIELD(Global Dimension 2 Filter) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1000000000;2;Field  ;
                  Name=DisplayCustContacts;
                  CaptionML=ENU=Show Customer Contact Information;
                  ToolTipML=ENU=Specifies, if you want to have contact infomation near the customer name.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ShowCustContactInfo }

      { 2   ;2   ;Field     ;
                  CaptionML=ENU=New Page per Account;
                  ToolTipML=ENU=Specifies if you want to print each account on a separate page. Each account will begin at the top of the following page. Otherwise, each account will follow the previous account on the current page.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=OnlyOnePerPage }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Item@1000000003 : Record 27;
      CompanyInformation@1000000002 : Record 79;
      ValueEntryTotalForItem@1000000001 : Record 5802;
      FilterString@1000 : Text;
      FilterString2@1001 : Text;
      Profit@1003 : Decimal;
      "Profit%"@1004 : Decimal;
      ProfitTotalForItem@1000000004 : Decimal;
      OnlyOnePerPage@1005 : Boolean;
      PrintToExcel@1000000000 : Boolean;
      Text000@1480002 : TextConst 'ENU=Invalid Item';
      Text001@1480013 : TextConst 'ENU=Data';
      Text002@1480012 : TextConst 'ENU=Customer/Item Statistics';
      Text003@1480011 : TextConst 'ENU=Company Name';
      Text004@1480010 : TextConst 'ENU=Report No.';
      Text005@1480009 : TextConst 'ENU=Report Name';
      Text006@1480008 : TextConst 'ENU=User ID';
      Text007@1480007 : TextConst 'ENU=Date / Time';
      Text008@1480006 : TextConst 'ENU=Customer Filters';
      Text009@1480005 : TextConst 'ENU=Value Entry Filters';
      Text010@1480004 : TextConst 'ENU=Contribution Margin';
      Text011@1480003 : TextConst 'ENU=Contribution Ratio';
      ShowCustContactInfo@1000000005 : Boolean;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    PROCEDURE "CalculateProfit%"@1();
    BEGIN
      IF ValueEntryTotalForItem."Sales Amount (Actual)" <> 0 THEN
        "Profit%" := ROUND(100 * ProfitTotalForItem / ValueEntryTotalForItem."Sales Amount (Actual)",0.1)
      ELSE
        "Profit%" := 0;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000000();
    VAR
      ForNAVSetup@1000000001 : Record 70000;
      OutStream@1000000000 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Customer': WITH Customer DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Value Entry"."Sales Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,1,Profit);
                ReportForNav.AddTotal(DataItemId,2,"Value Entry"."Discount Amount");
              END;
           'Restore': BEGIN
                 "Value Entry"."Sales Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 Profit := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Value Entry"."Discount Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
              END;
        END;  'ValueEntry': WITH "Value Entry" DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Invoiced Quantity");
                ReportForNav.AddTotal(DataItemId,1,"Sales Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,2,"Discount Amount");
                ReportForNav.AddTotal(DataItemId,3,"Invoiced Quantity");
                ReportForNav.AddTotal(DataItemId,4,"Sales Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,5,Profit);
                ReportForNav.AddTotal(DataItemId,6,"Discount Amount");
              END;
           'Restore': BEGIN
                 "Invoiced Quantity" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Sales Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Discount Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Invoiced Quantity" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Sales Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
                 Profit := ReportForNav.RestoreTotal(DataItemId,5,GroupTotalFieldNo);
                 "Discount Amount" := ReportForNav.RestoreTotal(DataItemId,6,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>abbf7959-7095-48cc-b333-0dde00daaebe</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>4c6bff39-b002-4f5d-9822-8f21395d3c39</rd:ReportID>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Fields>
        <Field Name="Profit">
          <DataField>Profit</DataField>
        </Field>
        <Field Name="ProfitFormat">
          <DataField>ProfitFormat</DataField>
        </Field>
        <Field Name="OnlyOnePerPage">
          <DataField>OnlyOnePerPage</DataField>
        </Field>
        <Field Name="ShowCustContactInfo">
          <DataField>ShowCustContactInfo</DataField>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70518 ForNAV Tax Purchase Templ.
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Tax Purchase Template;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                   ERROR('');
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000 : Text;Operation@1001 : Text;GroupTotalFieldNo@1002 : Integer);
    VAR
      CurrRecRef@1003 : RecordRef;
      NextRecRef@1004 : RecordRef;
      CurrKeyRef@1005 : KeyRef;
      NextKeyRef@1006 : KeyRef;
      FieldIndex@1007 : Integer;
      GroupFieldIndex@1008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>42097cf4-a61f-4439-87ad-4177d490da5f</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>8e027807-8865-48c9-aa32-ce34a126a5ac</rd:ReportID>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Fields>
        <Field Name="HasDiscount">
          <DataField>HasDiscount</DataField>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70519 ForNAV Sales Templ. Sales Tax
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Sales Template Sales Tax;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                   ERROR('');
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000 : Text;Operation@1001 : Text;GroupTotalFieldNo@1002 : Integer);
    VAR
      CurrRecRef@1003 : RecordRef;
      NextRecRef@1004 : RecordRef;
      CurrKeyRef@1005 : KeyRef;
      NextKeyRef@1006 : KeyRef;
      FieldIndex@1007 : Integer;
      GroupFieldIndex@1008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>6038ae24-61f3-4345-8295-9e6137bd26b6</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>11e51b7d-0317-4137-a2d4-add320a61641</rd:ReportID>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Fields>
        <Field Name="HasDiscount">
          <DataField>HasDiscount</DataField>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70526 ForNAV Template - Landscape
{
  OBJECT-PROPERTIES
  {
    Date=05-09-17;
    Time=17:00:00;
    Modified=Yes;
    Version List=FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Template - Landscape;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table2000000026;
               MaxIteration=1 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Mo§nosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>17a7f641-5e7b-438d-8e19-46e0ba32d129</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>40bc8683-8fb4-4526-851c-87fbbe0af3a2</rd:ReportID>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70527 ForNAV Template
{
  OBJECT-PROPERTIES
  {
    Date=05-09-17;
    Time=17:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table2000000026;
               MaxIteration=1 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Mo§nosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>17a7f641-5e7b-438d-8e19-46e0ba32d129</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>40bc8683-8fb4-4526-851c-87fbbe0af3a2</rd:ReportID>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70528 ForNAV Purchase Template
{
  OBJECT-PROPERTIES
  {
    Date=06-09-17;
    Time=10:04:05;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Purchase Template;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                   ERROR('');
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000 : Text;Operation@1001 : Text;GroupTotalFieldNo@1002 : Integer);
    VAR
      CurrRecRef@1003 : RecordRef;
      NextRecRef@1004 : RecordRef;
      CurrKeyRef@1005 : KeyRef;
      NextKeyRef@1006 : KeyRef;
      FieldIndex@1007 : Integer;
      GroupFieldIndex@1008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>EJ0AAO1de3PcNpL//6ruO/AmdSu5bjImiAfJtWZTeliJamVJZ8lOaq+uVHxgJMYUOcfhyFZ2c3Wf5j7YfZID+Bo+wBlwyJGVSpyKLZF4NPrXALobjebBd18efOWRRgsvDKYjMFFHCg2c0PWCu+loGc++NUbf/eWf/+ngpziy3tN5GMWLc+spXMbXNPIs3/uFRsrqx49FQ2iiTTBv7T2dsV9HynEYxFHo3zzN6XR0Qh/ffplHdLGYlBqefDgr/TpWWko98sbHSt5X3tVYOV768TKi04AuWXF/rFwtbd9z/kqfbsJPNJiaNgaWZpMZ0uyZjZ2RcmE9MGqyhk/D6MJ6HClX1h39gXp39/F0pJm6mj750XPje/YAqOzBOyu684LFdARV1i/gf2nZXyPllI10OjrkPBkr5pwNxLm3omsaT9nLk7nHGsGI/WTF1nW4jBxGwTeMS98mzOKUfAg81sANDeL7xeXs8J3n+94DjWk0UioMHimXwVVE00rXTuTNWbXj8GFuBU9nwSyMHqyYFZ58T+P9V2/+9M2XE/7X4RtvpuwrV5EXxOfhXbj/6pXy99VLRRG0cGz5zqlHfXexv3flOZzLe+UWf139uPqJ8/PwIxv3ct4gYfXTbBk4vI8yQVV6OLnHyyhKxzlJylHOz5gJ6SL9/SacTveuTk73anUVJWL9R4ESR0uqvCm/+nW7PiL66NHPa/tp60bIpWL8jEXn9M7y2URxPf5kIWJEytSi4E1kBQt/BfMP1HJpNDm3grslE9rj0KV1eAtS1zRVI0RMea2hFOh6zdLomch7i7lvPaWzLq3F5mjEpseCKjf0gb2MKZNq+2fqxBfhdKSrWDPyaZFN0GIKaBOV/Qc0oo7YCqUoB0dW4C6SH9kvZzF9AOnqo9VWn7QdPv94IV4rXwlS9tVnKS91Y9k+/ciQn46uL9/fnF18v38RTl7VCrBZy/8BmrZ68dGKqo1/H4XL+U0YW346paYj1tJIqTw5fAiXQTxO/1HOAsdf8iVZ+Xh4wwZTzMa8YLVEVo2Peu5RVggkS8uCxnwhu1g+2DSajriksnHTz/zhFWWi74SRmz8/cxO+JQtMPpJ8ieGN/dep57MZUhrB+Cpc8NnCB84aOKeP1J+OMmwSSMr41DGCQoxSlpUROgmd5QNbGZtIHVnOp+PQD9nQElGeWxFNmGAF1/ds/n6ajmaWv2CkJbP5nfXlMnD4wPn4q+8ug7dsS3xKX6T8OPT98HPKgLdRFEaL/MW1dxdYybYzsgETxhlyTYgpJUClyHEcCwDLch1N1XTXMS0NuWyo1zSZ8+IhpXvP6XRkQCbgqgpGJZ4xrmV8WlSeVrmJhNy8oV/io/BLVdhvT5Y0Reya7eCsV2gkvWoIjbE5Mdkf1tp56CQrw6kfWkwCAATJK8MYK0RPf8w3vmt6F1Llw9lYMeYxfxjRDJYjn0FUhowTdOgzBvLhT0fvPNf16Xs+esaFMPolecf25/QJLz0d/d///G9BcbKF0jgRwvKYJnmJGosYk67jJ58ykMPIi59SZuGR8mFBU+IzKUh+L+hePawRnL14XUfidQKFCB8t7ZLI4LPaj26vYzYFrMg9tubJsnrLZvZTgRhiqgdbBOsgMX0EE7UFlioICVvTNps8Le2LdTomSR0pLutNLov5pon4BtNGjA5ynYzgPAw/LeeL2yvriUN2Q6OHxQldJPOYDaAs9IyFyWzTNCCQd41xU4eJpOuYPJ+stxLeKvvlcU/aqktBZu5mYkARwCgzFNQhEM7Ec4WulkCrEpCBrJImxKq6gtgUAjxWFpxJ06PQdzeD3YCvoKo7dHlVKdgAkMRNDA8SwYOzpsWq1Bp4ihWrsc2UMWlBY+3WsgUamzeOCs3dthEAe7Edi9hOsqa77Oc1tmfKRZ33a5iebu0mHGwSVGmQ5X25khwAshu5GAAiAkDPmpbasIUAXEbs2UW4ifc7WHuKniU5npeXY7ZgP+/AbF3EbCNruvMuXzCbGT/v6Z23iKOEt1JsH3qREdAgCUCzphwUsvu0GApDBIWZWc5bb8cfaeCGkWAjbkNh2FVHyF+2o97GYUpZB1hq1aQw0frtwabQtlOztjtvwonHIVGR2EAOXZe7VCvWg5ZsxlAzmqov928mdiAhhhibTnrvTTg/p7M48WTGmc7LnlV04LRAE8h0GJPaMNajKKwjB6Hsft7VLlSF4Oa+KqmtvumirQDdEWIA1cz0GRzrzJxZA3bd4FmDq8AxXca4G7q7svqFZj/I7H6tq+FfX0ATFa3F1lfFtn63pbNhoqaTsWV2llwDGaXKvyl7f1b22D/ZLBQvtHIV5ZCU1US6Iil0RIDME6GJlZTscGT9VM0KtejflUOiDHadvchnJja2dybkHbNmkwO+v4Xhw9mDdSdUywXTLW9ADhizO8+FvgGQOQeglDZSmj1XycgyHmrimQOwumby7Min08Lw0gEULyLFZSiraXSFQugHAJkjAHbRQep6V74rYSEgiattgzo4PCzZoiOtIm6jFMJdaRRC3wHInAews/NApC6iMmxrHDcpes9+JNDF6NrSzIK70hiEjgeQeR5gZ8+DCD1jhR5KJ1a7IzRzzAEDjhUd5Vg/H5Sb3RadHBVwV+qB0IUBMh8G7OLDEPvoOhzDYfAVVkx5x153Vx7c0dEDqDo7Dl4LzlKbp3flkzsk1kFOwzCuHlSnT2QOqK8YGvQsOArjOHzIj5XbzqHXnV03T7pLh9PEck3VMiwCHReqtjmzVWCqBFqmY+szqkPVUJmNSGqH0/kwikNpDatbnEfXA8C2WsXIygxKFGIktIPkTjwb0n5Mg3SgK3HPH71b+rF37gUFCOkE+A+RgnwfBvQiVJR/mSp7e8p3omCqmncpq8HMHyW1f9Y1+2clWPr+WFmF1QhKv719Z3m+PAlZ+bUUZGWy/td2/0P4QLlcdmBCUWUtDUUpKS40tnl5cppVc7rEhDXLS1F4dnR4IU9UUnotf5ISUj1f/3h2esODwzpgtKqzlohVsZSS/5yUYt2SmKH9IuRt/9HyXyl/z8LI2C9vfn01+Tn0gv095R/K3ivRnvLHrPtj1v0x63Y666RUNKQJVbShIqSQOCBwKz+4VtUbxO5Tpgw1FQeycp+exZbvOX3UiFRrEIX5vhEtdOKCctig3thosoqyVleUMwcpwtJRt1y1koy5zU0JhQec8nrKuihcKIjCTTsTBNuuyrIin9gYKFPPnVLcLg+JhdVSq+BNTsf09Ozt+UkWF9yMf004VI+BbWjKYnv/KHSf6ixb8IdSBsa2NoOuAqC7lLoWRkhzyUyFps0MCV2jhgUhoth1dWDRms1QIq4wG4gqEN0Wy6HBE70y7ATcGpd+ep893TDRtQmEEOiYkKqjXUABo+F9+FlEW4M+o0IfqyWmLnmxguvH7I6JOsFEN1Umrij7QUxOyjLqC/klpMsU08HbKFN8m3hbCrqE1lNh8/OyJcpNYmg60gmzHU2oGVi0kvE+knOgLgdMTDDZKv65CLO+Dz9fLuP5Ms7aY8vjZbJHfrT8Jd3f4yPce6VMp8oa9iUcEoUAqz0WzErjwo2tAVC2yeG6WdwGUDXyUxKpSqUcMm2CDaJhDQJADFPny00LYJXqVTS681egLGxmY/0ArsHGbKvBdV2hjY3/vrSCmBElz8NVjabMI4iIAUydgXjkW8Gnv9EozMW1haer5rp53Pqyv48+0MSlfkjXwCU7r8N1FaANF37hLZy9o9YiOZ2UBadWrY4QViFhPwAdoFZAak08LypkUFTq53UNVLKjO6xLosL/OvEWDleOrpxYHpdGxebcgcQwMEbcTS47dxqt9gGrsp+cPAXWg+csMvWU9T35wVrkfU2nW8JrDApv/YyvAW923IdlN30u+sfhogOuqxpNQHVdNQE29Q6Arpp71mlHht3r66d3DVyygzwiu9cX1ogkKnn5HBMwASYkGKuGhjRVBSaRhyRv63kB6eNJaAJSP5crv1+nPa9T3Q5et5gCbZWEBnP2KjlOYHba8iHIGAC3ukMmPtdvXplMjJJd3ZcsWYuuifEMU5u6hmmx3uCMYOjOTOgSTJmB4Liu62DHFVmLjbuP/Jr91gYjwYKxS5uNyQ1/4blSiXkhP4NeTEfpqV0/+5EQAbkDWJHK4TIOT3kugfUTs5NRSWTVh2pk/kV42yaHNVZujmEU2qJkYqhIM1XdxARCE/HAicbBXcuyV3W5CizVlLRG4HJO8QbjtfuKKFYdCk49n4VKZLWJ2q2jle3YBrs8ymI71pwgA2vYMAiCpqZyX992cFea/7q462LVZEDcZU1qXVZbqeKe27f9QW8a3vkEhyZgK7QGtwa81QhPYW2GrAvgXmk++V6ZEtBXAMSq0IACIGu767I+laoAcJ3+Mren+0tBi4WfiwIBmP2vqfwG1HaysN7+fwECIfbcDCgQsm4DXdaZUxWImtXeLhL14DR5IWl1N+Rigg2gAQQRP7LcTkw2+R62EpTndUfoYm+TMKRuQPGSdVvo26mVuQ9hF3LVdHcUAqUignQdo611zFbfxwtYcsTK564FRdaPom+nkaaejbKY9NydBKBmuZh4oMZ+6SJTJasDv+NBA+cpD+l4tVfy3MAJUQ22WrE/hgY0Y2vx2paSgZe1zrJn7FwBflbvUMsg0xs7Jf9L+0hFA+rsc5LIq9NynYf7hZoOpdLjnYYfWA7QAYDYQBaGtg2poxqGAbELVdVEeOa6FNp0Nqs5lCrkrRxKfSIQDCgY+8t1KBlIQO5LdSgZ2ymWF+Ftixz28x8BFSKCdYC3tim+vv/IEOt6X8F/ZGyn1pX9R71RXus/IrqhG4YO+Q2F37z/yNi531DWf2Rsp6UV/qPeoP9m/Ed98DZ3ri7JuovM7fyFFfdLf9Bl3UUvyFvUC/6dewtlnUPmdt7CunOoVQCewTmEf8e+IVPsZXwpviFzOw2x8A3tQKx+p74h8+s4EWV9Q6astnkRqi/L5QMNJj0mSoJ1fl8uH3PnOusLcPmY5m5cPlVjK/EzyFyaYuprsKTubeYIzaO+8kQ5Zpq9QzeE+XJQKVnYhpRTknemNicaKN/QaQ9bk4YDqOKkOfIS1m4Nla0goEqlyWkA0sj6Jc6UAzSsbgaBr2BjRQxFlvc767578u+8YgfOC3LgtDO4aX5scHKuzy0tjphL1INmAofS4516OW0KMNIAcQwXUkptw8Am0FUDUKQTCikwDBNRfuzR9HI2sjOYbG4SpOnbuzqBKr64t9XNSyQnwr8pARaoQH2W7LrK0oPbcJU8piXXGVI3cvvlrtl94+nb1uwNS8rafOhq3c/Vlg4mOWx8htXEUFWXYNfUCDapyVYCCnQIiW2ohECLmhqybYyJLQrCbeZ6UXGS/gmCHusJT+mfdnJ9b82peEdMXlVPTbDwlnY1OyKvlTbDBTG72pvmcyt+v44jGjv3xYdcgjt+Q9gUnAalosfbzEkHWR/lq8M9Jrtc+vxm+k8iq5vB9LVOxoqGknRQGo/b2WjfCBbV9umbWRadJ7AoQX4P3UouKX6TmcbGVbLERSPhIj8elfqKSoU1xTeZPh7efFtl2iaurqnagd+ChHVdVK2a9iSXA7/Jb30jv9Pv5/WU1+ulnVzq76oDFPU6MFbiWzYrxop8qJU9RC7ffZOxphxjASoW8c2MbQTj1zm9jpUJH7t7ILrhtV0nHcAVp56Tt9JFXs3KxzzkkurLqXxql8VsWEko9ojyYtVpZeuASks+fXlURC7Eyhc+5LLqy6ECyqjkWRxbJ2jHPYbx/cb60r6RrJ08RcUOrO+0bTedbRvU6+p0OXjd+EhgY3eq7Eot+fJFaWaYxKWD75BvhtVRzlymknszj0Zj/iv/+uIy/U6mwrscM6am33RU+IIz/sC/ZWl94Z9D9GLvkbZkp9H44W0jO02NxkqaGt75v6ZJb7LPQ/InpR+PrEWi/z4w8K3oqfwpR55aPPkDisw09c8KbspMAzSxY6CemoZRsvPENDYxgKph3ZoBZFPo6CqxTQNjC9tQA9QyKVCBReo+k4K0QdLSAK24txdzRFtOqWSSTw2WigZoeoUmVq2FrOdORgMaGfPbD2ew/O1nBulqfpaHgXR+poJNXQXI1DAUZqapTLdJra2eBxtAE2gSw0VWgUY2/HZ+kk78rKVs2I6RSSN9OSjKbT9cjBJoJLFv56DeLftF/U7+VlwsN9Sbk5KbeJWTstE/oJFjvp2TRidZHISRpXZ681HSpq7yUTaMBjSyvbfz0ezEx1Q16MvFtJXePJQ0n6s8bA8WealpHQDPbtM9rwOAYp9yMw6fIfIMaR1021Zdx8bIRsC1ELI16JjsP4pMaCPHtoDuanQGmrpWIwZf76NtIbWi2bTMFKlUn8OpWzxsuKputdD17OoWkt3cSvHLa28kdIiOGlIpa+QIHlJFQ+Ivssi4FYp2u2ltSHanLMEChoOlv27XwGMQTQ+JP67SHQhp5a+RaFUCCG0gIAZTEZuRqEMpOkj82ZTugEjrkEjWPiwBAoebGTvAY0C9E23vla7CIa2KYlnzsgQHGg6OARTWBhjDqK94e1d0FYqXrdFuvjQKsNhl3gx+YLx/htAHy8CGqesYOtTUXehgc6abNjUAdYllUQs4hm1ptsAp2Ah86OUWxLCiE7bEJD+vWxCjup7aQtaz66kySWLj/IFYE0o+KSs0gVfkm4hgSIipIxWrGkrSTfRdCF7MLUsgndO1tFjrbbwcK2tWbBktRiMGNCBPGQ8IXyOe09HVknV1h4qkdMLVEu+NvrxvU1jKrBfn9t6Za6wlr+oONUbplKolzpsDcF6gm3QV+cG0kZbkqUMqhi9HG6lKRttZcXkkFZWWiL8p03JWfOxby4XsOTE/+W056MWk5aA372D9ga1WHNhqXQ9sWzLECg5sU1J2fmyrqbYOAdUN27YJgtBwNUiAa1DHUamLdDKj2LTNekKPGoHDaGlEKsx90ycJgaQa1z/geuOHhQoulTMSJIFSPE5K+LZtoerejnw4Cemb9X4Y3zxPYyvjm29bZFbGW73EQdrPor4KFYJn1Ga4KgyaWt3qZSIWLiOHvv0yj1IxPfx4fE+dT8V3VbOC5avA+6nksjUpjbiimSEsYC1nXJniKhsqeiaPqMhU8nD+zoruvIAPvr4P35RfliW7FFmurkioqFN64ea3k/24vZej2vtNHZWBOnhPHbZFLsoU5ADx3KcXYZpprC3qq0Z8zh+evzOpmsKa1k4RY/Au521jhqtqoFqt+ARYsgL7lc7Z9loaxQGbkGz+0Cj9LM4ibxulN8iTRdsL7n60ooD9s1IN+EsmWmEUN15l3VzaP7Pl+Dpmm9QdrXIsfZXicUIfuYiyVXHyUxxZaQzaYnJNI4+tcL+kH6qrtMUZOlZa6j0CNGHsTEaR+aKSpeG/eaFvLj6cn4+UtOPrpwUjZsIn0SSbSSsW1Yk/eF3q5Nx6CpdxTiGN/vL/</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>0a2d6cf4-5f6e-47c4-879b-635237817f5e</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>c0e38a5b-34ff-4e4b-b346-2fce429822d9</rd:ReportID>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Fields>
        <Field Name="HasDiscount">
          <DataField>HasDiscount</DataField>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70529 ForNAV Sales Template
{
  OBJECT-PROPERTIES
  {
    Date=01-09-17;
    Time=18:00:00;
    Modified=Yes;
    Version List=CTP4,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Sales Template;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                   ERROR('');
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1260, Version=2.0.0.1260, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000 : Text;SectionId@1001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000 : Text;Parameters@1001 : Text;ServerFileName@1002 : Text);
    VAR
      ServerFile@1003 : File;
      ServerInStream@1004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000 : Text;Parameter@1001 : Text;ParameterNo@1002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1001 : Boolean);
    VAR
      ClientFileName@1002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000 : Text;Operation@1001 : Text;GroupTotalFieldNo@1002 : Integer);
    VAR
      CurrRecRef@1003 : RecordRef;
      NextRecRef@1004 : RecordRef;
      CurrKeyRef@1005 : KeyRef;
      NextKeyRef@1006 : KeyRef;
      FieldIndex@1007 : Integer;
      GroupFieldIndex@1008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>28718e97-e54a-457b-98dc-06440c548451</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>c049cc91-3123-4ca0-aebc-a668de832ff8</rd:ReportID>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Fields>
        <Field Name="HasDiscount">
          <DataField>HasDiscount</DataField>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Codeunit 70000 ForNAV Check Document Discount
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Version List=FORNAVBETA;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE HasDiscount@1000000001(Rec@1000000000 : Variant) : Boolean;
    VAR
      RecRefLib@1000000002 : Codeunit 70090;
      TestValidDociFace@1000000003 : Codeunit 70080;
      RecRef@1000000001 : RecordRef;
    BEGIN
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      TestValidDociFace.ThrowErrorIfNotValid(RecRef);
      EXIT(CheckLinesTableForDiscount(RecRef, FindDiscountFieldNoInLines(RecRef)));
    END;

    LOCAL PROCEDURE FindDiscountFieldNoInLines@1000000009(RecRef@1000000001 : RecordRef) : Integer;
    VAR
      Field@1000000000 : Record 2000000041;
      NoDiscountFieldErr@1000000002 : TextConst 'ENU=The connected line table does not contain a valid field for Line Discount.';
    BEGIN
      Field.SETRANGE(TableNo, RecRef.NUMBER + 1);
      Field.SETRANGE(FieldName, 'Line Discount %');
      IF NOT Field.FINDFIRST THEN
        ERROR(NoDiscountFieldErr);

      EXIT(Field."No.");
    END;

    LOCAL PROCEDURE CheckLinesTableForDiscount@1000000011(VAR RecRef@1000000000 : RecordRef;FieldNo@1000000001 : Integer) : Boolean;
    VAR
      RecRefLib@1000000004 : Codeunit 70090;
      LineRec@1000000003 : RecordRef;
      FldRef@1000000002 : FieldRef;
    BEGIN
      LineRec.OPEN(RecRef.NUMBER + 1);

      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'No.');
      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'Document Type');

      FldRef := LineRec.FIELD(FieldNo);
      FldRef.SETFILTER('<>0');
      EXIT(NOT LineRec.ISEMPTY);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70001 ForNAV Get Vat Amount Lines
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Version List=FORNAVBETA;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetVatAmountLines@1000000000(Rec@1000000000 : Variant;VAR VATAmountLine@1000000001 : TEMPORARY Record 290);
    VAR
      DocLineBuffer@1000000006 : TEMPORARY Record 70999;
      RecRefLib@1000000002 : Codeunit 70090;
      TestValidDociFace@1000000004 : Codeunit 70080;
      RecRef@1000000003 : RecordRef;
      LineRec@1000000005 : RecordRef;
    BEGIN
      ThrowErrorIfNotTemp(VATAmountLine);
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      TestValidDociFace.ThrowErrorIfNotValid(RecRef);
      FindLinesRecRef(DocLineBuffer, RecRef, LineRec);
      CreateVATAmountLine(DocLineBuffer, VATAmountLine);
    END;

    LOCAL PROCEDURE ThrowErrorIfNotTemp@1000000001(VAR VATAmountLine@1000000000 : Record 290);
    VAR
      NotTempErr@1000000001 : TextConst 'ENU=When using this function the Vat Amount Line table should be declared as temporary.';
    BEGIN
      WITH VATAmountLine DO
        IF NOT ISTEMPORARY THEN
          ERROR(NotTempErr);
    END;

    LOCAL PROCEDURE FindLinesRecRef@1000000003(VAR DocLineBuffer@1000000004 : Record 70999;VAR RecRef@1000000000 : RecordRef;VAR LineRec@1000000001 : RecordRef);
    VAR
      RecRefLib@1000000002 : Codeunit 70090;
      FldRef@1000000003 : FieldRef;
    BEGIN
      LineRec.OPEN(RecRef.NUMBER + 1);

      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'No.');
      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'Document Type');
      IF LineRec.FINDSET THEN REPEAT
        DocLineBuffer.CreateForRecRef(LineRec);
      UNTIL LineRec.NEXT = 0;
    END;

    LOCAL PROCEDURE CreateVATAmountLine@1000000002(VAR DocLineBuffer@1000000001 : Record 70999;VAR VATAmountLine@1000000000 : Record 290);
    BEGIN
      WITH DocLineBuffer DO
        IF FINDSET THEN REPEAT
          VATAmountLine.INIT;
          VATAmountLine."VAT Identifier" := "VAT Identifier";
          VATAmountLine."VAT Calculation Type" := "VAT Calculation Type";
          VATAmountLine."Tax Group Code" := "Tax Group Code";
          VATAmountLine."VAT %" := "VAT %";
          VATAmountLine."VAT Base" := Amount;
          VATAmountLine."Amount Including VAT" := "Amount Including VAT";
          VATAmountLine."Line Amount" := "Line Amount";
          IF "Allow Invoice Disc." THEN
            VATAmountLine."Inv. Disc. Base Amount" := "Line Amount";
          VATAmountLine."Invoice Discount Amount" := "Inv. Discount Amount";
          VATAmountLine."VAT Clause Code" := "VAT Clause Code";
          IF ("VAT %" <> 0) OR ("VAT Clause Code" <> '') OR (Amount <> "Amount Including VAT") THEN
            VATAmountLine.InsertLine;
        UNTIL NEXT = 0;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70002 ForNAV Get Vat Clause
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Version List=FORNAVBETA;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      TryGetVATClause@1000000000 : Integer;

    PROCEDURE GetVATClauses@1000000000(VAR VATAmountLine@1000000001 : TEMPORARY Record 290;VAR VATClause@1000000000 : Record 560;LanguageCode@1000000002 : Code[10]);
    BEGIN
      WITH VATAmountLine DO
        IF FINDSET THEN REPEAT
          TryGetVATClauseText(VATClause, "VAT Clause Code", LanguageCode);
        UNTIL NEXT = 0;
    END;

    LOCAL PROCEDURE TryGetVATClauseText@1000000002(VAR VATClausePar@1000000000 : Record 560;VATClauseCode@1000000002 : Code[10];LanguageCode@1000000003 : Code[10]);
    VAR
      VATClause@1000000001 : Record 560;
    BEGIN
      IF NOT VATClause.GET(VATClauseCode) THEN
        EXIT;

      VATClause.TranslateDescription(LanguageCode);

      VATClausePar := VATClause;
      IF VATClausePar.INSERT THEN;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70003 ForNAV Update No. Printed
{
  OBJECT-PROPERTIES
  {
    Date=14-07-17;
    Time=14:46:59;
    Version List=FORNAVCTP4;
  }
  PROPERTIES
  {
    Permissions=TableData 36=rm,
                TableData 38=rm,
                TableData 110=rm,
                TableData 112=rm,
                TableData 114=rm,
                TableData 120=rm,
                TableData 122=rm,
                TableData 124=rm;
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE UpdateNoPrinted@1000000001(Rec@1000000000 : Variant);
    VAR
      RecRefLib@1000000003 : Codeunit 70090;
      TestValidDociFace@1000000002 : Codeunit 70080;
      RecRef@1000000001 : RecordRef;
    BEGIN
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      TestValidDociFace.ThrowErrorIfNotValid(RecRef);
      FindAndUpdateField(RecRef);
    END;

    LOCAL PROCEDURE FindAndUpdateField@1000000003(VAR RecRef@1000000000 : RecordRef);
    VAR
      Field@1000000001 : Record 2000000041;
      FldRef@1000000003 : FieldRef;
      NoPrinted@1000000004 : Integer;
    BEGIN
      Field.SETRANGE(TableNo, RecRef.NUMBER);
      Field.SETRANGE(FieldName, 'No. Printed');
      IF NOT Field.FINDFIRST THEN
        EXIT;

      FldRef := RecRef.FIELD(Field."No.");
      NoPrinted := FldRef.VALUE;
      NoPrinted +=1;
      FldRef.VALUE := NoPrinted;
      RecRef.MODIFY;
      COMMIT;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70004 ForNAV Get Sales Tax Details
{
  OBJECT-PROPERTIES
  {
    Date=17-07-17;
    Time=15:25:13;
    Modified=Yes;
    Version List=FORNAVCTP5;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetSalesTax@1000000000(Rec@1000000000 : Variant;VAR ForNAVSalesTaxBuffer@1000000001 : TEMPORARY Record 70998);
    VAR
      DocLineBuffer@1000000006 : TEMPORARY Record 70999;
      RecRefLib@1000000002 : Codeunit 70090;
      TestValidDociFace@1000000004 : Codeunit 70080;
      RecRef@1000000003 : RecordRef;
      LineRec@1000000005 : RecordRef;
    BEGIN
      ThrowErrorIfNotTemp(ForNAVSalesTaxBuffer);
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      TestValidDociFace.ThrowErrorIfNotValid(RecRef);
      FindLinesRecRef(DocLineBuffer, RecRef, LineRec);
      CreateSalesTaxDetails(DocLineBuffer, ForNAVSalesTaxBuffer);
    END;

    LOCAL PROCEDURE ThrowErrorIfNotTemp@1000000001(VAR ForNAVSalesTaxBuffer@1000000000 : Record 70998);
    VAR
      NotTempErr@1000000001 : TextConst 'ENU=When using this function the Vat Amount Line table should be declared as temporary.';
    BEGIN
      WITH ForNAVSalesTaxBuffer DO
        IF NOT ISTEMPORARY THEN
          ERROR(NotTempErr);
    END;

    LOCAL PROCEDURE FindLinesRecRef@1000000003(VAR DocLineBuffer@1000000004 : Record 70999;VAR RecRef@1000000000 : RecordRef;VAR LineRec@1000000001 : RecordRef);
    VAR
      RecRefLib@1000000002 : Codeunit 70090;
      FldRef@1000000003 : FieldRef;
    BEGIN
      LineRec.OPEN(RecRef.NUMBER + 1);

      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'No.');
      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'Document Type');
      IF LineRec.FINDSET THEN REPEAT
        DocLineBuffer.CreateForRecRef(LineRec);
      UNTIL LineRec.NEXT = 0;
    END;

    LOCAL PROCEDURE CreateSalesTaxDetails@1000000002(VAR DocLineBuffer@1000000001 : Record 70999;VAR ForNAVSalesTaxBuffer@1000000000 : Record 70998);
    BEGIN
      ForNAVSalesTaxBuffer.INIT;
      ForNAVSalesTaxBuffer.INSERT;

      WITH DocLineBuffer DO
        IF FINDSET THEN REPEAT
          IF "VAT %" = 0 THEN
            ForNAVSalesTaxBuffer."Exempt Amount" := ForNAVSalesTaxBuffer."Exempt Amount" + Amount
          ELSE
            ForNAVSalesTaxBuffer."Taxable Amount" := ForNAVSalesTaxBuffer."Taxable Amount" + Amount;
          ForNAVSalesTaxBuffer.MODIFY;
        UNTIL NEXT = 0;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70005 ForNAV Detect Localization
{
  OBJECT-PROPERTIES
  {
    Date=20-07-17;
    Time=19:43:26;
    Modified=Yes;
    Version List=FORNAVCTP5;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE CheckLocalizationBasedOnTables@1(VAR ForNAVSetup@1000 : Record 70000);
    VAR
      AllObjWithCaption@1001 : Record 2000000058;
    BEGIN
      WITH AllObjWithCaption DO BEGIN
        SETRANGE("Object Type", "Object Type"::Table);
        SETRANGE("Object ID", 10000);
        IF NOT ISEMPTY THEN BEGIN
          ForNAVSetup.Localization := ForNAVSetup.Localization::"North America";
          EXIT;
        END;
        SETRANGE("Object Type", "Object Type"::Table);
        SETRANGE("Object ID", 11000, 49999);
        IF NOT ISEMPTY THEN BEGIN
          ForNAVSetup.Localization := ForNAVSetup.Localization::Other;
          EXIT;
        END;

        ForNAVSetup.Localization := ForNAVSetup.Localization::"World Wide";

      END;
    END;

    PROCEDURE ValidateCurrentLocalization@2(ForNAVSetup@1000 : Record 70000) : Boolean;
    VAR
      ForNAVSetupSetLocalization@1001 : Record 70000;
    BEGIN
      CheckLocalizationBasedOnTables(ForNAVSetupSetLocalization);
      EXIT(ForNAVSetupSetLocalization.Localization = ForNAVSetup.Localization);
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70009 ForNAV First Time Setup
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Version List=FORNAVBETA;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            IF CheckIfSetupExists THEN
              EXIT;

            AskForDefault;
            RunWizardIfSetupDoesNotExist;
          END;

  }
  CODE
  {

    LOCAL PROCEDURE CheckIfSetupExists@2() : Boolean;
    VAR
      ForNAVSetup@1000 : Record 70000;
    BEGIN
      EXIT(ForNAVSetup.GET);
    END;

    LOCAL PROCEDURE AskForDefault@3();
    VAR
      SetDefaultsQst@1000 : TextConst 'ENU=Do you want to setup ForNAV with default values?';
      ForNAVSetup@1001 : Record 70000;
    BEGIN
      IF NOT CONFIRM(SetDefaultsQst, TRUE) THEN
        EXIT;

      ForNAVSetup.InitSetup;
      ForNAVSetup.ReplaceReportSelection(TRUE);
      COMMIT;
    END;

    LOCAL PROCEDURE RunWizardIfSetupDoesNotExist@4();
    VAR
      ForNAVSetup@1000 : Record 70000;
    BEGIN
      IF ForNAVSetup.GET THEN
        EXIT;

      PAGE.RUNMODAL(PAGE::"ForNAV Setup Wizard");

      IF ForNAVSetup.GET THEN
        COMMIT;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70019 ForNAV Notifications
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Version List=FORNAVBETA;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Codeunit,1,OnAfterFindPrinter,"",Skip,Skip)]
    LOCAL PROCEDURE OnFindPrinter@2(ReportID@1000 : Integer;VAR PrinterName@1001 : Text[250]);
    BEGIN
      ShowSetupNotification;
    END;

    LOCAL PROCEDURE ShowSetupNotification@1();
    VAR
      MyNotifications@1006 : Record 1518;
      ForNAVSetup@1001 : Record 70000;
      NotificationIDs@1004 : Codeunit 70022;
      MyNotification@1000 : Notification;
      ForNAVNotSetup@1002 : TextConst 'ENU=ForNAV is installed but not setup. Do you want to do this now?';
      Yes@1003 : TextConst 'ENU=Yes';
      NoAndDontAskAgain@1005 : TextConst 'ENU=No, and please don''t remind me again.';
    BEGIN
      IF ForNAVSetup.GET THEN
        EXIT;

      IF NOT MyNotifications.IsEnabled(NotificationIDs.SetupForNAV) THEN
        EXIT;

      MyNotification.ID := NotificationIDs.SetupForNAV;
      MyNotification.MESSAGE := ForNAVNotSetup;
      MyNotification.ADDACTION(Yes, CODEUNIT::"ForNAV Notification Actions", 'SetupForNAV');
      MyNotification.ADDACTION(NoAndDontAskAgain, CODEUNIT::"ForNAV Notification Actions", 'DisableSetup');
      MyNotification.SEND;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70020 ForNAV Notification Actions
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Version List=FORNAVBETA;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE SetupForNAV@2(VAR MyNotification@1000 : Notification);
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
    END;

    PROCEDURE DisableSetup@1(VAR MyNotification@1000 : Notification);
    VAR
      MyNotifications@1001 : Record 1518;
      NotificationID@1002 : GUID;
    BEGIN
      MyNotifications.LOCKTABLE;
      NotificationID := MyNotification.ID;
      IF MyNotifications.GET(USERID, NotificationID) THEN BEGIN
        MyNotifications.Enabled := FALSE;
        MyNotifications.MODIFY;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70021 ForNAV Initialize Notification
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Version List=FORNAVBETA;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Page,1518,OnInitializingNotificationWithDefaultState,"",Skip,Skip)]
    LOCAL PROCEDURE OnInitializingNotificationWithDefaultState@2();
    VAR
      MyNotifications@1000 : Record 1518;
      SetupForNAVTxt@1001 : TextConst 'ENU=Ask to setup ForNAV.';
      SetupForNAVDescriptionTxt@1002 : TextConst 'ENU=If you have ForNAV installed but don''t want to use it, switch off receiving the notification.';
      NotificationIDs@1003 : Codeunit 70022;
    BEGIN
      MyNotifications.InsertDefaultWithTableNum(NotificationIDs.SetupForNAV,
        SetupForNAVTxt,
        SetupForNAVDescriptionTxt,
        DATABASE::"ForNAV Setup");
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70022 ForNAV Notification IDs
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Version List=FORNAVBETA;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE SetupForNAV@2() : Text;
    BEGIN
      EXIT('cf8edf36-45c2-44c9-8367-cac5748bd597');
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70029 ForNAV Replace Report Sel.
{
  OBJECT-PROPERTIES
  {
    Date=20-07-17;
    Time=20:16:47;
    Modified=Yes;
    Version List=FORNAVCTP5;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            ReplaceSalesOrderConfirmation;
            ReplaceSalesInvoice;
            ReplaceSalesCreditMemo;
            ReplaceSalesShipment;
            ReplaceSalesQuote;
            ReplacePurchaseOrder;
            ReplacePurchaseInvoice;
            ReplacePurchaseQuote;
            ReplacePurchaseCreditMemo;
            //ReplaceReminder;
          END;

  }
  CODE
  {

    LOCAL PROCEDURE ReplaceSalesOrderConfirmation@1000000001();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Order");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Order";
        Sequence := '1';
        "Report ID" := FindReportID('Order Confirmation', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesInvoice@1000000000();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Invoice");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Invoice";
        Sequence := '1';
        "Report ID" := FindReportID('Sales Invoice', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesCreditMemo@1000000002();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Cr.Memo");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Cr.Memo";
        Sequence := '1';
        "Report ID" := FindReportID('Credit Memo', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesShipment@1000000009();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Shipment");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Shipment";
        Sequence := '1';
        "Report ID" := FindReportID('Sales Shipment', '');
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesQuote@1000000008();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Quote");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Quote";
        Sequence := '1';
        "Report ID" := FindReportID('Sales Quote', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseOrder@1000000005();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Order");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Order";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Order', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseQuote@1000000010();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Quote");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Quote";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Quote', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseInvoice@1000000003();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Invoice");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Invoice";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Invoice', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseCreditMemo@1000000007();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Cr.Memo");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Cr.Memo";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Cr. Memo', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceReminder@1000000006();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::Reminder);
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::Reminder;
        Sequence := '1';
        "Report ID" := FindReportID('Reminder', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE FindReportID@1000000004(ReportName@1000000001 : Text;Prefix@1000 : Text) : Integer;
    VAR
      AllObjWithCaption@1000000000 : Record 2000000058;
    BEGIN
      WITH AllObjWithCaption DO BEGIN
        SETRANGE("Object Type", "Object Type"::Report);
        SETRANGE("Object Name", 'ForNAV ' + Prefix +ReportName);
        FINDFIRST;
        EXIT("Object ID");
      END;
    END;

    LOCAL PROCEDURE GetPrefix@1() : Text;
    VAR
      ForNAVSetup@1000 : Record 70000;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."VAT Amount Specification" = ForNAVSetup."VAT Amount Specification"::"N/A. (Sales Tax)" THEN
        EXIT('Tax ');

      EXIT('VAT ');
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70080 ForNAV Test Valid Doc iFace
{
  OBJECT-PROPERTIES
  {
    Date=14-07-17;
    Time=14:59:03;
    Version List=FORNAVCTP4;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ThrowErrorIfNotValid@1000000000(VAR RecRef@1000000000 : RecordRef);
    VAR
      IsValid@1000000001 : Boolean;
      NotValidTableErr@1000000002 : TextConst 'ENU=This table (%1) is not supported for this function.';
    BEGIN
      CASE RecRef.NUMBER OF
        DATABASE::"Sales Header":
          EXIT;
        DATABASE::"Sales Shipment Header":
          EXIT;
        DATABASE::"Sales Invoice Header":
          EXIT;
        DATABASE::"Sales Cr.Memo Header":
          EXIT;
        DATABASE::"Purchase Header":
          EXIT;
        DATABASE::"Purch. Rcpt. Header":
          EXIT;
        DATABASE::"Purch. Inv. Header":
          EXIT;
        DATABASE::"Purch. Cr. Memo Hdr.":
          EXIT;
      END;

      CheckForValidPartnerTables(RecRef, IsValid);
      IF NOT IsValid THEN
        ERROR(NotValidTableErr, RecRef.CAPTION);
    END;

    [Business]
    LOCAL PROCEDURE CheckForValidPartnerTables@1000000007(RecRef@1000000001 : RecordRef;VAR IsVaild@1000000000 : Boolean);
    BEGIN
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70090 ForNAV RecordRef Library
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Version List=FORNAVBETA;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ConvertToRecRef@1000000002(VAR Rec@1000000000 : Variant;RecRef@1000000001 : RecordRef);
    VAR
      WrongDataTypeErr@1000000002 : TextConst 'ENU=Runtime Error: Wrong Datatype. Please contact your ForNAV reseller.';
    BEGIN
      CASE TRUE OF
        Rec.ISRECORDREF:
          RecRef := Rec;
        Rec.ISRECORD:
          RecRef.GETTABLE(Rec);
        ELSE
          ERROR(WrongDataTypeErr);
      END;
    END;

    PROCEDURE FindAndFilterieldNo@1000000003(VAR RecRef@1000000000 : RecordRef;VAR LineRec@1000000004 : RecordRef;VAR FldRef@1000000001 : FieldRef;Value@1000000005 : Text);
    VAR
      Field@1000000003 : Record 2000000041;
      DocumentNoField@1000000002 : FieldRef;
    BEGIN
      Field.SETRANGE(TableNo, RecRef.NUMBER);
      Field.SETRANGE(FieldName, Value);
      IF NOT Field.FINDFIRST THEN
        EXIT;

      DocumentNoField := RecRef.FIELD(Field."No.");

      Field.RESET;
      Field.SETRANGE(TableNo, RecRef.NUMBER + 1);
      Field.SETRANGE("No.", Field."No.");
      IF NOT Field.FINDFIRST THEN
        EXIT;

      FldRef := LineRec.FIELD(Field."No.");
      FldRef.SETRANGE(DocumentNoField.VALUE);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70206 ForNAV Trial Balance
{
  OBJECT-PROPERTIES
  {
    Date=05-09-17;
    Time=17:00:00;
    Modified=Yes;
    Version List=VAM1,FORNAV2.0.0.1260/1260;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      SingleQuote@1000 : Char;
      Char127@1001 : Char;
      Text000@1020000 : TextConst 'ENU=The StringPrintLength function in CodeUnit 70206 only works for font sizes from 7 through 10.';

    PROCEDURE InitGlobals@1();
    BEGIN
      SingleQuote := 39;
      Char127 := 127;
    END;

    PROCEDURE StringPrintLength@2(PrintString@1001 : Text[250];PointSize@1002 : Integer) Length@1000 : Integer;
    VAR
      i@1003 : Integer;
      OneCharLen@1004 : Integer;
    BEGIN
      InitGlobals;
      Length := 0;
      FOR i := 1 TO STRLEN(PrintString) DO BEGIN
        CASE PointSize OF
          7:
            CASE PrintString[i] OF
              SingleQuote:
                OneCharLen := 46;
              'i','j','l':
                OneCharLen := 55;
              '|':
                OneCharLen := 61;
              '!':
                OneCharLen := 63;
              ' ',',','.','/','\',':',';','I','[',']','f','t':
                OneCharLen := 68;
              '`','r','{','}','(',')','-':
                OneCharLen := 83;
              '"':
                OneCharLen := 87;
              '*':
                OneCharLen := 95;
              '^':
                OneCharLen := 115;
              'y':
                OneCharLen := 116;
              'v','x':
                OneCharLen := 121;
              'J','c','k','s','z':
                OneCharLen := 123;
              '+','<','>','=','~':
                OneCharLen := 145;
              'F','T','Z':
                OneCharLen := 151;
              'Y':
                OneCharLen := 159;
              '&','A','B','E','K','P','S','V','X':
                OneCharLen := 164;
              'C','D','H','w':
                OneCharLen := 174;
              'N','R','U':
                OneCharLen := 178;
              Char127:
                OneCharLen := 185;
              'G':
                OneCharLen := 190;
              'Q':
                OneCharLen := 192;
              '%','M','O','m':
                OneCharLen := 200;
              'W':
                OneCharLen := 238;
              '@':
                OneCharLen := 250;
              ELSE
                OneCharLen := 138;
            END;
          8:
            CASE PrintString[i] OF
              SingleQuote:
                OneCharLen := 54;
              'i','j','l':
                OneCharLen := 64;
              '|','!':
                OneCharLen := 72;
              ' ',',','.','/','\',':',';','I','[',']','f','t':
                OneCharLen := 78;
              '`','r','{','}','(',')','-':
                OneCharLen := 94;
              '"':
                OneCharLen := 100;
              '*':
                OneCharLen := 110;
              '^':
                OneCharLen := 130;
              'y':
                OneCharLen := 138;
              'x':
                OneCharLen := 140;
              'J','c','k','s','v','z':
                OneCharLen := 144;
              '+','<','>','=','~':
                OneCharLen := 166;
              'F','T','Z':
                OneCharLen := 172;
              'Y':
                OneCharLen := 186;
              '&','A','B','E','K','P','S','V','X':
                OneCharLen := 190;
              'C','D','H','N','R','U','w':
                OneCharLen := 204;
              Char127:
                OneCharLen := 212;
              'G','O','Q':
                OneCharLen := 220;
              'M','m':
                OneCharLen := 236;
              '%':
                OneCharLen := 250;
              'W':
                OneCharLen := 270;
              '@':
                OneCharLen := 288;
              ELSE
                OneCharLen := 158;
            END;
          9:
            CASE PrintString[i] OF
              SingleQuote:
                OneCharLen := 62;
              'i','j','l':
                OneCharLen := 70;
              '|':
                OneCharLen := 78;
              '!':
                OneCharLen := 82;
              ' ',',','.','/','\',':',';','I','[',']','f','t':
                OneCharLen := 88;
              '`','r','{','}','(',')','-':
                OneCharLen := 106;
              '"':
                OneCharLen := 112;
              '*':
                OneCharLen := 124;
              '^':
                OneCharLen := 144;
              'y':
                OneCharLen := 156;
              'x':
                OneCharLen := 158;
              'J','c','k','s','v','z':
                OneCharLen := 160;
              '+','<','>','=','~':
                OneCharLen := 186;
              'F','T','Z':
                OneCharLen := 196;
              'X':
                OneCharLen := 210;
              'Y':
                OneCharLen := 212;
              '&','A','B','E','K','P','S','V':
                OneCharLen := 212;
              'w':
                OneCharLen := 224;
              'C','D','H','N','R','U':
                OneCharLen := 230;
              Char127:
                OneCharLen := 240;
              'G','O','Q':
                OneCharLen := 250;
              'M','m':
                OneCharLen := 266;
              '%':
                OneCharLen := 282;
              'W':
                OneCharLen := 302;
              '@':
                OneCharLen := 322;
              ELSE
                OneCharLen := 176;
            END;
          10:
            CASE PrintString[i] OF
              SingleQuote:
                OneCharLen := 68;
              'i','j','l':
                OneCharLen := 78;
              '|':
                OneCharLen := 88;
              '!',',','.',':',';':
                OneCharLen := 96;
              ' ','/','\','I','[',']','f','t':
                OneCharLen := 98;
              '`','r','{','}','(',')','-':
                OneCharLen := 116;
              '"':
                OneCharLen := 126;
              '*':
                OneCharLen := 138;
              '^':
                OneCharLen := 166;
              'y':
                OneCharLen := 174;
              'J','c','k','s','v','x','z':
                OneCharLen := 176;
              '+','<','>','=','~':
                OneCharLen := 206;
              'F','T','Z':
                OneCharLen := 214;
              '&','A','B','E','K','P','S','V','X','Y':
                OneCharLen := 236;
              'C','D','H','N','R','U','w':
                OneCharLen := 254;
              Char127:
                OneCharLen := 266;
              'G','O','Q':
                OneCharLen := 274;
              'M','m':
                OneCharLen := 292;
              '%':
                OneCharLen := 314;
              'W':
                OneCharLen := 332;
              '@':
                OneCharLen := 358;
              ELSE
                OneCharLen := 196;
            END;
          ELSE
            ERROR(Text000);
        END;
        Length := Length + OneCharLen;
      END;
      EXIT((Length + 80) DIV 100);
    END;

    PROCEDURE SplitPrintLine@3(VAR PrintString@1000 : Text[250];VAR PrintString2@1001 : Text[250];SpaceOnPrintLine@1002 : Integer;PointSize@1003 : Integer);
    VAR
      OneWord@1004 : Text[250];
      s@1005 : Integer;
      e@1006 : Integer;
    BEGIN
      PrintString2 := '';
      WHILE StringPrintLength(PrintString,PointSize) > SpaceOnPrintLine DO BEGIN
        IF PrintString2 = '' THEN BEGIN
          s := 1;
          WHILE (s < STRLEN(PrintString)) AND (PrintString[s] = ' ') DO BEGIN
            PrintString2 := PrintString2 + ' ';
            s := s + 1;
          END;
        END ELSE BEGIN
          s := 1;
          WHILE (s < STRLEN(PrintString)) AND (PrintString[s] = ' ') DO
            s := s + 1;
        END;
        IF PrintString[s] = ' ' THEN
          EXIT;
        OneWord := '';
        e := s;
        WHILE (e < STRLEN(PrintString)) AND (PrintString[e] <> ' ') DO BEGIN
          OneWord := OneWord + COPYSTR(PrintString,e,1);
          e := e + 1;
        END;
        IF PrintString[e] <> ' ' THEN
          EXIT;
        IF StringPrintLength(PrintString2 + OneWord,PointSize) > SpaceOnPrintLine THEN
          EXIT;
        PrintString2 := PrintString2 + OneWord + ' ';
        WHILE (e < STRLEN(PrintString)) AND (PrintString[e] = ' ') DO
          e := e + 1;
        PrintString := DELSTR(PrintString,s,e - s);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

      This codeunit is based on 10025 Paragraph Handling.
    }
    END.
  }
}

OBJECT Codeunit 70528 ForNAV Edit Layout
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Version List=FORNAVBETA;
  }
  PROPERTIES
  {
    TableNo=9650;
    OnRun=BEGIN
            MESSAGE('1 Hello world from : ' + FORMAT(Rec));
          END;

  }
  CODE
  {

    [EventSubscriber(Page,9650,OnBeforeActionEvent,EditForNAV,Skip,Skip)]
    LOCAL PROCEDURE EditForNAVLayout@2(VAR Rec@1000 : Record 9650);
    BEGIN
      MESSAGE('Hello world from : ' + FORMAT(Rec));
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70700 Create Report Tests
{
  OBJECT-PROPERTIES
  {
    Date=14-07-17;
    Time=15:14:52;
    Version List=FORNAVCTP4;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            ForEachReportWriteATestCodeunit;
          END;

  }
  CODE
  {

    LOCAL PROCEDURE ForEachReportWriteATestCodeunit@1000000001();
    VAR
      AllObjWithCaption@1000000000 : Record 2000000058;
      TheFile@1000000001 : File;
    BEGIN
      TheFile.TEXTMODE(TRUE);
      TheFile.CREATE('Q:\Test.Txt');

      WITH AllObjWithCaption DO BEGIN
        SETRANGE("Object Type", "Object Type"::Report);
        SETRANGE("Object ID", 70000, 70999);
        IF FINDSET THEN REPEAT
          WriteTheCodeunitToATextFile(AllObjWithCaption, TheFile);
        UNTIL NEXT = 0;
      END;
      TheFile.CLOSE;
    END;

    LOCAL PROCEDURE WriteTheCodeunitToATextFile@1000000003(AllObjWithCaption@1000000000 : Record 2000000058;VAR TheFile@1000000002 : File);
    VAR
      TheObject@1000000001 : TextConst 'ENU="OBJECT Codeunit %2 %1 { OBJECT-PROPERTIES   {    Version List=FORNAVTEST;  }  PROPERTIES  {    Subtype=Test;    OnRun=BEGIN          END;  }  CODE  {    [Test]    [HandlerFunctions(HandleReport)]    PROCEDURE TestReport@1();    BEGIN REPORT.RUN(REPORT::REPORT%3);    END;    [ReportHandler]    PROCEDURE HandleReport@2(VAR TheReport@1000 : Report %3);    BEGIN    END;    BEGIN    {      Copyright (c) 2017 ForNAV ApS - All Rights Reserved      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.      This source code is distributed on an ""AS IS"" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.    }    END.  }}"';
    BEGIN
      TheFile.WRITE(STRSUBSTNO(TheObject, ObjName(AllObjWithCaption), TestObjAsString(AllObjWithCaption), ObjAsString(AllObjWithCaption)));
    END;

    LOCAL PROCEDURE ObjAsString@1000000000(AllObjWithCaption@1000000000 : Record 2000000058) : Text;
    BEGIN
      EXIT(FORMAT(AllObjWithCaption."Object ID"));
    END;

    LOCAL PROCEDURE TestObjAsString@1000000002(AllObjWithCaption@1000000000 : Record 2000000058) : Text;
    BEGIN
      EXIT('1' + ObjAsString(AllObjWithCaption));
    END;

    LOCAL PROCEDURE ObjName@1000000004(AllObjWithCaption@1000000000 : Record 2000000058) : Text;
    BEGIN
      EXIT(AllObjWithCaption."Object Name");
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70701 Create Report Tests as PDF
{
  OBJECT-PROPERTIES
  {
    Date=14-07-17;
    Time=15:15:33;
    Version List=FORNAVCTP4;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            ForEachReportWriteATestCodeunit;
          END;

  }
  CODE
  {

    LOCAL PROCEDURE ForEachReportWriteATestCodeunit@1000000001();
    VAR
      AllObjWithCaption@1000000000 : Record 2000000058;
      TheFile@1000000001 : File;
    BEGIN
      TheFile.TEXTMODE(TRUE);
      TheFile.CREATE('Q:\Test.Txt');

      WITH AllObjWithCaption DO BEGIN
        SETRANGE("Object Type", "Object Type"::Report);
        SETRANGE("Object ID", 70000, 70999);
        IF FINDSET THEN REPEAT
          WriteTheCodeunitToATextFile(AllObjWithCaption, TheFile);
        UNTIL NEXT = 0;
      END;
      TheFile.CLOSE;
    END;

    LOCAL PROCEDURE WriteTheCodeunitToATextFile@1000000003(AllObjWithCaption@1000000000 : Record 2000000058;VAR TheFile@1000000002 : File);
    VAR
      TheObject@1000000001 : TextConst 'ENU="OBJECT Codeunit %2 %1 { OBJECT-PROPERTIES   {    Version List=FORNAVTEST;  }  PROPERTIES  {    Subtype=Test;    OnRun=BEGIN          END;  }  CODE  {    [Test]    PROCEDURE TestReport@1();    BEGIN REPORT.SAVEASPDF(REPORT::REPORT%3, ''Q:\%4.xml'');    END;    BEGIN    {      Copyright (c) 2017 ForNAV ApS - All Rights Reserved      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.      This source code is distributed on an ""AS IS"" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.    }    END.  }}"';
    BEGIN
      TheFile.WRITE(STRSUBSTNO(TheObject, ObjName(AllObjWithCaption), TestObjAsString(AllObjWithCaption), ObjAsString(AllObjWithCaption), ObjNameWithoutSpaces(AllObjWithCaption)));
    END;

    LOCAL PROCEDURE ObjAsString@1000000000(AllObjWithCaption@1000000000 : Record 2000000058) : Text;
    BEGIN
      EXIT(FORMAT(AllObjWithCaption."Object ID"));
    END;

    LOCAL PROCEDURE TestObjAsString@1000000002(AllObjWithCaption@1000000000 : Record 2000000058) : Text;
    BEGIN
      EXIT('1' + ObjAsString(AllObjWithCaption));
    END;

    LOCAL PROCEDURE ObjName@1000000004(AllObjWithCaption@1000000000 : Record 2000000058) : Text;
    BEGIN
      EXIT(AllObjWithCaption."Object Name");
    END;

    LOCAL PROCEDURE ObjNameWithoutSpaces@1000000005(AllObjWithCaption@1000000000 : Record 2000000058) : Text;
    BEGIN
      EXIT(DELCHR(ObjName(AllObjWithCaption)));
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70995 Create Large Sales Quote
{
  OBJECT-PROPERTIES
  {
    Date=14-07-17;
    Time=10:54:21;
    Version List=FORNAVCTP4;
  }
  PROPERTIES
  {
    OnRun=VAR
            Value@1000000000 : Code[20];
          BEGIN
            Value := CreateSalesHeaderWithNumber10000;
            CreateALotOfSalesLinesWithNumber70000(Value);
          END;

  }
  CODE
  {

    LOCAL PROCEDURE CreateSalesHeaderWithNumber10000@1000000001() : Code[20];
    VAR
      SalesHeader@1000000000 : Record 36;
    BEGIN
      WITH SalesHeader DO BEGIN
        INIT;
        "Document Type" := "Document Type"::Quote;
        INSERT(TRUE);
        SetHideValidationDialog(TRUE);
        VALIDATE("Bill-to Customer No.",  '10000');
        VALIDATE("Sell-to Customer No.",  '10000');
        MODIFY(TRUE);
        EXIT("No.");
      END;
    END;

    LOCAL PROCEDURE CreateALotOfSalesLinesWithNumber70000@1000000002(Value@1000000002 : Code[20]);
    VAR
      SalesLine@1000000001 : Record 37;
      i@1000000000 : Integer;
    BEGIN
      FOR i := 1 TO 100 DO
        WITH SalesLine DO BEGIN
          INIT;
          "Document Type" := "Document Type"::Quote;
          "Document No." := Value;
          "Line No." := i * 10000;
          INSERT(TRUE);
          SetHideValidationDialog(TRUE);
          VALIDATE(Type, Type::Item);
          VALIDATE("No.", '70000');
          VALIDATE(Quantity, 1);
          MODIFY(TRUE);
        END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70996 Create Large Sales Invoice
{
  OBJECT-PROPERTIES
  {
    Date=14-07-17;
    Time=10:54:23;
    Version List=FORNAVCTP4;
  }
  PROPERTIES
  {
    OnRun=VAR
            Value@1000000000 : Code[20];
          BEGIN
            Value := CreateSalesHeaderWithNumber10000;
            CreateALotOfSalesLinesWithNumber70000(Value);
            PostTheLargeInvoice(Value);
          END;

  }
  CODE
  {

    LOCAL PROCEDURE CreateSalesHeaderWithNumber10000@1000000001() : Code[20];
    VAR
      SalesHeader@1000000000 : Record 36;
    BEGIN
      WITH SalesHeader DO BEGIN
        INIT;
        "Document Type" := "Document Type"::Invoice;
        INSERT(TRUE);
        SetHideValidationDialog(TRUE);
        VALIDATE("Bill-to Customer No.",  '10000');
        VALIDATE("Sell-to Customer No.",  '10000');
        MODIFY(TRUE);
        EXIT("No.");
      END;
    END;

    LOCAL PROCEDURE CreateALotOfSalesLinesWithNumber70000@1000000002(Value@1000000002 : Code[20]);
    VAR
      SalesLine@1000000001 : Record 37;
      i@1000000000 : Integer;
    BEGIN
      FOR i := 1 TO 100 DO
        WITH SalesLine DO BEGIN
          INIT;
          "Document Type" := "Document Type"::Invoice;
          "Document No." := Value;
          "Line No." := i * 10000;
          INSERT(TRUE);
          SetHideValidationDialog(TRUE);
          VALIDATE(Type, Type::Item);
          VALIDATE("No.", '70000');
          VALIDATE(Quantity, 1);
          MODIFY(TRUE);
        END;
    END;

    LOCAL PROCEDURE PostTheLargeInvoice@1000000003(Value@1000000000 : Code[20]);
    VAR
      SalesHeader@1000000002 : Record 36;
      SalesPost@1000000001 : Codeunit 80;
    BEGIN
      SalesHeader.GET(SalesHeader."Document Type"::Invoice, Value);
      SalesHeader.Ship := TRUE;
      SalesHeader.Invoice := TRUE;
      SalesPost.RUN(SalesHeader);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70997 ForNAV Create Test Setup
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Version List=FORNAVBETA;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            CreateVATClause;
            ChangeVATPostingSetup;
            ChangeExistingSalesInvoiceLines;
            ChangeReportSelections;
          END;

  }
  CODE
  {

    LOCAL PROCEDURE CreateVATClause@1000000001();
    BEGIN
    END;

    LOCAL PROCEDURE ChangeVATPostingSetup@1000000002();
    BEGIN
    END;

    LOCAL PROCEDURE ChangeExistingSalesInvoiceLines@1000000000();
    VAR
      SalesInvoiceLine@1000000000 : Record 113;
    BEGIN
      SalesInvoiceLine.MODIFYALL("VAT Clause Code" , 'TEST');
    END;

    LOCAL PROCEDURE ChangeReportSelections@1000000003();
    BEGIN
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70998 ForNAV Test Runner
{
  OBJECT-PROPERTIES
  {
    Date=14-07-17;
    Time=12:08:41;
    Version List=FORNAVCTP4;
  }
  PROPERTIES
  {
    Subtype=TestRunner;
    TestIsolation=Codeunit;
    OnRun=VAR
            ForNAVTest@1000000000 : Codeunit 70999;
            AllObjWithCaption@1000000001 : Record 2000000058;
          BEGIN
            ForNAVTest.RUN;
          END;

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70999 ForNAV Test
{
  OBJECT-PROPERTIES
  {
    Date=14-07-17;
    Time=14:59:43;
    Version List=FORNAVCTP4;
  }
  PROPERTIES
  {
    Subtype=Test;
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [Test]
    PROCEDURE TestDiscountForDocument@1000000000();
    VAR
      SalesHeader@1000000001 : Record 36;
      SalesLine@1000000000 : Record 37;
      ForNAVCheckDocumentDiscount@1000000002 : Codeunit 70000;
    BEGIN
      IF SalesHeader.FINDSET THEN REPEAT
        SalesLine.SETRANGE("Document No.", SalesHeader."No.");
        SalesLine.SETRANGE("Document Type", SalesHeader."Document Type");
        SalesLine.SETFILTER("Line Discount %", '<>0');
        IF SalesLine.ISEMPTY THEN BEGIN
          IF ForNAVCheckDocumentDiscount.HasDiscount(SalesHeader) THEN
            ERROR('No Discount expected for record ' + FORMAT(SalesHeader));
        END ELSE BEGIN
          IF NOT ForNAVCheckDocumentDiscount.HasDiscount(SalesHeader) THEN
            ERROR('Discount expected for record ' + FORMAT(SalesHeader));
        END;
      UNTIL SalesHeader.NEXT = 0;
    END;

    [Test]
    PROCEDURE TestCreateVATAmoutLine@1000000001();
    VAR
      SalesHeader@1000000001 : Record 36;
      SalesInvoiceHeader@1000000003 : Record 112;
      VATAmountLine@1000000000 : TEMPORARY Record 290;
      ForNAVGetVatAmountLines@1000000002 : Codeunit 70001;
    BEGIN
      IF SalesHeader.FINDSET THEN REPEAT
        ForNAVGetVatAmountLines.GetVatAmountLines(SalesHeader, VATAmountLine);
      UNTIL SalesHeader.NEXT = 0;

      IF SalesInvoiceHeader.FINDSET THEN REPEAT
        ForNAVGetVatAmountLines.GetVatAmountLines(SalesInvoiceHeader, VATAmountLine);
      UNTIL SalesInvoiceHeader.NEXT = 0;
    END;

    [Test]
    PROCEDURE TestReplaceReports@1000000002();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"ForNAV Replace Report Sel.");
    END;

    [Test]
    PROCEDURE TestLegalConditions@1000000005();
    VAR
      ForNAVSetup@1000000000 : Record 70000;
      ForNAVLegalCondTranslation@1000000001 : Record 70001;
    BEGIN
      ForNAVSetup.InitSetup;
      ForNAVSetup."Legal Conditions" := 'English';
      ForNAVSetup.MODIFY;
      ForNAVLegalCondTranslation.DELETEALL;
      ForNAVLegalCondTranslation."Language Code" := 'NLD';
      ForNAVLegalCondTranslation."Legal Conditions" := 'Nederlands';
      ForNAVLegalCondTranslation.INSERT;
      IF ForNAVSetup.GetLegalConditions('') <> 'English' THEN
        ERROR('Wrong Translation');

      IF ForNAVSetup.GetLegalConditions('NLD') <> 'Nederlands' THEN
        ERROR('Wrong Translation');
    END;

    [Test]
    PROCEDURE TestNoPrinted@1000000003();
    VAR
      SalesHeader@1000000000 : Record 36;
      PurchaseHeader@1000000001 : Record 38;
      SalesShipmentHeader@1000000002 : Record 110;
      SalesInvoiceHeader@1000000003 : Record 112;
      SalesCrMemoHeader@1000000004 : Record 114;
      PurchRcptHeader@1000000005 : Record 120;
      PurchInvHeader@1000000006 : Record 122;
      PurchCrMemoHdr@1000000007 : Record 124;
      CompanyInformation@1000000008 : Record 79;
      UpdateNoPrinted@1000000010 : Codeunit 70003;
      xNoPrinted@1000000009 : Integer;
    BEGIN
      WITH SalesHeader DO
        IF FINDSET THEN REPEAT
          xNoPrinted := "No. Printed";
          UpdateNoPrinted.UpdateNoPrinted(SalesHeader);
          FIND;
          TESTFIELD("No. Printed", xNoPrinted + 1);
        UNTIL NEXT = 0;

      WITH SalesShipmentHeader DO
        IF FINDSET THEN REPEAT
          xNoPrinted := "No. Printed";
          UpdateNoPrinted.UpdateNoPrinted(SalesShipmentHeader);
          FIND;
          TESTFIELD("No. Printed", xNoPrinted + 1);
        UNTIL NEXT = 0;

      WITH SalesInvoiceHeader DO
        IF FINDSET THEN REPEAT
          xNoPrinted := "No. Printed";
          UpdateNoPrinted.UpdateNoPrinted(SalesInvoiceHeader);
          FIND;
          TESTFIELD("No. Printed", xNoPrinted + 1);
        UNTIL NEXT = 0;

      WITH SalesCrMemoHeader DO
        IF FINDSET THEN REPEAT
          xNoPrinted := "No. Printed";
          UpdateNoPrinted.UpdateNoPrinted(SalesCrMemoHeader);
          FIND;
          TESTFIELD("No. Printed", xNoPrinted + 1);
        UNTIL NEXT = 0;

      WITH PurchaseHeader DO
        IF FINDSET THEN REPEAT
          xNoPrinted := "No. Printed";
          UpdateNoPrinted.UpdateNoPrinted(PurchaseHeader);
          FIND;
          TESTFIELD("No. Printed", xNoPrinted + 1);
        UNTIL NEXT = 0;

      WITH PurchRcptHeader DO
        IF FINDSET THEN REPEAT
          xNoPrinted := "No. Printed";
          UpdateNoPrinted.UpdateNoPrinted(PurchRcptHeader);
          FIND;
          TESTFIELD("No. Printed", xNoPrinted + 1);
        UNTIL NEXT = 0;

      WITH PurchInvHeader DO
        IF FINDSET THEN REPEAT
          xNoPrinted := "No. Printed";
          UpdateNoPrinted.UpdateNoPrinted(PurchInvHeader);
          FIND;
          TESTFIELD("No. Printed", xNoPrinted + 1);
        UNTIL NEXT = 0;

      WITH PurchCrMemoHdr DO
        IF FINDSET THEN REPEAT
          xNoPrinted := "No. Printed";
          UpdateNoPrinted.UpdateNoPrinted(PurchCrMemoHdr);
          FIND;
          TESTFIELD("No. Printed", xNoPrinted + 1);
        UNTIL NEXT = 0;

      CompanyInformation.GET;
      ASSERTERROR UpdateNoPrinted.UpdateNoPrinted(CompanyInformation);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT MenuSuite 1060 Dept - Add-on 10
{
  OBJECT-PROPERTIES
  {
    Date=27-07-17;
    Time=10:22:23;
    Modified=Yes;
    Version List=FORNAVCTP4;
  }
  PROPERTIES
  {
  }
  MENUNODES
  {
    {                ;[{7FD6154D-F047-4A31-B857-0DA1E0BA97D8}] ;NextNodeID=[{E55ED739-BBB9-4063-AF58-225E99C5FE72}] }
    { MenuItem       ;[{E55ED739-BBB9-4063-AF58-225E99C5FE72}] ;Name=Document Sending Profiles;
                                                                CaptionML=[ENU=Document Sending Profiles;
                                                                           NLD=Verzendprofielen van documenten];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=359;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{379BBC3B-5EBB-4617-8419-8D76352F8337}] ;Name=Electronic Document Formats;
                                                                CaptionML=[ENU=Electronic Document Formats;
                                                                           NLD=Elektronische documentindelingen];
                                                                ApplicationArea=#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=363;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{8A3934DD-BE0A-4851-B8E0-50A64106B98A}] ;Name=Data Exchange Types;
                                                                CaptionML=[ENU=Data Exchange Types;
                                                                           NLD=Typen gegevensuitwisseling];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1213;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{0D3D0EB4-59D7-4D3E-95AC-49CD269C6C04}] ;Name=Data Migration Settings;
                                                                AccessByPermission=TableData 1806=R;
                                                                CaptionML=[ENU=Data Migration Settings;
                                                                           NLD=Instellingen van gegevensmigratie];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1807;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{00646221-3EEF-4883-8640-FECFD9BEC705}] ;Name=Report Configuration;
                                                                AccessByPermission=TableData 2000000196=IMD;
                                                                CaptionML=[ENU=Report Settings;
                                                                           NLD=Rapportinstellingen];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1560;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{A1E3A413-B0C4-4D20-8B1F-AFF7DFFDB43C}] ;Name=Setup and Help Resources;
                                                                CaptionML=[ENU=Setup and Help Resources;
                                                                           NLD=Instellings- en Help-resources];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1822;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    {                ;[{19A352FE-D90D-424E-B85F-CF3B8E98CF0E}] ;NextNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}] }
    { Menu           ;[{0691571E-EDD6-473D-A139-81B1E9B887F2}] ;Name=ForNAV;
                                                                CaptionML=ENU=ForNAV;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                Image=15;
                                                                IsShortcut=No;
                                                                Visible=Yes;
                                                                Enabled=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{E849D80C-A6A0-4A75-9313-4A9691856383}] }
    { MenuItem       ;[{CC9EF159-165D-4DCB-8A3B-05D408AB94F8}] ;Name=ForNAV Setup;
                                                                CaptionML=ENU=ForNAV Setup;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70000;
                                                                ParentNodeID=[{E849D80C-A6A0-4A75-9313-4A9691856383}];
                                                                Visible=Yes;
                                                                NextNodeID=[{C331F6D8-9B94-4792-89D9-CEDBB101436C}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{E849D80C-A6A0-4A75-9313-4A9691856383}] ;Name=Application Setup;
                                                                CaptionML=ENU=Application Setup;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}];
                                                                FirstChild=[{CC9EF159-165D-4DCB-8A3B-05D408AB94F8}] }
    { MenuItem       ;[{E6D918CF-B1F7-4171-A3E9-3C6E9B592EB1}] ;Name=Transformation Rules;
                                                                CaptionML=ENU=Transformation Rules;
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1237;
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{C331F6D8-9B94-4792-89D9-CEDBB101436C}] ;Name=ForNAV Legal Cond. Translation;
                                                                CaptionML=ENU=ForNAV Legal Cond. Translation;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70001;
                                                                ParentNodeID=[{E849D80C-A6A0-4A75-9313-4A9691856383}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}] ;Name=Document Reports;
                                                                CaptionML=ENU=Document Reports;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                Visible=Yes;
                                                                NextNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                FirstChild=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}] }
    { MenuItem       ;[{62E72610-35DE-4B65-A0A8-4A4464FD467C}] ;Name=Sales Order Confirmation;
                                                                CaptionML=ENU=Sales Order Confirmation;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70000;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{D30D76B6-37A6-4333-B5F6-F6688007A102}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{596FD082-176B-47D1-B4BA-5DABB301A6C3}] ;Name=Sales;
                                                                CaptionML=ENU=Sales;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                FirstChild=[{62E72610-35DE-4B65-A0A8-4A4464FD467C}] }
    { MenuItem       ;[{D30D76B6-37A6-4333-B5F6-F6688007A102}] ;Name=Sales Invoice;
                                                                CaptionML=ENU=Sales Invoice;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70001;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{D689D68B-B7E6-44FA-A12E-412B7F969A7A}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{D689D68B-B7E6-44FA-A12E-412B7F969A7A}] ;Name=Sales Credit Memo;
                                                                CaptionML=ENU=Sales Credit Memo;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70002;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{1D3B52D4-9A4A-45D3-A4EA-4EBB5B792BBA}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{1D3B52D4-9A4A-45D3-A4EA-4EBB5B792BBA}] ;Name=Sales Shipment;
                                                                CaptionML=ENU=Sales Shipment;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70003;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{BB66C103-03B0-4D34-BAA5-44DE7EB35EB2}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{BB66C103-03B0-4D34-BAA5-44DE7EB35EB2}] ;Name=Sales Quote;
                                                                CaptionML=ENU=Sales Quote;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70004;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}] ;Name=Purchase;
                                                                CaptionML=ENU=Purchase;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{3C3B5DC6-21F5-4E37-8C08-8E5938133520}] }
    { MenuItem       ;[{3C3B5DC6-21F5-4E37-8C08-8E5938133520}] ;Name=Purchase Order;
                                                                CaptionML=ENU=Purchase Order;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70100;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{59F08D28-DEAC-4A3B-96E2-A6D597DDE1F6}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{59F08D28-DEAC-4A3B-96E2-A6D597DDE1F6}] ;Name=Purchase Invoice;
                                                                CaptionML=ENU=Purchase Invoice;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70101;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{4CC18C18-81F4-4235-ADCD-5168C7501B6E}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{4CC18C18-81F4-4235-ADCD-5168C7501B6E}] ;Name=Purchase Credit Memo;
                                                                CaptionML=ENU=Purchase Credit Memo;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70102;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F10C4BA6-49D1-41DC-834C-A7F72C44B7C5}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{F10C4BA6-49D1-41DC-834C-A7F72C44B7C5}] ;Name=Purchase Quote;
                                                                CaptionML=ENU=Purchase Quote;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70104;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}] ;Name=Reports;
                                                                CaptionML=ENU=Reports;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{BA687EE2-5570-4962-B8FF-C27DE3ABC6F3}] }
    { MenuItem       ;[{BA687EE2-5570-4962-B8FF-C27DE3ABC6F3}] ;Name=ForNAV Trial Balance;
                                                                CaptionML=ENU=ForNAV Trial Balance;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70206;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{80F41632-02B7-4B65-9469-B637CEA37A37}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{80F41632-02B7-4B65-9469-B637CEA37A37}] ;Name=ForNAV Customer/Item Statistics;
                                                                CaptionML=ENU=ForNAV Customer/Item Statistics;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70248;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{8EBA2FA7-A319-4BFA-8379-B9A253503879}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{8EBA2FA7-A319-4BFA-8379-B9A253503879}] ;Name=ForNav Salesperson-Commission;
                                                                CaptionML=ENU=ForNav Salesperson-Commission;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70215;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{3E0EA722-316D-4835-B87E-31E12BE27FF9}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{3E0EA722-316D-4835-B87E-31E12BE27FF9}] ;Name=ForNAV Aged Accounts Receivable;
                                                                CaptionML=ENU=ForNAV Aged Accounts Receivable;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70220;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F84E0725-FFC0-482E-A802-8C3F918E698E}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{F84E0725-FFC0-482E-A802-8C3F918E698E}] ;Name=ForNAV Aged Accounts Payable;
                                                                CaptionML=ENU=ForNAV Aged Accounts Payable;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70221;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
  }
}
OBJECT Page 70000 ForNAV Setup
{
  OBJECT-PROPERTIES
  {
    Date=09-08-17;
    Time=12:56:11;
    Modified=Yes;
    Version List=FORNAVCTP5;
  }
  PROPERTIES
  {
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table70000;
    PageType=Card;
    OnOpenPage=BEGIN
                 InitSetup;
               END;

    OnAfterGetRecord=BEGIN
                       WrongLocalization := NOT ValidateCurrentLocalization;
                     END;

    ActionList=ACTIONS
    {
      { 1       ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000010;1 ;Action    ;
                      Name=ImportDocWatermark;
                      CaptionML=ENU=Import Document Watermark;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ImportWatermarkFromClientFile(FIELDNO("Document Watermark"));
                               END;
                                }
      { 8       ;1   ;Action    ;
                      Name=ImportListWatermark;
                      CaptionML=ENU=Import List Report Watermark;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ImportCodes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ImportWatermarkFromClientFile(FIELDNO("List Report Watermark"));
                               END;
                                }
      { 9       ;1   ;Action    ;
                      Name=ImportLogo;
                      CaptionML=ENU=Import Logo;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CompanyInformation;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ImportWatermarkFromClientFile(FIELDNO(Logo));
                               END;
                                }
      { 2       ;1   ;Action    ;
                      Name=ReplaceReports;
                      CaptionML=ENU=Replace Reportselection;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SwitchCompanies;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 ReplaceReportSelection(FALSE);
                               END;
                                }
      { 3       ;1   ;Action    ;
                      Name=RunTest;
                      CaptionML=ENU=Test;
                      ToolTipML=ENU=Running this test will tell you if the ForNAV reports work on your system;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=TestDatabase;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 RunTest;
                               END;
                                }
      { 1000000014;1 ;Action    ;
                      Name=DesignTemplate;
                      CaptionML=ENU=Design General Template;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=UnitOfMeasure;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignTemplate;
                               END;
                                }
      { 4       ;1   ;Action    ;
                      Name=DesignSalesTemplate;
                      CaptionML=ENU=Design Sales Template;
                      ToolTipML=ENU=Use this option to change the sales template, for example when you want to move the address or change the font.;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Design;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignSalesTemplate;
                               END;
                                }
      { 1000000009;1 ;Action    ;
                      Name=DesignPurchaseTemplate;
                      CaptionML=ENU=Design Purchase Template;
                      ToolTipML=ENU=Use this option to change the purchase template, for example when you want to move the address or change the font.;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=DesignCodeBehind;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignPurchaseTemplate;
                               END;
                                }
      { 7       ;1   ;Action    ;
                      Name=CheckLocalization;
                      CaptionML=ENU=Check Localization;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=MapSetup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CheckLocalizationBasedOnTables;
                                 MODIFY;
                               END;
                                }
      { 1000000011;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000013;1 ;Action    ;
                      CaptionML=ENU=Translations;
                      ToolTipML=ENU=View or edit translated legal conditions. Translated legal conditions are automatically inserted on documents according to the language code.;
                      RunObject=Page 70001;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Translations }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                GroupType=Group }

    { 6   ;2   ;Field     ;
                SourceExpr=Localization;
                Style=Unfavorable;
                StyleExpr=WrongLocalization }

    { 1000000002;1;Group  ;
                Name=VAT/Sales Tax;
                GroupType=Group }

    { 1000000003;2;Field  ;
                SourceExpr="VAT Amount Specification" }

    { 1000000004;1;Group  ;
                Name=Document Texts;
                GroupType=Group }

    { 5   ;2   ;Field     ;
                SourceExpr="Payment Note";
                MultiLine=Yes }

    { 1000000005;2;Field  ;
                SourceExpr="Legal Conditions";
                MultiLine=Yes }

    { 1000000006;0;Container;
                ContainerType=FactBoxArea }

    { 1000000007;1;Part   ;
                PartType=System;
                SystemPartID=MyNotes }

    { 1000000008;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

  }
  CODE
  {
    VAR
      WrongLocalization@1000 : Boolean INDATASET;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Page 70001 ForNAV Legal Cond. Translation
{
  OBJECT-PROPERTIES
  {
    Date=14-07-17;
    Time=10:56:09;
    Version List=FORNAVCTP4;
  }
  PROPERTIES
  {
    SourceTable=Table70001;
    PageType=List;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr="Language Code" }

    { 1000000003;2;Field  ;
                SourceExpr="Legal Conditions" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Page 70005 ForNAV Setup Wizard
{
  OBJECT-PROPERTIES
  {
    Date=09-08-17;
    Time=12:59:10;
    Modified=Yes;
    Version List=FORNAVCTP5;
  }
  PROPERTIES
  {
    SourceTable=Table70000;
    PageType=NavigatePage;
    SourceTableTemporary=Yes;
    OnInit=BEGIN
             LoadTopBanners;
           END;

    OnOpenPage=BEGIN
                 INIT;
                 IF ForNAVSetup.GET THEN BEGIN
                   TRANSFERFIELDS(ForNAVSetup);
                   WrongLocalization := NOT ValidateCurrentLocalization;
                 END ELSE BEGIN
                   CheckLocalizationBasedOnTables;
                   "Legal Conditions" := LegalConditionsTxt;
                   "Payment Note" := PaymentNoteTxt;
                   "VAT Amount Specification" := "VAT Amount Specification"::"Multiple Lines";
                   VALIDATE(Localization);
                 END;
                 INSERT;

                 Step := Step::Start;
                 EnableControls;
               END;

    ActionList=ACTIONS
    {
      { 19      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 18      ;1   ;Action    ;
                      Name=ActionBack;
                      CaptionML=ENU=Back;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=BackActionEnabled;
                      InFooterBar=Yes;
                      Image=PreviousRecord;
                      OnAction=BEGIN
                                 NextStep(TRUE);
                               END;
                                }
      { 16      ;1   ;Action    ;
                      Name=ActionNext;
                      CaptionML=ENU=Next;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NextActionEnabled;
                      InFooterBar=Yes;
                      Image=NextRecord;
                      OnAction=BEGIN
                                 NextStep(FALSE);
                               END;
                                }
      { 8       ;1   ;Action    ;
                      Name=ActionFinish;
                      CaptionML=ENU=Finish;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=FinishActionEnabled;
                      InFooterBar=Yes;
                      Image=Approve;
                      OnAction=BEGIN
                                 FinishAction;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 5   ;0   ;Container ;
                ContainerType=ContentArea }

    { 4   ;1   ;Group     ;
                Visible=TopBannerVisible AND NOT FinalStepVisible;
                Editable=FALSE;
                GroupType=Group }

    { 3   ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaRepositoryStandard.Image;
                Editable=FALSE;
                ShowCaption=No }

    { 2   ;1   ;Group     ;
                Visible=TopBannerVisible AND FinalStepVisible;
                Editable=FALSE;
                GroupType=Group }

    { 1   ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaRepositoryDone.Image;
                Editable=FALSE;
                ShowCaption=No }

    { 11  ;1   ;Group     ;
                Visible=FirstStepVisible;
                GroupType=Group }

    { 10  ;2   ;Group     ;
                CaptionML=ENU=Welcome to ForNAV Setup;
                Visible=FirstStepVisible;
                GroupType=Group }

    { 9   ;3   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU="The ForNAV report package contains several documents that are optimized to work with our designer. " }

    { 7   ;2   ;Group     ;
                CaptionML=ENU=Let's go!;
                GroupType=Group }

    { 6   ;3   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU=Choose Next so you can set up the ForNAV report package. }

    { 15  ;1   ;Group     ;
                Visible=FinalStepVisible;
                GroupType=Group }

    { 13  ;2   ;Group     ;
                CaptionML=ENU=That's it!;
                GroupType=Group }

    { 12  ;3   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU=To enable the ForNAV report package choose Finish. }

    { 24  ;1   ;Group     ;
                Visible=Step1Visible;
                GroupType=Group;
                InstructionalTextML=ENU=Select your localization... }

    { 25  ;2   ;Field     ;
                SourceExpr=Localization;
                OnValidate=BEGIN
                             WrongLocalization := NOT ValidateCurrentLocalization;
                           END;
                            }

    { 27  ;2   ;Group     ;
                Visible=WrongLocalization;
                GroupType=Group;
                InstructionalTextML=ENU=WARNING! This is not the localization we detected! }

    { 21  ;1   ;Group     ;
                Visible=Step2Visible;
                GroupType=Group;
                InstructionalTextML=ENU=Select your VAT printing preferences and legal clause. }

    { 22  ;2   ;Field     ;
                SourceExpr="VAT Amount Specification" }

    { 14  ;2   ;Field     ;
                SourceExpr="Payment Note" }

    { 23  ;2   ;Field     ;
                SourceExpr="Legal Conditions" }

    { 17  ;1   ;Group     ;
                Visible=Step3Visible;
                GroupType=Group;
                InstructionalTextML=ENU=Do you want replace the current report selections with the ForNAV reports? }

    { 20  ;2   ;Field     ;
                Name=ReplaceReports;
                CaptionML=ENU=Replace Reports;
                SourceExpr=ReplaceReports }

    { 1000000001;1;Group  ;
                Visible=Step2Visible;
                GroupType=Group;
                InstructionalTextML=ENU=A watermark can make your reports look nicer. Do you want to import one? }

    { 1000000000;2;Field  ;
                Name=ImportWatermark;
                SourceExpr=WatermarkTxt;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              ImportWatermarkFromClientFile(FIELDNO("Document Watermark"));
                            END;

                ShowCaption=No }

    { 28  ;2   ;Field     ;
                Name=ImportWatermarkList;
                SourceExpr=WatermarkListTxt;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              ImportWatermarkFromClientFile(FIELDNO("List Report Watermark"));
                            END;

                ShowCaption=No }

    { 26  ;2   ;Field     ;
                Name=ImportCompanyLogo;
                SourceExpr=CompanyLogoTxt;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              ImportWatermarkFromClientFile(FIELDNO(Logo));
                            END;

                ShowCaption=No }

  }
  CODE
  {
    VAR
      MediaRepositoryStandard@1001 : Record 9400;
      MediaRepositoryDone@1000 : Record 9400;
      ForNAVSetup@1005 : Record 70000;
      TopBannerVisible@1003 : Boolean;
      FinalStepVisible@1002 : Boolean;
      FirstStepVisible@1004 : Boolean;
      FinishActionEnabled@1007 : Boolean;
      BackActionEnabled@1008 : Boolean;
      NextActionEnabled@1009 : Boolean;
      Step1Visible@1011 : Boolean;
      Step2Visible@1010 : Boolean;
      Step3Visible@1013 : Boolean;
      ReplaceReports@1012 : Boolean;
      WrongLocalization@1014 : Boolean INDATASET;
      Step@1006 : 'Start,Step1,Step2,Step3,Finish';
      WatermarkTxt@1000000000 : TextConst 'ENU=Click to import a watermark for document reports';
      WatermarkListTxt@1018 : TextConst 'ENU=Click to import a watermark for list reports';
      CompanyLogoTxt@1017 : TextConst 'ENU=Click to import a company logo';
      PaymentNoteTxt@1015 : TextConst 'ENU=- You can print a payment note here -';
      LegalConditionsTxt@1016 : TextConst 'ENU=- You can print your legal conditions here -';

    LOCAL PROCEDURE LoadTopBanners@40();
    BEGIN
      IF MediaRepositoryStandard.GET('AssistedSetup-NoText-400px.png',FORMAT(CURRENTCLIENTTYPE)) AND
         MediaRepositoryDone.GET('AssistedSetupDone-NoText-400px.png',FORMAT(CURRENTCLIENTTYPE))
      THEN
        TopBannerVisible := MediaRepositoryDone.Image.HASVALUE;
    END;

    LOCAL PROCEDURE EnableControls@2();
    BEGIN
      ResetControls;

      CASE Step OF
        Step::Start:
          ShowStartStep;
        Step::Step1:
          ShowStep1;
        Step::Step2:
          ShowStep2;
        Step::Step3:
          ShowStep3;
        Step::Finish:
          ShowFinishStep;
      END;
    END;

    LOCAL PROCEDURE ShowStartStep@24();
    BEGIN
      FirstStepVisible := TRUE;
      FinishActionEnabled := FALSE;
      BackActionEnabled := FALSE;
    END;

    LOCAL PROCEDURE ShowStep1@33();
    BEGIN
      Step1Visible := TRUE;
    END;

    LOCAL PROCEDURE ShowStep2@34();
    BEGIN
      Step2Visible := TRUE;
    END;

    LOCAL PROCEDURE ShowStep3@4();
    BEGIN
      Step3Visible := TRUE;
    END;

    LOCAL PROCEDURE ShowFinishStep@35();
    BEGIN
      FinalStepVisible := TRUE;
      NextActionEnabled := FALSE;
    END;

    LOCAL PROCEDURE ResetControls@1();
    BEGIN
      FinishActionEnabled := 1=1;
      BackActionEnabled := TRUE;
      NextActionEnabled := TRUE;

      FirstStepVisible := FALSE;
      Step1Visible := FALSE;
      Step2Visible := FALSE;
      Step3Visible := FALSE;
      FinalStepVisible := FALSE;
    END;

    LOCAL PROCEDURE NextStep@41(Backwards@1000 : Boolean);
    BEGIN
      IF Backwards THEN
        Step := Step - 1
      ELSE
        Step := Step + 1;

      EnableControls;
    END;

    LOCAL PROCEDURE FinishAction@12();
    BEGIN
      StoreForNAVSetup;
      //AssistedSetup.SetStatus(PAGE::"Email Setup Wizard",AssistedSetup.Status::Completed);
      CurrPage.CLOSE;
    END;

    LOCAL PROCEDURE StoreForNAVSetup@3();
    BEGIN
      IF NOT ForNAVSetup.GET THEN BEGIN
        ForNAVSetup.INIT;
        ForNAVSetup.INSERT;
      END;

      ForNAVSetup.TRANSFERFIELDS(Rec,FALSE);
      ForNAVSetup.MODIFY;
      IF ReplaceReports THEN
        ForNAVSetup.ReplaceReportSelection(TRUE);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

