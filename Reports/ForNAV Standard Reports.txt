OBJECT Table 70000 ForNAV Setup
{
  OBJECT-PROPERTIES
  {
    Date=22-05-18;
    Time=13:18:02;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=ENU=Primary Key }
    { 9   ;   ;Localization        ;Option        ;OnValidate=BEGIN
                                                                IF Localization = Localization::"North America" THEN
                                                                  "VAT Amount Specification" := "VAT Amount Specification"::"N/A. (Sales Tax)";
                                                              END;

                                                   CaptionML=ENU=Localization;
                                                   OptionString=World Wide,North America,Other }
    { 10  ;   ;VAT Amount Specification;Option    ;CaptionML=ENU=VAT Amount Specification;
                                                   OptionString=Multiple Lines,Always,Never,N/A. (Sales Tax) }
    { 14  ;   ;Use ForNAV Languages;Boolean       ;InitValue=Yes;
                                                   CaptionML=ENU=Use ForNAV Languages }
    { 15  ;   ;Use Preprinted Paper;Boolean       ;CaptionML=ENU=Use Preprinted Paper }
    { 20  ;   ;Logo                ;BLOB          ;CaptionML=ENU=Logo }
    { 21  ;   ;Logo File Name      ;Text250       ;InitValue=Click to import...;
                                                   CaptionML=ENU=Logo File Name;
                                                   Editable=No }
    { 50  ;   ;Document Watermark File Name;Text250;
                                                   InitValue=Click to import...;
                                                   CaptionML=ENU=Document Watermark File Name;
                                                   Editable=No }
    { 51  ;   ;List Report Watermark File N.;Text250;
                                                   InitValue=Click to import...;
                                                   CaptionML=ENU=List Report Watermark File Name;
                                                   Editable=No }
    { 60  ;   ;Document Watermark  ;BLOB          ;CaptionML=ENU=Document Watermark }
    { 61  ;   ;List Report Watermark;BLOB         ;CaptionML=ENU=List Report Watermark }
    { 70  ;   ;Payment Note        ;Text250       ;CaptionML=ENU=Payment Note }
    { 80  ;   ;Legal Conditions    ;Text250       ;CaptionML=ENU=Legal Conditions }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE InitSetup@1000000000();
    BEGIN
      IF GET THEN
        EXIT;

      INIT;
      INSERT;
    END;

    PROCEDURE ReplaceReportSelection@1(HideDialog@1000 : Boolean);
    VAR
      DoYouWantToQst@1001 : TextConst 'ENU=Do you want to replace the current reports with the ForNAV reports?';
      ReplaceReportSel@1002 : Codeunit 70029;
    BEGIN
      IF NOT HideDialog THEN
        IF NOT CONFIRM(DoYouWantToQst, TRUE) THEN
          EXIT;

      ReplaceReportSel.RUN;
    END;

    PROCEDURE DesignTemplatePortrait@1000000003();
    VAR
      Template@1000 : Report 70527;
    BEGIN
      Template.RUNMODAL;
    END;

    PROCEDURE DesignTemplateLandscape@9();
    VAR
      Template@1000 : Report 70526;
    BEGIN
      Template.RUNMODAL;
    END;

    PROCEDURE DesignSalesTemplate@3();
    VAR
      SalesTemplateVAT@1000 : Report 70529;
      SalesTemplSalesTax@1001 : Report 70519;
    BEGIN
      IF Localization = Localization::"North America" THEN
        SalesTemplSalesTax.RUNMODAL
      ELSE
        SalesTemplateVAT.RUNMODAL;
    END;

    PROCEDURE DesignPurchaseTemplate@1000000001();
    VAR
      PurchaseTemplVAT@1000 : Report 70528;
      PurchaseTemplTax@1001 : Report 70518;
    BEGIN
      IF Localization = Localization::"North America" THEN
        PurchaseTemplTax.RUNMODAL
      ELSE
        PurchaseTemplVAT.RUNMODAL;
    END;

    PROCEDURE ImportWatermarkFromClientFile@21(Which@1000 : Integer) : Boolean;
    VAR
      ForNAVReadWatermarks@1002 : Codeunit 70006;
    BEGIN
      EXIT(ForNAVReadWatermarks.ReadFromFile(Rec, Which));
    END;

    PROCEDURE GetLegalConditions@1000000002(LanguageCode@1000000001 : Code[10]) : Text;
    VAR
      LegalCondTranslation@1000000000 : Record 70001;
    BEGIN
      IF LegalCondTranslation.GET(LanguageCode) THEN
        EXIT(LegalCondTranslation."Legal Conditions");

      EXIT("Legal Conditions");
    END;

    PROCEDURE CheckLocalizationBasedOnTables@5();
    VAR
      DetectLocalization@1001 : Codeunit 70005;
    BEGIN
      DetectLocalization.CheckLocalizationBasedOnTables(Rec);
    END;

    PROCEDURE ValidateCurrentLocalization@4() : Boolean;
    VAR
      DetectLocalization@1001 : Codeunit 70005;
    BEGIN
      EXIT(DetectLocalization.ValidateCurrentLocalization(Rec));
    END;

    PROCEDURE DownloadWatermarks@6();
    BEGIN
      HYPERLINK('http://www.fornav.com/report-watermarks/');
    END;

    PROCEDURE CreateWebService@7();
    VAR
      CreateWebServices@1000000000 : Codeunit 70011;
    BEGIN
      CreateWebServices.RUN;
    END;

    PROCEDURE GetCompanyLogo@8();
    VAR
      CompanyInformation@1000 : Record 79;
    BEGIN
      CompanyInformation.GET;
      CompanyInformation.CALCFIELDS(Picture);
      Logo := CompanyInformation.Picture;
    END;

    PROCEDURE GetDocumentWatermark@1000000005() : Text;
    VAR
      TempBlob@1000000000 : Record 99008535;
    BEGIN
      CALCFIELDS("Document Watermark");
      TempBlob.Blob := "Document Watermark";
      EXIT(TempBlob.ToBase64String);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70001 ForNAV Legal Cond. Translation
{
  OBJECT-PROPERTIES
  {
    Date=14-07-17;
    Time=10:55:28;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 2   ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=ENU=Language Code }
    { 80  ;   ;Legal Conditions    ;Text250        }
  }
  KEYS
  {
    {    ;Language Code                           ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70002 ForNAV Web Service
{
  OBJECT-PROPERTIES
  {
    Date=22-05-18;
    Time=13:28:04;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    DataPerCompany=No;
    CaptionML=[ENU=Web Service;
               ESM=Servicio Web;
               FRC=Service web;
               ENC=Web Service];
  }
  FIELDS
  {
    { 3   ;   ;Object Type         ;Option        ;CaptionML=[ENU=Object Type;
                                                              ESM=Tipo objeto;
                                                              FRC=Type d'objet;
                                                              ENC=Object Type];
                                                   OptionCaptionML=[ENU=,,,,,Codeunit,,,Page,Query;
                                                                    ESM=,,,,,Codeunit,,,Page,Query;
                                                                    FRC=,,,,,Codeunit,,,Page,Query;
                                                                    ENC=,,,,,Codeunit,,,Page,Query];
                                                   OptionString=,,,,,Codeunit,,,Page,Query }
    { 6   ;   ;Object ID           ;Integer       ;TableRelation=AllObjWithCaption."Object ID" WHERE (Object Type=FIELD(Object Type));
                                                   CaptionML=[ENU=Object ID;
                                                              ESM=Id. objeto;
                                                              FRC=Code d'objet;
                                                              ENC=Object ID] }
    { 9   ;   ;Service Name        ;Text240       ;CaptionML=[ENU=Service Name;
                                                              ESM=Nombre del servicio;
                                                              FRC=Nom du service;
                                                              ENC=Service Name] }
    { 12  ;   ;Published           ;Boolean       ;CaptionML=[ENU=Published;
                                                              ESM=Publicado;
                                                              FRC=PubliÇ;
                                                              ENC=Published] }
  }
  KEYS
  {
    {    ;Object Type,Service Name                ;Clustered=Yes }
    {    ;Object Type,Object ID                    }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70003 ForNAV Object
{
  OBJECT-PROPERTIES
  {
    Date=14-06-18;
    Time=20:36:09;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;ID                  ;Integer       ;DataClassification=ToBeClassified }
    { 2   ;   ;Name                ;Text50        ;DataClassification=ToBeClassified }
  }
  KEYS
  {
    {    ;ID                                      ;Clustered=Yes }
    {    ;Name                                     }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70205 ForNAV Trial Balance Args.
{
  OBJECT-PROPERTIES
  {
    Date=02-02-18;
    Time=10:23:01;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Show by             ;Option        ;CaptionML=[DAN=Vis efter;
                                                              DEU=Anzeigen nach;
                                                              ENU=Show by;
                                                              ESP=Mostrar por;
                                                              FIN=NÑyttîperuste;
                                                              FRA=Afficher par;
                                                              ISL=SÏna eftir;
                                                              ITA=Mostra per;
                                                              NLD=Tonen op;
                                                              NOR=Vis etter];
                                                   OptionCaptionML=[DAN=Sidste Ür,Budget;
                                                                    DEU=Vorjahr,Budget;
                                                                    ENU=Last Year,Budget;
                                                                    ESP=El a§o pasado,Presupuesto;
                                                                    FIN=Edellinen vuosi,Budjetti;
                                                                    ISL=S°–asta †r,µëtlun;
                                                                    ITA=Anno prec.,Budget;
                                                                    NLD=Vorig jaar,Budget;
                                                                    NOR=I fjor,Budsjett;
                                                                    SVE=FîregÜende Ür,Budget];
                                                   OptionString=Last Year,Budget }
    { 2   ;   ;Net Change Actual   ;Boolean       ;CaptionML=[DAN=Faktisk bevëgelse;
                                                              DEU=NettoÑnderung - Ist;
                                                              ENU=Net Change Actual;
                                                              ESP=Saldo periodo real;
                                                              FIN=Nettomuutos, toteutunut;
                                                              FRA=Solde pÇriode - RÇel;
                                                              ISL=Raunveruleg nett¢breyting;
                                                              ITA=Saldo periodo effettivo;
                                                              NLD=Mutatie werkelijk;
                                                              NOR=Faktisk bevegelse] }
    { 3   ;   ;Net Change Actual Last Year;Boolean;CaptionML=[DAN=Faktisk bevëgelse sidste Ür;
                                                              DEU=NettoÑnderung - Ist - Vorjahr;
                                                              ENU=Net Change Actual Last Year;
                                                              ESP=Saldo periodo real el a§o anterior;
                                                              FIN=Nettomuutos, toteutunut edellisenÑ vuonna;
                                                              FRA=Solde pÇriode - RÇel dernier exercice;
                                                              ISL=Raunveruleg nett¢breyting s°–asta †rs;
                                                              ITA=Saldo periodo effettivo anno precedente;
                                                              NLD=Mutatie werkelijk vorig jaar;
                                                              NOR=Faktisk bevegelse i fjor] }
    { 4   ;   ;Variance in Changes ;Boolean       ;CaptionML=[DAN=Difference;
                                                              DEU=Abweichung;
                                                              ENU=Difference;
                                                              ESP=Diferencia;
                                                              FIN=Ero;
                                                              FRA=DiffÇrence;
                                                              ISL=Mismunur;
                                                              ITA=Differenza;
                                                              NLD=Verschil;
                                                              NOR=Differanse] }
    { 5   ;   ;% Variance in Changes;Boolean      ;CaptionML=[DAN=Variansprocent;
                                                              DEU=Abweichung %;
                                                              ENU=Variance %;
                                                              ESP=% de desviaci¢n;
                                                              FIN=Vaihtelu-%;
                                                              FRA=% Çcart;
                                                              ISL=Fr†vik ° %;
                                                              ITA=% scostamento;
                                                              NLD=Verschil %;
                                                              NOR=Avviks-%] }
    { 6   ;   ;Balance at Date Actual;Boolean     ;CaptionML=[DAN=Faktisk saldo til dato;
                                                              DEU=Saldo bis Datum - Ist;
                                                              ENU=Balance at Date Actual;
                                                              ESP=Saldo a la fecha real;
                                                              FIN=Pvm:n saldo, toteutunut;
                                                              FRA=Solde au - RÇel;
                                                              ISL=Raunsta–a til dags;
                                                              ITA=Saldo alla data effettivo;
                                                              NLD=Saldo op datum werkelijk;
                                                              NOR=Faktisk saldo per dato] }
    { 7   ;   ;Balance at Date Act. Last Year;Boolean;
                                                   CaptionML=[DAN=Faktisk saldo til dato sidste Ür;
                                                              DEU=Saldo bis Datum - Ist - Vorjahr;
                                                              ENU=Balance at Date Act. Last Year;
                                                              ESP=Saldo a la fecha real del a§o anterior;
                                                              FIN=Pvm:n saldo, toteutunut edellisenÑ vuonna;
                                                              FRA=Solde au - RÇel dernier exercice;
                                                              ISL=Nett¢sta–a til dags fyrir s°–asta †r;
                                                              ITA=Saldo alla data anno precedente effet.;
                                                              NLD=Saldo op datum werkelijk vorig jaar;
                                                              NOR=Fakt. saldo per dato i fjor] }
    { 8   ;   ;Variance in Balances;Boolean       ;CaptionML=[DAN=Difference;
                                                              DEU=Abweichung;
                                                              ENU=Difference;
                                                              ESP=Diferencia;
                                                              FIN=Ero;
                                                              FRA=DiffÇrence;
                                                              ISL=Mismunur;
                                                              ITA=Differenza;
                                                              NLD=Verschil;
                                                              NOR=Differanse] }
    { 9   ;   ;% Variance in Balances;Boolean     ;CaptionML=[DAN=Variansprocent;
                                                              DEU=Abweichung %;
                                                              ENU=Variance %;
                                                              ESP=% de desviaci¢n;
                                                              FIN=Vaihtelu-%;
                                                              FRA=% Çcart;
                                                              ISL=Fr†vik ° %;
                                                              ITA=% scostamento;
                                                              NLD=Verschil %;
                                                              NOR=Avviks-%] }
    { 10  ;   ;Rounding Factor     ;Option        ;CaptionML=[DAN=Afrundingsfaktor;
                                                              DEU=Rundungsfaktor;
                                                              ENU=Rounding Factor;
                                                              ESP=Factor redondeo;
                                                              FIN=Pyîristyskerroin;
                                                              FRA=UnitÇ d'affichage;
                                                              ISL=SlÇttunarstu–ull;
                                                              ITA=Fattore arrotondamento;
                                                              NLD=Afrondingsfactor;
                                                              NOR=Avrundingsfaktor];
                                                   OptionCaptionML=[DAN=Ingen,1,1000,1000000;
                                                                    DEU=Kein,1,1000,1000000;
                                                                    ENU=None,1,1000,1000000;
                                                                    NLD=Geen,1,1000,1000000];
                                                   OptionString=None,1,1000,1000000 }
    { 11  ;   ;Skip Accounts with all zero;Boolean;CaptionML=ENU=Skip Accounts with all zero Amounts }
    { 12  ;   ;All Amounts in LCY  ;Boolean       ;InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                GetReportingCurrency;
                                                              END;

                                                   CaptionML=[DAN=Alle belõb i RV;
                                                              DEU=Alle BetrÑge in MW;
                                                              ENU=All Amounts in LCY;
                                                              FIN=Kaikki summat PVA;
                                                              FRA=Tous les montants DS;
                                                              ISL=Allar upphë–ir ° SGM;
                                                              ITA=Tutti gli importi in VL;
                                                              NLD=Alle bedragen in LV;
                                                              NOR=Alle belõp i NOK;
                                                              SVE=Alla belopp i BVA] }
    { 13  ;   ;From Date           ;Date           }
    { 14  ;   ;To Date             ;Date           }
    { 15  ;   ;Currency Code       ;Code10        ;CaptionML=[DAN=Valutakode;
                                                              DEU=WÑhrungscode;
                                                              ENU=Currency Code;
                                                              ESP=C¢d. divisa;
                                                              FIN=Valuutan koodi;
                                                              FRA=Code devise;
                                                              ISL=Gjaldmi–ilsk¢ti;
                                                              ITA=Cod. valuta;
                                                              NLD=Valutacode;
                                                              NOR=Valutakode] }
  }
  KEYS
  {
    {    ;Show by                                 ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE GetNoOfColumns@1000000000() : Integer;
    VAR
      NoOfColumns@1000000000 : Integer;
    BEGIN
      IF "Net Change Actual" THEN
        NoOfColumns += 1;
      IF "Net Change Actual Last Year" THEN
        NoOfColumns += 1;
      IF "Variance in Changes" THEN
        NoOfColumns += 1;
      IF "% Variance in Changes" THEN
        NoOfColumns += 1;
      IF "Balance at Date Actual" THEN
        NoOfColumns += 1;
      IF "Balance at Date Act. Last Year" THEN
        NoOfColumns += 1;
      IF "Variance in Balances" THEN
        NoOfColumns += 1;
      IF "% Variance in Balances" THEN
        NoOfColumns += 1;

      EXIT(NoOfColumns);
    END;

    LOCAL PROCEDURE GetReportingCurrency@1000000001();
    VAR
      GLSetup@1000000000 : Record 98;
    BEGIN
      "Currency Code" := '';

      IF "All Amounts in LCY" THEN
        EXIT;

      GLSetup.GET;
      GLSetup.TESTFIELD("Additional Reporting Currency");
      "Currency Code" := GLSetup."Additional Reporting Currency";
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70206 ForNAV Trial Balance
{
  OBJECT-PROPERTIES
  {
    Date=01-02-18;
    Time=20:26:03;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;G/L Account No.     ;Code20         }
    { 4   ;   ;Description         ;Text80         }
    { 11  ;   ;Net Change Actual   ;Decimal       ;CaptionML=[DAN=Faktisk bevëgelse;
                                                              DEU=NettoÑnderung - Ist;
                                                              ENU=Net Change Actual;
                                                              ESP=Saldo periodo real;
                                                              FIN=Nettomuutos, toteutunut;
                                                              FRA=Solde pÇriode - RÇel;
                                                              ISL=Raunveruleg nett¢breyting;
                                                              ITA=Saldo periodo effettivo;
                                                              NLD=Mutatie werkelijk;
                                                              NOR=Faktisk bevegelse] }
    { 13  ;   ;Net Change Actual Last Year;Decimal;CaptionML=[DAN=Faktisk bevëgelse sidste Ür;
                                                              DEU=NettoÑnderung - Ist - Vorjahr;
                                                              ENU=Net Change Actual Last Year;
                                                              ESP=Saldo periodo real el a§o anterior;
                                                              FIN=Nettomuutos, toteutunut edellisenÑ vuonna;
                                                              FRA=Solde pÇriode - RÇel dernier exercice;
                                                              ISL=Raunveruleg nett¢breyting s°–asta †rs;
                                                              ITA=Saldo periodo effettivo anno precedente;
                                                              NLD=Mutatie werkelijk vorig jaar;
                                                              NOR=Faktisk bevegelse i fjor] }
    { 14  ;   ;Variance in Changes ;Decimal       ;CaptionML=[DAN=Difference;
                                                              DEU=Abweichung;
                                                              ENU=Difference;
                                                              ESP=Diferencia;
                                                              FIN=Ero;
                                                              FRA=DiffÇrence;
                                                              ISL=Mismunur;
                                                              ITA=Differenza;
                                                              NLD=Verschil;
                                                              NOR=Differanse] }
    { 15  ;   ;% Variance in Changes;Decimal      ;CaptionML=[DAN=Variansprocent;
                                                              DEU=Abweichung %;
                                                              ENU=Variance %;
                                                              ESP=% de desviaci¢n;
                                                              FIN=Vaihtelu-%;
                                                              FRA=% Çcart;
                                                              ISL=Fr†vik ° %;
                                                              ITA=% scostamento;
                                                              NLD=Verschil %;
                                                              NOR=Avviks-%] }
    { 17  ;   ;Balance at Date Actual;Decimal     ;CaptionML=[DAN=Faktisk saldo til dato;
                                                              DEU=Saldo bis Datum - Ist;
                                                              ENU=Balance at Date Actual;
                                                              ESP=Saldo a la fecha real;
                                                              FIN=Pvm:n saldo, toteutunut;
                                                              FRA=Solde au - RÇel;
                                                              ISL=Raunsta–a til dags;
                                                              ITA=Saldo alla data effettivo;
                                                              NLD=Saldo op datum werkelijk;
                                                              NOR=Faktisk saldo per dato] }
    { 19  ;   ;Balance at Date Act. Last Year;Decimal;
                                                   CaptionML=[DAN=Faktisk saldo til dato sidste Ür;
                                                              DEU=Saldo bis Datum - Ist - Vorjahr;
                                                              ENU=Balance at Date Act. Last Year;
                                                              ESP=Saldo a la fecha real del a§o anterior;
                                                              FIN=Pvm:n saldo, toteutunut edellisenÑ vuonna;
                                                              FRA=Solde au - RÇel dernier exercice;
                                                              ISL=Nett¢sta–a til dags fyrir s°–asta †r;
                                                              ITA=Saldo alla data anno precedente effet.;
                                                              NLD=Saldo op datum werkelijk vorig jaar;
                                                              NOR=Fakt. saldo per dato i fjor] }
    { 21  ;   ;Print Amount 1      ;Text30        ;CaptionClass=GetCaptionClass(1) }
    { 22  ;   ;Print Amount 2      ;Text30        ;CaptionClass=GetCaptionClass(2) }
    { 23  ;   ;Print Amount 3      ;Text30        ;CaptionClass=GetCaptionClass(3) }
    { 24  ;   ;Print Amount 4      ;Text30        ;CaptionClass=GetCaptionClass(4) }
    { 25  ;   ;Print Amount 5      ;Text30        ;CaptionClass=GetCaptionClass(5) }
    { 26  ;   ;Print Amount 6      ;Text30        ;CaptionClass=GetCaptionClass(6) }
    { 27  ;   ;Print Amount 7      ;Text30        ;CaptionClass=GetCaptionClass(7) }
    { 28  ;   ;Print Amount 8      ;Text30        ;CaptionClass=GetCaptionClass(8) }
    { 31  ;   ;RoundTo             ;Option        ;OptionString=Pennies,Dollars,Thousands }
    { 32  ;   ;No. of Columns      ;Integer        }
    { 41  ;   ;Variance in Balances;Decimal       ;CaptionML=[DAN=Difference;
                                                              DEU=Abweichung;
                                                              ENU=Difference;
                                                              ESP=Diferencia;
                                                              FIN=Ero;
                                                              FRA=DiffÇrence;
                                                              ISL=Mismunur;
                                                              ITA=Differenza;
                                                              NLD=Verschil;
                                                              NOR=Differanse] }
    { 42  ;   ;% Variance in Balances;Decimal     ;CaptionML=[DAN=Variansprocent;
                                                              DEU=Abweichung %;
                                                              ENU=Variance %;
                                                              ESP=% de desviaci¢n;
                                                              FIN=Vaihtelu-%;
                                                              FRA=% Çcart;
                                                              ISL=Fr†vik ° %;
                                                              ITA=% scostamento;
                                                              NLD=Verschil %;
                                                              NOR=Avviks-%] }
    { 43  ;   ;Bold                ;Boolean        }
    { 102 ;   ;Caption 1           ;Text80         }
    { 103 ;   ;Caption 2           ;Text80         }
    { 104 ;   ;Caption 3           ;Text80         }
    { 105 ;   ;Caption 4           ;Text80         }
    { 106 ;   ;Caption 5           ;Text80         }
    { 107 ;   ;Caption 6           ;Text80         }
    { 108 ;   ;Caption 7           ;Text80         }
    { 109 ;   ;Caption 8           ;Text80         }
  }
  KEYS
  {
    {    ;G/L Account No.                         ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE CreateForGLAccount@1(VAR GLAccount@1000000000 : Record 15;Args@1000000001 : Record 70205);
    VAR
      TrialBalance@1000000004 : Codeunit 70206;
    BEGIN
      INIT;
      "G/L Account No." := GLAccount."No.";

      TrialBalance.GetDataFromGLAccount(Rec, GLAccount, Args);

      Description := PADSTR('',GLAccount.Indentation) + GLAccount.Name;

      IF HasNumbers THEN BEGIN
        FormatAmounts(Args);
        "No. of Columns" := Args.GetNoOfColumns;
        Bold := GLAccount."Account Type" <> GLAccount."Account Type"::Posting;//GLA.AccountType != 0)
        INSERT;
      END;
    END;

    LOCAL PROCEDURE FormatAmounts@1000000000(VAR Args@1000000000 : Record 70205);
    VAR
      i@1000000001 : Integer;
    BEGIN
      IF Args."Net Change Actual" THEN
        AddToNext(FormatAsNumber(Args, "Net Change Actual"), FIELDCAPTION("Net Change Actual"), i);
      IF Args."Net Change Actual Last Year" THEN
        AddToNext(FormatAsNumber(Args, "Net Change Actual Last Year"), FIELDCAPTION("Net Change Actual Last Year"), i);
      IF Args."Variance in Changes" THEN
        AddToNext(FormatAsNumber(Args, "Variance in Changes"), FIELDCAPTION("Variance in Changes"), i);
      IF Args."% Variance in Changes" THEN
        AddToNext(FormatAsPct("% Variance in Changes"), FIELDCAPTION("% Variance in Changes"), i);
      IF Args."Balance at Date Actual" THEN
        AddToNext(FormatAsNumber(Args, "Balance at Date Actual"), FIELDCAPTION("Balance at Date Actual"), i);
      IF Args."Balance at Date Act. Last Year" THEN
        AddToNext(FormatAsNumber(Args, "Balance at Date Act. Last Year"), FIELDCAPTION("Balance at Date Act. Last Year"), i);
      IF Args."Variance in Balances" THEN
        AddToNext(FormatAsNumber(Args, "Variance in Changes"), FIELDCAPTION("Variance in Balances"), i);
      IF Args."% Variance in Balances" THEN
        AddToNext(FormatAsPct("% Variance in Changes"), FIELDCAPTION("% Variance in Balances"), i);
    END;

    LOCAL PROCEDURE AddToNext@1000000005(Value@1000000001 : Text;Caption@1000000002 : Text;VAR i@1000000000 : Integer);
    BEGIN
      i += 1;
      CASE i OF
        1:
          BEGIN
            "Print Amount 1" := Value;
            "Caption 1" := Caption;
          END;
        2:
          BEGIN
            "Print Amount 2" := Value;
            "Caption 2" := Caption;
          END;
        3:
          BEGIN
            "Print Amount 3" := Value;
            "Caption 3" := Caption;
          END;
        4:
          BEGIN
            "Print Amount 4" := Value;
            "Caption 4" := Caption;
          END;
        5:
          BEGIN
            "Print Amount 5" := Value;
            "Caption 5" := Caption;
          END;
        6:
          BEGIN
            "Print Amount 6" := Value;
            "Caption 6" := Caption;
          END;
        7:
          BEGIN
            "Print Amount 7" := Value;
            "Caption 7" := Caption;
          END;
        8:
          BEGIN
            "Print Amount 8" := Value;
            "Caption 8" := Caption;
          END;
      END;
    END;

    LOCAL PROCEDURE RoundAmounts@1000000001(Value@1000000001 : Decimal;Args@1000000000 : Record 70205) : Decimal;
    BEGIN
      CASE Args."Rounding Factor" OF
        Args."Rounding Factor"::None:
          EXIT(ROUND(Value, 0.01));
        Args."Rounding Factor"::"1":
          EXIT(ROUND(Value, 1));
        Args."Rounding Factor"::"1000":
          EXIT(ROUND(Value / 1000, 1));
        Args."Rounding Factor"::"1000000":
          EXIT(ROUND(Value / 10000000, 0.01));
      END;
    END;

    LOCAL PROCEDURE HasNumbers@1000000002() : Boolean;
    BEGIN
      EXIT(("Net Change Actual" <> 0) OR
        ("Net Change Actual Last Year" <> 0) OR
        ("Balance at Date Actual" <> 0) OR
        ("Balance at Date Act. Last Year" <> 0) OR
        ("Variance in Changes" <> 0) OR
        ("% Variance in Changes" <> 0));
    END;

    LOCAL PROCEDURE FormatAsNumber@1000000003(Args@1000000002 : Record 70205;Value@1000000000 : Decimal) TheText : Text;
    VAR
      j@1000000001 : Integer;
    BEGIN
      IF Value = 0 THEN
        TheText := ''
      ELSE
        TheText := FORMAT(RoundAmounts(Value, Args));
    END;

    LOCAL PROCEDURE FormatAsPct@1000000004(Value@1000000000 : Decimal) : Text;
    VAR
      Args@1000000001 : Record 70205;
    BEGIN
      IF Value = 0 THEN
        EXIT('');

      EXIT(FormatAsNumber(Args, Value) + '%');
    END;

    PROCEDURE GetCaptionClass@1000000007(FieldNo@1000000000 : Integer) : Text;
    BEGIN
      CASE FieldNo OF
        1:
          EXIT('3,' + "Caption 1");
        2:
          EXIT('3,' + "Caption 2");
        3:
          EXIT('3,' + "Caption 3");
        4:
          EXIT('3,' + "Caption 4");
        5:
          EXIT('3,' + "Caption 5");
        6:
          EXIT('3,' + "Caption 6");
        7:
          EXIT('3,' + "Caption 7");
        8:
          EXIT('3,' + "Caption 8");
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70215 ForNAV Salesperson-Comm. Args.
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=13:37:13;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;New Page per Person ;Boolean       ;CaptionML=[DAN=Skift side pr. sëlger;
                                                              DEU=Neue Seite pro VerkÑufer;
                                                              ENU=New Page per Person;
                                                              NLD=Nieuwe pagina per persoon] }
  }
  KEYS
  {
    {    ;New Page per Person                     ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70219 ForNAV Aged Accounts Args.
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=10:40:54;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Print Amounts in LCY;Boolean       ;CaptionML=[DAN=Udskriv belõb i RV;
                                                              DEU=BetrÑge in MW drucken;
                                                              ENU=Print Amounts in LCY;
                                                              ESP=Imprimir importes en DL;
                                                              FIN=Tulosta summat PVA;
                                                              FRA=Imprimer montants DS;
                                                              ISL=Prenta upphë–ir ° SGM;
                                                              ITA=Stampa importi in VL;
                                                              NLD=Bedragen in LV afdrukken;
                                                              NOR=Skriv ut belõp i NOK;
                                                              SVE=Skriv ut belopp i BVA];
                                                   Description=Done }
    { 2   ;   ;Ending Date         ;Date          ;CaptionML=[DAN=Slutdato;
                                                              DEU=Enddatum;
                                                              ENU=Ending Date;
                                                              ESP=Fecha final;
                                                              FIN=Lopetuspvm;
                                                              FRA=Date fin;
                                                              ISL=Lokadagsetning;
                                                              ITA=Data fine;
                                                              NLD=Einddatum;
                                                              NOR=Sluttdato];
                                                   Description=Done }
    { 3   ;   ;Aging By            ;Option        ;CaptionML=[DAN=Aldersford.intv. efter;
                                                              DEU=SaldenrÅckblick nach;
                                                              ENU=Aging Band by;
                                                              ESP=Rango antigÅedad por;
                                                              FIN=ErÑÑntymisjakso per;
                                                              FRA=Cumul par;
                                                              ISL=T°mabil aldursgreiningar eftir;
                                                              ITA=Periodo scadenziario per;
                                                              NLD=Vervaldatuminterval per;
                                                              NOR=Aldersfordeling pÜ basis av;
                                                              SVE=èldersspann per];
                                                   OptionCaptionML=[DAN=Forfaldsdato,Bogfõringsdato,Bilagsdato;
                                                                    DEU=FÑlligkeitsdatum,Buchungsdatum,Belegdatum;
                                                                    ENU=Due Date,Posting Date,Document Date;
                                                                    ESP=Fecha vencimiento,Fecha registro,Fecha documento;
                                                                    FIN=ErÑpÑivÑ,Kirjauspvm.,Asiakirjan pvm.;
                                                                    FRA=Date d'ÇchÇance,Date comptabilisation,Date document;
                                                                    ISL=Gjalddagi,B¢kunardagsetning,Dags. fylgiskjals;
                                                                    ITA=Data scadenza,Data registrazione,Data documento;
                                                                    NLD=Vervaldatum,Boekingsdatum,Documentdatum;
                                                                    NOR=Forfallsdato,Bokfõringsdato,Bilagsdato;
                                                                    SVE=Fîrfallodatum,Bokfîringsdatum,Dokumentdatum];
                                                   OptionString=Due Date,Posting Date,Document Date;
                                                   Description=Done }
    { 4   ;   ;Period Length       ;DateFormula   ;CaptionML=[DAN=Periodelëngde;
                                                              DEU=PeriodenlÑnge;
                                                              ENU=Period Length;
                                                              ESP=Longitud periodo;
                                                              FIN=Jakson pituus;
                                                              FRA=Base pÇriode;
                                                              ISL=Lengd t°mabils;
                                                              ITA=Durata periodo;
                                                              NLD=Periodelengte;
                                                              NOR=Periodelengde];
                                                   Description=Done }
    { 5   ;   ;Print Details       ;Boolean       ;CaptionML=[DAN=Udskriv detaljer;
                                                              DEU=Details drucken;
                                                              ENU=Print Details;
                                                              ESP=Imprimir detalles;
                                                              FIN=Tulosta yksityiskohdat;
                                                              FRA=Imprimer dÇtails;
                                                              ISL=Prenta sundurli–un;
                                                              ITA=Stampa dettagli;
                                                              NLD=Details afdrukken;
                                                              NOR=Skriv ut spesifikasjoner;
                                                              SVE=Skriv ut detaljer];
                                                   Description=Done }
    { 6   ;   ;Heading Type        ;Option        ;CaptionML=[DAN=Overskriftstype;
                                                              DEU=öberschriftsart;
                                                              ENU=Heading Type;
                                                              ESP=Tipo cabecera;
                                                              FIN=Otsikon tyyppi;
                                                              FRA=Type titre;
                                                              ISL=Tegund yfirskriftar;
                                                              ITA=Tipo testata;
                                                              NLD=Type kop;
                                                              NOR=Overskriftstype;
                                                              SVE=Rubriktyp];
                                                   OptionString=Date Interval,Number of Days;
                                                   Description=Done }
    { 7   ;   ;New Page Per Customer;Boolean      ;CaptionML=[DAN=Skift side pr. debitor;
                                                              DEU=Neue Seite pro Debitor;
                                                              ENU=New Page Per Customer;
                                                              NLD=Nieuwe pagina per klant];
                                                   Description=Done }
    { 9   ;   ;Period Start Date   ;Date          ;CaptionML=[DAN=Periodes startdato;
                                                              DEU=Periodenstartdatum;
                                                              ENU=Period Start Date;
                                                              ESP=Fecha inicial del periodo;
                                                              FIN=Jakson aloituspvm;
                                                              FRA=Date dÇbut pÇriode;
                                                              ISL=Upphafsdagur t°mabils;
                                                              ITA=Data inizio periodo;
                                                              NLD=Begindatum periode;
                                                              NOR=Periodens startdato];
                                                   Description=Done }
    { 12  ;   ;Currency Code       ;Code10        ;CaptionML=[DAN=Valutakode;
                                                              DEU=WÑhrungscode;
                                                              ENU=Currency Code;
                                                              ESP=C¢d. divisa;
                                                              FIN=Valuutan koodi;
                                                              FRA=Code devise;
                                                              ISL=Gjaldmi–ilsk¢ti;
                                                              ITA=Cod. valuta;
                                                              NLD=Valutacode;
                                                              NOR=Valutakode];
                                                   Description=Done }
    { 13  ;   ;Column Count        ;Integer       ;CaptionML=[DAN=Antal kolonner;
                                                              DEU=Anzahl Spalten;
                                                              ENU=Column Count;
                                                              ESP=Recuento de columnas;
                                                              FIN=SarakemÑÑrÑ;
                                                              FRA=Nombre colonnes;
                                                              ISL=D†lkafjîldi;
                                                              ITA=Conteggio colonne;
                                                              NLD=Kolomtelling;
                                                              NOR=Antall kolonner];
                                                   MinValue=1;
                                                   MaxValue=31;
                                                   Description=Done }
  }
  KEYS
  {
    {    ;Print Amounts in LCY                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      PeriodStartDate@1000000001 : ARRAY [31] OF Date;
      PeriodEndDate@1000000000 : ARRAY [31] OF Date;
      HeaderText@1000000002 : ARRAY [31] OF Text;

    PROCEDURE CalcDates@5();
    VAR
      i@1000 : Integer;
      PeriodLength2@1001 : DateFormula;
      Text010@1000000001 : TextConst 'ENU=The Date Formula %1 cannot be used. Try to restate it. E.g. 1M+CM instead of CM+1M.';
      Text032@1000000000 : TextConst '@@@=Negating the period length: %1 is the period length;ENU=-%1';
    BEGIN
      EVALUATE(PeriodLength2,STRSUBSTNO(Text032, "Period Length"));

      IF "Aging By" = "Aging By"::"Due Date" THEN BEGIN
        PeriodEndDate[1] := DMY2DATE(31,12,9999);
        PeriodStartDate[1] := "Ending Date" + 1;
      END ELSE BEGIN
        PeriodEndDate[1] := "Ending Date";
        PeriodStartDate[1] := CALCDATE(PeriodLength2, "Ending Date" + 1);
      END;

      FOR i := 2 TO "Column Count" DO BEGIN
        PeriodEndDate[i] := PeriodStartDate[i - 1] - 1;
        PeriodStartDate[i] := CALCDATE(PeriodLength2,PeriodEndDate[i] + 1);
      END;

      PeriodStartDate[i] := 0D;
      FOR i := 1 TO "Column Count" DO
        IF PeriodEndDate[i] < PeriodStartDate[i] THEN
          ERROR(Text010, "Period Length");

      CreateHeadings;
    END;

    PROCEDURE GetPeriodIndex@8(Date@1040000 : Date) : Integer;
    VAR
      i@1000 : Integer;
    BEGIN
      FOR i := 1 TO "Column Count" DO
        IF Date IN [PeriodStartDate[i]..PeriodEndDate[i]] THEN
          EXIT(i);
    END;

    PROCEDURE GetCaption@1000000000(i@1000000000 : Integer) : Text;
    BEGIN
      EXIT(HeaderText[i]);
    END;

    LOCAL PROCEDURE CreateHeadings@10();
    VAR
      i@1000 : Integer;
      NotDueTxt@1000000015 : TextConst 'DAN=Ikke forfalden;DEU=Nicht fÑllig;ENU=Not Due;NLD=Niet vervallen';
      BeforeTxt@1000000014 : TextConst 'DAN=Fõr;DEU=Vor;ENU=Before;NLD=Voor';
      DaysTxt@1000000013 : TextConst 'ENU=days';
      MoreThanTxt@1000000012 : TextConst 'ENU=More than';
    BEGIN
      IF "Aging By" = "Aging By"::"Due Date" THEN BEGIN
        HeaderText[1] := NotDueTxt;
        i := 2;
      END ELSE
        i := 1;

      WHILE i < "Column Count" DO BEGIN
        IF "Heading Type" = "Heading Type"::"Date Interval" THEN
          HeaderText[i] := STRSUBSTNO('%1\..%2',PeriodStartDate[i],PeriodEndDate[i])
        ELSE
          HeaderText[i] :=
            STRSUBSTNO('%1 - %2 %3', "Ending Date" - PeriodEndDate[i] + 1, "Ending Date" - PeriodStartDate[i] + 1, DaysTxt);
        i := i + 1;
      END;

      IF "Heading Type" = "Heading Type"::"Date Interval" THEN
        HeaderText["Column Count"] := STRSUBSTNO('%1 \%2', BeforeTxt, PeriodStartDate[i - 1])
      ELSE
        HeaderText["Column Count"] := STRSUBSTNO('%1 \%2 %3', MoreThanTxt, "Ending Date" - PeriodStartDate[i - 1] + 1, DaysTxt);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70220 ForNAV Aging Buffer
{
  OBJECT-PROPERTIES
  {
    Date=22-05-18;
    Time=08:32:06;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[DAN=Lõbenr.;
                                                              DEU=Lfd. Nr.;
                                                              ENU=Entry No.;
                                                              ESP=Nß mov.;
                                                              FIN=Tapahtumanro;
                                                              FRA=N¯ sÇquence;
                                                              ISL=Fërslunr.;
                                                              ITA=Nr. movimento;
                                                              NLD=Volgnummer;
                                                              NOR=Lõpenr.] }
    { 20  ;   ;Account Type        ;Option        ;CaptionML=[DAN=Kontotype;
                                                              DEU=Kontoart;
                                                              ENU=Account Type;
                                                              ESP=Tipo mov.;
                                                              FIN=Tilityyppi;
                                                              FRA=Type compte;
                                                              ISL=Tegund reiknings;
                                                              ITA=Tipo conto;
                                                              NLD=Rekeningsoort;
                                                              NOR=Kontotype];
                                                   OptionString=Customer,Vendor }
    { 30  ;   ;Account No.         ;Code20        ;TableRelation=IF (Account Type=CONST(Customer)) Customer
                                                                 ELSE IF (Account Type=CONST(Vendor)) Vendor;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DAN=Nummer;
                                                              DEU=Nr.;
                                                              ENU=No.;
                                                              ESP=Nß;
                                                              FIN=Nro;
                                                              FRA=N¯;
                                                              ISL=Nr.;
                                                              ITA=Nr.;
                                                              NLD=Nr.;
                                                              NOR=Nr.] }
    { 31  ;   ;Account Name        ;Text50        ;CaptionML=[DAN=Navn;
                                                              DEU=Name;
                                                              ENU=Name;
                                                              ESP=Nombre;
                                                              FIN=Nimi;
                                                              FRA=Nom;
                                                              ISL=Heiti;
                                                              ITA=Nome;
                                                              NLD=Naam;
                                                              NOR=Navn] }
    { 35  ;   ;Credit Limit (LCY)  ;Decimal       ;CaptionML=[DAN=Kreditmaksimum (RV);
                                                              DEU=Kreditlimit (MW);
                                                              ENU=Credit Limit (LCY);
                                                              ESP=CrÇdito m†ximo (DL);
                                                              FIN=Luottoraja (PVA);
                                                              FRA=CrÇdit autorisÇ DS;
                                                              ISL=H†marksskuld (SGM);
                                                              ITA=Limite credito (VL);
                                                              NLD=Kredietlimiet (LV);
                                                              NOR=Kredittgrense (NOK)] }
    { 40  ;   ;Currency Code       ;Code10        ;CaptionML=[DAN=Valutakode;
                                                              DEU=WÑhrungscode;
                                                              ENU=Currency Code;
                                                              ESP=C¢d. divisa;
                                                              FIN=Valuutan koodi;
                                                              FRA=Code devise;
                                                              ISL=Gjaldmi–ilsk¢ti;
                                                              ITA=Cod. valuta;
                                                              NLD=Valutacode;
                                                              NOR=Valutakode] }
    { 50  ;   ;Document Type       ;Option        ;CaptionML=[DAN=Bilagstype;
                                                              DEU=Belegart;
                                                              ENU=Document Type;
                                                              FIN=Asiakirjatyyppi;
                                                              FRA=Type document;
                                                              ISL=Tegund fylgiskjals;
                                                              ITA=Tipo di documento;
                                                              NLD=Documenttype;
                                                              NOR=Bilagstype;
                                                              SVE=Dokumenttyp];
                                                   OptionCaptionML=ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 60  ;   ;Document No.        ;Code20        ;CaptionML=[DAN=Bilagsnr.;
                                                              DEU=Belegnr.;
                                                              ENU=Document No.;
                                                              ESP=Nß documento;
                                                              FIN=Asiakirjan nro;
                                                              FRA=N¯ document;
                                                              ISL=N£mer fylgiskjals;
                                                              ITA=Nr. documento;
                                                              NLD=Documentnr.;
                                                              NOR=Bilagsnr.] }
    { 61  ;   ;External Document No.;Code35       ;CaptionML=[DAN=Eksternt bilagsnr.;
                                                              DEU=Externe Belegnummer;
                                                              ENU=External Document No.;
                                                              ESP=Nß documento externo;
                                                              FIN=Ulkoisen asiakirjan nro;
                                                              FRA=N¯ doc. externe;
                                                              ISL=N£mer utana–k. skjals;
                                                              ITA=Nr. documento esterno;
                                                              NLD=Extern documentnr.;
                                                              NOR=Eksterndokumentnr.] }
    { 65  ;   ;Document Date       ;Date          ;CaptionML=[DAN=Bilagsdato;
                                                              DEU=Belegdatum;
                                                              ENU=Document Date;
                                                              FIN=Asiakirjan pvm;
                                                              FRA=Date document;
                                                              ISL=Dags. fylgiskjals;
                                                              ITA=Data documento;
                                                              NLD=Documentdatum;
                                                              NOR=Bilagsdato;
                                                              SVE=Dokumentdatum] }
    { 70  ;   ;Posting Date        ;Date          ;CaptionML=[DAN=Bogfõringsdato;
                                                              DEU=Buchungsdatum;
                                                              ENU=Posting Date;
                                                              FIN=Kirjauspvm.;
                                                              FRA=Date comptabilisation;
                                                              ISL=B¢kunardags.;
                                                              ITA=Data di registrazione;
                                                              NLD=Boekingsdatum;
                                                              NOR=Bokfõringsdato;
                                                              SVE=Bokfîringsdatum] }
    { 80  ;   ;Due Date            ;Date          ;CaptionML=[DAN=Forfaldsdato;
                                                              DEU=FÑlligkeitsdatum;
                                                              ENU=Due Date;
                                                              FIN=ErÑpÑivÑ;
                                                              FRA=Date d'ÇchÇance;
                                                              ISL=Gjalddagi;
                                                              ITA=Data scadenza;
                                                              NLD=Vervaldatum;
                                                              NOR=Forfallsdato;
                                                              SVE=Fîrfallodatum] }
    { 90  ;   ;Amount              ;Decimal       ;CaptionML=[DAN=Belõb;
                                                              DEU=Betrag;
                                                              ENU=Amount;
                                                              ESP=Importe;
                                                              FIN=Summa;
                                                              FRA=Montant;
                                                              ISL=Upphë–;
                                                              ITA=Importo;
                                                              NLD=Bedrag;
                                                              NOR=Belõp] }
    { 95  ;   ;Amount (LCY)        ;Decimal       ;CaptionML=[DAN=Belõb (RV);
                                                              DEU=Betrag (MW);
                                                              ENU=Amount (LCY);
                                                              ESP=Importe (DL);
                                                              FIN=Summa (PVA);
                                                              FRA=Montant DS;
                                                              ISL=Upphë– (SGM);
                                                              ITA=Importo (VL);
                                                              NLD=Bedrag (LV);
                                                              NOR=Belõp (NOK)] }
    { 100 ;   ;Balance             ;Decimal       ;CaptionML=[DAN=Saldo;
                                                              DEU=Saldo;
                                                              ENU=Balance;
                                                              ESP=Saldo;
                                                              FIN=Saldo;
                                                              FRA=Solde;
                                                              ISL=Sta–a;
                                                              ITA=Saldo;
                                                              NLD=Saldo;
                                                              NOR=Saldo] }
    { 105 ;   ;Balance (LCY)       ;Decimal       ;CaptionML=[DAN=Saldo (RV);
                                                              DEU=Saldo (MW);
                                                              ENU=Balance (LCY);
                                                              ESP=Saldo (DL);
                                                              FIN=Saldo (PVA);
                                                              FRA=Solde DS;
                                                              ISL=Sta–a (SGM);
                                                              ITA=Saldo (VL);
                                                              NLD=Saldo (LV);
                                                              NOR=Saldo (NOK)] }
    { 110 ;   ;Amount 1            ;Decimal       ;CaptionClass=GetCaptionClass(1) }
    { 115 ;   ;Amount 1 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(1) }
    { 120 ;   ;Amount 2            ;Decimal       ;CaptionClass=GetCaptionClass(2) }
    { 125 ;   ;Amount 2 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(2) }
    { 130 ;   ;Amount 3            ;Decimal       ;CaptionClass=GetCaptionClass(3) }
    { 135 ;   ;Amount 3 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(3) }
    { 140 ;   ;Amount 4            ;Decimal       ;CaptionClass=GetCaptionClass(4) }
    { 145 ;   ;Amount 4 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(4) }
    { 150 ;   ;Amount 5            ;Decimal       ;CaptionClass=GetCaptionClass(5) }
    { 155 ;   ;Amount 5 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(5) }
    { 160 ;   ;Amount 6            ;Decimal       ;CaptionClass=GetCaptionClass(6) }
    { 165 ;   ;Amount 6 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(6) }
    { 167 ;   ;Amount 7            ;Decimal       ;CaptionClass=GetCaptionClass(7) }
    { 170 ;   ;Amount 7 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(7) }
    { 175 ;   ;Amount 8            ;Decimal       ;CaptionClass=GetCaptionClass(8) }
    { 180 ;   ;Amount 8 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(8) }
    { 182 ;   ;Amount 9            ;Decimal       ;CaptionClass=GetCaptionClass(9) }
    { 185 ;   ;Amount 9 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(9) }
    { 190 ;   ;Amount 10           ;Decimal       ;CaptionClass=GetCaptionClass(10) }
    { 195 ;   ;Amount 10 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(10) }
    { 200 ;   ;Amount 11           ;Decimal       ;CaptionClass=GetCaptionClass(11) }
    { 205 ;   ;Amount 11 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(11) }
    { 210 ;   ;Amount 12           ;Decimal       ;CaptionClass=GetCaptionClass(12) }
    { 215 ;   ;Amount 12 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(12) }
    { 220 ;   ;Amount 13           ;Decimal       ;CaptionClass=GetCaptionClass(13) }
    { 225 ;   ;Amount 13 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(13) }
    { 230 ;   ;Amount 14           ;Decimal       ;CaptionClass=GetCaptionClass(14) }
    { 235 ;   ;Amount 14 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(14) }
    { 240 ;   ;Amount 15           ;Decimal       ;CaptionClass=GetCaptionClass(15) }
    { 245 ;   ;Amount 15 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(15) }
    { 250 ;   ;Amount 16           ;Decimal       ;CaptionClass=GetCaptionClass(16) }
    { 255 ;   ;Amount 16 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(16) }
    { 260 ;   ;Amount 17           ;Decimal       ;CaptionClass=GetCaptionClass(17) }
    { 265 ;   ;Amount 17 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(17) }
    { 270 ;   ;Amount 18           ;Decimal       ;CaptionClass=GetCaptionClass(18) }
    { 275 ;   ;Amount 18 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(18) }
    { 280 ;   ;Amount 19           ;Decimal       ;CaptionClass=GetCaptionClass(19) }
    { 285 ;   ;Amount 19 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(19) }
    { 290 ;   ;Amount 20           ;Decimal       ;CaptionClass=GetCaptionClass(20) }
    { 295 ;   ;Amount 20 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(20) }
    { 300 ;   ;Amount 21           ;Decimal       ;CaptionClass=GetCaptionClass(21) }
    { 305 ;   ;Amount 21 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(21) }
    { 310 ;   ;Amount 22           ;Decimal       ;CaptionClass=GetCaptionClass(22) }
    { 315 ;   ;Amount 22 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(22) }
    { 320 ;   ;Amount 23           ;Decimal       ;CaptionClass=GetCaptionClass(23) }
    { 325 ;   ;Amount 23 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(23) }
    { 330 ;   ;Amount 24           ;Decimal       ;CaptionClass=GetCaptionClass(24) }
    { 335 ;   ;Amount 24 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(24) }
    { 340 ;   ;Amount 25           ;Decimal       ;CaptionClass=GetCaptionClass(25) }
    { 345 ;   ;Amount 25 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(25) }
    { 350 ;   ;Amount 26           ;Decimal       ;CaptionClass=GetCaptionClass(26) }
    { 355 ;   ;Amount 26 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(26) }
    { 360 ;   ;Amount 27           ;Decimal       ;CaptionClass=GetCaptionClass(27) }
    { 365 ;   ;Amount 27 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(27) }
    { 370 ;   ;Amount 28           ;Decimal       ;CaptionClass=GetCaptionClass(28) }
    { 375 ;   ;Amount 28 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(28) }
    { 380 ;   ;Amount 29           ;Decimal       ;CaptionClass=GetCaptionClass(29) }
    { 385 ;   ;Amount 29 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(29) }
    { 390 ;   ;Amount 30           ;Decimal       ;CaptionClass=GetCaptionClass(30) }
    { 395 ;   ;Amount 30 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(30) }
    { 400 ;   ;Amount 31           ;Decimal       ;CaptionClass=GetCaptionClass(31) }
    { 405 ;   ;Amount 31 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(31) }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Currency Code                            }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      HeaderText@1000000000 : ARRAY [31] OF Text;

    PROCEDURE GetCaptionClass@1000000000(FieldNo@1000000000 : Integer) : Text;
    BEGIN
      EXIT('3,' + HeaderText[FieldNo]);
    END;

    PROCEDURE SetCaptions@1000000001(VAR Args@1000000000 : Record 70219);
    VAR
      i@1000000001 : Integer;
    BEGIN
      FOR i := 1 TO ARRAYLEN(HeaderText) DO
        HeaderText[i] := Args.GetCaption(i);
    END;

    PROCEDURE GetAccountName@1000000002();
    VAR
      Customer@1000000000 : Record 18;
      Vendor@1000000001 : Record 23;
    BEGIN
      CASE "Account Type" OF
        "Account Type"::Customer:
          BEGIN
            Customer.GET("Account No.");
            "Account Name" := Customer.Name;
          END;
        "Account Type"::Vendor:
          BEGIN
            Vendor.GET("Account No.");
            "Account Name" := Vendor.Name;
          END;
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70230 ForNAV Statistics Args.
{
  OBJECT-PROPERTIES
  {
    Date=04-03-18;
    Time=15:28:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Currency Code       ;Code10        ;CaptionML=[DAN=Valutakode;
                                                              DEU=WÑhrungscode;
                                                              ENU=Currency Code;
                                                              ESP=C¢d. divisa;
                                                              FIN=Valuutan koodi;
                                                              FRA=Code devise;
                                                              ISL=Gjaldmi–ilsk¢ti;
                                                              ITA=Cod. valuta;
                                                              NLD=Valutacode;
                                                              NOR=Valutakode] }
    { 2   ;   ;Invoices            ;Boolean       ;CaptionML=[DAN=Fakturaer;
                                                              DEU=Rechnungen;
                                                              ENU=Invoices;
                                                              ESP=Facturas;
                                                              FIN=Laskut;
                                                              FRA=Factures;
                                                              ISL=Reikningar;
                                                              ITA=Fatture;
                                                              NLD=Facturen;
                                                              NOR=Fakturaer] }
    { 3   ;   ;Credit Memos        ;Boolean       ;CaptionML=[DAN=Kreditnotaer;
                                                              DEU=Gutschriften;
                                                              ENU=Credit Memos;
                                                              ESP=Abonos;
                                                              FIN=Hyvityslaskujen;
                                                              FRA=Avoirs;
                                                              ISL=Kreditreikninga;
                                                              ITA=Note credito;
                                                              NLD=Creditnota's;
                                                              NOR=Kreditnotaer] }
    { 4   ;   ;Customer No.        ;Boolean       ;CaptionML=[DAN=Debitornr.;
                                                              DEU=Debitorennr.;
                                                              ENU=Customer No.;
                                                              ESP=Nß cliente;
                                                              FIN=Asiakasnro;
                                                              FRA=N¯ client;
                                                              ISL=N£mer vi–skiptamanns;
                                                              ITA=Nr. cliente;
                                                              NLD=Klantnr.;
                                                              NOR=Kundenr.] }
    { 5   ;   ;Vendor No.          ;Boolean        }
  }
  KEYS
  {
    {    ;Currency Code                           ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE CreateCurrencies@1000000000();
    VAR
      Currency@1000000000 : Record 4;
    BEGIN
      IF Currency.FINDSET THEN
        REPEAT
          "Currency Code" := Currency.Code;
          INSERT;
        UNTIL Currency.NEXT = 0;

      IF NOT GET('') THEN BEGIN
        "Currency Code" := '';
        INSERT;
      END;
    END;

    PROCEDURE GetInvoiceAmountLCY@1000000001(SalesInvoiceHeader@1000000000 : Record 112) : Decimal;
    VAR
      CustLedgEntry@1000000002 : Record 21;
    BEGIN
      CustLedgEntry.SETCURRENTKEY("Document No.");
      CustLedgEntry.SETRANGE("Document No.",SalesInvoiceHeader."No.");
      CustLedgEntry.SETRANGE("Document Type",CustLedgEntry."Document Type"::Invoice);
      CustLedgEntry.SETRANGE("Customer No.",SalesInvoiceHeader."Bill-to Customer No.");
      IF CustLedgEntry.FINDFIRST THEN
        EXIT(CustLedgEntry."Sales (LCY)");
    END;

    PROCEDURE GetInvoiceCostLCY@1000000002(SalesInvoiceHeader@1000000000 : Record 112) : Decimal;
    VAR
      SalesInvoiceLine@1000000001 : Record 113;
      CostCalcMgt@1000000002 : Codeunit 5836;
      CostLCY@1000000003 : Decimal;
    BEGIN
      SalesInvoiceLine.SETRANGE("Document No.",SalesInvoiceHeader."No.");
      IF SalesInvoiceLine.FIND('-') THEN
        REPEAT
          CostLCY := CostLCY + CostCalcMgt.CalcSalesInvLineCostLCY(SalesInvoiceLine);
        UNTIL SalesInvoiceLine.NEXT = 0;

      EXIT(CostLCY);
    END;

    PROCEDURE GetCreditMemoAmountLCY@1000000004(SalesCrMemoHeader@1000000000 : Record 114) : Decimal;
    VAR
      CustLedgEntry@1000000002 : Record 21;
    BEGIN
      CustLedgEntry.SETCURRENTKEY("Document No.");
      CustLedgEntry.SETRANGE("Document No.",SalesCrMemoHeader."No.");
      CustLedgEntry.SETRANGE("Document Type",CustLedgEntry."Document Type"::"Credit Memo");
      CustLedgEntry.SETRANGE("Customer No.",SalesCrMemoHeader."Bill-to Customer No.");
      IF CustLedgEntry.FINDFIRST THEN
        EXIT(CustLedgEntry."Sales (LCY)");
    END;

    PROCEDURE GetCreditMemoCostLCY@1000000003(SalesCrMemoHeader@1000000000 : Record 114) : Decimal;
    VAR
      SalesCrMemoLine@1000000001 : Record 115;
      CostCalcMgt@1000000002 : Codeunit 5836;
      CostLCY@1000000003 : Decimal;
    BEGIN
      SalesCrMemoLine.SETRANGE("Document No.",SalesCrMemoHeader."No.");
      IF SalesCrMemoLine.FIND('-') THEN
        REPEAT
          CostLCY := CostLCY + CostCalcMgt.CalcSalesCrMemoLineCostLCY(SalesCrMemoLine);
        UNTIL SalesCrMemoLine.NEXT = 0;

      EXIT(CostLCY);
    END;

    PROCEDURE GetPurchInvAmountLCY@1000000005(PurchInvHeader@1000000000 : Record 122) : Decimal;
    VAR
      VendLedgEntry@1000000002 : Record 25;
    BEGIN
      VendLedgEntry.SETCURRENTKEY("Document No.");
      VendLedgEntry.SETRANGE("Document No.",PurchInvHeader."No.");
      VendLedgEntry.SETRANGE("Document Type",VendLedgEntry."Document Type"::Invoice);
      VendLedgEntry.SETRANGE("Vendor No.", PurchInvHeader."Pay-to Vendor No.");
      IF VendLedgEntry.FINDFIRST THEN
        EXIT(VendLedgEntry."Purchase (LCY)");
    END;

    PROCEDURE GetPurchCrMemoAmountLCY@1000000006(PurchCrMemoHdr@1000000000 : Record 124) : Decimal;
    VAR
      VendLedgEntry@1000000002 : Record 25;
    BEGIN
      VendLedgEntry.SETCURRENTKEY("Document No.");
      VendLedgEntry.SETRANGE("Document No.",PurchCrMemoHdr."No.");
      VendLedgEntry.SETRANGE("Document Type",VendLedgEntry."Document Type"::"Credit Memo");
      VendLedgEntry.SETRANGE("Vendor No.", PurchCrMemoHdr."Pay-to Vendor No.");
      IF VendLedgEntry.FINDFIRST THEN
        EXIT(VendLedgEntry."Purchase (LCY)");
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70239 ForNAV Inv. to G/L Arguments
{
  OBJECT-PROPERTIES
  {
    Date=30-04-18;
    Time=10:39:04;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;To Date             ;Date          ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Til dato;
                                                              DEU=Bis Datum;
                                                              ENU=To Date;
                                                              ESP=Hasta fecha;
                                                              FIN=Pvm:ÑÑn asti;
                                                              FRA=Date fin;
                                                              ISL=Til dags.;
                                                              ITA=A data;
                                                              NLD=T/m datum;
                                                              NOR=Til dato] }
    { 2   ;   ;Location Code       ;Boolean       ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Lokationskode;
                                                              DEU=Lagerortcode;
                                                              ENU=Location Code;
                                                              ESP=C¢d. almacÇn;
                                                              FIN=Sijaintikoodi;
                                                              FRA=Code magasin;
                                                              ISL=K¢ti birg˜ageymslu;
                                                              ITA=Cod. ubicazione;
                                                              NLD=Vestiging;
                                                              NOR=Lokasjonskode] }
    { 3   ;   ;Variant Code        ;Boolean       ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Variantkode;
                                                              DEU=Variantencode;
                                                              ENU=Variant Code;
                                                              ESP=C¢d. variante;
                                                              FIN=Varianttikoodi;
                                                              FRA=Code variante;
                                                              ISL=Afbrig˜isk¢ti;
                                                              ITA=Cod. variante;
                                                              NLD=Variant;
                                                              NOR=Variantkode;
                                                              ESM=C¢d. variante;
                                                              FRC=Code variante;
                                                              ENC=Variant Code] }
    { 4   ;   ;Amounts in Add. Currency;Boolean   ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Bel˚b i ekstra valuta;
                                                              DEU=BetrÑge in BW;
                                                              ENU=Amounts in Add. Currency;
                                                              ESP=Importes en divisa adic.;
                                                              FIN=Summat lisÑvaluuttana;
                                                              FRA=Montants DR;
                                                              ISL=Upphë˜ir ° î˜rum gjaldm.;
                                                              ITA=Importi in val. addizionale;
                                                              NLD=Bedragen in rapp.-valuta;
                                                              NOR=Bel˚p i tilleggsvaluta] }
  }
  KEYS
  {
    {    ;To Date                                 ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE CreateBuffer@1000000000(VAR Item@1000000002 : Record 27;VAR InvToGLBuffer@1000000000 : Record 70240);
    VAR
      InvToGLRecon@1000000001 : Query 70240;
    BEGIN
      InvToGLBuffer.RESET;
      InvToGLBuffer.DELETEALL;

      //IF "By Location" then
      InvToGLRecon.SETRANGE(No, Item."No.");
      InvToGLRecon.SETRANGE(Date_Filter, 0D, "To Date");
      InvToGLRecon.SETFILTER(Valued_Quantity, '<0');
      InvToGLRecon.OPEN;
      WITH InvToGLBuffer DO
        WHILE InvToGLRecon.READ DO BEGIN
          CreateRowSetDescription(InvToGLBuffer, InvToGLRecon);
          "Cost Amount (Expected)" := InvToGLRecon.Sum_Cost_Amount_Expected;
          "Cost Amount (Expected) (ACY)" := InvToGLRecon.Sum_Cost_Amount_Expected_ACY;
          "Expected Cost Posted to G/L" := InvToGLRecon.Sum_Expected_Cost_Posted_to_G_;
          "Exp. Cost Posted to G/L (ACY)" := InvToGLRecon.Sum_Exp_Cost_Posted_to_G_L_ACY;
          "Valued Quantity" := InvToGLRecon.Sum_Valued_Quantity;
          "Invoiced Quantity" := InvToGLRecon.Sum_Invoiced_Quantity;
          "Cost Amount (Actual)" := InvToGLRecon.Sum_Cost_Amount_Actual;
          "Cost Amount (Actual) (ACY)" := InvToGLRecon.Sum_Cost_Amount_Actual_ACY;
          "Cost Posted to G/L" := InvToGLRecon.Sum_Cost_Posted_to_G_L;
          "Cost Posted to G/L (ACY)" := InvToGLRecon.Sum_Cost_Posted_to_G_L_ACY;
          CreateValues(Rec, TRUE, FALSE);
          MODIFY;
        END;

      InvToGLRecon.SETRANGE(No, Item."No.");
      InvToGLRecon.SETRANGE(Date_Filter, 0D, "To Date");
      InvToGLRecon.SETFILTER(Valued_Quantity, '>0');
      InvToGLRecon.OPEN;
      WITH InvToGLBuffer DO
        WHILE InvToGLRecon.READ DO BEGIN
          CreateRowSetDescription(InvToGLBuffer, InvToGLRecon);
          "Cost Amount (Expected)" := InvToGLRecon.Sum_Cost_Amount_Expected;
          "Cost Amount (Expected) (ACY)" := InvToGLRecon.Sum_Cost_Amount_Expected_ACY;
          "Expected Cost Posted to G/L" := InvToGLRecon.Sum_Expected_Cost_Posted_to_G_;
          "Exp. Cost Posted to G/L (ACY)" := InvToGLRecon.Sum_Exp_Cost_Posted_to_G_L_ACY;
          "Valued Quantity" := InvToGLRecon.Sum_Valued_Quantity;
          "Invoiced Quantity" := InvToGLRecon.Sum_Invoiced_Quantity;
          "Cost Amount (Actual)" += InvToGLRecon.Sum_Cost_Amount_Actual;
          "Cost Amount (Actual) (ACY)" += InvToGLRecon.Sum_Cost_Amount_Actual_ACY;
          "Cost Posted to G/L" += InvToGLRecon.Sum_Cost_Posted_to_G_L;
          "Cost Posted to G/L (ACY)" += InvToGLRecon.Sum_Cost_Posted_to_G_L_ACY;
          CreateValues(Rec, FALSE, TRUE);
          MODIFY;
        END;
    END;

    LOCAL PROCEDURE CreateRowSetDescription@1000000002(VAR InvToGLBuffer@1000000001 : Record 70240;VAR InvToGLRecon@1000000000 : Query 70240);
    BEGIN
      IF NOT InvToGLBuffer.GET(InvToGLRecon.No, InvToGLRecon.Variant_Code, InvToGLRecon.Location_Code) THEN BEGIN
        InvToGLBuffer.INIT;
        InvToGLBuffer."Item No." := InvToGLRecon.No;
        InvToGLBuffer."Variant Code" := InvToGLRecon.Variant_Code;
        InvToGLBuffer."Location Code" := InvToGLRecon.Location_Code;
        InvToGLBuffer.SetDescription;
        InvToGLBuffer.INSERT;
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70240 ForNAV Inventory to G/L Buffer
{
  OBJECT-PROPERTIES
  {
    Date=30-04-18;
    Time=15:21:43;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Item No.            ;Code20        ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Varenr.;
                                                              DEU=Artikelnummer;
                                                              ENU=Item No.;
                                                              ESP=N.ß producto;
                                                              FIN=Nimikenro;
                                                              FRA=N¯ article;
                                                              ISL=Vîrunr.;
                                                              ITA=Nr. articolo;
                                                              NLD=Artikelnr.;
                                                              NOR=Varenr.] }
    { 2   ;   ;Variant Code        ;Code10        ;DataClassification=SystemMetadata;
                                                   CaptionML=[DAN=Variantkode;
                                                              DEU=Variantencode;
                                                              ENU=Variant Code;
                                                              ESP=C¢d. variante;
                                                              FIN=Varianttikoodi;
                                                              FRA=Code variante;
                                                              ISL=Afbrig˜isk¢ti;
                                                              ITA=Cod. variante;
                                                              NLD=Variant;
                                                              NOR=Variantkode;
                                                              ESM=C¢d. variante;
                                                              FRC=Code variante;
                                                              ENC=Variant Code] }
    { 3   ;   ;Location Code       ;Code10        ;DataClassification=SystemMetadata;
                                                   CaptionML=[DAN=Lokationskode;
                                                              DEU=Lagerortcode;
                                                              ENU=Location Code;
                                                              ESP=C¢d. almacÇn;
                                                              FIN=Sijaintikoodi;
                                                              FRA=Code magasin;
                                                              ISL=K¢ti birg˜ageymslu;
                                                              ITA=Cod. ubicazione;
                                                              NLD=Vestiging;
                                                              NOR=Lokasjonskode] }
    { 8   ;   ;Inventory Value     ;Decimal       ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Lagervërdi;
                                                              DEU=Lagerwert;
                                                              ENU=Inventory Value;
                                                              ESP=Valor inventario;
                                                              FIN=Varaston arvo;
                                                              FRA=Valeur stock;
                                                              ISL=Birg˜avir˜i;
                                                              ITA=Valore magazzino;
                                                              NLD=Voorraadwaarde;
                                                              NOR=Lagerverdi] }
    { 9   ;   ;Received Not Invoiced;Decimal      ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Modtag bel˚b (ufakt.);
                                                              DEU=Nicht fakt. Wareneingangen;
                                                              ENU=Received Not Invoiced;
                                                              ESP=Recepci¢n no facturado;
                                                              FIN=Vastaanotto toimitukset;
                                                              FRA=Recevoir non facturÇ;
                                                              ISL=M¢ttaka, ¢reikningsfërt;
                                                              ITA=Ricevi non fatturato;
                                                              NLD=Ontvangen/Niet gefact.;
                                                              NOR=Motta, ikke fakturert] }
    { 10  ;   ;Shipped Not Invoiced;Decimal       ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Lev. bel˚b (ufakt.);
                                                              DEU=Nicht fakt. Lieferungen;
                                                              ENU=Shipped Not Invoiced;
                                                              ESP=Enviado no facturado;
                                                              FIN=Laskuttamattomat toimitukset;
                                                              FRA=LivrÇ non facturÇ;
                                                              ISL=Afhent, ¢reikningsfërt;
                                                              ITA=Spedito non fatturato;
                                                              NLD=Verzonden/Niet gefact.;
                                                              NOR=Levert, ikke fakturert] }
    { 11  ;   ;Total Expected Cost ;Decimal       ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Forventet kostpris;
                                                              DEU=Soll-Kosten;
                                                              ENU=Total Expected Cost;
                                                              ESP=Coste previsto;
                                                              FIN=Oletettu kustannus;
                                                              FRA=Coñt prÇvu;
                                                              ISL=Vëntanl. kostna˜ur;
                                                              ITA=Costo previsto;
                                                              NLD=Verwachte kosten;
                                                              NOR=Forventet kostnad] }
    { 12  ;   ;Received Not Invoiced Posted;Decimal;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Modtag bel˚b (ufakt./bogf˚rt);
                                                              DEU=Nicht fakt. Wareneingangen (Gebucht);
                                                              ENU=Received Not Invoiced (Posted);
                                                              ESP=Recepci¢n no facturado (Registrado);
                                                              FIN=Vastaanotto toimitukset (Kirjattu);
                                                              FRA=Recevoir non facturÇ (ValidÇ);
                                                              ISL=M¢ttaka, ¢reikningsfërt (B¢ka˜);
                                                              ITA=Ricevi non fatturato (Registrato);
                                                              NLD=Ontvangen/Niet gefact. (Geboekt);
                                                              NOR=Motta, ikke fakturert (Bokf˚rt)] }
    { 13  ;   ;Shipped Not Invoiced Posted;Decimal;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Lev. bel˚b (ufakt./bogf˚rt);
                                                              DEU=Nicht fakt. Lieferungen (Gebucht);
                                                              ENU=Shipped Not Invoiced (Posted);
                                                              ESP=Enviado no facturado (Registrado);
                                                              FIN=Laskuttamattomat toimitukset (Kirjattu);
                                                              FRA=LivrÇ non facturÇ (ValidÇ);
                                                              ISL=Afhent, ¢reikningsfërt (B¢ka˜);
                                                              ITA=Spedito non fatturato (Registrato);
                                                              NLD=Verzonden/Niet gefact. (Geboekt);
                                                              NOR=Levert, ikke fakturert (Bokf˚rt)] }
    { 14  ;   ;Net Expected Cost Posted;Decimal   ;DataClassification=ToBeClassified }
    { 15  ;   ;Net Expected Cost Not Posted;Decimal;
                                                   DataClassification=ToBeClassified }
    { 16  ;   ;Total Invoiced Value;Decimal       ;DataClassification=ToBeClassified }
    { 17  ;   ;Invoiced Value Posted;Decimal      ;DataClassification=ToBeClassified }
    { 18  ;   ;Invoiced Value Not Posted;Decimal  ;DataClassification=ToBeClassified }
    { 19  ;   ;Cost Amount (Expected);Decimal     ;DataClassification=ToBeClassified }
    { 20  ;   ;Cost Amount (Expected) (ACY);Decimal;
                                                   DataClassification=ToBeClassified }
    { 30  ;   ;Expected Cost Posted to G/L;Decimal;DataClassification=ToBeClassified }
    { 40  ;   ;Exp. Cost Posted to G/L (ACY);Decimal;
                                                   DataClassification=ToBeClassified }
    { 50  ;   ;Valued Quantity     ;Decimal       ;DataClassification=ToBeClassified }
    { 60  ;   ;Invoiced Quantity   ;Decimal       ;DataClassification=ToBeClassified }
    { 70  ;   ;Cost Amount (Actual);Decimal       ;DataClassification=ToBeClassified }
    { 80  ;   ;Cost Amount (Actual) (ACY);Decimal ;DataClassification=ToBeClassified }
    { 90  ;   ;Cost Posted to G/L  ;Decimal       ;DataClassification=ToBeClassified }
    { 100 ;   ;Cost Posted to G/L (ACY);Decimal   ;DataClassification=ToBeClassified }
    { 200 ;   ;Pending Adj.        ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Post Value Entry to G/L" WHERE (Item No.=FIELD(Item No.))) }
  }
  KEYS
  {
    {    ;Item No.,Variant Code,Location Code     ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE CreateValues@1000000000(VAR Args@1000000000 : Record 70239;Received@1000000001 : Boolean;Shipped@1000000002 : Boolean);
    VAR
      WrongCallErr@1000000003 : TextConst 'ENU=Wrong Function Call';
    BEGIN
      IF (Received = Shipped) OR (NOT ISTEMPORARY) THEN
        ERROR(WrongCallErr);

      IF "Valued Quantity" = 0 THEN
        "Valued Quantity" := "Invoiced Quantity"
      ELSE
        IF "Valued Quantity" > 0 THEN BEGIN
          IF Args."Amounts in Add. Currency" THEN BEGIN
            "Received Not Invoiced" := "Cost Amount (Expected) (ACY)";
            "Received Not Invoiced Posted" := "Exp. Cost Posted to G/L (ACY)";
          END ELSE BEGIN
            "Received Not Invoiced" := "Cost Amount (Expected)";
            "Received Not Invoiced Posted" := "Expected Cost Posted to G/L";
          END;
        END ELSE
          IF "Valued Quantity" < 0 THEN
            IF Args."Amounts in Add. Currency" THEN BEGIN
              "Shipped Not Invoiced" := "Cost Amount (Expected) (ACY)";
              "Shipped Not Invoiced Posted" := "Exp. Cost Posted to G/L (ACY)";
            END ELSE BEGIN
              "Shipped Not Invoiced" := "Cost Amount (Expected)";
              "Shipped Not Invoiced Posted" := "Expected Cost Posted to G/L";
            END;

      "Total Expected Cost" := "Received Not Invoiced" + "Shipped Not Invoiced";
      "Net Expected Cost Posted" := "Received Not Invoiced Posted" + "Shipped Not Invoiced Posted";
      "Net Expected Cost Not Posted" := "Total Expected Cost" - "Net Expected Cost Posted";

      IF Args."Amounts in Add. Currency" THEN BEGIN
        "Total Invoiced Value" := "Cost Amount (Actual) (ACY)";
        "Invoiced Value Posted" := "Cost Posted to G/L (ACY)";
      END ELSE BEGIN
        "Total Invoiced Value" := "Cost Amount (Actual)";
        "Invoiced Value Posted" := "Cost Posted to G/L";
      END;

      "Invoiced Value Not Posted" := "Total Invoiced Value" - "Invoiced Value Posted";
      "Inventory Value" := "Total Invoiced Value" + "Total Expected Cost";
    END;

    PROCEDURE SetDescription@1000000001();
    VAR
      Location@1000000001 : Record 14;
      ItemVariant@1000000000 : Record 5401;
      NoVariant@1000000003 : TextConst 'ENU=No Variant;ESM=Sin variante;FRC=Pas de variante;ENC=No Variant';
      NoLocation@1000000002 : TextConst 'ENU=No Location;ESM=Sin almacÇn;FRC=Pas de localisation;ENC=No Location';
    BEGIN
      // IF ("Variant Code" = '') OR NOT ItemVariant.GET("Item No.","Variant Code") THEN
      //  Description := NoVariant
      // ELSE
      //  Description := ItemVariant.TABLECAPTION + ' ' + "Variant Code" + '(' + ItemVariant.Description + ')';
      //
      // IF ("Location Code" = '') OR NOT Location.GET("Location Code") THEN
      //  Description := Description + ' ' + NoLocation
      // ELSE
      //  Description := Description + ' ' + Location.TABLECAPTION + ' ' + "Location Code" + '(' + Location.Name + ')';
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70248 ForNAV Cust./Item Stat. Args.
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=11:48:50;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Print Details       ;Boolean       ;CaptionML=[DAN=Udskriv detaljer;
                                                              DEU=Details drucken;
                                                              ENU=Print Details;
                                                              ESP=Imprimir detalles;
                                                              FIN=Tulosta yksityiskohdat;
                                                              FRA=Imprimer dÇtails;
                                                              ISL=Prenta sundurli–un;
                                                              ITA=Stampa dettagli;
                                                              NLD=Details afdrukken;
                                                              NOR=Skriv ut spesifikasjoner;
                                                              SVE=Skriv ut detaljer] }
    { 2   ;   ;New Page Per Customer;Boolean      ;CaptionML=[ENU="ENU=""New Page per Customer"";DAN=""Skift side pr. debitor"";DEU=""Neue Seite pro Debitor"";ESP=""P†gina nueva por cliente"";FIN=""Uusi sivu asiakasta kohti"";FRA=""Nouvelle page par client"";ISL=""NÏ bla–s°–a † hvern vi–skiptamann"";ITA=""Nuova pagina per cliente"";NLD=""Nieuwe pagina per klant"";NOR=""Sideskift per kunde"";SVE=""Ny sida per kund"""] }
  }
  KEYS
  {
    {    ;Print Details                           ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70250 ForNAV Statement Arguments
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=10:45:57;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Start Date          ;Date          ;CaptionML=[DAN=Startdato;
                                                              DEU=Startdatum;
                                                              ENU=Start Date;
                                                              ESP=Fecha inicial;
                                                              FIN=Aloituspvm;
                                                              FRA=Date dÇbut;
                                                              ISL=Upphafsdagur;
                                                              ITA=Data di inizio;
                                                              NLD=Begindatum;
                                                              NOR=Startdato] }
    { 2   ;   ;Ending Date         ;Date          ;CaptionML=[DAN=Slutdato;
                                                              DEU=Enddatum;
                                                              ENU=Ending Date;
                                                              ESP=Fecha final;
                                                              FIN=Lopetuspvm;
                                                              FRA=Date fin;
                                                              ISL=Lokadagsetning;
                                                              ITA=Data fine;
                                                              NLD=Einddatum;
                                                              NOR=Sluttdato] }
    { 3   ;   ;Document Date       ;Date          ;CaptionML=[DAN=Bilagsdato;
                                                              DEU=Belegdatum;
                                                              ENU=Document Date;
                                                              FIN=Asiakirjan pvm;
                                                              FRA=Date document;
                                                              ISL=Dags. fylgiskjals;
                                                              ITA=Data documento;
                                                              NLD=Documentdatum;
                                                              NOR=Bilagsdato;
                                                              SVE=Dokumentdatum] }
    { 4   ;   ;Print All Having Balance;Boolean   ;CaptionML=[DAN=Medtag ogsÜ debitorer, der kun har saldo;
                                                              DEU=Alle Debitoren mit Saldo einbeziehen;
                                                              ENU=Include All Customers with a Balance;
                                                              NLD=Alle klanten met saldo] }
    { 5   ;   ;Print All Having Entries;Boolean   ;CaptionML=[DAN=Medtag alle debitorer, der har poster;
                                                              DEU=Alle Debitoren mit Buchungen einbeziehen;
                                                              ENU=Include All Customers with Ledger Entries;
                                                              NLD=Alle klanten met posten] }
    { 6   ;   ;Print Entries Due   ;Boolean       ;CaptionML=[DAN=Vis forfaldne poster;
                                                              DEU=FÑllige Posten drucken;
                                                              ENU=Show Overdue Entries;
                                                              NLD=Vervallen posten weergeven] }
    { 7   ;   ;Print Unapplied Entries;Boolean     }
    { 8   ;   ;Print Reversed Entries;Boolean      }
    { 9   ;   ;Include Aging Band  ;Boolean       ;CaptionML=[DAN=Medtag aldersford.intv.;
                                                              DEU=Mit SaldenrÅckblick;
                                                              ENU=Include Aging Band;
                                                              ESP=Incluye rango antigÅedad;
                                                              FIN=Sis. erÑÑntymisjakso;
                                                              FRA=Inclure cumul date;
                                                              ISL=Taka aldursgreiningart°mabil me–;
                                                              ITA=Includi periodo scadenziario;
                                                              NLD=Vervaldatuminterval opnemen;
                                                              NOR=Vis aldersfordeling;
                                                              SVE=Ta med Üldersspann] }
    { 10  ;   ;Date                ;Option        ;CaptionML=[DAN=Dato;
                                                              DEU=Datum;
                                                              ENU=Date;
                                                              ESP=Fecha;
                                                              FIN=Pvm;
                                                              FRA=Date;
                                                              ISL=Dagsetning;
                                                              ITA=Data;
                                                              NLD=Datum;
                                                              NOR=Dato];
                                                   OptionCaptionML=[DAN=Forfaldsdato,Bogfõringsdato;
                                                                    DEU=FÑlligkeitsdatum,Buchungsdatum;
                                                                    ENU=Due Date,Posting Date;
                                                                    ESP=Fecha vto,Fecha registro;
                                                                    FIN=ErÑpÑivÑ,Kirjauspvm.;
                                                                    FRA=Date d'ÇchÇance,Date comptabilisation;
                                                                    ISL=Gjalddagi,B¢kunardagsetning;
                                                                    ITA=Data scadenza,Data registrazione;
                                                                    NLD=Vervaldatum,Boekingsdatum;
                                                                    NOR=Forfallsdato,Bokfõringsdato;
                                                                    SVE=Fîrfallodatum,Bokfîringsdatum];
                                                   OptionString=Due Date,Posting Date }
    { 11  ;   ;Period Length       ;DateFormula   ;CaptionML=[DAN=Periodelëngde;
                                                              DEU=PeriodenlÑnge;
                                                              ENU=Period Length;
                                                              ESP=Longitud periodo;
                                                              FIN=Jakson pituus;
                                                              FRA=Base pÇriode;
                                                              ISL=Lengd t°mabils;
                                                              ITA=Durata periodo;
                                                              NLD=Periodelengte;
                                                              NOR=Periodelengde] }
  }
  KEYS
  {
    {    ;Start Date                              ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70300 ForNAV Check Arguments
{
  OBJECT-PROPERTIES
  {
    Date=15-03-18;
    Time=19:05:46;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10         }
    { 7   ;   ;Test Print          ;Boolean        }
    { 8   ;   ;Bank Account No.    ;Code20         }
    { 12  ;   ;Reprint Checks      ;Boolean        }
    { 20  ;   ;One Check Per Vendor;Boolean        }
    { 25  ;   ;Check No.           ;Code20         }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE GetNextCheckNo@1000000000() : Code[20];
    BEGIN
      "Check No." := INCSTR("Check No.");
      IF "Test Print" THEN
        "Check No." := 'XXXX';

      EXIT("Check No.");
    END;

    PROCEDURE TestMandatoryFields@1000000001();
    BEGIN
      TESTFIELD("Bank Account No.");
      TESTFIELD("Check No.");
    END;

    PROCEDURE CreateModelFromGenJnlLn@1000000002(VAR GenJnlLn@1000000001 : Record 81;VAR Model@1000000002 : Record 70303) : Boolean;
    VAR
      CreateCheckModel@1000000000 : Codeunit 70304;
    BEGIN
      EXIT(CreateCheckModel.CreateFromGenJnlLn(Rec, GenJnlLn, Model));
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70301 ForNAV Check
{
  OBJECT-PROPERTIES
  {
    Date=14-05-18;
    Time=13:26:05;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Check No.           ;Code20         }
    { 2   ;   ;Test                ;Boolean       ;DataClassification=ToBeClassified }
    { 5   ;   ;Currency Code       ;Code10         }
    { 6   ;   ;Posting Date        ;Date           }
    { 8   ;   ;Bank Account No.    ;Code20         }
    { 9   ;   ;Balancing Type      ;Option        ;OptionString=G/L Account,Customer,Vendor,Bank Account }
    { 10  ;   ;Balancing No.       ;Code20         }
    { 11  ;   ;Amount              ;Decimal        }
    { 12  ;   ;Document No.        ;Code20         }
    { 25  ;   ;Amount as Text (LCY);Text250        }
    { 26  ;   ;Amount as Text      ;Text250        }
    { 27  ;   ;Application Method  ;Option        ;OptionString=Payment,OneLineOneEntry,OneLineID,MoreLinesOneEntry }
    { 28  ;   ;Applies-to Doc. No. ;Code20         }
    { 29  ;   ;Applies-to ID       ;Code50         }
    { 31  ;   ;Amount Filled as Text;Text30        }
    { 36  ;   ;Pay-to Vendor No.   ;Code20        ;DataClassification=ToBeClassified }
    { 38  ;   ;Pay-to Name         ;Text50         }
    { 42  ;   ;Bank Name           ;Text50         }
    { 50  ;   ;Pay-to Name 2       ;Text50        ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Navn 2;
                                                              DEU=Name 2;
                                                              ENU=Pay-to Name 2;
                                                              ESP=Nombre 2;
                                                              FIN=Nimi 2;
                                                              FRA=Nom 2;
                                                              ISL=Heiti 2;
                                                              ITA=Nome 2;
                                                              NLD=Naam 2;
                                                              NOR=Navn 2] }
    { 52  ;   ;Pay-to Address      ;Text50        ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Adresse;
                                                              DEU=Adresse;
                                                              ENU=Pay-to Address;
                                                              ESP=Direcci¢n;
                                                              FIN=Osoite;
                                                              FRA=Adresse;
                                                              ISL=A–setur;
                                                              ITA=Indirizzo;
                                                              NLD=Adres;
                                                              NOR=Adresse] }
    { 53  ;   ;Pay-to Address 2    ;Text50        ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Adresse 2;
                                                              DEU=Adresse 2;
                                                              ENU=Pay-to Address 2;
                                                              ESP=Direcci¢n 2;
                                                              FIN=Osoite 2;
                                                              FRA=Adresse (2äme ligne);
                                                              ISL=A–setur 2;
                                                              ITA=Indirizzo 2;
                                                              NLD=Adres 2;
                                                              NOR=Adresse 2] }
    { 54  ;   ;Pay-to City         ;Text30        ;ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=By;
                                                              DEU=Ort;
                                                              ENU=Pay-to City;
                                                              ESP=Poblaci¢n;
                                                              FIN=Paikkakunta;
                                                              FRA=Ville;
                                                              ISL=Bër;
                                                              ITA=CittÖ;
                                                              NLD=Plaats;
                                                              NOR=Sted] }
    { 55  ;   ;Pay-to Post Code    ;Code20        ;ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Postnr.;
                                                              DEU=PLZ-Code;
                                                              ENU=Pay-to Post Code;
                                                              ESP=C¢digo postal;
                                                              FIN=Postinro;
                                                              FRA=Code postal;
                                                              ISL=P¢stn£mer;
                                                              ITA=CAP;
                                                              NLD=Postcode;
                                                              NOR=Postnr.] }
    { 56  ;   ;Pay-to County       ;Text30        ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Amt;
                                                              DEU=Bundesregion;
                                                              ENU=Pay-to County;
                                                              ESP=Provincia;
                                                              FIN=LÑÑni;
                                                              FRA=RÇgion;
                                                              ISL=SÏsla;
                                                              ITA=Provincia;
                                                              NLD=Provincie;
                                                              NOR=Fylke/delstat] }
    { 57  ;   ;Pay-to Country/Region Code;Code10  ;TableRelation=Country/Region;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Lande-/omrÜdekode;
                                                              DEU=LÑnder-/Regionscode;
                                                              ENU=Pay-to Country/Region Code;
                                                              ESP=C¢d. pa°s/regi¢n;
                                                              FIN=Maa-/aluekoodi;
                                                              FRA=Code pays/rÇgion;
                                                              ISL=Lands-/svë–isk¢ti;
                                                              ITA=Cod. paese;
                                                              NLD=Land-/regiocode;
                                                              NOR=Lands-/regionkode] }
  }
  KEYS
  {
    {    ;Check No.                               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE CreateFromGenJnlLn@1000000000(VAR Args@1000000019 : Record 70300;GenJnlLn@1000000001 : Record 81);
    VAR
      BankAccount@1000000000 : Record 270;
    BEGIN
      "Check No." := Args.GetNextCheckNo;
      Test := Args."Test Print";
      "Currency Code" := GenJnlLn."Currency Code";
      "Posting Date" := GenJnlLn."Posting Date";
      "Bank Account No." := Args."Bank Account No.";
      BankAccount.GET("Bank Account No.");
      "Bank Name" := BankAccount.Name;
      "Document No." := GenJnlLn."Document No.";
      "Applies-to Doc. No." := GenJnlLn."Applies-to Doc. No.";
      "Applies-to ID" := GenJnlLn."Applies-to ID";
      "Balancing Type" := GenJnlLn."Account Type";
      "Balancing No." := GenJnlLn."Account No.";
      GetAmount(Args, GenJnlLn);
      GetAmountsAsText;
      GetApplicationMethod(Args, GenJnlLn);
      GetPayToAddress(GenJnlLn);
      INSERT;
    END;

    PROCEDURE GetStub@1000000002(Args@1000000010 : Record 70300;VAR Stub@1000000000 : Record 70302;GenJnlLine@1000000011 : Record 81);
    VAR
      CreateStub@1000000001 : Codeunit 70302;
    BEGIN
      CreateStub.FromCheck(Args, Rec, Stub, GenJnlLine);
    END;

    PROCEDURE UpdateJournal@1000000005(Args@1000000002 : Record 70300;VAR GenJnlLine@1000000001 : Record 81);
    VAR
      CheckUpdateJournal@1000000000 : Codeunit 70301;
    BEGIN
      CheckUpdateJournal.UpdateJournal(Args, Rec, GenJnlLine);
    END;

    PROCEDURE CreateCheckLedgerEntry@1000000001(Args@1000000001 : Record 70300;GenJnlLine@1000000002 : Record 81);
    VAR
      CreateCheckLedgEnt@1000000000 : Codeunit 70303;
    BEGIN
      CreateCheckLedgEnt.CreateCheckLedgerEntry(Args, Rec, GenJnlLine);
    END;

    LOCAL PROCEDURE GetAmountsAsText@1000000003();
    VAR
      GLSetup@1000000002 : Record 98;
      AmountasText@1000000000 : Codeunit 70305;
      NumberText@1000000001 : ARRAY [2] OF Text[80];
    BEGIN
      AmountasText.InitTextVariable;
      AmountasText.FormatNoText(NumberText,Amount,"Currency Code");
      "Amount as Text (LCY)" := NumberText[1];
      "Amount as Text" := NumberText[2];
      "Amount Filled as Text" := FORMAT(Amount,0,'<Integer Thousand><Decimals,3>');
      WHILE STRLEN("Amount Filled as Text") < 17 DO
        "Amount Filled as Text" := '*' + "Amount Filled as Text";

      GLSetup.GET;
      "Amount Filled as Text" := GLSetup."Local Currency Symbol" + "Amount Filled as Text";
    END;

    LOCAL PROCEDURE GetApplicationMethod@1000000004(Args@1000000002 : Record 70300;FromGenJournalLine@1000000001 : Record 81);
    BEGIN
      WITH FromGenJournalLine DO BEGIN
        IF Args."One Check Per Vendor" THEN
          "Application Method" := "Application Method"::MoreLinesOneEntry
        ELSE
          IF "Applies-to Doc. No." <> '' THEN
            "Application Method" := "Application Method"::OneLineOneEntry
          ELSE
            IF "Applies-to ID" <> '' THEN
              "Application Method" := "Application Method"::OneLineID
            ELSE
              "Application Method" := "Application Method"::Payment;
      END;
    END;

    LOCAL PROCEDURE GetAmount@1000000007(Args@1000000002 : Record 70300;FromGenJournalLine@1000000001 : Record 81);
    VAR
      GenJournalLine@1000000000 : Record 81;
    BEGIN
      IF Args."One Check Per Vendor" THEN BEGIN
        WITH FromGenJournalLine DO BEGIN
          GenJournalLine.RESET;
          GenJournalLine.SETCURRENTKEY("Journal Template Name","Journal Batch Name","Posting Date","Document No.");
          GenJournalLine.SETRANGE("Journal Template Name", "Journal Template Name");
          GenJournalLine.SETRANGE("Journal Batch Name", "Journal Batch Name");
          GenJournalLine.SETRANGE("Posting Date","Posting Date");
          GenJournalLine.SETRANGE("Document No.","Document No.");
          GenJournalLine.SETRANGE("Account Type","Account Type");
          GenJournalLine.SETRANGE("Account No.","Account No.");
          GenJournalLine.SETRANGE("Bal. Account Type","Bal. Account Type");
          GenJournalLine.SETRANGE("Bal. Account No.","Bal. Account No.");
          GenJournalLine.SETRANGE("Bank Payment Type","Bank Payment Type");
          GenJournalLine.CALCSUMS(Amount);
        END;
        Amount := GenJournalLine.Amount;
      END ELSE
        Amount := FromGenJournalLine.Amount;
    END;

    LOCAL PROCEDURE GetPayToAddress@1000000006(VAR GenJnlLn@1000000000 : Record 81);
    VAR
      Cust@1000000001 : Record 18;
      Vend@1000000002 : Record 23;
    BEGIN
      CASE GenJnlLn."Account Type" OF
        GenJnlLn."Account Type"::Customer:
          BEGIN
            Cust.GET(GenJnlLn."Account No.");
            "Pay-to Vendor No." := GenJnlLn."Account No.";
            "Pay-to Name" := Cust.Name;
            "Pay-to Name 2" := Cust."Name 2";
            "Pay-to Address" := Cust.Address;
            "Pay-to Address 2" := Cust."Address 2";
            "Pay-to City" := Cust.City;
            "Pay-to Post Code" := Cust."Post Code";
            "Pay-to County" := Cust.County;
            "Pay-to Country/Region Code" := Cust."Country/Region Code";
          END;
        GenJnlLn."Account Type"::Vendor:
          BEGIN
            Vend.GET(GenJnlLn."Account No.");
            "Pay-to Vendor No." := GenJnlLn."Account No.";
            "Pay-to Name" := Vend.Name;
            "Pay-to Name 2" := Vend."Name 2";
            "Pay-to Address" := Vend.Address;
            "Pay-to Address 2" := Vend."Address 2";
            "Pay-to City" := Vend.City;
            "Pay-to Post Code" := Vend."Post Code";
            "Pay-to County" := Vend.County;
            "Pay-to Country/Region Code" := Vend."Country/Region Code";
         END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70302 ForNAV Stub
{
  OBJECT-PROPERTIES
  {
    Date=15-03-18;
    Time=19:42:29;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer        }
    { 2   ;   ;Document Date       ;Date           }
    { 3   ;   ;Document No.        ;Code20         }
    { 4   ;   ;External Document No.;Text35        }
    { 5   ;   ;Amount              ;Decimal        }
    { 6   ;   ;Discount Amount     ;Decimal        }
    { 8   ;   ;Document Type       ;Text50         }
    { 9   ;   ;Amount Paid         ;Decimal        }
    { 10  ;   ;Job No.             ;Code20         }
    { 12  ;   ;Currency Code       ;Code10         }
    { 13  ;   ;Posting Date        ;Date           }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE CustUpdateAmounts@3(VAR CustLedgEntry2@1000 : Record 21;VAR RemainingAmount2@1001 : Decimal;VAR LineAmount2@1000000000 : Decimal);
    VAR
      Currency@1000000001 : Record 4;
    BEGIN
      IF "Currency Code" <> '' THEN
        Currency.GET("Currency Code");

      "Entry No." := CustLedgEntry2."Entry No.";
      "Document Type" := FORMAT(CustLedgEntry2."Document Type");
      "Document No." := CustLedgEntry2."Document No.";
      "External Document No." := CustLedgEntry2."External Document No.";
      "Document Date" := CustLedgEntry2."Document Date";
      CustLedgEntry2.CALCFIELDS("Remaining Amount");
      Amount := -(CustLedgEntry2."Remaining Amount" - CustLedgEntry2."Remaining Pmt. Disc. Possible"-
        CustLedgEntry2."Accepted Payment Tolerance");

      LineAmount2 :=
        ROUND(
          ExchangeAmt(CustLedgEntry2."Posting Date","Currency Code",CustLedgEntry2."Currency Code",Amount),
          Currency."Amount Rounding Precision");

      IF ((((CustLedgEntry2."Document Type" = CustLedgEntry2."Document Type"::Invoice) AND
            (LineAmount2 >= RemainingAmount2)) OR
           ((CustLedgEntry2."Document Type" = CustLedgEntry2."Document Type"::"Credit Memo") AND
            (LineAmount2 <= RemainingAmount2))) AND
          ("Posting Date" <= CustLedgEntry2."Pmt. Discount Date")) OR
         CustLedgEntry2."Accepted Pmt. Disc. Tolerance"
      THEN BEGIN
        "Discount Amount" := -CustLedgEntry2."Remaining Pmt. Disc. Possible";
        IF CustLedgEntry2."Accepted Payment Tolerance" <> 0 THEN
          "Discount Amount" := "Discount Amount" - CustLedgEntry2."Accepted Payment Tolerance";
      END ELSE BEGIN
        "Discount Amount" := 0;
      END;
      INSERT;
    END;

    PROCEDURE VendUpdateAmounts@4(VAR VendLedgEntry2@1000 : Record 25;VAR RemainingAmount2@1001 : Decimal;VAR LineAmount2@1000000002 : Decimal);
    VAR
      Currency@1000000001 : Record 4;
      CurrencyCode2@1000000000 : Code[10];
    BEGIN
      IF "Currency Code" <> '' THEN
        Currency.GET("Currency Code");

      "Entry No." := VendLedgEntry2."Entry No.";
      "Document Type" := FORMAT(VendLedgEntry2."Document Type");
      "Document No." := VendLedgEntry2."Document No.";
      "External Document No." := VendLedgEntry2."External Document No.";
      "Document Date" := VendLedgEntry2."Document Date";
      CurrencyCode2 := VendLedgEntry2."Currency Code";
      VendLedgEntry2.CALCFIELDS("Remaining Amount");
      Amount := -(VendLedgEntry2."Remaining Amount" - VendLedgEntry2."Remaining Pmt. Disc. Possible" -
        VendLedgEntry2."Accepted Payment Tolerance");
      LineAmount2 :=
        ROUND(
          ExchangeAmt(VendLedgEntry2."Posting Date","Currency Code",CurrencyCode2,Amount),
          Currency."Amount Rounding Precision");
      IF ((((VendLedgEntry2."Document Type" = VendLedgEntry2."Document Type"::Invoice) AND
            (LineAmount2 <= RemainingAmount2)) OR
           ((VendLedgEntry2."Document Type" = VendLedgEntry2."Document Type"::"Credit Memo") AND
            (LineAmount2 >= RemainingAmount2))) AND
          ("Posting Date" <= VendLedgEntry2."Pmt. Discount Date")) OR
         VendLedgEntry2."Accepted Pmt. Disc. Tolerance"
      THEN BEGIN
        "Discount Amount" := -VendLedgEntry2."Remaining Pmt. Disc. Possible";
        IF VendLedgEntry2."Accepted Payment Tolerance" <> 0 THEN
          "Discount Amount" := "Discount Amount" - VendLedgEntry2."Accepted Payment Tolerance";
      END ELSE BEGIN
        "Discount Amount" := 0;
      END;
      INSERT;
    END;

    LOCAL PROCEDURE ExchangeAmt@7(PostingDate@1000 : Date;CurrencyCode@1001 : Code[10];CurrencyCode2@1003 : Code[10];Amount@1002 : Decimal) Amount2 : Decimal;
    VAR
      CurrencyExchangeRate@1000000000 : Record 330;
    BEGIN
      IF (CurrencyCode <> '')  AND (CurrencyCode2 = '') THEN
         Amount2 :=
           CurrencyExchangeRate.ExchangeAmtLCYToFCY(
             PostingDate,CurrencyCode,Amount,CurrencyExchangeRate.ExchangeRate(PostingDate,CurrencyCode))
      ELSE IF (CurrencyCode = '') AND (CurrencyCode2 <> '') THEN
        Amount2 :=
          CurrencyExchangeRate.ExchangeAmtFCYToLCY(
            PostingDate,CurrencyCode2,Amount,CurrencyExchangeRate.ExchangeRate(PostingDate,CurrencyCode2))
      ELSE IF (CurrencyCode <> '') AND (CurrencyCode2 <> '') AND (CurrencyCode <> CurrencyCode2) THEN
        Amount2 := CurrencyExchangeRate.ExchangeAmtFCYToFCY(PostingDate,CurrencyCode2,CurrencyCode,Amount)
      ELSE
        Amount2 := Amount;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70303 ForNAV Check Model
{
  OBJECT-PROPERTIES
  {
    Date=15-03-18;
    Time=19:37:48;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Page No.            ;Integer       ;InitValue=1 }
    { 2   ;   ;Part No.            ;Option        ;InitValue=1;
                                                   OptionString=[ ,1,2,3] }
    { 3   ;   ;Line No.            ;Integer       ;InitValue=1 }
    { 6   ;   ;Test                ;Boolean       ;DataClassification=ToBeClassified }
    { 7   ;   ;Void                ;Boolean        }
    { 8   ;   ;Type                ;Option        ;OptionString=[ ,Check,Stub] }
    { 10  ;   ;Check No.           ;Code20         }
    { 11  ;   ;Amount Written in Text;Text250      }
    { 12  ;   ;Amount in Numbers   ;Text250        }
    { 13  ;   ;Pay-to Name         ;Text50         }
    { 14  ;   ;Bank Name           ;Text50         }
    { 30  ;   ;Pay-to Vendor No.   ;Code20        ;DataClassification=ToBeClassified;
                                                   CaptionML=ENU=Pay-to Vendor No. }
    { 31  ;   ;Pay-to Name 2       ;Text50        ;CaptionML=[DAN=Navn 2;
                                                              DEU=Name 2;
                                                              ENU=Pay-to Name 2;
                                                              ESP=Nombre 2;
                                                              FIN=Nimi 2;
                                                              FRA=Nom 2;
                                                              ISL=Heiti 2;
                                                              ITA=Nome 2;
                                                              NLD=Naam 2;
                                                              NOR=Navn 2] }
    { 32  ;   ;Pay-to Address      ;Text50        ;CaptionML=[DAN=Adresse;
                                                              DEU=Adresse;
                                                              ENU=Pay-to Address;
                                                              ESP=Direcci¢n;
                                                              FIN=Osoite;
                                                              FRA=Adresse;
                                                              ISL=A–setur;
                                                              ITA=Indirizzo;
                                                              NLD=Adres;
                                                              NOR=Adresse] }
    { 33  ;   ;Pay-to Address 2    ;Text50        ;CaptionML=[DAN=Adresse 2;
                                                              DEU=Adresse 2;
                                                              ENU=Pay-to Address 2;
                                                              ESP=Direcci¢n 2;
                                                              FIN=Osoite 2;
                                                              FRA=Adresse (2äme ligne);
                                                              ISL=A–setur 2;
                                                              ITA=Indirizzo 2;
                                                              NLD=Adres 2;
                                                              NOR=Adresse 2] }
    { 34  ;   ;Pay-to City         ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DAN=By;
                                                              DEU=Ort;
                                                              ENU=Pay-to City;
                                                              ESP=Poblaci¢n;
                                                              FIN=Paikkakunta;
                                                              FRA=Ville;
                                                              ISL=Bër;
                                                              ITA=CittÖ;
                                                              NLD=Plaats;
                                                              NOR=Sted] }
    { 35  ;   ;Pay-to Post Code    ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".Code
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".Code WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DAN=Postnr.;
                                                              DEU=PLZ-Code;
                                                              ENU=Pay-to Post Code;
                                                              ESP=C¢digo postal;
                                                              FIN=Postinro;
                                                              FRA=Code postal;
                                                              ISL=P¢stn£mer;
                                                              ITA=CAP;
                                                              NLD=Postcode;
                                                              NOR=Postnr.] }
    { 36  ;   ;Pay-to County       ;Text30        ;CaptionML=[DAN=Amt;
                                                              DEU=Bundesregion;
                                                              ENU=Pay-to County;
                                                              ESP=Provincia;
                                                              FIN=LÑÑni;
                                                              FRA=RÇgion;
                                                              ISL=SÏsla;
                                                              ITA=Provincia;
                                                              NLD=Provincie;
                                                              NOR=Fylke/delstat] }
    { 37  ;   ;Pay-to Country/Region Code;Code10  ;TableRelation=Country/Region;
                                                   CaptionML=[DAN=Lande-/omrÜdekode;
                                                              DEU=LÑnder-/Regionscode;
                                                              ENU=Pay-to Country/Region Code;
                                                              ESP=C¢d. pa°s/regi¢n;
                                                              FIN=Maa-/aluekoodi;
                                                              FRA=Code pays/rÇgion;
                                                              ISL=Lands-/svë–isk¢ti;
                                                              ITA=Cod. paese;
                                                              NLD=Land-/regiocode;
                                                              NOR=Lands-/regionkode] }
    { 40  ;   ;Name                ;Text50        ;CaptionML=[DAN=Navn;
                                                              DEU=Name;
                                                              ENU=Name;
                                                              ESP=Nombre;
                                                              FIN=Nimi;
                                                              FRA=Nom;
                                                              ISL=Heiti;
                                                              ITA=Nome;
                                                              NLD=Naam;
                                                              NOR=Navn] }
    { 41  ;   ;Name 2              ;Text50        ;CaptionML=[DAN=Navn 2;
                                                              DEU=Name 2;
                                                              ENU=Name 2;
                                                              ESP=Nombre 2;
                                                              FIN=Nimi 2;
                                                              FRA=Nom 2;
                                                              ISL=Heiti 2;
                                                              ITA=Nome 2;
                                                              NLD=Naam 2;
                                                              NOR=Navn 2] }
    { 42  ;   ;Address             ;Text50        ;CaptionML=[DAN=Adresse;
                                                              DEU=Adresse;
                                                              ENU=Address;
                                                              ESP=Direcci¢n;
                                                              FIN=Osoite;
                                                              FRA=Adresse;
                                                              ISL=A–setur;
                                                              ITA=Indirizzo;
                                                              NLD=Adres;
                                                              NOR=Adresse] }
    { 43  ;   ;Address 2           ;Text50        ;CaptionML=[DAN=Adresse 2;
                                                              DEU=Adresse 2;
                                                              ENU=Address 2;
                                                              ESP=Direcci¢n 2;
                                                              FIN=Osoite 2;
                                                              FRA=Adresse (2äme ligne);
                                                              ISL=A–setur 2;
                                                              ITA=Indirizzo 2;
                                                              NLD=Adres 2;
                                                              NOR=Adresse 2] }
    { 44  ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DAN=By;
                                                              DEU=Ort;
                                                              ENU=City;
                                                              ESP=Poblaci¢n;
                                                              FIN=Paikkakunta;
                                                              FRA=Ville;
                                                              ISL=Bër;
                                                              ITA=CittÖ;
                                                              NLD=Plaats;
                                                              NOR=Sted] }
    { 45  ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".Code
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".Code WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DAN=Postnr.;
                                                              DEU=PLZ-Code;
                                                              ENU=Post Code;
                                                              ESP=C¢digo postal;
                                                              FIN=Postinro;
                                                              FRA=Code postal;
                                                              ISL=P¢stn£mer;
                                                              ITA=CAP;
                                                              NLD=Postcode;
                                                              NOR=Postnr.] }
    { 46  ;   ;County              ;Text30        ;CaptionML=[DAN=Amt;
                                                              DEU=Bundesregion;
                                                              ENU=County;
                                                              ESP=Provincia;
                                                              FIN=LÑÑni;
                                                              FRA=RÇgion;
                                                              ISL=SÏsla;
                                                              ITA=Provincia;
                                                              NLD=Provincie;
                                                              NOR=Fylke/delstat] }
    { 47  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[DAN=Lande-/omrÜdekode;
                                                              DEU=LÑnder-/Regionscode;
                                                              ENU=Country/Region Code;
                                                              ESP=C¢d. pa°s/regi¢n;
                                                              FIN=Maa-/aluekoodi;
                                                              FRA=Code pays/rÇgion;
                                                              ISL=Lands-/svë–isk¢ti;
                                                              ITA=Cod. paese;
                                                              NLD=Land-/regiocode;
                                                              NOR=Lands-/regionkode] }
    { 50  ;   ;Document Date       ;Date           }
    { 55  ;   ;Document No.        ;Code20         }
    { 60  ;   ;External Document No.;Text35        }
    { 65  ;   ;Amount              ;Decimal        }
    { 70  ;   ;Discount Amount     ;Decimal        }
    { 75  ;   ;Net Amount          ;Decimal        }
    { 80  ;   ;Document Type       ;Text50         }
    { 85  ;   ;Amount Paid         ;Decimal        }
    { 90  ;   ;Job No.             ;Code20         }
    { 95  ;   ;Currency Code       ;Code10         }
    { 100 ;   ;Posting Date        ;Date           }
  }
  KEYS
  {
    {    ;Page No.,Part No.,Line No.              ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE SetPageAndLineNo@1000000000(VAR NextLineNo@1000000000 : Integer);
    VAR
      CheckSetup@1000000001 : Record 70310;
    BEGIN
      CheckSetup.GET;
      NextLineNo += 1;
      "Part No." := 1;
      IF "Line No." = CheckSetup."No. of Lines (Stub)" THEN BEGIN
        "Page No." += 1;
        NextLineNo := 1;
      END;
      "Line No." := NextLineNo;
    END;

    PROCEDURE Duplicate@1000000001();
    VAR
      CheckSetup@1000000000 : Record 70310;
    BEGIN
      CheckSetup.GET;
      IF CheckSetup.Layout = CheckSetup.Layout::"3 Checks" THEN
        EXIT;

      "Part No." := 2;
      INSERT;

      IF CheckSetup.Layout = CheckSetup.Layout::"Top Check with one Stub" THEN
        EXIT;

      "Part No." := 3;
      INSERT;
    END;

    PROCEDURE SetType@1000000002();
    VAR
      CheckSetup@1000000000 : Record 70310;
    BEGIN
      CheckSetup.GET;
      Type := CheckSetup.GetTypeBasedOnLayout("Part No.");
    END;

    PROCEDURE SetIsVoid@1000000003();
    BEGIN
      Void := "Page No." <> 1;
    END;

    PROCEDURE SetAddress@1000000004();
    VAR
      CompInfo@1000000000 : Record 79;
    BEGIN
      IF Void OR Test THEN BEGIN
        Name := 'XXXXXXXXXXXXXXXXXXXXXXXX';
        Address := 'XXXXXXXXXXXXXXXXXXXXXXXX';
        "Post Code" := 'XXXXX';
        "Country/Region Code" := 'XX';
      END ELSE BEGIN
        CompInfo.GET;
        Name := CompInfo.Name;
        "Name 2" := CompInfo."Name 2";
        Address := CompInfo.Address;
        "Address 2" := CompInfo."Address 2";
        "Post Code" := CompInfo."Post Code";
        City := CompInfo.City;
        County := CompInfo.County;
        "Country/Region Code" := CompInfo."Country/Region Code";
      END;
    END;

    PROCEDURE VoidCheckFields@1000000008();
    BEGIN
      IF NOT (Void OR Test) THEN
        EXIT;

      "Check No." := 'XXXXX';
      "Amount Written in Text" := 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX';
      "Amount in Numbers" := 'XXXXXXXXXXXXX';
    END;

    PROCEDURE SetPayToAddress@1000000005();
    BEGIN
      IF Void OR Test THEN BEGIN
        "Pay-to Name" := 'XXXXXXXXXXXXXXXXXXXXXXXX';
        "Pay-to Name 2" := '';
        "Pay-to Address" := 'XXXXXXXXXXXXXXXXXXXXXXXX';
        "Pay-to Address 2" := '';
        "Pay-to Post Code" := 'XXXXX';
        "Pay-to County" := '';
        "Pay-to Country/Region Code" := 'XX';
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70310 ForNAV Check Setup
{
  OBJECT-PROPERTIES
  {
    Date=28-05-18;
    Time=16:22:40;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10         }
    { 10  ;   ;Layout              ;Option        ;OnValidate=BEGIN
                                                                "No. of Lines (Stub)" := MaxLineNo;
                                                              END;

                                                   OptionString=[ ,Check-Stub-Stub,Stub-Stub-Check,Stub-Check-Stub,3 Checks,Top Check with one Stub,Bottom Check with one Stub,,,Other] }
    { 11  ;   ;No. of Lines (Stub) ;Integer        }
    { 20  ;   ;Watermark           ;BLOB           }
    { 21  ;   ;Watermark File Name ;Text250       ;InitValue=Click to import...;
                                                   CaptionML=ENU=Watermark File Name;
                                                   Editable=No }
    { 30  ;   ;Signature           ;BLOB           }
    { 31  ;   ;Signature File Name ;Text250       ;InitValue=Click to import...;
                                                   CaptionML=ENU=Signature File Name;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE InitSetup@1000000002();
    BEGIN
      IF GET THEN
        EXIT;

      INIT;
      INSERT;
    END;

    LOCAL PROCEDURE MaxLineNo@1000000000() : Integer;
    BEGIN
      CASE Layout OF
        Layout::"3 Checks":
          EXIT(0);
        Layout::"Top Check with one Stub", Layout::"Bottom Check with one Stub":
          EXIT(20);
        ELSE
          EXIT(9);
      END;
    END;

    PROCEDURE GetTypeBasedOnLayout@1000000001(PartNo@1000000000 : Integer) : Integer;
    VAR
      Model@1000000001 : Record 70303;
      NoImplementedErr@1000000002 : TextConst 'ENU=This is not implemented, please contact your ForNAV partner.';
    BEGIN
      CASE Layout OF
        Layout::"3 Checks":
          EXIT(Model.Type::Check);
        Layout::"Top Check with one Stub":
          CASE PartNo OF
            1: EXIT(Model.Type::Check);
            2: EXIT(Model.Type::Stub);
            3: EXIT(Model.Type::" ");
          END;
        Layout::"Bottom Check with one Stub":
          CASE PartNo OF
            1: EXIT(Model.Type::Stub);
            2: EXIT(Model.Type::Check);
            3: EXIT(Model.Type::" ");
          END;
        Layout::"Check-Stub-Stub":
          CASE PartNo OF
            1: EXIT(Model.Type::Check);
            2: EXIT(Model.Type::Stub);
            3: EXIT(Model.Type::Stub);
          END;
        Layout::Other:
          ERROR(NoImplementedErr);
        Layout::"Stub-Check-Stub":
          CASE PartNo OF
            1: EXIT(Model.Type::Stub);
            2: EXIT(Model.Type::Check);
            3: EXIT(Model.Type::Stub);
          END;
        Layout::"Stub-Stub-Check":
          CASE PartNo OF
            1: EXIT(Model.Type::Stub);
            2: EXIT(Model.Type::Stub);
            3: EXIT(Model.Type::Check);
          END;
      END;
    END;

    PROCEDURE ImportWatermarkFromClientFile@21(Which@1000 : Integer) : Boolean;
    VAR
      ReadCheckWatermarks@1002 : Codeunit 70306;
    BEGIN
      EXIT(ReadCheckWatermarks.ReadFromFile(Rec, Which));
    END;

    PROCEDURE DesignTemplatePortrait@1000000003();
    VAR
      Template@1000 : Report 70527;
    BEGIN
      Template.RUNMODAL;
    END;

    PROCEDURE DesignTemplateLandscape@9();
    VAR
      Template@1000 : Report 70526;
    BEGIN
      Template.RUNMODAL;
    END;

    PROCEDURE DownloadWatermarks@6();
    BEGIN
      HYPERLINK('http://www.fornav.com/report-watermarks/');
    END;

    PROCEDURE SetDefault@1000000004(Setup@1000000001 : Record 70000);
    VAR
      CheckSetup@1000000000 : Codeunit 70010;
    BEGIN
      CheckSetup.SetCheckType(Setup, Rec);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70900 ForNAV Captions
{
  OBJECT-PROPERTIES
  {
    Date=14-01-18;
    Time=14:49:20;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    DataPerCompany=No;
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=NLD=Primary Key }
    { 2   ;   ;Unit Price          ;Boolean       ;CaptionML=[ENU=Unit Price;
                                                              NLD=Unit Price;
                                                              ESM=Precio unitario;
                                                              FRC=Prix unitaire;
                                                              ENC=Unit Price] }
    { 3   ;   ;No.                 ;Boolean       ;CaptionML=[ENU=No.;
                                                              NLD=Nr.] }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70998 ForNAV Sales Tax Buffer
{
  OBJECT-PROPERTIES
  {
    Date=17-07-17;
    Time=15:23:01;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10         }
    { 2   ;   ;Exempt Amount       ;Decimal        }
    { 3   ;   ;Taxable Amount      ;Decimal        }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70999 ForNAV Document Line Buffer
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;VAT %               ;Decimal       ;CaptionML=[ENU=VAT %;
                                                              NLD=Btw %];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 2   ;   ;VAT Base            ;Decimal       ;CaptionML=[ENU=VAT Base;
                                                              NLD=Basisbedrag btw];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 3   ;   ;VAT Amount          ;Decimal       ;CaptionML=[ENU=VAT Amount;
                                                              NLD=Btw-bedrag];
                                                   AutoFormatType=1 }
    { 4   ;   ;Amount Including VAT;Decimal       ;CaptionML=[ENU=Amount Including VAT;
                                                              NLD=Bedrag incl. btw];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5   ;   ;VAT Identifier      ;Code10        ;CaptionML=[ENU=VAT Identifier;
                                                              NLD=Btw-identificatie];
                                                   Editable=No }
    { 6   ;   ;Line Amount         ;Decimal       ;CaptionML=[ENU=Line Amount;
                                                              NLD=Regelbedrag];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 7   ;   ;Inv. Disc. Base Amount;Decimal     ;CaptionML=[ENU=Inv. Disc. Base Amount;
                                                              NLD=Basisbedrag factuurkorting];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 8   ;   ;Invoice Discount Amount;Decimal    ;CaptionML=[ENU=Invoice Discount Amount;
                                                              NLD=Bedrag factuurkorting];
                                                   AutoFormatType=1 }
    { 9   ;   ;VAT Calculation Type;Option        ;CaptionML=[ENU=VAT Calculation Type;
                                                              NLD=Btw-berekening];
                                                   OptionCaptionML=[ENU=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                                    NLD=Normaal,Verlegging,Volledig,Sales tax];
                                                   OptionString=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                   Editable=No }
    { 10  ;   ;Tax Group Code      ;Code10        ;TableRelation="Tax Group";
                                                   CaptionML=[ENU=Tax Group Code;
                                                              NLD=Tax Group Code];
                                                   Editable=No }
    { 11  ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NLD=Aantal];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 12  ;   ;Modified            ;Boolean       ;CaptionML=[ENU=Modified;
                                                              NLD=Gewijzigd] }
    { 13  ;   ;Use Tax             ;Boolean       ;CaptionML=[ENU=Use Tax;
                                                              NLD=Use Tax] }
    { 14  ;   ;Calculated VAT Amount;Decimal      ;CaptionML=[ENU=Calculated VAT Amount;
                                                              NLD=Berekend btw-bedrag];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 15  ;   ;VAT Difference      ;Decimal       ;CaptionML=[ENU=VAT Difference;
                                                              NLD=Btw-verschil];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 16  ;   ;Positive            ;Boolean       ;CaptionML=[ENU=Positive;
                                                              NLD=Positief] }
    { 17  ;   ;Includes Prepayment ;Boolean       ;CaptionML=[ENU=Includes Prepayment;
                                                              NLD=Inclusief vooruitbetaling] }
    { 18  ;   ;VAT Clause Code     ;Code10        ;TableRelation="VAT Clause";
                                                   CaptionML=[ENU=VAT Clause Code;
                                                              NLD=Code btw-clausule] }
    { 19  ;   ;Tax Category        ;Code10        ;CaptionML=[ENU=Tax Category;
                                                              NLD=Belastingcategorie] }
    { 70000;  ;Line No.            ;Integer        }
    { 70001;  ;Amount              ;Decimal        }
    { 70002;  ;Allow Invoice Disc. ;Boolean        }
    { 70003;  ;Inv. Discount Amount;Decimal        }
  }
  KEYS
  {
    {    ;Line No.                                ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE CreateForRecRef@1000000000(VAR RecRef@1000000000 : RecordRef);
    VAR
      Fld@1000000002 : Record 2000000041;
    BEGIN
      FindAndSetField(RecRef, 'Line No.', 70000);

      Fld.SETRANGE(TableNo, DATABASE::"ForNAV Document Line Buffer");
      Fld.SETFILTER("No.", '<>70000');
      Fld.FINDSET;
      REPEAT
        FindAndSetField(RecRef, Fld.FieldName, Fld."No.");
      UNTIL Fld.NEXT = 0;
    END;

    LOCAL PROCEDURE FindAndSetField@1000000004(VAR RecRef@1000000003 : RecordRef;FieldName@1000000002 : Text;FieldNo@1000000004 : Integer);
    VAR
      FldRef@1000000001 : FieldRef;
      Fld@1000000000 : Record 2000000041;
      ThisRecRef@1000000006 : RecordRef;
      ThisFld@1000000005 : FieldRef;
    BEGIN
      Fld.SETRANGE(TableNo, RecRef.NUMBER);
      Fld.SETRANGE(FieldName, FieldName);
      IF NOT Fld.FINDFIRST THEN
        EXIT;

      FldRef := RecRef.FIELD(Fld."No.");

      ThisRecRef.GETTABLE(Rec);
      ThisFld := ThisRecRef.FIELD(FieldNo);
      ThisFld.VALUE := FldRef.VALUE;

      ThisRecRef.SETTABLE(Rec);
      IF FieldNo = 70000 THEN
        INSERT
      ELSE
        MODIFY;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Report 70000 ForNAV VAT Order Confirmation
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:16;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Objedn†vka;
               DAN=Ordre;
               DEU=Auftrag;
               ENU=Order;
               FIN=Tilaus;
               FRA=Commande;
               ISL=Pîntun;
               ITA=Ordine;
               NLD=Order;
               NOR=Ordre;
               SVE=Order;
               DES=Auftrag;
               ENG=Order;
               ESM=Pedido;
               FRB=Commande;
               ITS=Ordine;
               NLB=Order;
               DEA=Auftrag;
               ENA=Order;
               ESN=Pedido;
               FRC=Commande;
               ENC=Order;
               FRS=Commande;
               ENZ=Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Order));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>+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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70001 ForNAV VAT Sales Invoice
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:16;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Faktura;
               DAN=Faktura;
               DEU=Rechnung;
               ENU=Invoice;
               FIN=Lasku;
               FRA=Facture;
               ISL=Reikningur;
               ITA=Fattura;
               NLD=Factuur;
               NOR=Faktura;
               SVE=Faktura;
               DES=Rechnung;
               ENG=Invoice;
               ESM=Factura;
               FRB=Facture;
               ITS=Fattura;
               NLB=Factuur;
               DEA=Rechnung;
               ENA=Invoice;
               ESN=Factura;
               FRC=Facture;
               ENC=Invoice;
               FRS=Facture;
               ENZ=Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  Name=NoOfCopies;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE GetNoOfCopies@1000000006() : Integer;
    VAR
      GetNoofCopies@1000000000 : Codeunit 70007;
    BEGIN
      EXIT(NoOfCopies + GetNoofCopies.GetNoOfCopies(Header));
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70002 ForNAV VAT Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:16;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Dobropis;
               DAN=Kreditnota;
               DEU=Gutschrift;
               ENU=Credit Memo;
               FIN=Hyvityslasku;
               FRA=Avoir;
               ISL=Kreditreikningur;
               ITA=Nota credito;
               NLD=Creditnota;
               NOR=Kreditnota;
               SVE=Kreditnota;
               DES=Gutschrift;
               ENG=Credit Memo;
               ESM=Nota de crÇdito;
               FRB=Avoir;
               ITS=Nota credito;
               NLB=Creditnota;
               DEA=Gutschrift;
               ENA=CR/Adj Note;
               ESN=Abono;
               FRC=Note de crÇdit;
               ENC=Credit Memo;
               FRS=Avoir;
               ENZ=Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table114;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table115;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70003 ForNAV Sales Shipment
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:16;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Prodejn° dod†vka;
               DAN=Salgsleverance;
               DEU=Verkaufslieferung;
               ENU=Sales Shipment;
               FIN=Myyntitoimitus;
               FRA=ExpÇdition vente;
               ISL=Sîluafhending;
               ITA=Spedizione vendita;
               NLD=Verkoopverzending;
               NOR=F˚lgeseddel;
               SVE=Utleverans;
               DES=Verkaufslieferung;
               ENG=Sales Shipment;
               ESM=Remisi¢n de venta;
               FRB=ExpÇdition vente;
               ITS=Spedizione vendita;
               NLB=Verkoopverzending;
               DEA=Verkaufslieferung;
               ENA=Sales Shipment;
               ESN=Albar†n de venta;
               FRC=Livraison de vente;
               ENC=Sales Shipment;
               FRS=ExpÇdition vente;
               ENZ=Sales Shipment];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table110;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table111;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70004 ForNAV VAT Sales Quote
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:16;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=ENU=Quote;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70010 ForNAV Warehouse Shipment
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:16;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=NLD=Warehouse Shipment;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;Header            ;
               DataItemTable=Table7320;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                END;

               ReqFilterFields=No.,Location Code }

    { 1000000001;1;DataItem;Line             ;
               DataItemTable=Table7321;
               DataItemTableView=SORTING(No.,Bin Code);
               CalcFields=Pick Qty.;
               DataItemLink=No.=FIELD(No.) }

    { 1000000002;2;DataItem;BOMComponent     ;
               DataItemTable=Table90;
               DataItemTableView=SORTING(Parent Item No.,Line No.);
               DataItemLink=Parent Item No.=FIELD(Item No.) }

    { 1000000003;2;DataItem;CommentLine      ;
               DataItemTable=Table44;
               DataItemTableView=SORTING(Document Type,No.,Document Line No.,Line No.)
                                 WHERE(Document Type=CONST(Order));
               DataItemLink=No.=FIELD(Source No.),
                            Document Line No.=FIELD(Source Line No.) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             PLK=Opcje;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Line': WITH Line DO CASE ForNavOperation OF
        END;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>uEsAAO1c63LbuBX+35m+A6vOrp2uViZAgACy0e74mngaX9Z2kp12OhmKgmxuKFKlqCTatjN9mj5Yn6QACd5BmpKc7p/N1SRxOVec8x2AfPHD57lvfOTR0guD8QCMzIHBAzecesH9eLCKZ9/SwQ/f//53L36KI+eGL8IoXr521uEqvuWR5/jeLzwyih/f5gOhERxhOVrl1sC4dOZ8PFAjnYXRpfNxYByHQRyF/t16IZ6d8I+nnxcRXy5HpUlHb85Ll3BotDT7KKcZZrMaYyOjZGgcr/x4FXFxL+Ar0cUfGterie+5f+bru/ADl62nxHUop9AkM8SRKeg/8ZYL31mndEuCD98a75yIP4SrJTduH7zFnAfxwKiwlDNticnNEUBMsH41+Zm78WU4HhDTBGLoM4/703d8IuT30XP5m8gfDx7iePH84GDKlx/icPGt8zD/6MXmc2IienCyDpy55y4FCQCYB1cnTuwcHIfzhROs9/eOb64u39x+Bc1jJ3CmzlfwWPx8HrijvWcD49q556+4d/8QjweQETO9886bxg/iBpCMXjjRvRcsk8uhIf5AM/0n4+1N4Ined4Lbh+XV7PDC831vzmMeCSEtPNEPo4Fx6H9y1svXfBYfTn9eLePjcMrfOv6Ki4HjaMUF10LZ48Etvw+58eZ8aNBFPDTcBye65fFYTHYVXEc8nfHWjbxFnIldPF8tRi95vP/su6//+PlE/nP4XfnZseO7iVCX+3uvw/twr9xQCeo8mIXR3ImFetRYA2HfhvHiyAmmy+RHcXEe8zlQxvqKO1PJZMVKUz1LDcimsq+wbf5JSvWaRzfcDaNpxnHW6q0TVUfMHtw5E1/cTv4jFkwk/vczzxeyTdkZDy7D0fB16CZ0G1KoA+NcTCA0p34pwWVDZqIbKI5qDJaYvOEzYada9lI6FXMJ5Sehu5L2nnOQK/7Wuw8c6V/jwQSY7sxGiLmEIXsC0Ixim9ucYmc2IzPbYZY1sye2MMLIC+Kr4FQsQGspukxit8JRBKP6OVM7PhNEI3NQ4kdwpHhYVu5WOUVaTu/45/go/JyxeRkeOwtJgeTrF34mnYaNGGP20BaSzhRx5oeOkLE5EvK3oPArQoTHANnStjEti0dOMB7899//uQxTvQuLTXRbtohRckdNvRzJpgc6VmDKCu7HSsEDRjryLTNhwLTAbsS3kmul5Np9yD1eRVHq/O+lQeS0A5JSCaBgISEXYKupiaEBcMoBZdqlRt6M+HHoh9F4cOQ77oeBcSR8VSzY4jqM43Be5vxVGP1y6AvTFjFLWl1JFil58jJpIC10PLjwplOfq6ZNSRXcjZLuNWkJed3Ga58LtwgjL16nciMD482Sp7zMHH/J1XXORnEz56S4VSNQPWjo6SBRlE57KKWCbqi9ugOJYKr1HRFqWmLCUopifBT6U53StDqScaekopwGrZbSxp1KygbopSfWX0+bKAXplILTKWUWodHKtefKlbismEbwe68aNTQiQ0qilPLanqhQuOAwcy+5QHTZfofjyMicjJnkmH8Jw/n5PPGlpirKwT3p1ksRAGwsZKwTsq2Gg31M//Qzd1dSjHciKcqflYw/ERxjROcCxbPHsqM+Zn8XTp319kafdu8naUtr85tI3tZJnqjhewVrMWF0Pq2LXAVsZrOWZQeAtIGlDxQbSz0lY3uxq/795I53ljvRyZ2q4XuF6kykaTbanWNk2rCYyDGoqU0uquO1phnVZmfJenYbR8li0pKAMMUW2ZStHbJAqg9ru3BezQ6rnbR8A1MxTjPmjpxItgdaQaiH5fU+4WkIYJNdloqC5jkjwWXerp1pWkOAeCj+mOJ3ig9XcXgRTlcS7yj77EwoUxlJXJmb9V24UCElG0jAe6pznPV8IiLvfeY0rIiGQgSQtrkGMKuo4kADK1TLOpyCmRF5Ae+BGLOraycSrElAl4PNHMqOByJSfzB+jNejgfEyCleLuzB2/Owh0ODLdPYWdAlqT956/JMw0qubu/PLl/sSZx55KcR8VrQUI35IQOj47Pz09Yls9qyGQEENi9XhZmGVqTpgixGG03UZccrrFpxpI+o4HOKJS1wyQSbDJkCMQ5tR5k5cxh0EHArdGp5MR8xRpIITpqUzoRZA2eAlr2zdPjiLFvdKHuXOhUVG0PQqYCMs0oEyw0ci3VUJ5LsHL9aAhtTY5eiKGhGVk8us2ObGTnDva1aJrG8zwkCUAopi8pZooneGmlOkQ+KyThPbq8nppxt1twT6OvKmyoJbiSnHTiA85ZMqJ+iZvgk/6dTaUK1dplp00tOcPCgIeKdqbeYI24QJ1Goh9YOemtTYuK+1NC1Z9Vim6JBjZATL5gli15BFsI0EUSaCAEKC5GLYXIflOjLKRsmjVXZDb0wavdeho4bUE75MClZJsG3SC0bERowJbTNMmA0JbCW3MtLFyo89eTsrLOVMVJpVzeVxxlRBA7LHGRNrqYrqOtsQ4qeQUkZsbBEo85MWrvJhcgbyO49SqwC8VceKGmp/XDlBLNYAbSQXEbyI43UmhG4sgqGsurSwUIyd85Df6mBBvzxZKcTLaetYnPJhtGi6IS2FrK066NNI63S+iNfyBtCr11SiIaZFEAMI6GTTCRjqaGNzOVkbAIOmtOqwuCEtBZGtOlDTSEtuH1zNLrizXMmKSJtPINNC0EbCliyL2iZtX5jkgGF1wA1EWQJujXE2FzPeScx1DNwQs8LDVh2XdRkl1MvXMiEmJqQACzRmWRh+YQMkO0mmjlLLz7vCZXtGIp+1hP60E2xLY9Sqb9FKrqffOemV62FmDg2UZDeU2LvlfLKKsWvOh8yNc756xbgFLalHSTgWQ6/mgZoRtGKwjn0PpC/INXer5DLRuVOFpjbEcIItGzqTCUIWI7OJa2Ewsa0ZnuKJwxxI2LSGIMrj5jhCbqJuDSCQNajsNvbOjpOtW21NPWd4p/QXoSphmyfADNnYhCYmNrCATW3riTJgVN/+as2A8ypOQd6jGw71TJmJWAQZMAHGrQGpWp8p582lpS/dY0pX17c8itXqmm09NcJUewqrJth4SUb2DsXDyuAdi2xJX5nX9kAspax8F6WlcIEyDGwGTQit9sS6qrMKKvhiiivPsrn26JNqTxftKtpTUQ/1xzq7uVuaMxPAbCTWYdyOJ6qaqwCkL6K1bIaNNYbNJ9VYM+TWNKbwHq5XoTrwnkZleti3uSItZJmmCFUSIvTSZBUnNlSpSr/duszqw63K3B55yoRZo806Et1BwX0hKq6nnq1oIBUteFL1KnBLTJsCylBLmtEpSfSlJdkXvuIeqUQDvu62zKUwFxBAbYKQSft6x+Og9+lWvCcAxvhpc42+QBn3yDXKrgG31KIE0zaTSS2FABGRZ2wuoaeN578CYG52asWA+pxD5Rkqibi6kIdVwiA5VbvFDlp18yvfE6uOq9sbY2bnzlg6gyGfGslpTDGPke6DVXfJag3Vjll2Wd8202wIaLfOckEp+GPrj/40ts+uLjp20DByJlNAJwJJziZIrOYQcQFxqMkmE5u7M8eacG6auL6Dlg1a2kRrgZkd+LfBEagUVvRnP/4vhZWEslJxxYabFVfS/k1ft60NCiyFv7QhrDK6slFFePoKyRfdgWwIDT+R0OythNYGbConUkkmtFj6e0s+VSq4AGsEbEph+0nG7qpLQkBH5SUnMHMJWiFQ9Gyh8Qm2H5O5HyvANAjsAQvj7IY8LdYZZium9tLxguUkjMJKMYZRYDFiib/MIky7o1Je6UeVncvHqiUJd7oTuHoE198k88EfrZjkAlZ+TXqguELAaEcBgxG1oSW3X6hli4xGv51XEXCjZLJZiaNV5HqYta3Iu8ocucjVqkB64KpC5PbONo0taDILY8s2sXBU4VLbSUwPp7aVWFeZIZeYKjWQHvipkBh5IolBChi1IEPawwAVI83g/oJHf9JuRvdsvZ1i9BhoW8V0lQdyxagSAemBg3LFQLCzYkypGYFobcSgMGVLGsZT7S62ilcPoJri3QpVFXLvKibkclcFBbJRWKQ7yx0JGEowxBDYQHgGtR/1iF9p87xNibRvhN1RiV0FhFyJqohANwm90NxZiRZGkJmUEIYsG0NZcf/SvkP7Rtkdxd5elUjbPLrv90je1FqhKDrr41nHbnXyuLFjTa3NjkC+ONCeg+163Sp/Y0cKeuuDxC1lkMqwuioIQp1VkOxlTEPSMpR1kPxOVhApKiPGu1enN6fVPuPjq8vbu/0r+aLas44TxrfhKnLTYYZGY45qo2LCWnFFs9fcq7hC9a9W1osrSphtxRXMXIkWKWa2Y08hIC6GhGBuysDoTsypixgg9cMF+aBPWlyhvV7pUJe0gLwIkxFAlkm0b3UgOKKYgNrp2+L9u1w+zRdfCjsc5c1ajqps7KPk6Xy06+07qn8n8iwM4+o5lPROS0nlLnKC5SLx28q2jFlsy1z7jsvPg7SEn78jXViaCSaUE4qAPcMTy53NJnwmzAzaMzqDnE3JxKbWxHHLp1XkYZ+K3Skitz7CQus5j9bC0lMk7xNLSF5mWL6/dtbv4/BwOpUfc7Brx1vQBq+Mlt7kvQsXLW9tHQs5S120bHv8VfOZgOsHkTNdhobxh7Gxt2f8YGjaVHdpsh7fGHvGc/H3G12XfNjnRrDy/aHR+a2C0/cXjuf3J0G176RAtVHzd07/Kpxz+cryBkLIu3TSkLfqJYW3h3c3/N5bxlFyLaTXm5xm14wuPWHN9r0oPD86vOxPVNK6Uz5Ji14z3747P7uTKfgGOir6dBJRNEsp+duooGSWfKdif7YKksXE2P/o+M+Mf0RcrE2BIS6++9ez0c+hF+zvGf805MdItFlt5pfNUPGbS/7mkr+55Bd1yd5HhFkLTt/2uxPdaVnnLnK1HtPM4eqF32qL8qTlJy/ST/fUPgSU8i7P6KZfb5KHbhtfKCi4KxfwGVK9Sm+f1pWZ9RQwNp/9xUHHJ7e+/x8=</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70011 ForNAV Warehouse Receipt
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:16;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=ENU=Warehouse Receipt;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;Header            ;
               DataItemTable=Table7316;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                END;

               ReqFilterFields=No.,Location Code }

    { 1000000001;1;DataItem;Line             ;
               DataItemTable=Table7317;
               DataItemTableView=SORTING(No.,Bin Code);
               DataItemLink=No.=FIELD(No.) }

    { 1000000002;2;DataItem;BOMComponent     ;
               DataItemTable=Table90;
               DataItemTableView=SORTING(Parent Item No.,Line No.);
               DataItemLink=Parent Item No.=FIELD(Item No.) }

    { 1000000003;2;DataItem;CommentLine      ;
               DataItemTable=Table43;
               DataItemTableView=SORTING(Document Type,No.,Document Line No.,Line No.)
                                 WHERE(Document Type=CONST(Order));
               DataItemLink=No.=FIELD(Source No.),
                            Document Line No.=FIELD(Source Line No.) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             PLK=Opcje;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Line': WITH Line DO CASE ForNavOperation OF
        END;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70050 ForNAV Tax Order Confirmation
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:17;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Objedn†vka;
               DAN=Ordre;
               DEU=Auftrag;
               ENU=Order;
               FIN=Tilaus;
               FRA=Commande;
               ISL=Pîntun;
               ITA=Ordine;
               NLD=Order;
               NOR=Ordre;
               SVE=Order;
               DES=Auftrag;
               ENG=Order;
               ESM=Pedido;
               FRB=Commande;
               ITS=Ordine;
               NLB=Order;
               DEA=Auftrag;
               ENA=Order;
               ESN=Pedido;
               FRC=Commande;
               ENC=Order;
               FRS=Commande;
               ENZ=Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Order));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70051 ForNAV Tax Sales Invoice
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:17;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Faktura;
               DAN=Faktura;
               DEU=Rechnung;
               ENU=Invoice;
               FIN=Lasku;
               FRA=Facture;
               ISL=Reikningur;
               ITA=Fattura;
               NLD=Factuur;
               NOR=Faktura;
               SVE=Faktura;
               DES=Rechnung;
               ENG=Invoice;
               ESM=Factura;
               FRB=Facture;
               ITS=Fattura;
               NLB=Factuur;
               DEA=Rechnung;
               ENA=Invoice;
               ESN=Factura;
               FRC=Facture;
               ENC=Invoice;
               FRS=Facture;
               ENZ=Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70052 ForNAV Tax Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:17;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Dobropis;
               DAN=Kreditnota;
               DEU=Gutschrift;
               ENU=Credit Memo;
               FIN=Hyvityslasku;
               FRA=Avoir;
               ISL=Kreditreikningur;
               ITA=Nota credito;
               NLD=Creditnota;
               NOR=Kreditnota;
               SVE=Kreditnota;
               DES=Gutschrift;
               ENG=Credit Memo;
               ESM=Nota de crÇdito;
               FRB=Avoir;
               ITS=Nota credito;
               NLB=Creditnota;
               DEA=Gutschrift;
               ENA=CR/Adj Note;
               ESN=Abono;
               FRC=Note de crÇdit;
               ENC=Credit Memo;
               FRS=Avoir;
               ENZ=Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table114;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table115;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70054 ForNAV Tax Sales Quote
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:17;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=ENU=Quote;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>z4EAAO1d63LbOJb+v1X7DhxtzdiuVcu4kCDYsabLl6Tjasf22E66a7a2XBQJ2ZzQooaiEnsuVfs0+2DzJAOQIMULKIGS7Hh7Jz8ciSKAg/MdAOd8AA8Pfnh8CI0vLJ4F0WTYgwPQM9jEi/xgcjfszZPxd7T3w+///d8Ofkli94pNoziZnblP0Ty5ZnHghsFfWGwsPn4qKjIHaGCJ2iqXesa5+8CGPVnTuyg+d7/0jONoksRRePM05b+dsC9vH6cxm80GpUYHH09LX1HfaLnti2imn7dqDI1ckr5xPA+Tecz4tQmb8yJh37icj8LA+4k93USfmbjbtz2XMoqAPTaZCbj8J8FsGrpPmdxC4MNPxo37aFy7IZsZf5hHCesZlf4UPca8ZTCApsP7fTH6E/OS82jYswGwzJ7xLmCh/zMbceV9CTz2MQ6HvfskmX6/v++z2eckmn7n3j98CRLwvQ1Mun/yNHEfAm/G24cQ7F+cuIm7fxw9TN3J0+7O8dXF+cfr3yJw7E5c3/0tOuafTyfeYGevZ1y6d+w9C+7uk2EP2Y6ZXfk58JN7fgFajrgwZfFPwcQf9s5YkrC4Z3xw47tgMuPdAFx5/K6+gcQnJLTyjiM27B0K3PuGM036hnfvxtcsGQqVTQNer+hkppePk4DffMMmyf3sYnz4IQjD4IGljVxMLmOW3fXBnfFL114cTJNC05mWb9jDNBzkX9zHHrdIwzg4cif+LP3Iv5wm7AFK83rPXF/UXrGrDByhNnGrKMutkX0Vqrhk8RXzopj3PonnHM9jN/RSgHj3Dx+i+SQxuDLDuRgWxqfDm352sWfcRIkb5ncS0CewZ/wYR/Np5QfMdSLb/eTGVRnzH27cUcgvp/9hUrv+KWBfh73ri6ub0/Mfd8+jwZ7x8/u3V293TyJv/sAVa6R9PL44v77ZTW1yb09o/8/vgpArNZeDF+xfRrNE9ILXLzoaTQPGf4EctlPefSRKzVgitHI+fxixOFdJilQuVI5ST2q/BkYJkCs2TvuvgCLTgAQi1Unem0I3hSEdud7n4yiMuDhH3JJTiCbX93Ew+Tzsjd1wxq9c8m/cih4vJp5AVHSh+tvF5C2f6Z6yH7JeSaPjQzMdsUutrl8X7zAMo6+ZKt7GcRTP8lqvg7uJK+aaYc/1TYvYbGyNiEU9xtDYJo4zwtaYf0VjaCHbt7DJNSSFUGsiG77vhj2KwQAAAHslVXNlS/XOKlerIJhKEG7YY3IUPfYqI+f2ZM4y+7jmszpvFdO0VWSafcsZOPwfr+0s8lwh8bswcrktQAzTnyjtG8TOPuYTxTW7i5jx8bRv0GkiLsYsRzPkyJaRFgIdhlyBovvD3ofA90N2JXrPtRDFf0l/4ytIdkXcPez943/+t5BYmCifh1KTL/dpkN9RUxFX0nXyFDJuIVEcJE+Zsqye8XHGMuGlCaXfC7kXF2sCyx/260jsp1Co8EFZk0QHn+N5HGfT5e11wkeOG/vH7lSgMLvlY/mpQIyvXX0CGiDx+dsioAWWKgipWrM6mzpdyDGoyzFIy2hp2W5qWa03pNIbziqhHew67cFZFH2eT2e3l+6TgOyGxQ+zEzZLxzHvQNnouQrT0YYQVNg74tq0cWrptkVeztZbBW+1/XK/B23FtSBznmdgYBXAZtakWJs2R1ia5wJdlEILCJQgA9KEGIAFxI4S4L4xE0oaHkWhvxrsBnyFVN2hy4tqwQahJm5qeEwVPJasGnWFp5ixGstMGZMWNJYuLWugsXrhqMjcbRmBeCO1Wyq1E1l1l/W8pnbpXNR1v0Tp2dLu4K0NgqoMurovF9IDQHchVwNAVADYsmqtBVsJwEXMr51Hq3T/DNZetKyp8fx+PWUr1vMOyrZVyqay6rVX+eP5LIkeWKyY/9t0vnVjb8igN9vXi+mBoLtCq0GgKhCcrGrUeSFOQ+HZ7RGP+G+T6ND3BV9T8VFROuVjRJsOVsY6cCgIoWooOnlXN9H0jI2TlJFKpGfFr1U8reyGDLcyIlk/BvV+LIdRXUgLRKS7XHd0sxxlfAhko1oLuaScTifjKH5I4apA3RFjiIH0sLcOtvSal6Bd96uX4NrsdQXjbuDqOgVdg0ugRFeG/0jLXyjFl/UJM/UEWkJKoAgpIeg6VzZCoWw4tozPUggqRTX+09j53tjh/8lhqF7o9ArqQflcPIGSKICSKUBqz+My8ATntHysypta/LwKeStxt/kP+dC06NpB61l0lzk86c7CH6Po4fTBvVP6fhkLx6/Np4O0mB4Wdnc1K3kFKIkFpOVzlEbMZdofqTakHi3QAm0D5vnoArWaS+MgvUVPy89EAEAlAwAlBYC7eB5ywc29p5KfbVpKTFIiZ4XXt31k5FSjkLbVrWjeq4UZfiZvAippASh5AdyZF1B6i3SBnpkh1M7XSP4AUszxpC84xFaHVZ0CKfxcHoKSUICSUcCddgiUHEKHbQILfoMxp088dKca8HP5AlUS4mBfsdfT3F0o7yxgtb/wLoqS6v5bdmX5vtslx4GdTo6ihM9B+YZX2/basi255gZep824XNbSXhskEDLbgrY9pojP9WMiNtwcHn4gyweeDx0TUWqj2l5bXlOxxwZNMqAQWXiNXTZsb2XWIwu32y4iJIIHyAYUiw37phOut6vTGDHH/HPa+8WQyS99mIdJcBZMCjizQfRfv/uPx5M3/M/hG0VY9Onw5ordBbMkTr+fR8ZvhsbOjvGD0RZDFWRTsyj3yw3hmPMPWk19b0zmYdg3lkp4eR9NGL9ZX7C8RC6OUpqiWi0h3t5+cINQXwR5/1IJ5D2y/aXNv+f+gxiNHZRQFFkqQ3FXUwv/PVh8HqfnEnbH80k6EI3dL264Z/w15j5/PDH4lzd/3xv8KQomuzvG3wxxiKU5U//LDv9lhy9uh3quAFW6Ats6KSDcpW0Rdaiy0LTwO1Suh80Vhiw4ntPEDQNvk/UmW15+ZMkZu3ND3kM/SCHf3XujGv/qG7UAMsHGACFdrwzVvTIsARIrq8YZtfzbpRtzqcQhrfxQUOWMmQjMG4fMsiaUR8zspUfMinNl4siYqEV82FsU4Zc+c00yLpKnOMx2lrp15UqG707fnp2kR9f6RvXUWvZL5dqekR1HwzUHrH7IrO59meqY8yjyn8p+rujQTFxc4eo+n/dakqDiwJomcW3gu3hE3TG2CXBNz/Et6JvQ8sDYYtSB/rjmwJYqK3xYPpCbI6HFf21oEVcUlZpHTa+/XMmrqyePMqeoaJg3fRV9VYnUEMusiMVLqYVKf1jg+rM8+QoGFrEd7kdjU35Qi5NpioVKNSnlstRyiDrKEt+mBEEhl9JZL8JUce9CcmI6Jo9cCICQ2sBBRDUfijZSyrsLl87tmC8IXwsrvr6Pvl7Mk+k8kRXyWfYiXXk/ueGc7e6ILu7sGcOhsUR/qYpU8y7ZYN6tVK5cJBsIyQXTrAdlbQhVT1NpQlUplGOGBnwwOwRhgBFHzbZwK2SV8jU8umtY4XqsVmSdB28oUlLiZt3zUCgyyS+Y+irkHvSpz7EPxoFYRhqGb1HTRJZDYLsWa1V0Y4c21bq1iT/RhKPOhTfgkLS4BTXt+g9zl2smedJHZFFiKRhHoTv5/EcWRzlF0ILOoroXBgZtFZg64d0ARnLfVv3Eexsw4tGIaPyBubN0U04XnVqxBkQI2ghDisUWVgsitSpeGBZzq7DUae0GLJLhtnRXavHnJJh54iGPSy/RB6ZRsDl6bJuaGAMH6o+eRq0boVVZ44vHirKwgzc+eO/O8saGw1Su7vhud52vH8Nr4CuP5Fm667wwfi6x13HIySJNvwxSYDqYAEcf01J9Lzz2NiEnmtjUT+01sJEn+CwN1yHFJn+0SheY/P4cFThADnVs27SQCTA2YQdQise6XhQRsl3voX6Er/z7srhmmU99sN8SpLUVUhIi8qd0X4GH2vOHiVQAXOuBGXWw33ysLA0Xt/9MWfeAP5ehFPJbI+JAQKnPTJeAETYxGUNoAuojOvJ8jCzA6MgfqUL+xsNhEGwQ9ROs0Jd27C+aXhH8G0eR2ASfcXWnm4ebsQHEVIi7BU7AOJwn0TvxwOrypa8TRUB0HY/qOfHz6LbNdmuqXH1QWcks0AEFlsUnSoxsbnVQnDtt7Pq1zJVVVl7BO2SiNc7c5hKvoiK6T6Nqp6NQ1cvxDUTXD6k9l7EgAtpw14dZzUo4A2xBagoaiSAbi6O26+Fdqf5bA6/2aLYIvC4/QrrwI2g9YFu4kmIoUxsDALE4frUetMuZlJcG1/421IqtS61Uh3DOc2w+fpsETI4w4uOXWhYfwesi3MrGZCg2T84r0F34vrnLlKdO2BBvNWOzxcGsS+LYuiRO1QREYHeREyub20EL1VMYg4UgpsTGa6/cy4mg12ARarJoixahyx/Z67lxNfqm3Sbqhx31raSVd8rthBACiYUJtde1k1Uk1FqW8sK8lK12EZVnNLdoX7r8lb2e31hQSc9hWQreK7cpizqWQ22K9GwqC5ALe2rOQmo67DXMQGoH87nNRpdas3WptarZZGRX2WY2XK0Uk4ZMniSOau2Wnq+qPeYai2MkT8eRnx7q2tspkXn2gEAIgYWo2NIQR9TXm73WFWTbk1xn26Nq/3eLZvaifGFLJ7MnVEqMXHtPVR3qzEJqpJVpeXwldiezJsVYuvzNzhRVZChRjB6xiQWY71ue5ViEEncEoAttnyHPpoRRRC06sv0axVipbkExbnKwiGKFvl4vxUhNhbivlWKka1OMLba7HqNoD0xgEuIAakPiYAevHaS+AkaRvhpGkW7OKG4Ms5pRNAeEIoSBY5rQwYCsjfdrYhTpq2EUaRdGEW+VUcyHMrZNCrADwdqhow6j+JI+lfNtOEVnQ05x4xHc5BS3h/F2OcXN4H01FKKzPoVYUHKbw95CIUrsKTUFj+hQa+3NoGegEDczgFfDGDrbYQxbTeAZGMPCLCDkgYM45Pn/ly90Xjdf6GzKFz6DXSn4wtyibGxB4FhYDIpfNV/ovG6+0NHlC88j8EpoQHNAgYMxBZRHlQhQPQv6NfGAKfvxqycCIXgmJrAaTkOgmeuOu7STOfNvJT+enw/Nczw5WXZOmypTPZml3HYtCZ86Pjy7Or1JcXp26QHXDnioU9Hom1h7uFsOcyHQSj7TAKSRpE6d4QkiC6wGQUxifUMNhcyGLpvvnhI9L9hB84p8Mu0KbsagK7jv5Rm3W3LbCnehmTamdPnbkt+KnDDOaGR7wPRHwCOmbTFAAcJ4NCa+75Mx8mxz7GA6Yiryu5EYxuHjmZjIXp8BTwPsbT27b+qZ/f8po9d8fFF3mt9ipgS8SHPVktrPBCu1/WrnebgpJdY2z6+YhpZmlod1wqwtcVW6b/2NZ6CKDKUZiGEPUZ/Csel4cMRj6jEkyB27DFg2QsyH0B4RG9SzUlWqK2YgBKw0952jePhaew7Sy9gvv1qlBLCOPSCE2JbMwIcgbubgQwOMMXQgX25NU3pHqvdFLRsP5dcknEfqPG3lJKHlWzuYvMK12WCugcVu4fW9O2VqHac/Vbc1LWXi62omVlEqq0ZMCVlWD5lFsvh+ncQs8e7zaOhwcieSfTiK7dpMI6LOXHRLtlHOGrKBM6eXGr+Za5joetY4+9kmfQOlRuYgcTZvZYCqMLP2iVSGht2nUo3X2iyUqdo8qPhieqnvm8qkK9erkhZpNlSR5puBKqop3oz26fDmu6rSVml1SdEO+lakpG3Xt4q6r77ORCvXbFPf9kp9w/T1eRva6/V8lOb96eqNFeX0FavKQt+uWBUlXnlhiWZ++YZiHT3FQjNbGsVJ6JWKbTw/Vdf0MlWmeuxOIXXDa71GOoCrDuz1ORYVSV15P4pmxnkt5xt0mcy2awnFGlGerDrNbF1QUSeR1UdFxQFXXqTSkjx+LVRgGZU882/rAO24xnC9c7e6fSFZOniKgh1U32nZbnKlKwKd6vR4sN94X2bDG5BegPQpRZzBu3U0H4+1Xm3anjaukSWuXrcqX5wN0rcQLUkZx9X54MZPxk/saS/L3gZ7aZQUxfyy6qzbynRuEKnj93o+t6IDK1O6lbcMq90evH3ksiZyf+A3QwO8edZwsSpzKV60feaNkIupDccj6GHgWsBhIzryLJ/Y0CEmxNgVTxpW4sVqfYvzmmiD85pQL+++/GrWZ4M8TgTNECebEbIk4S3ve1npCfHOCitsnyFqAFc3gqql9acJVTL9DaJGvSz58itu17A4Ga/U8Wr2T6nc8mjorNtK4Q6q7RSQr4xC9fLZy6+oi4Ox1G63YqtrW+eGmwa12LMlc7xahbAevVvLdsVMRzdl+Tr2uK4FdvIBmqFkp6wnUKQJ1kl70uYsLNqv33GQtaN4H3fmlzI5VBdHaaJ57LG3j9O4OHdxz7zPxVsQ5Dma8pma3cyfyNd6kP9TusaLYuUuC3WV5Sx3vtylg+zt7LV3vcvXYPKRex5lD0G1+a6LNitzb5rnNErfcCTEbvCKtWL5vJLmIZXFYLVYkY843T8KVY3nQ0tkDc1qceqN5/NoXvJgf9H/g/1fktjN/N7ZmfsUzZNrJmhVPvLi3/8T</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70100 ForNAV VAT Purchase Order
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:17;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° objedn†vka;
               DAN=K˚bsordre;
               DEU=Einkaufsbestellung;
               ENU=Purchase Order;
               FIN=Ostotilaus;
               FRA=Commande achat;
               ISL=Innkaupapîntun;
               ITA=Ordine acquisto;
               NLD=Inkooporder;
               NOR=Bestilling;
               SVE=Inkîpsorder;
               DES=Einkaufsbestellung;
               ENG=Purchase Order;
               ESM=Pedido compra;
               FRB=Commande achat;
               ITS=Ordine acquisto;
               NLB=Inkooporder;
               DEA=Einkaufsbestellung;
               ENA=Purchase Order;
               ESN=Pedido compra;
               FRC=Bon de commande;
               ENC=Purchase Order;
               FRS=Commande achat;
               ENZ=Purchase Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(Document Type,No.)
                                 WHERE(Document Type=CONST(Order));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70101 ForNAV VAT Purchase Invoice
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:17;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° faktura;
               DAN=K˚bsfaktura;
               DEU=Einkaufsrechnung;
               ENU=Purchase Invoice;
               FIN=Ostolasku;
               FRA=Facture achat;
               ISL=Innkaupareikningur;
               ITA=Fattura acquisto;
               NLD=Inkoopfactuur;
               NOR=Kj˚psfaktura;
               SVE=Inkîpsfaktura;
               DES=Einkaufsrechnung;
               ENG=Purchase Invoice;
               ESM=Factura compra;
               FRB=Facture achat;
               ITS=Fattura acquisto;
               NLB=Inkoopfactuur;
               DEA=Einkaufsrechnung;
               ENA=Purchase Invoice;
               ESN=Factura compra;
               FRC=Facture achat;
               ENC=Purchase Invoice;
               FRS=Facture achat;
               ENZ=Purchase Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70102 ForNAV VAT Purchase Cr. Memo
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:17;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° dobropis;
               DAN=K˚bskreditnota;
               DEU=Einkaufsgutschrift;
               ENU=Purchase Credit Memo;
               FIN=Ostohyvityslasku;
               FRA=Avoir achat;
               ISL=Innkaupakreditreikningur;
               ITA=Nota credito acquisto;
               NLD=Inkoopcreditnota;
               NOR=Kj˚pskreditnota;
               SVE=Inkîpskreditnota;
               DES=Einkaufsgutschrift;
               ENG=Purchase Credit Memo;
               ESM=Nota crÇdito compra;
               FRB=Avoir achat;
               ITS=Nota credito acquisto;
               NLB=Inkoopcreditnota;
               DEA=Einkaufsgutschrift;
               ENA=Purchase CR/Adj Note;
               ESN=Abono compra;
               FRC=Note de crÇdit d'achat;
               ENC=Purchase Credit Memo;
               FRS=Avoir achat;
               ENZ=Purchase Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table124;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table125;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70104 ForNAV VAT Purchase Quote
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:17;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° popt†vka;
               DAN=K˚bsrekvisition;
               DEU=Einkaufsanfrage;
               ENU=Purchase Quote;
               FIN=Ostotarjous;
               FRA=Demande de prix;
               ISL=Innkaupabei˜ni;
               ITA=Offerta acquisto;
               NLD=Inkoopofferte;
               NOR=Foresp˚rsel;
               SVE=Inkîpsoffert;
               DES=Einkaufsofferte;
               ENG=Purchase Quote;
               ESM=Cotizaci¢n compra;
               FRB=Demande de prix;
               ITS=Offerta acquisto;
               NLB=Inkoopofferte;
               DEA=Einkaufsanfrage;
               ENA=Purchase Quote;
               ESN=Oferta compra;
               FRC=Devis d'achat;
               ENC=Purchase Quote;
               FRS=Demande de prix;
               ENZ=Purchase Quote];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70150 ForNAV Tax Purchase Order
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:18;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° objedn†vka;
               DAN=K˚bsordre;
               DEU=Einkaufsbestellung;
               ENU=Purchase Order;
               FIN=Ostotilaus;
               FRA=Commande achat;
               ISL=Innkaupapîntun;
               ITA=Ordine acquisto;
               NLD=Inkooporder;
               NOR=Bestilling;
               SVE=Inkîpsorder;
               DES=Einkaufsbestellung;
               ENG=Purchase Order;
               ESM=Pedido compra;
               FRB=Commande achat;
               ITS=Ordine acquisto;
               NLB=Inkooporder;
               DEA=Einkaufsbestellung;
               ENA=Purchase Order;
               ESN=Pedido compra;
               FRC=Bon de commande;
               ENC=Purchase Order;
               FRS=Commande achat;
               ENZ=Purchase Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(Document Type,No.)
                                 WHERE(Document Type=CONST(Order));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70151 ForNAV Tax Purchase Invoice
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:18;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° faktura;
               DAN=K˚bsfaktura;
               DEU=Einkaufsrechnung;
               ENU=Purchase Invoice;
               FIN=Ostolasku;
               FRA=Facture achat;
               ISL=Innkaupareikningur;
               ITA=Fattura acquisto;
               NLD=Inkoopfactuur;
               NOR=Kj˚psfaktura;
               SVE=Inkîpsfaktura;
               DES=Einkaufsrechnung;
               ENG=Purchase Invoice;
               ESM=Factura compra;
               FRB=Facture achat;
               ITS=Fattura acquisto;
               NLB=Inkoopfactuur;
               DEA=Einkaufsrechnung;
               ENA=Purchase Invoice;
               ESN=Factura compra;
               FRC=Facture achat;
               ENC=Purchase Invoice;
               FRS=Facture achat;
               ENZ=Purchase Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70152 ForNAV Tax Purchase Cr. Memo
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:18;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° dobropis;
               DAN=K˚bskreditnota;
               DEU=Einkaufsgutschrift;
               ENU=Purchase Credit Memo;
               FIN=Ostohyvityslasku;
               FRA=Avoir achat;
               ISL=Innkaupakreditreikningur;
               ITA=Nota credito acquisto;
               NLD=Inkoopcreditnota;
               NOR=Kj˚pskreditnota;
               SVE=Inkîpskreditnota;
               DES=Einkaufsgutschrift;
               ENG=Purchase Credit Memo;
               ESM=Nota crÇdito compra;
               FRB=Avoir achat;
               ITS=Nota credito acquisto;
               NLB=Inkoopcreditnota;
               DEA=Einkaufsgutschrift;
               ENA=Purchase CR/Adj Note;
               ESN=Abono compra;
               FRC=Note de crÇdit d'achat;
               ENC=Purchase Credit Memo;
               FRS=Avoir achat;
               ENZ=Purchase Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table124;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table125;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>+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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70154 ForNAV Tax Purchase Quote
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:18;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° popt†vka;
               DAN=K˚bsrekvisition;
               DEU=Einkaufsanfrage;
               ENU=Purchase Quote;
               FIN=Ostotarjous;
               FRA=Demande de prix;
               ISL=Innkaupabei˜ni;
               ITA=Offerta acquisto;
               NLD=Inkoopofferte;
               NOR=Foresp˚rsel;
               SVE=Inkîpsoffert;
               DES=Einkaufsofferte;
               ENG=Purchase Quote;
               ESM=Cotizaci¢n compra;
               FRB=Demande de prix;
               ITS=Offerta acquisto;
               NLB=Inkoopofferte;
               DEA=Einkaufsanfrage;
               ENA=Purchase Quote;
               ESN=Oferta compra;
               FRC=Devis d'achat;
               ENC=Purchase Quote;
               FRS=Demande de prix;
               ENZ=Purchase Quote];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70201 ForNAV Customer Top 10 List
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:18;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Nejlep °ch 10 z†kazn°ku;
               DAN=Debitor - top 10-liste;
               DEU=Top 10 Liste (Debitoren);
               ENU=Customer Top 10 List;
               FIN=Asiakkaat - 10 pÑÑasiakasta;
               FRA=Clients - Palmaräs;
               ISL=Vi˜skiptama˜ur - 10 efstu;
               ITA=Lista primi 10 clienti;
               NLD=Klanten - Top 10;
               NOR=Kunde - ti pÜ topp-liste;
               RUS=‡âäÜ°ï - ãÜ˜ÉÖò ÑÜ§òïàÖ;
               SVE=Kunder, 10 i topp;
               DES=Top 10 Liste (Debitoren);
               ENG=Customer Top 10 List;
               FRB=Clients - Palmaräs;
               ITS=Lista primi 10 clienti;
               NLB=Klanten - Top 10;
               DEA=Top 10 Liste (Debitoren);
               ENA=Customer Top 10 List;
               ESN=Los 10 mejores clientes;
               FRS=Clients - Palmaräs;
               ENZ=Customer Top 10 List];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;                    ;
               DataItemTable=Table18;
               DataItemTableView=SORTING(Net Change (LCY))
                                 ORDER(Descending);
               OnAfterGetRecord=BEGIN
                                  i += 1;
                                  IF i = NoOfRecordsToPrint THEN
                                    CurrReport.BREAK;
                                END;

               ReqFilterFields=No.,Name,Customer Posting Group,Country/Region Code,Date Filter;
               CalcFields=Balance (LCY),Net Change (LCY) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   IF NoOfRecordsToPrint = 0 THEN
                     NoOfRecordsToPrint := 10;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 1   ;2   ;Field     ;
                  CaptionML=[DAN=Antal;
                             DEU=Menge;
                             ENU=Quantity;
                             ESP=Cantidad;
                             FIN=MÑÑrÑ;
                             FRA=QuantitÇ;
                             ISL=Magn;
                             ITA=QuantitÖ;
                             NLD=Aantal;
                             NOR=Antall];
                  ToolTipML=ENU=Specifies the number of customers that will be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfRecordsToPrint }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      NoOfRecordsToPrint@1000 : Integer;
      i@1001 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70202 ForNAV Vendor Top 10 List
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:18;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Dodavatel - nejlep °ch 10;
               DAN=Kreditor - top 10-liste;
               DEU=HÑndler Top-10-Liste;
               ENU=Vendor Top 10 List;
               FIN=10 pÑÑtoimittajaa;
               FRA=Palmaräs fournisseurs;
               ISL=10 efstu l†nardrottnar;
               ITA=Lista primi 10 fornitori;
               NLD=Lijst top 10 leveranciers;
               NOR=Leverand˚r - topp 10-liste;
               RUS=Áå§ïÖÉóäàä - ãÜ˜ÉÖò ÑÜ§òïàÖ;
               SVE=10 i topp leverantîrer;
               DES=HÑndler Top-10-Liste;
               ENG=Vendor Top 10 List;
               FRB=Palmaräs fournisseurs;
               ITS=Lista primi 10 fornitori;
               NLB=Lijst top 10 leveranciers;
               DEA=HÑndler Top-10-Liste;
               ENA=Vendor Top 10 List;
               ESN=Listado 10 mejores proveedores;
               FRS=Palmaräs fournisseurs;
               ENZ=Vendor Top 10 List];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;                    ;
               DataItemTable=Table23;
               DataItemTableView=SORTING(Net Change (LCY))
                                 ORDER(Descending);
               OnAfterGetRecord=BEGIN
                                  i += 1;
                                  IF i = NoOfRecordsToPrint THEN
                                    CurrReport.BREAK;
                                END;

               ReqFilterFields=No.,Name,Vendor Posting Group,Country/Region Code,Date Filter;
               CalcFields=Balance (LCY),Net Change (LCY) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   IF NoOfRecordsToPrint = 0 THEN
                     NoOfRecordsToPrint := 10;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 1   ;2   ;Field     ;
                  CaptionML=[DAN=Antal;
                             DEU=Menge;
                             ENU=Quantity;
                             ESP=Cantidad;
                             FIN=MÑÑrÑ;
                             FRA=QuantitÇ;
                             ISL=Magn;
                             ITA=QuantitÖ;
                             NLD=Aantal;
                             NOR=Antall];
                  ToolTipML=ENU=Specifies the number of vendors that will be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfRecordsToPrint }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      NoOfRecordsToPrint@1000 : Integer;
      i@1001 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70206 ForNAV Trial Balance
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:18;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Predvaha;
               DAN=Balance;
               DEU=Rohbilanz;
               ENU=Trial Balance;
               FIN=Alustava saldo;
               FRA=Balance;
               ISL=Pr¢fjîfnu˜ur;
               ITA=Bilancio di verifica;
               NLD=Proefbalans;
               NOR=RÜbalanse;
               RUS=Á˜å†°ñÇ †ÖâÖ°§;
               SVE=RÜbalans;
               DES=Bilanz;
               ENG=Trial Balance;
               FRB=Balance;
               ITS=Bilancio di verifica;
               NLB=Proefbalans;
               DEA=Rohbilanz;
               ENA=Trial Balance;
               ESN=Balance comprobaci¢n;
               FRS=Balance;
               ENZ=Trial Balance];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  Args."From Date" := "G/L Account".GETRANGEMIN("Date Filter");
                  Args."To Date" := "G/L Account".GETRANGEMAX("Date Filter");
                  "G/L Account".SETRANGE("Date Filter");

                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000001;;DataItem;Args              ;
               DataItemTable=Table70205;
               DataItemTableView=SORTING(Show by);
               OnPreDataItem=BEGIN
                               INSERT;
                             END;

               Temporary=Yes }

    { 6710;1   ;DataItem;                    ;
               DataItemTable=Table15;
               DataItemTableView=SORTING(No.);
               PrintOnlyIfDetail=Yes;
               OnAfterGetRecord=BEGIN
                                  TrialBalance.CreateForGLAccount("G/L Account", Args);
                                END;

               ReqFilterFields=No.,Account Type,Date Filter,Global Dimension 1 Filter,Global Dimension 2 Filter,Budget Filter }

    { 1000000002;1;DataItem;TrialBalance     ;
               DataItemTable=Table70206;
               DataItemTableView=SORTING(G/L Account No.);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   IF Args.GetNoOfColumns = 0 THEN BEGIN
                     Args."Net Change Actual" := TRUE;
                     Args."Net Change Actual Last Year" := TRUE;
                   END;
                   Args."All Amounts in LCY" := TRUE;
                 END;

    }
    CONTROLS
    {
      { 1020001;0;Container ;
                  ContainerType=ContentArea }

      { 1020000;1;Group     ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 4   ;2   ;Field     ;
                  Name=ShowComaprison;
                  CaptionML=[DAN=Vis efter;
                             DEU=Anzeigen nach;
                             ENU=Show by;
                             ESP=Mostrar por;
                             FIN=NÑyttîperuste;
                             FRA=Afficher par;
                             ISL=SÏna eftir;
                             ITA=Mostra per;
                             NLD=Tonen op;
                             NOR=Vis etter];
                  ToolTipML=ENU=Specifies if figures either from the prior year or for the defined budget are included.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Show by" }

      { 19  ;2   ;Group     ;
                  CaptionML=[DAN=Kolonneindstilling;
                             DEU=Spaltenoption;
                             ENU=Column Option;
                             ESP=Opci¢n columna;
                             FIN=Sarakevaihtoehto;
                             FRA=Option colonne;
                             ISL=D†lka–ger–;
                             ITA=Opzione colonna;
                             NLD=kolomoptie;
                             NOR=Kolonnealternativ] }

      { 1000000000;3;Field  ;
                  CaptionML=[DAN=Faktisk bevëgelse;
                             DEU=NettoÑnderung - Ist;
                             ENU=Net Change Actual;
                             ESP=Saldo periodo real;
                             FIN=Nettomuutos, toteutunut;
                             FRA=Solde pÇriode - RÇel;
                             ISL=Raunveruleg nett¢breyting;
                             ITA=Saldo periodo effettivo;
                             NLD=Mutatie werkelijk;
                             NOR=Faktisk bevegelse];
                  SourceExpr=Args."Net Change Actual" }

      { 1000000001;3;Field  ;
                  CaptionML=[DAN=Faktisk bevëgelse sidste Ür;
                             DEU=NettoÑnderung - Ist - Vorjahr;
                             ENU=Net Change Actual Last Year;
                             ESP=Saldo periodo real el a§o anterior;
                             FIN=Nettomuutos, toteutunut edellisenÑ vuonna;
                             FRA=Solde pÇriode - RÇel dernier exercice;
                             ISL=Raunveruleg nett¢breyting s°–asta †rs;
                             ITA=Saldo periodo effettivo anno precedente;
                             NLD=Mutatie werkelijk vorig jaar;
                             NOR=Faktisk bevegelse i fjor];
                  SourceExpr=Args."Net Change Actual Last Year" }

      { 1000000002;3;Field  ;
                  CaptionML=[DAN=Difference;
                             DEU=Abweichung;
                             ENU=Difference;
                             ESP=Diferencia;
                             FIN=Ero;
                             FRA=DiffÇrence;
                             ISL=Mismunur;
                             ITA=Differenza;
                             NLD=Verschil;
                             NOR=Differanse];
                  SourceExpr=Args."Variance in Changes" }

      { 1000000003;3;Field  ;
                  CaptionML=[DAN=Variansprocent;
                             DEU=Abweichung %;
                             ENU=Variance %;
                             ESP=% de desviaci¢n;
                             FIN=Vaihtelu-%;
                             FRA=% Çcart;
                             ISL=Fr†vik ° %;
                             ITA=% scostamento;
                             NLD=Verschil %;
                             NOR=Avviks-%];
                  SourceExpr=Args."% Variance in Changes" }

      { 1000000004;3;Field  ;
                  CaptionML=[DAN=Faktisk saldo til dato;
                             DEU=Saldo bis Datum - Ist;
                             ENU=Balance at Date Actual;
                             ESP=Saldo a la fecha real;
                             FIN=Pvm:n saldo, toteutunut;
                             FRA=Solde au - RÇel;
                             ISL=Raunsta–a til dags;
                             ITA=Saldo alla data effettivo;
                             NLD=Saldo op datum werkelijk;
                             NOR=Faktisk saldo per dato];
                  SourceExpr=Args."Balance at Date Actual" }

      { 1000000005;3;Field  ;
                  CaptionML=[DAN=Faktisk saldo til dato sidste Ür;
                             DEU=Saldo bis Datum - Ist - Vorjahr;
                             ENU=Balance at Date Act. Last Year;
                             ESP=Saldo a la fecha real del a§o anterior;
                             FIN=Pvm:n saldo, toteutunut edellisenÑ vuonna;
                             FRA=Solde au - RÇel dernier exercice;
                             ISL=Nett¢sta–a til dags fyrir s°–asta †r;
                             ITA=Saldo alla data anno precedente effet.;
                             NLD=Saldo op datum werkelijk vorig jaar;
                             NOR=Fakt. saldo per dato i fjor];
                  SourceExpr=Args."Balance at Date Act. Last Year" }

      { 1000000006;3;Field  ;
                  CaptionML=[DAN=Difference;
                             DEU=Abweichung;
                             ENU=Difference;
                             ESP=Diferencia;
                             FIN=Ero;
                             FRA=DiffÇrence;
                             ISL=Mismunur;
                             ITA=Differenza;
                             NLD=Verschil;
                             NOR=Differanse];
                  SourceExpr=Args."Variance in Balances" }

      { 1000000007;3;Field  ;
                  CaptionML=[DAN=Variansprocent;
                             DEU=Abweichung %;
                             ENU=Variance %;
                             ESP=% de desviaci¢n;
                             FIN=Vaihtelu-%;
                             FRA=% Çcart;
                             ISL=Fr†vik ° %;
                             ITA=% scostamento;
                             NLD=Verschil %;
                             NOR=Avviks-%];
                  SourceExpr=Args."% Variance in Balances" }

      { 1000000008;2;Field  ;
                  CaptionML=[DAN=Afrundingsfaktor;
                             DEU=Rundungsfaktor;
                             ENU=Rounding Factor;
                             ESP=Factor redondeo;
                             FIN=Pyîristyskerroin;
                             FRA=UnitÇ d'affichage;
                             ISL=SlÇttunarstu–ull;
                             ITA=Fattore arrotondamento;
                             NLD=Afrondingsfactor;
                             NOR=Avrundingsfaktor];
                  SourceExpr=Args."Rounding Factor" }

      { 1000000009;2;Field  ;
                  CaptionML=ENU=Skip Accounts with all zero Amounts;
                  SourceExpr=Args."Skip Accounts with all zero";
                  Visible=FALSE }

      { 1000000010;2;Field  ;
                  CaptionML=[DAN=Alle belõb i RV;
                             DEU=Alle BetrÑge in MW;
                             ENU=All Amounts in LCY;
                             FIN=Kaikki summat PVA;
                             FRA=Tous les montants DS;
                             ISL=Allar upphë–ir ° SGM;
                             ITA=Tutti gli importi in VL;
                             NLD=Alle bedragen in LV;
                             NOR=Alle belõp i NOK;
                             SVE=Alla belopp i BVA];
                  SourceExpr=Args."All Amounts in LCY" }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      This report is based on 10022 Trial Balance.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70210 ForNAV Customer Payments
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:18;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[DAN=Debitor Betalinger;
               DEU=Debitor Zahlungen;
               ENU=Customer Payments;
               ESP=Cliente Pagos;
               FIN=Asiakas Maksut;
               FRA=Client Paiements;
               ISL=Vi˜skiptama˜ur Grei˜slur;
               ITA=Cliente Pagamenti;
               NLD=Klant Betalingen;
               NOR=Kunde Betalinger];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  SalespersonFilterString := CustLedgerEntry.GETFILTER("Salesperson Code");
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 8503;    ;DataItem;CustLedgerEntry     ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Customer No.,Document Type,Posting Date)
                                 WHERE(Document Type=FILTER(Payment|Credit Memo));
               OnPreDataItem=BEGIN
                               SETRANGE("Salesperson Code");
                             END;

               OnAfterGetRecord=BEGIN
                                  CALCFIELDS("Amount (LCY)");
                                  GetAppliedCustEntries(CustLedgerEntry,TRUE);
                                END;

               ReqFilterFields=Posting Date,Global Dimension 1 Code,Global Dimension 2 Code,Salesperson Code,Customer No.;
               CalcFields=Remaining Amt. (LCY),Amount (LCY) }

    { 1000000000;1;DataItem;TempAppliedCustLedgEntry;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Entry No.);
               OnPreDataItem=BEGIN
                               SETFILTER("Salesperson Code", SalespersonFilterString);
                             END;

               OnAfterGetRecord=BEGIN
                                  CALCFIELDS("Remaining Amt. (LCY)", "Amount (LCY)");
                                END;

               CalcFields=Original Amt. (LCY),Amount (LCY);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      SalespersonFilterString@1480002 : Text;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    PROCEDURE GetAppliedCustEntries@1020000(CustLedgEntry@1020001 : Record 21;UseLCY@1480000 : Boolean);
    VAR
      DtldCustLedgEntry@1020003 : Record 379;
      PmtDtldCustLedgEntry@1020004 : Record 379;
      PmtCustLedgEntry@1020015 : Record 21;
      ClosingCustLedgEntry@1020002 : Record 21;
      AmountToApply@1020005 : Decimal;
      AppliedDtldCustLedgEntry@1000000001 : Record 379;
    BEGIN
      TempAppliedCustLedgEntry.RESET;
      TempAppliedCustLedgEntry.DELETEALL;
      DtldCustLedgEntry.SETCURRENTKEY("Cust. Ledger Entry No.");
      DtldCustLedgEntry.SETRANGE("Cust. Ledger Entry No.",CustLedgEntry."Entry No.");
      DtldCustLedgEntry.SETRANGE(Unapplied,FALSE);
      IF DtldCustLedgEntry.FIND('-') THEN
        REPEAT
          IF DtldCustLedgEntry."Cust. Ledger Entry No." = DtldCustLedgEntry."Applied Cust. Ledger Entry No." THEN BEGIN
            AppliedDtldCustLedgEntry.INIT;
            AppliedDtldCustLedgEntry.SETCURRENTKEY("Applied Cust. Ledger Entry No.","Entry Type");
            AppliedDtldCustLedgEntry.SETRANGE("Applied Cust. Ledger Entry No.",DtldCustLedgEntry."Applied Cust. Ledger Entry No.");
            AppliedDtldCustLedgEntry.SETRANGE("Entry Type",AppliedDtldCustLedgEntry."Entry Type"::Application);
            AppliedDtldCustLedgEntry.SETRANGE(Unapplied,FALSE);
            IF AppliedDtldCustLedgEntry.FIND('-') THEN
              REPEAT
                IF AppliedDtldCustLedgEntry."Cust. Ledger Entry No." <> AppliedDtldCustLedgEntry."Applied Cust. Ledger Entry No."
                THEN BEGIN
                  IF ClosingCustLedgEntry.GET(AppliedDtldCustLedgEntry."Cust. Ledger Entry No.") THEN BEGIN
                    TempAppliedCustLedgEntry := ClosingCustLedgEntry;
                    IF UseLCY THEN
                      TempAppliedCustLedgEntry."Amount to Apply" := -AppliedDtldCustLedgEntry."Amount (LCY)"
                    ELSE
                      TempAppliedCustLedgEntry."Amount to Apply" := -AppliedDtldCustLedgEntry.Amount;
                    IF TempAppliedCustLedgEntry.INSERT THEN ;
                  END;
                END;
              UNTIL AppliedDtldCustLedgEntry.NEXT = 0;
          END ELSE BEGIN
            IF ClosingCustLedgEntry.GET(DtldCustLedgEntry."Applied Cust. Ledger Entry No.") THEN BEGIN
              TempAppliedCustLedgEntry := ClosingCustLedgEntry;
              IF UseLCY THEN
                TempAppliedCustLedgEntry."Amount to Apply" := DtldCustLedgEntry."Amount (LCY)"
              ELSE
                TempAppliedCustLedgEntry."Amount to Apply" := DtldCustLedgEntry.Amount;
              IF TempAppliedCustLedgEntry.INSERT THEN ;
            END;
          END;
        UNTIL DtldCustLedgEntry.NEXT = 0;
      IF CustLedgEntry."Closed by Entry No." <> 0 THEN BEGIN
        IF ClosingCustLedgEntry.GET(CustLedgEntry."Closed by Entry No.") THEN BEGIN
          TempAppliedCustLedgEntry := ClosingCustLedgEntry;
          IF UseLCY THEN
            TempAppliedCustLedgEntry."Amount to Apply" := -CustLedgEntry."Closed by Amount (LCY)"
          ELSE
            TempAppliedCustLedgEntry."Amount to Apply" := -CustLedgEntry."Closed by Amount";
          IF TempAppliedCustLedgEntry.INSERT THEN ;
        END;
      END;
      ClosingCustLedgEntry.RESET;
      ClosingCustLedgEntry.SETCURRENTKEY("Closed by Entry No.");
      ClosingCustLedgEntry.SETRANGE("Closed by Entry No.",CustLedgEntry."Entry No.");
      IF ClosingCustLedgEntry.FIND('-') THEN
        REPEAT
          TempAppliedCustLedgEntry := ClosingCustLedgEntry;
          IF UseLCY THEN
            TempAppliedCustLedgEntry."Amount to Apply" := ClosingCustLedgEntry."Closed by Amount (LCY)"
          ELSE
            TempAppliedCustLedgEntry."Amount to Apply" := ClosingCustLedgEntry."Closed by Amount";
          IF TempAppliedCustLedgEntry.INSERT THEN ;
        UNTIL ClosingCustLedgEntry.NEXT = 0;
      IF TempAppliedCustLedgEntry.ISEMPTY THEN BEGIN
        TempAppliedCustLedgEntry.INIT;
        TempAppliedCustLedgEntry."Entry No." := 0;
        TempAppliedCustLedgEntry."Salesperson Code" := CustLedgEntry."Salesperson Code";
        TempAppliedCustLedgEntry.INSERT;
      //  ApplicationExist := FALSE;
      END;
      // ELSE
      //  ApplicationExist := TRUE;
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'CustLedgerEntry': WITH CustLedgerEntry DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Amount (LCY)");
                ReportForNav.AddTotal(DataItemId,1,"Remaining Amt. (LCY)");
              END;
           'Restore': BEGIN
                 "Amount (LCY)" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Remaining Amt. (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70215 ForNAV Salesperson-Commission
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:18;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Provize prodejce;
               DAN=Salgsprovision;
               DEU=VerkÑufer - Provision;
               ENU=Salesperson Commission;
               FIN=MyyjÑn provisio;
               FRA=Commission vendeurs;
               ISL=Sîlumenn - Sîlulaun;
               ITA=Commissioni agente;
               NLD=Verkoper - Provisie;
               NOR=Selgerprovisjon;
               RUS=‡åçä§§äå°°ñÜ çÜ°ÜÑëÜ˜Ö ãå ã˜åÑÖëÖç;
               SVE=SÑljarprovision;
               DES=VerkÑufer - Provision;
               ENG=Salesperson Commission;
               ESM=Vendedor: comisi¢n;
               FRB=Commission vendeurs;
               ITS=Commissioni agente;
               NLB=Verkoper - Provisie;
               DEA=VerkÑufer - Provision;
               ENA=Salesperson Commission;
               ESN=Vendedor: comisi¢n;
               FRC=Commission du reprÇsentant;
               ENC=Salesperson Commission;
               FRS=Commission vendeurs;
               ENZ=Salesperson Commission];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;Args              ;
               DataItemTable=Table70215;
               OnPreDataItem=BEGIN
                               INSERT;
                             END;

               Temporary=Yes }

    { 3065;    ;DataItem;SalespersonPurchaser;
               DataItemTable=Table13;
               DataItemTableView=SORTING(Code);
               PrintOnlyIfDetail=Yes;
               OnPreDataItem=BEGIN
                               ReportForNav.GetDataItem('SalespersonPurchaser').NewPagePerRecord := Args."New Page per Person";
                             END;

               ReqFilterFields=Code }

    { 8503;1   ;DataItem;CustLedgerEntry     ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Salesperson Code,Posting Date)
                                 WHERE(Document Type=FILTER(Invoice|Credit Memo));
               OnAfterGetRecord=VAR
                                  CostCalcMgt@1000 : Codeunit 5836;
                                BEGIN
                                END;

               ReqFilterFields=Posting Date;
               DataItemLink=Salesperson Code=FIELD(Code) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1000000000;2;Field  ;
                  Name=NewPagePerPerson;
                  CaptionML=[DAN=Skift side pr. sëlger;
                             DEU=Neue Seite pro VerkÑufer;
                             ENU=New Page per Person;
                             NLD=Nieuwe pagina per persoon];
                  ToolTipML=[DAN=Angiver, om oplysninger om hver enkelt person udskrives pÜ en ny side, hvis du har valgt to eller flere personer, der skal medtages i rapporten.;
                             DEU=Gibt an, ob die Informationen der einzelnen Personen jeweils auf einer neuen Seite gedruckt werden, wenn Sie fÅr den Bericht zwei oder mehr Personen ausgewÑhlt haben.;
                             ENU=Specifies if each person's information is printed on a new page if you have chosen two or more persons to be included in the report.;
                             NLD=Hiermee wordt opgegeven of de gegevens van de persoon op een nieuwe pagina moeten worden afgedrukt als u hebt opgegeven dat u twee of meer personen in het rapport wilt opnemen.];
                  SourceExpr=Args."New Page per Person" }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'SalespersonPurchaser': WITH SalespersonPurchaser DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,CustLedgerEntry."Sales (LCY)");
                ReportForNav.AddTotal(DataItemId,1,CustLedgerEntry."Profit (LCY)");
              END;
           'Restore': BEGIN
                 CustLedgerEntry."Sales (LCY)" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 CustLedgerEntry."Profit (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'CustLedgerEntry': WITH CustLedgerEntry DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Sales (LCY)");
                ReportForNav.AddTotal(DataItemId,1,"Profit (LCY)");
                ReportForNav.AddTotal(DataItemId,2,"Sales (LCY)");
                ReportForNav.AddTotal(DataItemId,3,"Profit (LCY)");
              END;
           'Restore': BEGIN
                 "Sales (LCY)" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Profit (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Sales (LCY)" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Profit (LCY)" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70220 ForNAV Aged Accounts Receivbl.
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:18;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=SplatnÇ pohled†vky;
               DAN=Aldersfordelte tilgodehavender;
               DEU=Debitor - SaldenrÅckblick;
               ENU=Aged Accounts Receivables;
               FIN=Myyntisaatavien tilanne;
               FRA=ComptabilitÇ client ÉgÇe;
               ISL=Aldursgreindar krîfur;
               ITA=Scadenziario clienti;
               NLD=Vervallen vorderingen;
               NOR=Aldersford. saldoliste - kunde;
               RUS=éÜ†äïå˜§àÖò áÖÑåâëÜ°°å§ïÅ ãå §˜åàÖç ÑÖÉ°å§ïä;
               SVE=Kundfordringar - Ülder;
               DES=Debitor - SaldenrÅckblick;
               ENG=Aged Accounts Receivable;
               ESM=AntigÅedad cobros;
               FRB=ComptabilitÇ client ÉgÇe;
               ITS=Scadenziario clienti;
               NLB=Vervallen vorderingen;
               DEA=Debitor - SaldenrÅckblick;
               ENA=Aged Accounts Receivable;
               ESN=AntigÅedad cobros;
               FRC=Comptes clients classÇs chronologiquement;
               ENC=Aged Accounts Receivable;
               FRS=ComptabilitÇ client ÉgÇe;
               ENZ=Aged Accounts Receivable];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=VAR
                  CaptionManagement@1000 : Codeunit 42;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000001;;DataItem;Args              ;
               DataItemTable=Table70219;
               DataItemTableView=SORTING(Print Amounts in LCY);
               OnPreDataItem=BEGIN
                               Args.INSERT;
                               Args.CalcDates;
                             END;

               Temporary=Yes }

    { 6836;1   ;DataItem;Account             ;
               DataItemTable=Table18;
               OnAfterGetRecord=BEGIN
                                  AgingCalculation.GetAgingWithCurrency(Account, AgingBuffer, CurrencyTotalsBuffer, Args, TempCurrency);
                                  IF AgingBuffer.ISEMPTY THEN
                                    CurrReport.SKIP;
                                END;

               ReqFilterFields=No. }

    { 70220;2  ;DataItem;AgingBuffer         ;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Currency Code);
               Temporary=Yes }

    { 1000000000;1;DataItem;CurrencyTotalsBuffer;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Currency Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   InitRequestPage;
                 END;

    }
    CONTROLS
    {
      { 4   ;0   ;Container ;
                  ContainerType=ContentArea }

      { 2   ;1   ;Group     ;
                  CaptionML=ENU=Options }

      { 1   ;2   ;Field     ;
                  Name=AgedAsOf;
                  CaptionML=[DAN=Slutdato;
                             DEU=Enddatum;
                             ENU=Ending Date;
                             ESP=Fecha final;
                             FIN=Lopetuspvm;
                             FRA=Date fin;
                             ISL=Lokadagsetning;
                             ITA=Data fine;
                             NLD=Einddatum;
                             NOR=Sluttdato];
                  ToolTipML=ENU=Specifies the date that you want the aging calculated for.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Ending Date" }

      { 3   ;2   ;Field     ;
                  Name=Agingby;
                  CaptionML=[DAN=Aldersfordelt efter;
                             DEU=RÅckblick nach;
                             ENU=Aging by;
                             ESP=AntigÅedad por;
                             FIN=Tilanne per;
                             FRA=AgÇe par;
                             ISL=Aldursgreining eftir;
                             ITA=Scadenziario per;
                             NLD=Vervallen per;
                             NOR=Aldersfordeling pÜ basis av;
                             SVE=èlder per];
                  ToolTipML=ENU=Specifies if the aging will be calculated from the due date, the posting date, or the document date.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Aging By" }

      { 7   ;2   ;Field     ;
                  Name=PeriodLength;
                  CaptionML=[DAN=Periodelëngde;
                             DEU=PeriodenlÑnge;
                             ENU=Period Length;
                             ESP=Longitud periodo;
                             FIN=Jakson pituus;
                             FRA=Base pÇriode;
                             ISL=Lengd t°mabils;
                             ITA=Durata periodo;
                             NLD=Periodelengte;
                             NOR=Periodelengde];
                  ToolTipML=ENU=Specifies the length of each period, for example, enter "1M" for one month.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Period Length" }

      { 9   ;2   ;Field     ;
                  Name=AmountsinLCY;
                  CaptionML=[DAN=Alle belõb i RV;
                             DEU=Alle BetrÑge in MW;
                             ENU=All Amounts in LCY;
                             FIN=Kaikki summat PVA;
                             FRA=Tous les montants DS;
                             ISL=Allar upphë–ir ° SGM;
                             ITA=Tutti gli importi in VL;
                             NLD=Alle bedragen in LV;
                             NOR=Alle belõp i NOK;
                             SVE=Alla belopp i BVA];
                  ToolTipML=ENU=Specifies if you want the report in customer's currencies. Report totals calculated in LCY.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Amounts in LCY" }

      { 11  ;2   ;Field     ;
                  Name=PrintDetails;
                  CaptionML=[DAN=Udskriv detaljer;
                             DEU=Details drucken;
                             ENU=Print Details;
                             ESP=Imprimir detalles;
                             FIN=Tulosta yksityiskohdat;
                             FRA=Imprimer dÇtails;
                             ISL=Prenta sundurli–un;
                             ITA=Stampa dettagli;
                             NLD=Details afdrukken;
                             NOR=Skriv ut spesifikasjoner;
                             SVE=Skriv ut detaljer];
                  ToolTipML=ENU=Specifies if you want the report to show the detailed entries that add up the total balance for each customer.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Details" }

      { 15  ;2   ;Field     ;
                  Name=HeadingType;
                  CaptionML=[DAN=Overskriftstype;
                             DEU=öberschriftsart;
                             ENU=Heading Type;
                             ESP=Tipo cabecera;
                             FIN=Otsikon tyyppi;
                             FRA=Type titre;
                             ISL=Tegund yfirskriftar;
                             ITA=Tipo testata;
                             NLD=Type kop;
                             NOR=Overskriftstype;
                             SVE=Rubriktyp];
                  ToolTipML=ENU=Specifies if the column heading for the report periods will indicate a date interval or the number of days overdue.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Heading Type";
                  Visible=FALSE }

      { 13  ;2   ;Field     ;
                  Name=perCustomer;
                  CaptionML=[DAN=Skift side pr. debitor;
                             DEU=Neue Seite pro Debitor;
                             ENU=New Page per Customer;
                             ESP=P†gina nueva por cliente;
                             FIN=Uusi sivu asiakasta kohti;
                             FRA=Nouvelle page par client;
                             ISL=NÏ bla–s°–a † hvern vi–skiptamann;
                             ITA=Nuova pagina per cliente;
                             NLD=Nieuwe pagina per klant;
                             NOR=Sideskift per kunde;
                             SVE=Ny sida per kund];
                  ToolTipML=ENU=Specifies if each customer's information is printed on a new page if you have chosen two or more customers to be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."New Page Per Customer" }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
    { 747 ;AgedOverdueAmounts  ;CaptionML=ENU=Aged Overdue Amounts }
    { 742 ;AmnsInLCY           ;CaptionML=ENU=All Amounts in LCY. }
  }
  CODE
  {
    VAR
      TempCurrency@1000000001 : TEMPORARY Record 4;
      AgingCalculation@1000000007 : Codeunit 70219;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE OnPostSectionAccountsReceivblBuffer_ColumnsHeading@5010(VAR AccountsReceivblBuffer@1000000000 : Record 70220);
    BEGIN
      WITH AccountsReceivblBuffer DO BEGIN
      END;// Autogenerated by ForNav;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE InitRequestPage@1000000001();
    VAR
      Blank@1000000000 : DateFormula;
    BEGIN
      WITH Args DO BEGIN
        IF "Ending Date" = 0D THEN
          "Ending Date" := WORKDATE;
        "Column Count" := 5;
        IF "Period Length" = Blank THEN
          EVALUATE("Period Length", '<1M>');
      END;
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'AgingBuffer': WITH AgingBuffer DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount (LCY)");
                ReportForNav.AddTotal(DataItemId,2,Balance);
                ReportForNav.AddTotal(DataItemId,3,"Balance (LCY)");
                ReportForNav.AddTotal(DataItemId,4,"Amount 1");
                ReportForNav.AddTotal(DataItemId,5,"Amount 1 (LCY)");
                ReportForNav.AddTotal(DataItemId,6,"Amount 2");
                ReportForNav.AddTotal(DataItemId,7,"Amount 2 (LCY)");
                ReportForNav.AddTotal(DataItemId,8,"Amount 3");
                ReportForNav.AddTotal(DataItemId,9,"Amount 3 (LCY)");
                ReportForNav.AddTotal(DataItemId,10,"Amount 4");
                ReportForNav.AddTotal(DataItemId,11,"Amount 4 (LCY)");
                ReportForNav.AddTotal(DataItemId,12,"Amount 5");
                ReportForNav.AddTotal(DataItemId,13,"Amount 5 (LCY)");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 Balance := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Balance (LCY)" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Amount 1" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
                 "Amount 1 (LCY)" := ReportForNav.RestoreTotal(DataItemId,5,GroupTotalFieldNo);
                 "Amount 2" := ReportForNav.RestoreTotal(DataItemId,6,GroupTotalFieldNo);
                 "Amount 2 (LCY)" := ReportForNav.RestoreTotal(DataItemId,7,GroupTotalFieldNo);
                 "Amount 3" := ReportForNav.RestoreTotal(DataItemId,8,GroupTotalFieldNo);
                 "Amount 3 (LCY)" := ReportForNav.RestoreTotal(DataItemId,9,GroupTotalFieldNo);
                 "Amount 4" := ReportForNav.RestoreTotal(DataItemId,10,GroupTotalFieldNo);
                 "Amount 4 (LCY)" := ReportForNav.RestoreTotal(DataItemId,11,GroupTotalFieldNo);
                 "Amount 5" := ReportForNav.RestoreTotal(DataItemId,12,GroupTotalFieldNo);
                 "Amount 5 (LCY)" := ReportForNav.RestoreTotal(DataItemId,13,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70221 ForNAV Aged Accounts Payables
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:19;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=SplatnÇ pohled†vky;
               DAN=Aldersfordelte tilgodehavender;
               DEU=Debitor - SaldenrÅckblick;
               ENU=Aged Accounts Payables;
               FIN=Myyntisaatavien tilanne;
               FRA=ComptabilitÇ client ÉgÇe;
               ISL=Aldursgreindar krîfur;
               ITA=Scadenziario clienti;
               NLD=Vervallen vorderingen;
               NOR=Aldersford. saldoliste - kunde;
               RUS=éÜ†äïå˜§àÖò áÖÑåâëÜ°°å§ïÅ ãå §˜åàÖç ÑÖÉ°å§ïä;
               SVE=Kundfordringar - Ülder;
               DES=Debitor - SaldenrÅckblick;
               ENG=Aged Accounts Receivable;
               ESM=AntigÅedad cobros;
               FRB=ComptabilitÇ client ÉgÇe;
               ITS=Scadenziario clienti;
               NLB=Vervallen vorderingen;
               DEA=Debitor - SaldenrÅckblick;
               ENA=Aged Accounts Receivable;
               ESN=AntigÅedad cobros;
               FRC=Comptes clients classÇs chronologiquement;
               ENC=Aged Accounts Receivable;
               FRS=ComptabilitÇ client ÉgÇe;
               ENZ=Aged Accounts Receivable];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=VAR
                  CaptionManagement@1000 : Codeunit 42;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000001;;DataItem;Args              ;
               DataItemTable=Table70219;
               DataItemTableView=SORTING(Print Amounts in LCY);
               OnPreDataItem=BEGIN
                               Args.INSERT;
                               Args.CalcDates;
                             END;

               Temporary=Yes }

    { 6836;1   ;DataItem;Account             ;
               DataItemTable=Table23;
               OnAfterGetRecord=BEGIN
                                  AgingCalculation.GetAgingWithCurrency(Account, AgingBuffer, CurrencyTotalsBuffer, Args, TempCurrency);
                                  IF AgingBuffer.ISEMPTY THEN
                                    CurrReport.SKIP;
                                END;

               ReqFilterFields=No. }

    { 70220;2  ;DataItem;AgingBuffer         ;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Currency Code);
               Temporary=Yes }

    { 1000000000;1;DataItem;CurrencyTotalsBuffer;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Currency Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   InitRequestPage;
                 END;

    }
    CONTROLS
    {
      { 1000000009;0;Container;
                  ContainerType=ContentArea }

      { 1000000008;1;Group  ;
                  CaptionML=ENU=Options }

      { 1000000007;2;Field  ;
                  Name=AgedAsOf;
                  CaptionML=[DAN=Slutdato;
                             DEU=Enddatum;
                             ENU=Ending Date;
                             ESP=Fecha final;
                             FIN=Lopetuspvm;
                             FRA=Date fin;
                             ISL=Lokadagsetning;
                             ITA=Data fine;
                             NLD=Einddatum;
                             NOR=Sluttdato];
                  ToolTipML=ENU=Specifies the date that you want the aging calculated for.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Ending Date" }

      { 1000000006;2;Field  ;
                  Name=Agingby;
                  CaptionML=[DAN=Aldersfordelt efter;
                             DEU=RÅckblick nach;
                             ENU=Aging by;
                             ESP=AntigÅedad por;
                             FIN=Tilanne per;
                             FRA=AgÇe par;
                             ISL=Aldursgreining eftir;
                             ITA=Scadenziario per;
                             NLD=Vervallen per;
                             NOR=Aldersfordeling pÜ basis av;
                             SVE=èlder per];
                  ToolTipML=ENU=Specifies if the aging will be calculated from the due date, the posting date, or the document date.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Aging By" }

      { 1000000005;2;Field  ;
                  Name=PeriodLength;
                  CaptionML=[DAN=Periodelëngde;
                             DEU=PeriodenlÑnge;
                             ENU=Period Length;
                             ESP=Longitud periodo;
                             FIN=Jakson pituus;
                             FRA=Base pÇriode;
                             ISL=Lengd t°mabils;
                             ITA=Durata periodo;
                             NLD=Periodelengte;
                             NOR=Periodelengde];
                  ToolTipML=ENU=Specifies the length of each period, for example, enter "1M" for one month.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Period Length" }

      { 1000000004;2;Field  ;
                  Name=AmountsinLCY;
                  CaptionML=[DAN=Alle belõb i RV;
                             DEU=Alle BetrÑge in MW;
                             ENU=All Amounts in LCY;
                             FIN=Kaikki summat PVA;
                             FRA=Tous les montants DS;
                             ISL=Allar upphë–ir ° SGM;
                             ITA=Tutti gli importi in VL;
                             NLD=Alle bedragen in LV;
                             NOR=Alle belõp i NOK;
                             SVE=Alla belopp i BVA];
                  ToolTipML=ENU=Specifies if you want the report in customer's currencies. Report totals calculated in LCY.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Amounts in LCY" }

      { 1000000003;2;Field  ;
                  Name=PrintDetails;
                  CaptionML=[DAN=Udskriv detaljer;
                             DEU=Details drucken;
                             ENU=Print Details;
                             ESP=Imprimir detalles;
                             FIN=Tulosta yksityiskohdat;
                             FRA=Imprimer dÇtails;
                             ISL=Prenta sundurli–un;
                             ITA=Stampa dettagli;
                             NLD=Details afdrukken;
                             NOR=Skriv ut spesifikasjoner;
                             SVE=Skriv ut detaljer];
                  ToolTipML=ENU=Specifies if you want the report to show the detailed entries that add up the total balance for each customer.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Details" }

      { 1000000002;2;Field  ;
                  Name=HeadingType;
                  CaptionML=[DAN=Overskriftstype;
                             DEU=öberschriftsart;
                             ENU=Heading Type;
                             ESP=Tipo cabecera;
                             FIN=Otsikon tyyppi;
                             FRA=Type titre;
                             ISL=Tegund yfirskriftar;
                             ITA=Tipo testata;
                             NLD=Type kop;
                             NOR=Overskriftstype;
                             SVE=Rubriktyp];
                  ToolTipML=ENU=Specifies if the column heading for the report periods will indicate a date interval or the number of days overdue.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Heading Type";
                  Visible=FALSE }

      { 1000000001;2;Field  ;
                  Name=perCustomer;
                  CaptionML=[DAN=Skift side pr. debitor;
                             DEU=Neue Seite pro Debitor;
                             ENU=New Page per Customer;
                             ESP=P†gina nueva por cliente;
                             FIN=Uusi sivu asiakasta kohti;
                             FRA=Nouvelle page par client;
                             ISL=NÏ bla–s°–a † hvern vi–skiptamann;
                             ITA=Nuova pagina per cliente;
                             NLD=Nieuwe pagina per klant;
                             NOR=Sideskift per kunde;
                             SVE=Ny sida per kund];
                  ToolTipML=ENU=Specifies if each customer's information is printed on a new page if you have chosen two or more customers to be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."New Page Per Customer" }

      { 1000000000;2;Field  ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
    { 747 ;AgedOverdueAmounts  ;CaptionML=ENU=Aged Overdue Amounts }
    { 742 ;AmnsInLCY           ;CaptionML=ENU=All Amounts in LCY. }
  }
  CODE
  {
    VAR
      TempCurrency@1000000001 : TEMPORARY Record 4;
      AgingCalculation@1000000007 : Codeunit 70219;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE OnPostSectionAccountsReceivblBuffer_ColumnsHeading@5010(VAR AccountsReceivblBuffer@1000000000 : Record 70220);
    BEGIN
      WITH AccountsReceivblBuffer DO BEGIN
      END;// Autogenerated by ForNav;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE InitRequestPage@1000000001();
    VAR
      Blank@1000000000 : DateFormula;
    BEGIN
      WITH Args DO BEGIN
        IF "Ending Date" = 0D THEN
          "Ending Date" := WORKDATE;
        "Column Count" := 5;
        IF "Period Length" = Blank THEN
          EVALUATE("Period Length", '<1M>');
      END;
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'AgingBuffer': WITH AgingBuffer DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount (LCY)");
                ReportForNav.AddTotal(DataItemId,2,Balance);
                ReportForNav.AddTotal(DataItemId,3,"Balance (LCY)");
                ReportForNav.AddTotal(DataItemId,4,"Amount 1");
                ReportForNav.AddTotal(DataItemId,5,"Amount 1 (LCY)");
                ReportForNav.AddTotal(DataItemId,6,"Amount 2");
                ReportForNav.AddTotal(DataItemId,7,"Amount 2 (LCY)");
                ReportForNav.AddTotal(DataItemId,8,"Amount 3");
                ReportForNav.AddTotal(DataItemId,9,"Amount 3 (LCY)");
                ReportForNav.AddTotal(DataItemId,10,"Amount 4");
                ReportForNav.AddTotal(DataItemId,11,"Amount 4 (LCY)");
                ReportForNav.AddTotal(DataItemId,12,"Amount 5");
                ReportForNav.AddTotal(DataItemId,13,"Amount 5 (LCY)");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 Balance := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Balance (LCY)" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Amount 1" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
                 "Amount 1 (LCY)" := ReportForNav.RestoreTotal(DataItemId,5,GroupTotalFieldNo);
                 "Amount 2" := ReportForNav.RestoreTotal(DataItemId,6,GroupTotalFieldNo);
                 "Amount 2 (LCY)" := ReportForNav.RestoreTotal(DataItemId,7,GroupTotalFieldNo);
                 "Amount 3" := ReportForNav.RestoreTotal(DataItemId,8,GroupTotalFieldNo);
                 "Amount 3 (LCY)" := ReportForNav.RestoreTotal(DataItemId,9,GroupTotalFieldNo);
                 "Amount 4" := ReportForNav.RestoreTotal(DataItemId,10,GroupTotalFieldNo);
                 "Amount 4 (LCY)" := ReportForNav.RestoreTotal(DataItemId,11,GroupTotalFieldNo);
                 "Amount 5" := ReportForNav.RestoreTotal(DataItemId,12,GroupTotalFieldNo);
                 "Amount 5 (LCY)" := ReportForNav.RestoreTotal(DataItemId,13,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70230 ForNAV Sales Statistics
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:19;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=ENU=Sales Statistics;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  IF NOT (Args.Invoices OR Args."Credit Memos") THEN
                    ERROR(Text000);
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  Args.CreateCurrencies;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 4146;    ;DataItem;Args                ;
               DataItemTable=Table70230;
               DataItemTableView=SORTING(Currency Code);
               PrintOnlyIfDetail=Yes;
               Temporary=Yes }

    { 5581;1   ;DataItem;SalesInvoiceHeader  ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               ReqFilterHeadingML=[ENU=Sales Invoice;
                                   ESM=Factura venta;
                                   FRC=Facture vente;
                                   ENC=Sales Invoice];
               OnPreDataItem=BEGIN
                               IF NOT Args.Invoices THEN
                                 CurrReport.BREAK;

                               IF Args."Customer No." THEN
                                 SETCURRENTKEY("Bill-to Customer No.");
                             END;

               ReqFilterFields=Posting Date,Bill-to Customer No.,Salesperson Code,Payment Terms Code;
               CalcFields=Amount,Amount Including VAT;
               DataItemLink=Currency Code=FIELD(Currency Code) }

    { 1000000021;2;Column;AmountLCY          ;
               IncludeCaption=No;
               SourceExpr=Args.GetInvoiceAmountLCY(SalesInvoiceHeader) }

    { 1000000010;2;Column;CostLCY            ;
               IncludeCaption=No;
               SourceExpr=Args.GetInvoiceCostLCY(SalesInvoiceHeader) }

    { 8098;1   ;DataItem;SalesCrMemoHeader   ;
               DataItemTable=Table114;
               DataItemTableView=SORTING(No.);
               OnPreDataItem=BEGIN
                               IF Args."Credit Memos" THEN BEGIN
                                 SalesInvoiceHeader.COPYFILTER("Posting Date","Posting Date");
                                 SalesInvoiceHeader.COPYFILTER("Bill-to Customer No.","Bill-to Customer No.");
                                 SalesInvoiceHeader.COPYFILTER("Salesperson Code","Salesperson Code");
                                 SalesInvoiceHeader.COPYFILTER("Payment Terms Code","Payment Terms Code");
                                 SalesInvoiceHeader.COPYFILTER("Shortcut Dimension 1 Code","Shortcut Dimension 1 Code");
                                 SalesInvoiceHeader.COPYFILTER("Shortcut Dimension 2 Code","Shortcut Dimension 2 Code");
                                 SalesInvoiceHeader.COPYFILTER("Sell-to Customer No.","Sell-to Customer No.");
                                 SalesInvoiceHeader.COPYFILTER("Location Code","Location Code");
                                 SalesInvoiceHeader.COPYFILTER("Tax Area Code","Tax Area Code");
                                 SalesInvoiceHeader.COPYFILTER("Responsibility Center","Responsibility Center");
                               END ELSE
                                 CurrReport.BREAK;

                               IF Args."Customer No." THEN
                                 SETCURRENTKEY("Bill-to Customer No.");
                             END;

               CalcFields=Amount,Amount Including VAT;
               DataItemLink=Currency Code=FIELD(Currency Code) }

    { 1000000022;2;Column;AmountLCY_CrMemo   ;
               IncludeCaption=No;
               SourceExpr=Args.GetCreditMemoAmountLCY(SalesCrMemoHeader) }

    { 1000000015;2;Column;CostLCY_CrMemo     ;
               IncludeCaption=No;
               SourceExpr=Args.GetCreditMemoCostLCY(SalesCrMemoHeader) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  Name=Options;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties];
                  GroupType=Group }

      { 1000000002;2;Group  ;
                  Name=Show;
                  CaptionML=[DAN=Vis;
                             DEU=Anzeigen;
                             ENU=Show;
                             ESP=Mostrar;
                             FIN=NÑytÑ;
                             FRA=Afficher;
                             ISL=SÏna;
                             ITA=Mostra;
                             NLD=Weergeven;
                             NOR=Vis];
                  GroupType=Group }

      { 2   ;3   ;Field     ;
                  Name=Invoices;
                  CaptionML=[DAN=Fakturaer;
                             DEU=Rechnungen;
                             ENU=Invoices;
                             ESP=Facturas;
                             FIN=Laskut;
                             FRA=Factures;
                             ISL=Reikningar;
                             ITA=Fatture;
                             NLD=Facturen;
                             NOR=Fakturaer];
                  ToolTipML=[ENU=Specifies if the report includes invoices.;
                             ESM=Especifica si en el informe se incluyen facturas.;
                             FRC=SpÇcifie si le rapport inclut des factures.;
                             ENC=Specifies if the report includes invoices.];
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args.Invoices }

      { 4   ;3   ;Field     ;
                  Name=CreditMemos;
                  CaptionML=[DAN=Kreditnotaer;
                             DEU=Gutschriften;
                             ENU=Credit Memos;
                             ESP=Abonos;
                             FIN=Hyvityslaskujen;
                             FRA=Avoirs;
                             ISL=Kreditreikninga;
                             ITA=Note credito;
                             NLD=Creditnota's;
                             NOR=Kreditnotaer];
                  ToolTipML=[ENU=Specifies if the report includes credit memos.;
                             ESM=Especifica si en el informe se incluyen notas de crÇdito.;
                             FRC=SpÇcifie si le rapport inclut des notes de crÇdit.;
                             ENC=Specifies if the report includes credit memos.];
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Credit Memos" }

      { 1000000001;2;Group  ;
                  Name=GroupBy;
                  CaptionML=[DAN=Grupper efter;
                             DEU=Gruppieren nach;
                             ENU=Group By;
                             ESP=Agrupar por;
                             FIN=Ryhmittelyperuste;
                             FRA=Regrouper par;
                             ISL=Flokka eftir;
                             ITA=Raggruppa per;
                             NLD=Groeperen op;
                             NOR=Grupper etter];
                  GroupType=Group }

      { 1000000000;3;Field  ;
                  Name=CustomerNo;
                  CaptionML=[DAN=Debitornr.;
                             DEU=Debitorennr.;
                             ENU=Customer No.;
                             ESP=Nß cliente;
                             FIN=Asiakasnro;
                             FRA=N¯ client;
                             ISL=N£mer vi–skiptamanns;
                             ITA=Nr. cliente;
                             NLD=Klantnr.;
                             NOR=Kundenr.];
                  SourceExpr=Args."Customer No." }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text000@1012 : TextConst 'ENU=You must Include either Invoices or Credit Memos.;ESM=Debe incluir facturas o crÇditos.;FRC=Vous devez inclure soit les factures soit les notes de crÇdit.;ENC=You must Include either Invoices or Credit Memos.';
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000001();
    VAR
      ForNAVSetup@1000000001 : Record 70000;
      OutStream@1000000000 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Args': WITH Args DO CASE ForNavOperation OF
        END;  'SalesInvoiceHeader': WITH SalesInvoiceHeader DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'SalesCrMemoHeader': WITH SalesCrMemoHeader DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70235 ForNAV Purchase Statistics
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:19;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=ENU=Sales Statistics;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  IF NOT (Args.Invoices OR Args."Credit Memos") THEN
                    ERROR(Text000);
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  Args.CreateCurrencies;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 4146;    ;DataItem;Args                ;
               DataItemTable=Table70230;
               DataItemTableView=SORTING(Currency Code);
               PrintOnlyIfDetail=Yes;
               Temporary=Yes }

    { 5581;1   ;DataItem;PurchInvoiceHeader  ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               ReqFilterHeadingML=[ENU=Sales Invoice;
                                   ESM=Factura venta;
                                   FRC=Facture vente;
                                   ENC=Sales Invoice];
               OnPreDataItem=BEGIN
                               IF NOT Args.Invoices THEN
                                 CurrReport.BREAK;

                               IF Args."Vendor No." THEN
                                 SETCURRENTKEY("Pay-to Vendor No.");
                             END;

               ReqFilterFields=Posting Date,Pay-to Vendor No.,Purchaser Code,Payment Terms Code;
               CalcFields=Amount,Amount Including VAT;
               DataItemLink=Currency Code=FIELD(Currency Code) }

    { 1000000021;2;Column;AmountLCY          ;
               IncludeCaption=No;
               SourceExpr=Args.GetPurchInvAmountLCY(PurchInvoiceHeader) }

    { 1000000010;2;Column;CostLCY            ;
               IncludeCaption=No;
               SourceExpr=0 }

    { 8098;1   ;DataItem;PurchCrMemoHeader   ;
               DataItemTable=Table124;
               DataItemTableView=SORTING(No.);
               OnPreDataItem=BEGIN
                               IF Args."Credit Memos" THEN BEGIN
                                 PurchInvoiceHeader.COPYFILTER("Posting Date","Posting Date");
                                 PurchInvoiceHeader.COPYFILTER("Pay-to Vendor No.","Pay-to Vendor No.");
                                 PurchInvoiceHeader.COPYFILTER("Purchaser Code","Purchaser Code");
                                 PurchInvoiceHeader.COPYFILTER("Payment Terms Code","Payment Terms Code");
                                 PurchInvoiceHeader.COPYFILTER("Shortcut Dimension 1 Code","Shortcut Dimension 1 Code");
                                 PurchInvoiceHeader.COPYFILTER("Shortcut Dimension 2 Code","Shortcut Dimension 2 Code");
                                 PurchInvoiceHeader.COPYFILTER("Sell-to Customer No.","Sell-to Customer No.");
                                 PurchInvoiceHeader.COPYFILTER("Location Code","Location Code");
                                 PurchInvoiceHeader.COPYFILTER("Tax Area Code","Tax Area Code");
                                 PurchInvoiceHeader.COPYFILTER("Responsibility Center","Responsibility Center");
                               END ELSE
                                 CurrReport.BREAK;

                               IF Args."Customer No." THEN
                                 SETCURRENTKEY("Pay-to Vendor No.");
                             END;

               CalcFields=Amount,Amount Including VAT;
               DataItemLink=Currency Code=FIELD(Currency Code) }

    { 1000000022;2;Column;AmountLCY_CrMemo   ;
               IncludeCaption=No;
               SourceExpr=Args.GetPurchCrMemoAmountLCY(PurchCrMemoHeader) }

    { 1000000015;2;Column;CostLCY_CrMemo     ;
               IncludeCaption=No;
               SourceExpr=0 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  Name=Options;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties];
                  GroupType=Group }

      { 1000000002;2;Group  ;
                  Name=Show;
                  CaptionML=[DAN=Vis;
                             DEU=Anzeigen;
                             ENU=Show;
                             ESP=Mostrar;
                             FIN=NÑytÑ;
                             FRA=Afficher;
                             ISL=SÏna;
                             ITA=Mostra;
                             NLD=Weergeven;
                             NOR=Vis];
                  GroupType=Group }

      { 2   ;3   ;Field     ;
                  Name=Invoices;
                  CaptionML=[DAN=Fakturaer;
                             DEU=Rechnungen;
                             ENU=Invoices;
                             ESP=Facturas;
                             FIN=Laskut;
                             FRA=Factures;
                             ISL=Reikningar;
                             ITA=Fatture;
                             NLD=Facturen;
                             NOR=Fakturaer];
                  ToolTipML=[ENU=Specifies if the report includes invoices.;
                             ESM=Especifica si en el informe se incluyen facturas.;
                             FRC=SpÇcifie si le rapport inclut des factures.;
                             ENC=Specifies if the report includes invoices.];
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args.Invoices }

      { 4   ;3   ;Field     ;
                  Name=CreditMemos;
                  CaptionML=[DAN=Kreditnotaer;
                             DEU=Gutschriften;
                             ENU=Credit Memos;
                             ESP=Abonos;
                             FIN=Hyvityslaskujen;
                             FRA=Avoirs;
                             ISL=Kreditreikninga;
                             ITA=Note credito;
                             NLD=Creditnota's;
                             NOR=Kreditnotaer];
                  ToolTipML=[ENU=Specifies if the report includes credit memos.;
                             ESM=Especifica si en el informe se incluyen notas de crÇdito.;
                             FRC=SpÇcifie si le rapport inclut des notes de crÇdit.;
                             ENC=Specifies if the report includes credit memos.];
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Credit Memos" }

      { 1000000001;2;Group  ;
                  Name=GroupBy;
                  CaptionML=[DAN=Grupper efter;
                             DEU=Gruppieren nach;
                             ENU=Group By;
                             ESP=Agrupar por;
                             FIN=Ryhmittelyperuste;
                             FRA=Regrouper par;
                             ISL=Flokka eftir;
                             ITA=Raggruppa per;
                             NLD=Groeperen op;
                             NOR=Grupper etter];
                  GroupType=Group }

      { 1000000000;3;Field  ;
                  Name=VendorNo;
                  CaptionML=[DAN=Debitornr.;
                             DEU=Debitorennr.;
                             ENU=Vendor No.;
                             ESP=Nß cliente;
                             FIN=Asiakasnro;
                             FRA=N¯ client;
                             ISL=N£mer vi–skiptamanns;
                             ITA=Nr. cliente;
                             NLD=Klantnr.;
                             NOR=Kundenr.];
                  SourceExpr=Args."Vendor No." }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text000@1012 : TextConst 'ENU=You must Include either Invoices or Credit Memos.;ESM=Debe incluir facturas o crÇditos.;FRC=Vous devez inclure soit les factures soit les notes de crÇdit.;ENC=You must Include either Invoices or Credit Memos.';
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000001();
    VAR
      ForNAVSetup@1000000001 : Record 70000;
      OutStream@1000000000 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Args': WITH Args DO CASE ForNavOperation OF
        END;  'PurchInvoiceHeader': WITH PurchInvoiceHeader DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'PurchCrMemoHeader': WITH PurchCrMemoHeader DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70240 ForNAV Inv. to G/L Reconcile
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:19;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=ENU=Inventory to G/L Reconcile;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                  COMMIT;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;Args              ;
               DataItemTable=Table70239;
               DataItemTableView=SORTING(To Date);
               OnPreDataItem=BEGIN
                               INSERT;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;                 ;
               DataItemTable=Table27;
               PrintOnlyIfDetail=Yes;
               OnAfterGetRecord=BEGIN
                                  Args.CreateBuffer(Item, InvToGLBuffer);
                                END;

               ReqFilterFields=No.,Inventory Posting Group,Costing Method,Location Filter,Variant Filter;
               CalcFields=Cost is Posted to G/L }

    { 1000000001;2;DataItem;InvToGLBuffer    ;
               DataItemTable=Table70240;
               DataItemTableView=SORTING(Item No.,Variant Code,Location Code);
               OnAfterGetRecord=BEGIN
                                  //WiriteDebugRecord;
                                END;

               CalcFields=Pending Adj.;
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 1000000003;2;Field  ;
                  Name=AsOfDate;
                  CaptionML=[DAN=Til dato;
                             DEU=Bis Datum;
                             ENU=To Date;
                             ESP=Hasta fecha;
                             FIN=Pvm:ÑÑn asti;
                             FRA=Date fin;
                             ISL=Til dags.;
                             ITA=A data;
                             NLD=T/m datum;
                             NOR=Til dato];
                  SourceExpr=Args."To Date" }

      { 1000000004;2;Group  ;
                  CaptionML=[DAN=Detaljer;
                             DEU=Details;
                             ENU=Details;
                             ESP=Detalles;
                             FIN=Erittely;
                             FRA=DÇtails;
                             ISL=Uppl¸singar;
                             ITA=Dettagli;
                             NLD=Details;
                             NOR=Detaljer];
                  GroupType=Group }

      { 1000000002;3;Field  ;
                  Name=BreakdownByVariants;
                  CaptionML=[DAN=Variantkode;
                             DEU=Variantencode;
                             ENU=Variant Code;
                             ESP=C¢d. variante;
                             FIN=Varianttikoodi;
                             FRA=Code variante;
                             ISL=Afbrig˜isk¢ti;
                             ITA=Cod. variante;
                             NLD=Variant;
                             NOR=Variantkode;
                             ESM=C¢d. variante;
                             FRC=Code variante;
                             ENC=Variant Code];
                  SourceExpr=Args."Variant Code" }

      { 1000000001;3;Field  ;
                  Name=BreakdownByLocation;
                  CaptionML=[DAN=Lokationskode;
                             DEU=Lagerortcode;
                             ENU=Location Code;
                             ESP=C¢d. almacÇn;
                             FIN=Sijaintikoodi;
                             FRA=Code magasin;
                             ISL=K¢ti birg˜ageymslu;
                             ITA=Cod. ubicazione;
                             NLD=Vestiging;
                             NOR=Lokasjonskode];
                  SourceExpr=Args."Location Code" }

      { 1000000000;2;Field  ;
                  Name=UseAdditionalReportingCurrency;
                  CaptionML=[DAN=Bel˚b i ekstra valuta;
                             DEU=BetrÑge in BW;
                             ENU=Amounts in Add. Currency;
                             ESP=Importes en divisa adic.;
                             FIN=Summat lisÑvaluuttana;
                             FRA=Montants DR;
                             ISL=Upphë˜ir ° î˜rum gjaldm.;
                             ITA=Importi in val. addizionale;
                             NLD=Bedragen in rapp.-valuta;
                             NOR=Bel˚p i tilleggsvaluta];
                  SourceExpr=Args."Amounts in Add. Currency" }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    PROCEDURE WiriteDebugRecord@1000000000();
    VAR
      ForNAVInventorytoGLBuffer@1000000000 : Record 70240;
    BEGIN
      WITH ForNAVInventorytoGLBuffer DO BEGIN
        TRANSFERFIELDS(InvToGLBuffer);
        "Variant Code" := 'FORNAV';
        INSERT;
      END;
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'InvToGLBuffer': WITH InvToGLBuffer DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Shipped Not Invoiced");
                ReportForNav.AddTotal(DataItemId,1,"Expected Cost Posted to G/L");
                ReportForNav.AddTotal(DataItemId,2,"Cost Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,3,"Cost Posted to G/L");
                ReportForNav.AddTotal(DataItemId,4,"Inventory Value");
                ReportForNav.AddTotal(DataItemId,5,"Received Not Invoiced");
                ReportForNav.AddTotal(DataItemId,6,"Total Expected Cost");
                ReportForNav.AddTotal(DataItemId,7,"Received Not Invoiced Posted");
                ReportForNav.AddTotal(DataItemId,8,"Shipped Not Invoiced Posted");
                ReportForNav.AddTotal(DataItemId,9,"Net Expected Cost Posted");
                ReportForNav.AddTotal(DataItemId,10,"Net Expected Cost Not Posted");
                ReportForNav.AddTotal(DataItemId,11,"Total Invoiced Value");
                ReportForNav.AddTotal(DataItemId,12,"Invoiced Value Posted");
              END;
           'Restore': BEGIN
                 "Shipped Not Invoiced" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Expected Cost Posted to G/L" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Cost Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Cost Posted to G/L" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Inventory Value" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
                 "Received Not Invoiced" := ReportForNav.RestoreTotal(DataItemId,5,GroupTotalFieldNo);
                 "Total Expected Cost" := ReportForNav.RestoreTotal(DataItemId,6,GroupTotalFieldNo);
                 "Received Not Invoiced Posted" := ReportForNav.RestoreTotal(DataItemId,7,GroupTotalFieldNo);
                 "Shipped Not Invoiced Posted" := ReportForNav.RestoreTotal(DataItemId,8,GroupTotalFieldNo);
                 "Net Expected Cost Posted" := ReportForNav.RestoreTotal(DataItemId,9,GroupTotalFieldNo);
                 "Net Expected Cost Not Posted" := ReportForNav.RestoreTotal(DataItemId,10,GroupTotalFieldNo);
                 "Total Invoiced Value" := ReportForNav.RestoreTotal(DataItemId,11,GroupTotalFieldNo);
                 "Invoiced Value Posted" := ReportForNav.RestoreTotal(DataItemId,12,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>4dcAAO1d/XLbtpb/f2f2HVjt3Jt2qtr4BtjEt2M7H/Vs4nhiJ+3szk6GIiFbjSzqUrQb9+6d2afZB9snWYCkPkiCFCFSsto0mTgWBQIH5wA4B79zcPDsh8+3Y+deRrNRODnqwQPQc+TED4PR5PqodxcPvxO9H/72r//y7Oc48t7JaRjFs9feQ3gXX8po5I1Hv8nIWf76YVEROUAHVNeWe9Rzzr1bedTLanoZRufefc85DSdxFI6vHqbqu+fy/sXnaSRns4OVRg/en618RH2noti9bqY/b9U5cuaU9J3Tu3F8F0n1bCLv1CvjvnNxNxiP/H+XD1fhJ6lLB9z3hBQI8CGRBCj6n49m07H3kNKtCT7+4JxN7g+cOHReHb523kk/nPijsew5uV4t+o1V++AAElf1/u3gF+nH5+FRjwNEVO0vR3Ic/CQHioX3I1++j8ZHvZs4nn5/eBjI2ac4nH7n3dzej2LwPQdEHD5/mHi3I3+mqIAQHL597sXe4Wl4O/UmD18/OX339vz95V8QOPUmXuD9BZ2q388m/sGTb3rOhXctf5Sj65v4qIeg7pp+8tMoiG/UA5erB2+86Ho0mamPQPEr96PnvPYmwcz3tIji6G7R3feTkarwSk7im9nb4fGb0Xg8upWxjBTrpiNVFSWqm0rAR71LeR1K5/1Z3xHTWDFjchHJtJI33ky9celHo2m84PKVvFWcj6Xz3bLtnhqLjvPsRH9OflUfzmJ5C7OBdRxdzwrjKRWHZpQuqN9UlGWfPnjR6nvzx1feYKweJv8pQWG38NWHkfxVdeftu6uz81dfX4X6W6lYfBaoYQ7mf3pJD8LIix4ylmUUFzqw0ol3cqgGjLEDP0ovkFFKfkpzyrT0+SqzTzz/02k4DqOj3omSt5LU5eh64umxr8bd0A/U8EaMSOxKxBHDRI2GARFDOfCHFDNBAxy4ejAkMlHjNRnGNULp5ym5iEaT+O3khVpVHvQQm4+Xy5vw17d38fROifj0LopS0R8kxXVDcawWnVn6WfH0qyPnyYvPvhw/Ua+mVJj6nQ7pl6rvCPRWOKp4mnFxlnua5zUx8vpKfo5Pws9zRr+fyegsWDy8VCvdy1TQfaYnRuh7mrqX49BTXVPzBUL3wFV/9MAxDP2+4994usNHYFVuP4bRb8djJaqj3ms5jPXw+axe/b//+d+UgPRBUuJW6krfjIJgLNOyenyqGpP1JKV6hcXZ+wU+KE5cxg9jqRgeRqP4IeUI7TmqeEr10BvPZPK50HL2xWGRs4cJa038RmntrAm/X3yW/p3m6JVaSYpsV4tyn6bs5SbeL7/rgvNXYeA9bM749PVGfOet+Y5MfMdp7cLI94uRr1eFFdZnquRsMgyj24SzH7NCJV5DwcGBmgNQqdscNzNBcSUomEiDMSoqePhOT96cALInCwm8Dq/DpM7EIvmPMLw9u/X0olZmfLpEqWd304PktUaMd60ZjU2MJmltEDQZ4csh8vHUm2qmNllWQMWYnulOHZ2E40AXiOR88R8rRdBsmC+I2HSgzytoxHEIjWN9hfTNJgAxyYVmbSJLuVx4qeZcjGWWjHYAKa6cCoiotT8b8sK89pskdBJGSpUps+skjOPwtkJkxYmRElg3q2ollrzeTFy4ubgWXdlMgjSvwA8NGrysY1b1CzQr9JdhGJuMp/R5vfFkbQfNK71Q0pVnk1SoHRhBlXbV0rpz3YE78DxlCkl/EHDGEfAwoMDnPvApRZ4nBwMp4YrZBPU2xGBfZb2wtqggbTLRUuvtYzI0X0Xh3XSmJtzDxzg8DgK9p2OLqYcoV3oEp1pd0Obr4sq8ugqnFZPqVE4SWb1Re8PR69FkwdR0mv1nWR8eXNyEE3keOolsnjg/OIYySb+yNXG2eONb54nzvfr3remVRbXfO5O7sdqb/vXfPj9/qn4cPzWUfvHxjTcaNychK19LQVYma7+2+R/DW6mHoAUTFq/U0rAo1YgLH46v3snr0Uxt5pPhGzYnp/zqnC4zYeXyjSg8Ozk+b05UUrqWP0mJRi1f/nT28uo0DGxktHynlohlsZSS/zpYUjIcjdWE+np4N0lWFOfre2/8jfOPSBll0cRRH57+85uDX8LR5Osnzn87GpcwarD5vCyrsD+n5J9T8s8pudUp2cwqZEarsKUBCJsagKhoAGYbXciN5sdJGDysmn8a79PP8vvWhR2FXeK5BHhQoAByDwngC+gLoEwqL3C5GCDX44IWLadlrQvzim0ASkHzbr1gQmUf0YqlRKo3jstuLjYQx7NwqIFL0yqre1IYicviJdGtGuCuBe1wHe043VcBDDfuRBXZxrGlHieWoNoB3N1O0h4hkH+1jAFk+/+0Uf27BQJ94UVqVmjgOIWgMyN//HA2fC5jtfjPDdJTb+wnfZtplGYWO6OZc6H+l0HmiTDD14hroP7vL5M1YP7+eXjQP5vcq4bD6CGpRW06nMQO759mn97I+CYM+nOBOGkN/Q9eNPImcfaxAHmjDNSfEzIH9O+9yLmOVL+vwljNfufI+cdyeXKcBSkfvPGd/B6sLqOOdrDI0b0MzsNYFQxHvgyKRS5vRtNpbYmk4Refp2q2ykB3sUErKXfXt2Uudy7j1fYaFVKVmssl5M/bM3Ip96W5klyRlaaWZf751CmsVkU/RXGpQmZYpeysKLspVpbbASeD4YBTT+1ZB5JTEkDoeVwCBNUzb0ixGAgIi8ttyQUAiy6AuhW31BU8pzXWE6e4jf35XTKfCvtStHa9NbSq2n0X/mqip0QTydGk3qogS32zytufMj8fOKCMuwAiTLJfzPSkfJJjI5OMhFXQoevIkawfYLTGF5iHMJfEQwyh+kcRE9TllDPTKq+G9VX46vXJ3XAoo6L1pig+D5cDvLTbuAqnKbr5QUZxhgkkaEEFVmrVWA0vzTYVMttUzQyoXOVGR0xJmJnORkWbqVaYeENhAg4Ehy7ngFDMGRKutTRzeqKFLCvQHmVOFJqwl6DoVIJFl05JgpnVi4pWV60ESVsJ6hnJAMTcVoIGLbsVMZrasZYlBp3Ksug1Ksky8yBhaCNL2laWAgplZXPryVi2g7YiSUMz9oJEnQqy6GYqCTJzOeFiIEetINljCbJkGm9FjuVW7MVIOhUjXSdGljVrZerwjsTIu1hbUwt/Vyts1pq9XLu1etg6ufKsWSurRzyaXKs2nDtabjeWareWEF8nVZE1a2UJuY8mVSM8sBWRmluylifp1hoS6+TpZs3aWEMEPJYSrQJydiHRZWP2Qu3WMnLXogcga9fGNCKbwgdzqVJBOacug9aztIy7bc84yjdjL8purSMI1spyHkJrYx+R1uhBNkPJJuhBESHdFoRQasdemh0jQWuhIJhhQcTGKiJtkQQBCUAIQR221UKa211uK5qyl2m3FhGsBoeeHdZhuXXg4LPDCmS66qUKN1qTWHBidhUWXbWJz6zaVYsAYW6gDzQEnkAUub7vQ04wR3Qw8Fw8BIQO0QAXfAfLWitdtQm9DZ0H2hW8Mjkq1FveebDeV9vKd0Bh0XdQQdWufQe06DOqW2K4mTQMhKuUAQaUuhQJ0MAzkMLztSHO1QHS2cvWc57inSD4tBj2WsdSUcFSTACFFLtQzx0OzSxVbR48l7PEsbuIGE9YlHta27UV4JraGA+umXDIOFAEC0U8oJxVoNKa8LwKyTzdqaN7NRg+/3xtVzLclhbPttRqzloZKGuVatdXYi2Zu9KMePvxyncCjdJihEsdr2jFgE3lLgRCmBG1BTfbEBVyn6VaPA5ffXy9cO41KWvPUpsDJmWWNoUpWfHgSS1LK5ZVgSlEQkBGoMvUhKqeSvVM7IBtDG4JBdwH48gUZ8TQJge7mPm06FXkTWblKIyVxxXmFBVDyoQcADZAREe/+WhIGOPEC4B6RinC3oBAWYi6yBtXq81sbFKxfOxDxYqx23gMRos2VQVZu7apmI3yEZvCZF9aPAZrcygzV7mVNcdstKOAf8Zj1EjQfZR4DG6jjEVbfPMLicfg5mOj247H4DbbVdEVvvlHjsfg5gOl2950cKtNcusgqT98PAZvkyqiLMamGx1uZep0FR/1BcVj8G6tnqbxGNzK6ukqXOqLicfg3VpCTeMxhJUl9HjRU7+7eAzRrTXUNB5DWFlDXUVNfSnxGKJby6hxPIawMo3aRk19EfEYolvrqHk8hrCxj9yuIqb+4PEYomMkqHE8hrCxity2WNAXFY8hurWIfhfxGBWpywzy3egMc3b4eeWo8oWc6FyyznHwy0EvPcc6/wqCPgZ9Dvou6Iu+24ewD1Ef4j4kfUj7kPW1gkhOJefew31kyOBZIL4ilWcSIVqdylM/dvTp6PkxZ51SYXkGWn8qpvmE5TSfztvJ8TCW0SsZ6+ywUTA/B71yBroAnjrfHjmFcIXc90+XMPZqJYZdX7kmQ6GK6sq7jXJt5TIVlZUQhnJdpSLNu5kdfW/S2bRo4y5X1VxVsqJio5lfrtVYrFmVi6Vvba2LknWiyi2rFbLKlamozKBvjaO7WKhJdTVdNpczOH2MZ9oXa2FmRLnFsHNzbFopLm0lu1uSfeLkYbF4/NW7nT5NfjjZV9kik/O/BhRzzHy9skhClZ2Mh5AOsEeki/CQEOYSDzEdc5vzuDYIZUu6WON7LbEA5eyLijj8TkLakqZrXLAl0nDRDVtBXQdu2JRta1yxJQJt9lPrjLacocaEIBwwrKl2GdUY7DpDLRtmWnltGP22WsMaLphNLberzVDSwFpn6kIcmRHt2myJ4DrIOG84I6YMZ4ihgBgJTBq4xOcTZCmQLNHtyuPNuNzVJmXJ5TqH54LLmdPTtdmqrPN55pnMiMs4FhRBjF0GG+w1Tb5pa49yJaMNO4dm/KxzOi74uUglbIOdrnM8GhiqtnqQUYBocrpxDUMrXcWbOXirWAuBAddsxts6P+CCt/N0wMAGx1znbDANViI4dgnBFXG0a0zLFh7Xas52BS4uWV7ns1uwnM3bt1KK64ApA88pwgIxKhhtwPMKN+smztFqjnev9uq8aQuO83n7VnrPyg5JOS4Qojp8iFYE3zbbmrV3Y1ZLoHuVWOf5WkhAzNu30YlwA6XIhStcgBHW0TH260xJAJs5HKv53xXGtuR/nadqwX93nmneRoVCex3KCCQugVgt9Gg9/2ucjJu6Bis5X5Fkvw3n69xJC87PXUqwlHG/lvXrwm3KrBeMUYwYIA0Gfr07sIUTr5r9BmXbcGNT5+lZsnmeK7SU8b6WzfaWDMNMjW4KAEMNzO4qB91GbrVq5m5hO9loPzn3ykBopVnXhTUYNzsCqQ2+K1iDdaXSlbaZA6ya791r0xqvySrf59l9S6lxa/m+LvzAwHeGhDKblBVJGuyJ6pxeG7uqqrnfvS6F9fvRer/VSjU1nq+6kxW1jq9aqLJ8fAYW8/SubyWXtxiZEd/yzSHlO0NWE0djLjxlEEBf+p6yywY+G+g00sxHA88fIsEZBH4Q5LHaPJZrunljQbIFgAtRHsGt0MePguBCVIJwK8h7LAgXIhvFummYaXaihkPKQGIz1N7ZcxmrcehFhXiYoobdcHlBBqXaPRQLkdUx2c3DdxESLhYAYFdfvYmaHBDfJmQIkUF3do/BQmSjIMnGUbTMJZRQpBgLMOewgY2yK/wQ7QabxTYbS9IyrtVFBBCMQQM27wZKxN1vLq3QW2yztyTtolCVBe5SyhGDpIGzbRewIn5kIBfbaEbSMlpUCAYY4WxvIUb8yCAvtlGotFW8JwKCqn0SoMAVG7k1tg034keGe7FVXouW0ZpUuC6DrMkp7F0Cj/iRIV9ilQij1dlbpMxLBAXFhDU5orB7FJJs7Ey1w3qJjT6m7Y5WCkypKzDTwQD7AkiS7jWyJQxMrHarrU5FIkAJUQYRRQzZgmRbBCfJo4PCxEoTtzzBSAXHgjHQLBZmhzAl2TlIvK8wZfX2PbdlJ+br3pLA9zL8uPI4F9hnhCODgeAucQMvCJQB7QviA4yHvkcoVnqaUjEgPpYDaoxcncfArwSuflUIai0gl1W0dRqXCvWOYmUyVUy6x4E1C3kg1asV5D0arEltEmojGw8KxBBQRpVNxKmLm2BCexCZCmlXKbCTFuzxUGqTCpvaRSgAQSAGlKslRunqJrHC28VANdE7wECtkkrSdfiEgaXY1UG/mAnYgKW7Aj6pIWX0FoBPapMgmtlF8WnmIpcxhphSV2KjiKZtwJ20q8zNS55bwZ3U5lILZhfHp3lOAAM6eFLvZPcD4mRd3Tax5LgVxMlstCSzi9tLlhDIgVr6iQuabKEeA9Zk3etFK1izlNiyVgL2epEIxoEO30OswRZq91AmM+jKXUKZzEaJMrvwvWSdx8ougYQ0iVvdJXzJurp5Ycl3K/iSWelXu7NKycrjAqI2hcyF+xk4yQy6dhuQJbPSqXZxk8n45i4ChAOQROLuB0zJu9eqljAlt9KrdnGTqWkuCCGK7xw3AId3BU3yLewx7aBJbqVN7eIm010mcoWyZTgCDZL67BaQ5N1r0t81IGna7uW2eLyo+psCkvmTrUZEkgjMhkMCJfAYJMpmdV3OCBsOXA58wkQwHGIx0LGKDc/Sf1U6TF+BSOaJ6xaS1D7YlUlUocIfB5LUufDykGQFeY8GSVplfiQ221t7SLJ8ONsak2x/kBt2lqwxacEelLTK2sg2QND2CJQ0JVLcAihplTiR2+Nm+wlKmhIabgGUtMpfyO0Bsn0EJTtLMLjkuRUoaZVnkNtDZPsHSnaWBHDJcStQ0ioXIN/AVbT3oGRnKfuWErACJV0bvcjtQbF9ByXd7uO+rUBJ10qJ2oNj+wpKut3Hl1mBklb5rLg9WLbvoKQpf9U2QEmrRFXcHh7bR1ByC1mrLEFJq8RVfANwbC9BSVMSq52CksgqvxXfZJe5t6AkMqW5+pJByfLW49mhKVGnufTqxgSVUnvVn+SGFUglDwaeD4lHiTL8JR9C6rqDwVB6gUckpkyK4QB4vlx/lBtufgkiAvlz0hVOq51eLI10Iq88olhB1q5vQUTA6jrhTc9+7P7QtnkJsQz4sruEMFkzm/Ny83vPmhzUrk6c3eFdgQhYup7t7gREwMbj7G58SKbJ0ew1ybW7vrkPQYPjubsb+hC08Sq7La8Eqz2MXZ9avON79BDsyq9sd5FecvCqOb/bHXRZd/y6NuV8txfeIdiVJ9nuxjsErdRay2QDaw5cN8rLv52L6RDsKjbL7mY6BK1UYat0A2uPWDe5vGArF8gh2FUUtN0Ncgha6c2W6QZqD1Wvvd+h+2veEOoqZsvunjdUyodVn623ZV6BNeeom9yCsZUL2RAyqNgOL15DyEaVJsmxt3h0uv5OkI4vSEOoW23a/IY0hGz0aZIqfIunpdfcndL1TWbJDutRrjJDyEaNJunKt3ZAev0NM1u4cAyhbjXo7+LGsaKRmzNsUVG1p1DdlZLOrIzXrTyuAu2gejBEHggwciHFlCHmY0KGwId84BI+EAHkPEB1oF2umc2RO5w/ClzhQdstcqfzduWRuwqydo7cWWX0gpsaeS2RO03gaHKXWxyWz+zXA1Mirw4RPKs8XWhzC25/EDxTLq4OETyrVFtoY1ttHxE8U2atDhE8q8RZqJVBtlcIXmfJsiwRPKskWaidJbZPCJ4pIdYuEDyrBFmoXYKsfUbwOkuUZYngWaXHQi3TY+0tgtdZiixLBM8qMRZqnRhrzxC8zhJiWSJ4pbxStVxv5TXYYwCPWOaDtgXwqJUmbYdO7xd+R7vVpRb4HbXRprglNL1n8B3tVoNawHfURofi1slt9w69o91qz98Fepc3sMohecVtR77EaqOr36TsvbyRMp6XXMWCdLqlVNB+SltSXA2okzAKZJR80tGbM6m2BxdeEIwm1xooS/8mA+7E8z+dhuMwOur9dDOK5eVt+EljbXGkyr4Mo1sNrZ1LL3qa/ABPz8OJfHp640WeUjrR0+dy6N2N47kcnx0WKH6mjGJFzMxIvs5PGB71uL7EexlrGJ0ff1DD+G66HBw5tEZjf8lri/SGp+Ht1Js8nE2GCcFJvsU5Pcv2nx3+HEdeClnNXnsP4V18KaORNx79JqO//T8=</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70248 ForNAV Cust./Item Statistics
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:19;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Statistika z†kazn°k/zboŒ°;
               DAN=Kunde/Varestatistik;
               DEU=Debitor/Artikelstatistik;
               ENU=Customer/Item Statistics;
               FIN=Asiakas/Nimikkeen tilastot;
               FRA=Statistiques client/article;
               ISL=Vi˜skiptama˜ur/Birg˜auppl¸singar;
               ITA=Statistiche cliente/articolo;
               NLD=Klant/Artikelstatistiek;
               NOR=Kunde/Varestatistikk;
               SVE=Kunde/Artikelstatistik;
               ESN=Estad°sticas cliente/producto];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;Args              ;
               DataItemTable=Table70248;
               OnPreDataItem=BEGIN
                               INSERT;
                             END;

               Temporary=Yes }

    { 6836;    ;DataItem;                    ;
               DataItemTable=Table18;
               PrintOnlyIfDetail=Yes;
               OnPreDataItem=BEGIN
                               ReportForNav.GetDataItem('Customer').NewPagePerRecord := Args."New Page Per Customer";
                             END;

               ReqFilterFields=No.,Search Name,Customer Posting Group }

    { 8894;1   ;DataItem;                    ;
               DataItemTable=Table5802;
               DataItemTableView=SORTING(Source Type,Source No.,Item Ledger Entry Type,Item No.,Posting Date)
                                 WHERE(Source Type=CONST(Customer),
                                       Item Ledger Entry Type=CONST(Sale),
                                       Expected Cost=CONST(No));
               ReqFilterFields=Item No.,Inventory Posting Group,Posting Date;
               DataItemLink=Source No.=FIELD(No.),
                            Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Code=FIELD(Global Dimension 2 Filter) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1000000002;2;Field  ;
                  Name=PrintDetails;
                  CaptionML=[DAN=Udskriv detaljer;
                             DEU=Details drucken;
                             ENU=Print Details;
                             ESP=Imprimir detalles;
                             FIN=Tulosta yksityiskohdat;
                             FRA=Imprimer dÇtails;
                             ISL=Prenta sundurli–un;
                             ITA=Stampa dettagli;
                             NLD=Details afdrukken;
                             NOR=Skriv ut spesifikasjoner;
                             SVE=Skriv ut detaljer];
                  SourceExpr=Args."Print Details" }

      { 1000000001;2;Field  ;
                  Name=NewPagePerCustomer;
                  CaptionML=[DAN=Skift side pr. debitor;
                             DEU=Neue Seite pro Debitor;
                             ENU=New Page per Customer;
                             ESP=P†gina nueva por cliente;
                             FIN=Uusi sivu asiakasta kohti;
                             FRA=Nouvelle page par client;
                             ISL=NÏ bla–s°–a † hvern vi–skiptamann;
                             ITA=Nuova pagina per cliente;
                             NLD=Nieuwe pagina per klant;
                             NOR=Sideskift per kunde;
                             SVE=Ny sida per kund];
                  SourceExpr=Args."New Page Per Customer" }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text000@1480002 : TextConst 'ENU=Invalid Item';
      Text001@1480013 : TextConst 'ENU=Data';
      Text002@1480012 : TextConst 'ENU=Customer/Item Statistics';
      Text003@1480011 : TextConst 'ENU=Company Name';
      Text004@1480010 : TextConst 'ENU=Report No.';
      Text005@1480009 : TextConst 'ENU=Report Name';
      Text006@1480008 : TextConst 'ENU=User ID';
      Text007@1480007 : TextConst 'ENU=Date / Time';
      Text008@1480006 : TextConst 'ENU=Customer Filters';
      Text009@1480005 : TextConst 'ENU=Value Entry Filters';
      Text010@1480004 : TextConst 'ENU=Contribution Margin';
      Text011@1480003 : TextConst 'ENU=Contribution Ratio';
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000000();
    VAR
      ForNAVSetup@1000000001 : Record 70000;
      OutStream@1000000000 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Customer': WITH Customer DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Value Entry"."Sales Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,1,"Value Entry"."Discount Amount");
              END;
           'Restore': BEGIN
                 "Value Entry"."Sales Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Value Entry"."Discount Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'ValueEntry': WITH "Value Entry" DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Invoiced Quantity");
                ReportForNav.AddTotal(DataItemId,1,"Sales Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,2,"Discount Amount");
                ReportForNav.AddTotal(DataItemId,3,"Cost Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,4,"Invoiced Quantity");
                ReportForNav.AddTotal(DataItemId,5,"Sales Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,6,"Cost Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,7,"Discount Amount");
              END;
           'Restore': BEGIN
                 "Invoiced Quantity" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Sales Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Discount Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Cost Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Invoiced Quantity" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
                 "Sales Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,5,GroupTotalFieldNo);
                 "Cost Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,6,GroupTotalFieldNo);
                 "Discount Amount" := ReportForNav.RestoreTotal(DataItemId,7,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>WHAAAO1d227jSHq+D5B34DroaTujkauKxSI5bu3Axx4httux3N2bBIFRIks2pylRS1Hu9m4WyKPsxWCA3C0QIAhyGb9JniR1ICUeijQp2x0gmGmMLZF1+Ov/v6r/VFV+88OXaWjcsXgRRLPBFuyDLYPNvMgPZjeDrWUy+c7Z+uG3f/1Xb36XxPSSzaM4WZzS+2iZjFgc0DD4A4uN9ccPq4ZwH/Ut0Vrh0ZZxTqdssJW2dBLF5/RuyziMZkkchVf3c/7uiN0df5nHbLHo5zrtvx/mvqKeUVPsTnTTy3o1BkZGSc84XIbJMmb82YwteZWwZ1wsx2Hg/R27v4o+MVHatz3qMAcBe4IZBpz+o2AxD+m9olsQvP+Bt7RI+rvDhE2NUUKTYJEE3mLLKIxqNW6T9w/6ELt89O/GPzEvOY8GWzZA2NkyTgIW+h/ZmLPwLvDY+zgcbN0myfz73V2fLT4l0fw7eju9CxLwvQ2ws3t0P6NT3hmnAkKw++6IJnT3MJrO6ex++/Xh5bvz96NXCBzSGfXpK3TIPw9nXv/1zpZxQW/Yjyy4uU0GW8i1gXryMfCTW/4AirGe0fgmmC34VwB7RvoDyB/Z6N7PAl7/is2S28W7yf5ZEIbBlCUs5pyaB7ymhbeM/fAzvV+cskmy7//EeXUY+ewDDZeMN53ES8bHzSU+2Bqxm4gZ74c9w5knnDuzi5ipbkZeHMx5icLDM7rgHWWvUllcsSmXT8K2OEoN480BnfkL+ZF/ERKCKeT245tFCWlKUIKFoqCoyQeRfvtA43y97PEVHYf8ofyVinDoc2yD7L8tSVAU0/g+HWtKTEabsZtRJwEE87SilFaBr2gqePoovRdxMEvezcL74eSIJTQIMw4fxoxz5SpKaMi5/s3vl1GyJ2VgHPMm79WDvvo1oiFbGPvTaDlLjO19L1nScEe96jXX5LPDk7VUZfVQzy7oCAz9/iQIuRAl7jld51G/N2I09m7l0HvZyI2LiE+q2Y3xNo6Wc8Vk4pgkxUPWfoaFO8prxNEkSPgcBntlnq++rjBxySaDLazl74+M+ixW3FXiULhTz/MwP6Dep8MojOLB1gGfWJzpo+BmRsUiwxt3XNf3ge9CgonvAW+MLIbMielQwqzxmFh4PHE9U8w6CWu+MMj1ooTrXrH3VN7HfMm+F/M3E3daXUewmvQnnGgEtnKs4MxIh78oPC0yydIy6Yp9SQ6iLxmH3i9YPPRXD0dcF5yoWdEjfEqcRh4V1J2EEeXS4isKhG7f5f+ZrnYt6BneLeUsSQYgz/Afo/gP+yHn8WBLLC5irn3hVf/nX39RBKgHssSUiUbPAt8PmSorMMNblMjLplkcq5Wln9Yv8YFzYpTch4wzPYqD5F5xhIOQF1dUT/jsYvJ7qef0xW6Zs4VJX+A3Uq3bbfh9/IV5S8HRK774ltnO1VbPUuy1dbxfv3sOzl9FPr3fnPGqeiu+O0/mO9Lx3VStu1q+XwSemM451qfKdjibRPFUcvY6LVThtcS/UeBjKiKbv4BSDoRYTg33LsW0LbA+fbLi/Wl0E8k2pbX2j1E0HU6pWIeqLFerCn+2nPdltVYsh6Azj00dj3HaHGwD7jU6rg/pXPCzzYoCauC8EKMaHEShLwrELFuwQ754t0P4iohNMZ410I7lSAvzHOmbYR/r5GKlfZod5XJBlbbLwNzncoFcMOI3gJZZMxUyyDv6VV8noIMo5kqMWwoHUcItgxqJlSeGoq9pVjUKTFZvJy3cXlqroWwmQKuounc1uruqXfKaBepVedXeyYwwZaotiuvXysABACNgEWJD7GEHsYlNzDExfYAptBwCkWshBsdc1KPb6PO7ZTJfJuu2+28F82X72zuG8ZuBoWzHzIIs2DMVglYmDdnAooGkHdrzfa5XIOJK9UlM7TokJgDCCJkmsklp7VfozDMgXRg4A75Nh/99+ps/0HJKD9yntbjbFlioDKxUdUK9zVIFlvQipBPRDC2XAB/Rydhnnk29MceR6SNm+dB2EYX+BHiQryLCG8hDa916EVzN2NLQ9DR0OW3QVe51jS+7RsMJZFnEQhBqYVUcfCMMavikg9ZztNoaXmYZXpnVoDfNqvCqemg5TPmmBZFlemPqW6ZvmsAljk+Jx10we0wcBibEJ6aNWrpYFecKIqX9gNMdM9wva4EZUeGILaTLy+ko20ZY2fV2poaB6VRQhBSRZuYE1CjiotV0QX0VDnR6QP6TrF0z+QOLk1QPZ0q63pjKDaCioFXtOoNKDL8vv6cjX/TzjbVS1whq1fVqhM/vziHUVrTnUVmiXFo1xi5pY+0+q9wUhR1FllsTioJLW2snM/MlZNbkCiJ9YOiUjlmYSUzFu9JH2drtcK8OVQXmOi39k7VszpZhEpwGs9Xik7Lu7JQ7/+fvB6r7vaP988EBCx/+c7x3dPyef0xierN3PLoYDEUQMmF7J8PzwWg5ndK9k8v9wRmngPJ6w9Hp4P18fvvwy8Nf9oZX+2nxaO/89Ii34otWzt9dqrbnexdXbwdcllGsM7o1MNKCpGCjK/pbAsB6CQA0+alIbyEWACAC4SXxI734nWxhboWB1bAQ1k/bx6AhCJPAOJ7dMl/i4jjgH/lTAQz+2qe+MWU+/y3hcRYkCb3/tAg+fXr4DwkT0cTDv0mUnD38EgYsmHGSJFDkqz8bfmBMg8UyphIxx0y070vIiF4TiRjVE9OsKm0hk1+DRMct8WK/BF6a/Gekt/kKePn7JZ94nMZ2SwZxpKK2TfTcK0dGh4TIPl8OQgmRMza7YRIgh+I9F5zCxsPPDz/HDz9LWKRVM2TQm5mERPb4zxIL+1S2KaAgWw8lFlSZChyesoRkA2kJCvclQGHpQEFUj2Yroy5LoKgFsRLvqoEHNLEy5LouKhuZAinbK8haG3WFQTQLr4OVUGq2lZzNF7HwiE7Odtqj3sIrTH6Vm7rwWhoM0FJ2OnafR7yPrQlp6uyVWhPu6Mxjcy/py4Xh6IA/F+vCK+Ng8t//ZYzjJbcTxNpwtRRy/e6VXBteGVMa3zCD6wTjjjOUyTXiJKbTkN08/IXGr+Ra8cqYy75SU+NjMFuIfqWtwRtOogk3Q35iM7ZIGG9ZLB2vZFqaaSG50cKRjbYloF7E/LR1gHLSHnHRoZXZ0xLGfneZPk2RxPVFY84nHzGoDvsy+lx2T1dEpS6qaRWJ4lX0JMkXa+h9THccgD6ybRsTp9q97OqQhRUXWUtH2TRLuxX1MwqT7IHILq5JWYmMzw/+L50lj06u9QggcrFJMLEwwtC1YGMwrriUPeI6tXHF6pdfnSfVCGm9gdQOv0Ucl13fgshSF9gsW0dNIsNAKzLUg2AjmSEbENN1HBvbGDpQxHfaC42/fEmxiea7CU5vxGwiuLL/m72rm4d14n6zq1k8VGFHt8a56dYLvXGkUZotNSYkaez9a2rMnL5MdaXUlFo9qfxvocmKmlGqxYuKUtSrRKkQX0QdtlOG+EWsK7dthDjvg+X9L6w3wQ4i/z4fHxbf65JZY4osiu2JxdcIxzRd2xzbpk8tAD2f+cD1fGKPmVWKAqsWn5QvwGZhDSxnyMuKvjY/UMoK5PYmjYLwjsWbqX2MC9TxGjUEltR+rvuPt0HCRtPoEyvoUowcy4ZPtAZwOaXZpFpggzGAuhsDJiEYIMLlYSKCgN2oWDT6P799oKI1xC63YLbaBrlYjuVOvvUetyeof6zZwPR0LY/LScAmUaAmJd9dFgJKAJm2Cblh5ti22SyLlVrfUA1jzU6kTbRtMeqMy2muRstWy0DSAcs9Y8gBFXgFTENou8RyTEiIA13idjCWLm6jGRMwz6dkf7O9Kp2+NwbFbOyO8Q2dzvfkD0Pste1L4Ku9rIv8lo60/U6SskBXSZXDwgVJpeFhq2YN1Bu0NVDPSSoHZO7yE2C6CFliYeHeUpMAtCxvw8N6HuSUqlVWqk2jtLSjhG6v/YRuAiQwLe46YqGNWgNS0E69ajTqkc11NfBNW6vCty1+M3K64VcTfGjGbzkiWZBsGpm0yvmtJskSrWRxXrBV/EKMgfCVmxeQlYTa4ndVQc+Deu+lhrsqsZSzVRpY3MkBqumPtOxP15fWLOaPpafCm1tOZ2kvdrHBKi4KWNCnLk6iKClurjhnn8VmCPWixoqeQAshDMiEmJh43Iqm2Hcg9JyJjQHzxqY3JpCIwPjKZDbNPkaAu2+4ZFoX++u+bV2/aaQUfefATPtZJ90xp4iTg5xenjbddhwTIde2be1+nGBibEsop+1fsDjD/Y7xx2/+5svRHv+xvyfozu08TEtv7+yti/ypWFo3pV6yt9b7d0gZYmmAnOh9/SrEGrFlmjbEYzyGDnPtsQswot5E6IcxYtjGYxfyB+bELW7JKYFqUzQRWKSxTUjWVjF8u+dqdgTYahNhvdMmvabNfDaCyj5bjSav99muYjpbzGnMRDZnvbwD7vC4yHUQcPhEtwkxn+i/kfLG40b/rc5r0JpSpg0cyE0obj04wHYqLlU3RUzw0wIdxZmi96e6qi/yHOqr6MQRknFdnXDjCKmxFbpjxwGWY7kEQxtgy+I+81Ox08LhlKnFa5lbvL6+lsfcrlU28fpaHXO7vn4cVI96ornRv6XBbDGO4qgwdhdx/9RCrgUI4jaSo7Xrc3lQSWlKqKJTs89TU6gbpvUHatrhqRlTFVy18G1VbOMrykNGoGzT5lDU+hVpYHSjwzl1QdUmedgaZ3UDebSJNdgtPNji3Mly8dn0+WpS4k4EtkxoAct8bNbotiHo9id0k4r+PE5XqbSJK9gttGEGyq/Efdt0gQVNbnyJBHDdHDH+1uCq1tg1Wi1hnep0k5X+NE5XWZW3emXvuqlnu7t6rk7dDt6l/RTvsrhc2/oDHYXsnPxirazdlUWrz02g9LjvxsBc472UiVOujCHD4zIfNzRomMh03Fu2oFO161G9Ftm4f7hNGJst0i1t6rlIyI14Uc4vmY6TT5lMxomP6XY21fDow7F6rzY5yo+cayFNHv6dyyMDeZ6sdrk1e1N1rMNOg5uW33qS33Zi6z3mqpumTpdXnbXqcfhWJ9uzhi5C6rHhTGUos7Rr7VmMtWPoQN+3x9CbYDT24NjxoMvdFHtCXTYBgNmeNWETgr28Y4jLjmGBlM7uodNqq5/aOHMtV095rcHi+oLeXyfRvu+Le0xIMckniWx7zjV3UPIqmteckjwU+7Li2i0J/1Q92ryK2otDVK9fGz8YmjLaPIDxrfHa+J7//62uyqrZ743ZMgx7xjrooCl9fH1Gg7A9CWn5RgrSMmn/jd3/GE2ZwF4HJqyqNNKwKtWKCx/2ry7ZTbBIYvmdc681OdWqGV16wqrlW1E4PNg/b0+ULN3IH1miVc+jj8OTK3HLTAcZres0ErEupij55/6akok85bY9Wc7kUmJs39Fwx/hjzPjKNDP4l70/7fR/ioLZ9mvjXwxxCY/Wl8jmZdW8+nVK/jolf52SLzolW9lmjn7f0xNP9LdI8FR30qW76MrOb4errS5kbE7cqLS+Z0raqdmlTBD3oN1DZk/sTdLdIzWc3UWBx3wjO4NRuCvq8dukDqNF0lig5lopaTUVSEX6u6YsB5TffAjYZ240vbu8Gp6/3R5Fy9hjhmBWL/0srqKSV7qdMv+GxeqyK1VCPhbvs1upeMtsx/j44/Hlcb6pweG789HVKmm800tlpm82LS3YtSp5/GXOzVLOWcGitMB5tLOzHgy32z7xcaxoHpwMj0+PeKE+b+RtGI25O3IUcPTJ+++gIeZJWkbzVp3T1tVEjTVRVtPQXOq1YhfHCUdaxMdbuM6rwEZ1t5fjuFiE6PcnvJ23LLlkHp9bWaxeHv3lT7dzsQJ1hDSfuUrjCt8OmkMK3+beCi4XXu6VjP/y9WEVy19/c0pdbgvWJLdsD3kYkwlhFGCf8m/Ecd2JZWHC0ARbjuONTeLnk1uuPrel2VFX58FUxlLc61eTNFo7KVi5/Eib4UpPmiOM63Nc+UyBPqxSk+2qUG6VM141pwRqDycA23Idi9gIYFOwu2ZjomJnQ4KiQlmX4wqwbu/7hnE9/c5L03Udx7IsE0DThQ7UxvVySeJRwmFM47WWVjGN/A1g2hhHgSU6nao/hVCNdzxH3k0S0ZiuWEkujYE5XU4tIP0umWeWHHCxDbjwMOBicwAg2n2OL5lGqpWl/mBC+8DrWj516YuVfLL72soxl0b52F9PPjZ0TWQShyDUPc3XqJxaCa+5hc6SdWss3w0kW5cCWUk2TYO4XTYeSh5/Jcm6NkEYYIgspE0YPmcqqlYe+uOIm8hDn+bIySPdCOp22S6I9EfuXmamAWBi2ybAcrXHurY3nyg7bVNaJ9IrHSWxHOYMVfeZpLL/CsR0B5P+Zo1NwFS377Q5b9ZlD4FLykZeTbq03sgzbW6uOiYBCNrIxXVbUGTPXaw8t8vZB6g/h1KzjckhNkQAORi5Fha/NpCy839lQ7ldjjTAFitHfnuX45jc93Bdk68Crml154u88vx5GVNvvLSZBXVnMmu9IP2o4LNvC4Og1S1W6VfU4gKrNmc0a7RAeaetOgH1yOGrDux7ioKtT+PXZREfzcVDoL+NSkZSqnfg5R7XBRvO2edcHKEcRig2UAlc5q99BPoLRWUL1QhI7nEdZdieYAsiCjEZ07GDmIWB5018Qm2XjLE7EZOdCWO+SvKq5drTmJL+lrEQCIrapkbVdD2W+aQoBxRnDIsasN3mzJanLhV/Oqg9CLr4yHoXzNEv7xDZ3MDDFnGQOPzjPmZv11xP13jGsny33QYKxP0qahTCLr6u3iFyeqb8Vz6wQ2xuXDiuCxzTwqb2Sovy/TynUfRpOVeX+FWuc1wxtPFuxkc5C6FWNT9f+ADCLl5mJ9OEr9jYcS0XYMKRqz8Y/F0eu2k2ZXWhVcrI5jKNrMh507ByuXejEVZ7XBHrhgqISyzXtIntmiYwTbEHrebmzgO6YOIOt2hyxuhCXpffmAzX7FtZ4ava1gYIw0+au22dZ1i5dbuR/fpzlM1Ac5ALkekQ/enIZwgHPo41kg22U7i7RdC0PFiCLMBdIROSx5aqrx9be5xNdsamTv5ii9hlmU0iMsIRDgnQBkY2CFQ9PjgnG1wXowC2CN9VAG+7SKgrF2lXG3EWrlGKxRNxLx+XyZ2tMxhfXvLdg9wmitzJuw5xpf8fw61H1+bho1rHuf4ob6OXVoxfv9mt/Gmp0mU2xRJ58yT/5o1KdZf+Zln6p0DEscNIbc2t++sza94VTEZx77SoilY+g3hbKpzZQuKKZfVH6eRfMKv8xZisGufoitg3uw1/EvC3/ws=</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70250 ForNAV Statement
{
  OBJECT-PROPERTIES
  {
    Date=11-06-18;
    Time=14:38:30;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=ENU=Statement;
    OnInitReport=BEGIN
                   GLSetup.GET;
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                  COMMIT;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000001;;DataItem;Args              ;
               DataItemTable=Table70250;
               DataItemTableView=SORTING(Start Date) }

    { 2   ;    ;DataItem;                    ;
               DataItemTable=Table18;
               PrintOnlyIfDetail=Yes;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  ProcessCustomer;
                                  UpdateAging;
                                END;

               ReqFilterFields=No.;
               CalcFields=Balance }

    { 6523;1   ;DataItem;CurrencyLoop        ;
               DataItemTable=Table4;
               DataItemTableView=SORTING(Code);
               PrintOnlyIfDetail=Yes;
               OnAfterGetRecord=BEGIN
                                  Customer.SETRANGE("Date Filter",0D, Args."Start Date" - 1);
                                  Customer.SETRANGE("Currency Filter",CurrencyLoop.Code);
                                  Customer.CALCFIELDS("Net Change");
                                END;

               OnPostDataItem=BEGIN
                                Customer.SETRANGE("Currency Filter");
                              END;

               Temporary=Yes }

    { 3   ;2   ;DataItem;                    ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Customer No.,Posting Date,Currency Code);
               OnPreDataItem=BEGIN
                               SETRANGE("Customer No.", Customer."No.");
                               SETRANGE("Posting Date", Args."Start Date", Args."Ending Date");
                               SETRANGE("Currency Code",CurrencyLoop.Code);
                               SETRANGE("Date Filter", Args."Start Date", Args."Ending Date");
                             END;

               CalcFields=Remaining Amount,Original Amount }

    { 9065;2   ;DataItem;OverdueEntry        ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Customer No.,Open,Positive,Due Date);
               OnPreDataItem=BEGIN
                               SETRANGE("Customer No.", Customer."No.");
                               IF NOT Args."Include Aging Band" THEN
                                 SETRANGE("Due Date", 0D, Args."Ending Date"- 1);
                               SETRANGE("Currency Code", CurrencyLoop.Code);
                               IF (NOT Args."Print Entries Due") AND (NOT Args."Include Aging Band") THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF Args."Include Aging Band" THEN BEGIN
                                    IF ("Posting Date" > Args."Ending Date") AND ("Due Date" >= Args."Ending Date") THEN
                                      CurrReport.SKIP;
                                    IF Args.Date = Args.Date::"Due Date" THEN
                                      IF "Due Date" >= Args."Ending Date" THEN
                                        CurrReport.SKIP;
                                  END;

                                  CALCFIELDS("Remaining Amount");
                                  IF "Remaining Amount" = 0 THEN
                                    CurrReport.SKIP;

                                  IF "Due Date" >= Args."Ending Date" THEN
                                    CurrReport.SKIP;
                                END;

               CalcFields=Original Amount,Remaining Amount;
               DataItemLinkReference=Customer;
               DataItemLink=Customer No.=FIELD(No.) }

    { 1000000000;1;DataItem;AgingBuffer      ;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Entry No.);
               DataItemLink=Account No.=FIELD(No.);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   InitRequestPageDataInternal
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             PLK=Opcje;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 1000000001;2;Field  ;
                  Name=DocumentDate;
                  CaptionML=[DAN=Bilagsdato;
                             DEU=Belegdatum;
                             ENU=Document Date;
                             FIN=Asiakirjan pvm;
                             FRA=Date document;
                             ISL=Dags. fylgiskjals;
                             ITA=Data documento;
                             NLD=Documentdatum;
                             NOR=Bilagsdato;
                             SVE=Dokumentdatum];
                  SourceExpr=Args."Document Date" }

      { 1000000000;2;Field  ;
                  Name=StartDate;
                  CaptionML=[DAN=Startdato;
                             DEU=Startdatum;
                             ENU=Start Date;
                             ESP=Fecha inicial;
                             FIN=Aloituspvm;
                             FRA=Date dÇbut;
                             ISL=Upphafsdagur;
                             ITA=Data di inizio;
                             NLD=Begindatum;
                             NOR=Startdato];
                  SourceExpr=Args."Start Date" }

      { 17  ;2   ;Field     ;
                  Name=EndDate;
                  CaptionML=[DAN=Slutdato;
                             DEU=Enddatum;
                             ENU=Ending Date;
                             ESP=Fecha final;
                             FIN=Lopetuspvm;
                             FRA=Date fin;
                             ISL=Lokadagsetning;
                             ITA=Data fine;
                             NLD=Einddatum;
                             NOR=Sluttdato];
                  ToolTipML=ENU=Specifies the date to which the report or batch job processes information.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Ending Date" }

      { 16  ;2   ;Field     ;
                  Name=ShowOverdueEntries;
                  CaptionML=[DAN=Vis forfaldne poster;
                             DEU=FÑllige Posten drucken;
                             ENU=Show Overdue Entries;
                             ESP=Muestra movs. vencidos;
                             FIN=NÑytÑ erÑÑntyneet tapahtumat;
                             FRA=Afficher Çcritures Çchues;
                             ISL=SÏna gjaldf. fërslur;
                             ITA=Mostra movimenti scaduti;
                             NLD=Vervallen posten weergeven;
                             NOR=Vis forfalte poster;
                             SVE=Visa fîrfallna transaktioner];
                  ToolTipML=ENU=Specifies if you want overdue entries to be shown separately for each currency.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Entries Due" }

      { 15  ;2   ;Group     ;
                  Name=Include;
                  CaptionML=[DAN=Inkluder;
                             DEU=Einschlie·en;
                             ENU=Include;
                             ESP=Incluye;
                             FIN=SisÑllytÑ;
                             FRA=Inclure;
                             ISL=Hafa me–;
                             ITA=Includi;
                             NLD=Invoegen;
                             NOR=Inkluder;
                             SVE=Inkludera];
                  GroupType=Group }

      { 14  ;3   ;Field     ;
                  Name=IncludeAllCustomerswithLE;
                  CaptionML=[DAN=Medtag ogsÜ debitorer, der kun har saldo;
                             DEU=Alle Debitoren mit Saldo einbeziehen;
                             ENU=Include All Customers with a Balance;
                             ESP=Incluye todos los clientes con saldo;
                             FIN=SisÑllytÑ kaikki asiakkaat, joilla on saldo;
                             FRA=Inclure tous les clients ayant un solde.;
                             ISL=Skrifa £t alla me– stî–u;
                             ITA=Includi tutti i clienti con saldo;
                             NLD=Alle klanten met saldo;
                             NOR=Ta med alle kunder med saldo;
                             SVE=Ta med alla kunder med ett saldo];
                  ToolTipML=ENU=Specifies if you want entries displayed for customers that have ledger entries at the end of the selected period.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print All Having Balance";
                  MultiLine=Yes;
                  OnValidate=BEGIN
                               IF NOT Args."Print All Having Entries" THEN
                                 Args."Print All Having Balance" := TRUE;
                             END;
                              }

      { 13  ;3   ;Field     ;
                  Name=IncludeAllCustomerswithBalance;
                  CaptionML=[DAN=Medtag alle debitorer, der har poster;
                             DEU=Alle Debitoren mit Buchungen einbeziehen;
                             ENU=Include All Customers with Ledger Entries;
                             ESP=Incluye todos los clientes con movs.;
                             FIN=SisÑllytÑ kaikki asiakkaat, joilla on tapahtumakirjauksia;
                             FRA=Inclure tous les clients mouvementÇs.;
                             ISL=Skrifa £t alla vskm. me– fërslur;
                             ITA=Includi tutti i clienti con movimenti contabili;
                             NLD=Alle klanten met posten;
                             NOR=Ta med alle kunder med poster;
                             SVE=Ta med alla kunder med reskontratransaktioner];
                  ToolTipML=ENU=Specifies if you want entries displayed for customers that have a balance at the end of the selected period.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print All Having Entries";
                  MultiLine=Yes;
                  OnValidate=BEGIN
                               IF NOT Args."Print All Having Balance" THEN
                                 Args."Print All Having Entries" := TRUE;
                             END;
                              }

      { 10  ;2   ;Group     ;
                  CaptionML=[DAN=Aldersford.intv. efter;
                             DEU=SaldenrÅckblick nach;
                             ENU=Aging Band by;
                             ESP=Rango antigÅedad por;
                             FIN=ErÑÑntymisjakso per;
                             FRA=Cumul par;
                             ISL=T°mabil aldursgreiningar eftir;
                             ITA=Periodo scadenziario per;
                             NLD=Vervaldatuminterval per;
                             NOR=Aldersfordeling pÜ basis av;
                             SVE=èldersspann per];
                  GroupType=Group }

      { 9   ;3   ;Field     ;
                  Name=IncludeAgingBand;
                  CaptionML=[DAN=Medtag aldersford.intv.;
                             DEU=Mit SaldenrÅckblick;
                             ENU=Include Aging Band;
                             ESP=Incluye rango antigÅedad;
                             FIN=Sis. erÑÑntymisjakso;
                             FRA=Inclure cumul date;
                             ISL=Taka aldursgreiningart°mabil me–;
                             ITA=Includi periodo scadenziario;
                             NLD=Vervaldatuminterval opnemen;
                             NOR=Vis aldersfordeling;
                             SVE=Ta med Üldersspann];
                  ToolTipML=ENU=Specifies if you want an aging band to be included in the document. If you place a check mark here, you must also fill in the Aging Band Period Length and Aging Band by fields.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Include Aging Band" }

      { 8   ;3   ;Field     ;
                  Name=AgingBandPeriodLengt;
                  CaptionML=[DAN=Periodelëngde;
                             DEU=PeriodenlÑnge;
                             ENU=Period Length;
                             ESP=Longitud periodo;
                             FIN=Jakson pituus;
                             FRA=Base pÇriode;
                             ISL=Lengd t°mabils;
                             ITA=Durata periodo;
                             NLD=Periodelengte;
                             NOR=Periodelengde];
                  ToolTipML=ENU=Specifies the length of each of the four periods in the aging band, for example, enter "1M" for one month. The most recent period will end on the last day of the period in the Date Filter field.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Period Length" }

      { 7   ;3   ;Field     ;
                  Name=AgingBandby;
                  CaptionML=[DAN=Aldersford.intv. efter;
                             DEU=SaldenrÅckblick nach;
                             ENU=Aging Band by;
                             ESP=Rango antigÅedad por;
                             FIN=ErÑÑntymisjakso per;
                             FRA=Cumul par;
                             ISL=T°mabil aldursgreiningar eftir;
                             ITA=Periodo scadenziario per;
                             NLD=Vervaldatuminterval per;
                             NOR=Aldersfordeling pÜ basis av;
                             SVE=èldersspann per];
                  ToolTipML=ENU=Specifies if the aging band will be calculated from the due date or from the posting date.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args.Date }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

      { 1000000004;1;Group  ;
                  Name=Output Options;
                  CaptionML=[ENU=Output Options;
                             ESM=Opciones de salida;
                             FRC=Options sortie;
                             ENC=Output Options];
                  GroupType=Group }

      { 1000000003;2;Field  ;
                  Name=ReportOutput;
                  CaptionML=[ENU=Report Output;
                             ESM=Salida de informe;
                             FRC=Sortie rapport;
                             ENC=Report Output];
                  ToolTipML=[ENU=Specifies the output of the scheduled report, such as PDF or Word.;
                             ESM=Especifica el tipo del informe programado, como PDF o Word.;
                             FRC=SpÇcifie la sortie du rapport programmÇ, par exemple PDF ou Word.;
                             ENC=Specifies the output of the scheduled report, such as PDF or Word.];
                  OptionCaptionML=[@@@=Each item is a verb/action - to print, to preview, to export to Word, export to PDF, send email, export to XML for RDLC layouts only;
                                   ENU=Print,Preview,Word,PDF,Email,XML - RDLC layouts only;
                                   ESM=Imprimir,Vista previa,Word,PDF,Correo electr¢nico,XML - solo dise§os RDLC;
                                   FRC=Imprimer,Aperáu,Word,PDF,Courriel,XML - PrÇsentations RDLC uniquement;
                                   ENC=Print,Preview,Word,PDF,Email,XML - RDLC layouts only];
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=SupportedOutputMethod;
                  OnValidate=VAR
                               CustomLayoutReporting@1000 : Codeunit 8800;
                             BEGIN
                               //ShowPrintRemaining := (SupportedOutputMethod = SupportedOutputMethod::Email);

                               CASE SupportedOutputMethod OF
                                 SupportedOutputMethod::Print:
                                   ChosenOutputMethod := CustomLayoutReporting.GetPrintOption;
                                 SupportedOutputMethod::Preview:
                                   ChosenOutputMethod := CustomLayoutReporting.GetPreviewOption;
                                 SupportedOutputMethod::Word:
                                   ChosenOutputMethod := CustomLayoutReporting.GetWordOption;
                                 SupportedOutputMethod::PDF:
                                   ChosenOutputMethod := CustomLayoutReporting.GetPDFOption;
                                 SupportedOutputMethod::Email:
                                   ChosenOutputMethod := CustomLayoutReporting.GetEmailOption;
                                 SupportedOutputMethod::XML:
                                   ChosenOutputMethod := CustomLayoutReporting.GetXMLOption;
                               END;
                             END;
                              }

      { 1000000002;2;Field  ;
                  Name=ChosenOutput;
                  ApplicationArea=#Advanced;
                  SourceExpr=ChosenOutputMethod;
                  Visible=False }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      GLSetup@1002 : Record 98;
      Language@1013 : Record 8;
      SupportedOutputMethod@1000000001 : 'Print,Preview,Word,PDF,Email,XML';
      ChosenOutputMethod@1000000000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE ProcessCustomer@1();
    VAR
      Currency@1000 : Record 4;
    BEGIN
      CurrencyLoop.RESET;
      CurrencyLoop.DELETEALL;
      WITH Customer DO BEGIN
        CurrReport.LANGUAGE := Language.GetLanguageID("Language Code");
        IF NOT CurrReport.PREVIEW THEN BEGIN
          LOCKTABLE;
          FIND;
          "Last Statement No." := "Last Statement No." + 1;
          MODIFY;
          COMMIT;
        END ELSE
          "Last Statement No." := "Last Statement No." + 1;
        SETRANGE("Date Filter",0D, Args."Ending Date");
        CALCFIELDS("Net Change");
        IF ("Net Change" <> 0) OR Args."Print All Having Balance" THEN BEGIN
          CurrencyLoop.Code := '';
          CurrencyLoop.INSERT;
          COPYFILTER("Currency Filter", Currency.Code);
          IF Currency.FINDSET THEN
            REPEAT
              CurrencyLoop := Currency;
              CurrencyLoop.INSERT;
            UNTIL Currency.NEXT = 0;
        END;
      END;
    END;

    LOCAL PROCEDURE GetDate@3(PostingDate@1000 : Date;DueDate@1001 : Date) : Date;
    BEGIN
      IF Args.Date = Args.Date::"Posting Date" THEN
        EXIT(PostingDate);
      EXIT(DueDate);
    END;

    LOCAL PROCEDURE InitRequestPageDataInternal@1091();
    BEGIN
      WITH Args DO BEGIN
        IF (NOT "Print All Having Entries") AND (NOT "Print All Having Balance") THEN
          "Print All Having Balance" := TRUE;
        IF FORMAT("Period Length") = '' THEN
          EVALUATE("Period Length",'<1M+CM>');
        IF "Document Date" = 0D THEN
          "Document Date" := TODAY;
      END;
    END;

    LOCAL PROCEDURE UpdateAging@1000000001();
    VAR
      AgingArgs@1000000001 : Record 70219;
      CustomerAging@1000000000 : Codeunit 70220;
    BEGIN
      IF NOT Args."Include Aging Band" THEN
        EXIT;
      CASE Args.Date OF
        Args.Date::"Due Date":
          AgingArgs."Aging By" := AgingArgs."Aging By"::"Due Date";
        Args.Date::"Posting Date":
          AgingArgs."Aging By" := AgingArgs."Aging By"::"Posting Date";
      END;
      AgingArgs."Ending Date" := Args."Ending Date";
      AgingArgs."Period Length" := Args."Period Length";
      AgingArgs."Column Count" := 5;
      AgingArgs.CalcDates;
      CustomerAging.GetAging(Customer, AgingBuffer, AgingArgs);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
      "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'OverdueEntry': WITH OverdueEntry DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Remaining Amount");
                ReportForNav.AddTotal(DataItemId,1,"Remaining Amount");
              END;
           'Restore': BEGIN
                 "Remaining Amount" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Remaining Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'AgingBuffer': WITH AgingBuffer DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Amount 1");
                ReportForNav.AddTotal(DataItemId,1,"Amount 2");
                ReportForNav.AddTotal(DataItemId,2,"Amount 3");
                ReportForNav.AddTotal(DataItemId,3,"Amount 4");
                ReportForNav.AddTotal(DataItemId,4,"Amount 5");
              END;
           'Restore': BEGIN
                 "Amount 1" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount 2" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Amount 3" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Amount 4" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Amount 5" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70252 ForNAV Reminder
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:20;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    OnInitReport=BEGIN
                                                                                                                              ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;Header            ;
               DataItemTable=Table297 }

    { 1000000001;1;DataItem;Line             ;
               DataItemTable=Table298 }

    { 1000000002;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>EAUAAK2UW2/aMBTH3yftO1iWqm4SzcUDQSvSKgvrhsZNFNheTXIAt44d2Q5t9unnAOG2burDIhRsn9vvf3yU9t1LytEalGZSBNh3PIxAxDJhYhng3CyuWvju9v279k+j6BgyqYzu0ULm5gEUo5z9AoUOy9k+Ud0hTqPMdnKE0YCmEOBdpnupBnSNUSSFUZJPiszaOrD+8pIp0No5KupMu0dbUkN/cVuXZWpVVRSgiqSGopybXIE9E5DbEF5Do3zOWfwdiol8gtI7aca0BS3iNRd1qHuWv8N0xmmx5S6BwxkaQ8pEAgqjEyF7qZ9sSc/x69dW8HD+CLEZyAA3PdKwB/cMePID5rZraxbDVPEAr4zJblw3Af1kZHZFV+maGe+m6dVbbqcQNGWxtoV933OHHWqoG8k0o6L4cBmNh4PpwwXxIipoQi9IZNddETuXHzEK+TMtdA8WJkwec20imcCM8hx0gI3KwarLWIBJo14pmQpmAjwBYVZ6uAj7jHOWgimlfk1Y38aXF7SgtpUYjRQTNmfGQPfBrGRyZOtTtWTC1iG+bb39EW/7sg2wtx3gsJyZGmpmBtv5Qqj9mYpEb5Z20zWQ+rth+QZ00+uTKdl2vOxF6VrG2tmC5xFdwgjUGGKpkr3IndeMqtOMlWFC59web/7IdROjro31verBO6ozyD9Ae0zAGzCr3Ygq2+ey1DnPHnSb8XXM1hmmj4+4KlTkHsO6G9pzfLLDn4WTMJW5MP9fx1nq1wV5Z4LIGwWRw/W4J0N0JPdgabv/+JTd/gY=</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70301 ForNAV US Check
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:20;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=ENU=US Check;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                  COMMIT;
                  LoadWatermark;
                  Args.TestMandatoryFields;
                  IF CurrReport.PREVIEW THEN
                    Args."Test Print" := TRUE;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000002;;DataItem;Args              ;
               DataItemTable=Table70300;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

    { 9788;1   ;DataItem;VoidGenJnlLine      ;
               DataItemTable=Table81;
               DataItemTableView=SORTING(Journal Template Name,Journal Batch Name,Posting Date,Document No.);
               OnPreDataItem=VAR
                               TestVoidCheck@1000000000 : Codeunit 70300;
                             BEGIN
                               IF NOT TestVoidCheck.TestVoidCheck(VoidGenJnlLine, Args, CurrReport.PREVIEW) THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=VAR
                                  CheckManagement@1000000000 : Codeunit 367;
                                BEGIN
                                  CheckManagement.VoidCheck(VoidGenJnlLine);
                                END;

               ReqFilterFields=Journal Template Name,Journal Batch Name,Posting Date }

    { 1000000001;1;DataItem;GenJnlLnBuffer   ;
               DataItemTable=Table81;
               DataItemTableView=SORTING(Journal Template Name,Journal Batch Name,Line No.);
               OnPreDataItem=BEGIN
                               CreateGenJnlLnBuffer;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF NOT Args.CreateModelFromGenJnlLn(GenJnlLnBuffer, Model) THEN
                                    CurrReport.SKIP;
                                END;

               Temporary=Yes }

    { 1000000004;2;DataItem;Model            ;
               DataItemTable=Table70303;
               DataItemTableView=SORTING(Page No.,Part No.,Line No.);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   IF NOT Args.GET THEN
                     Args.INSERT;

                   Args."Test Print" := FALSE;
                 END;

      OnClosePage=BEGIN
                    Args.MODIFY;
                  END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 1000000006;2;Field  ;
                  Name=BankAccount;
                  CaptionML=[ENU=Bank Account;
                             ESM=Cuenta bancaria;
                             FRC=Compte bancaire;
                             ENC=Bank Account];
                  ToolTipML=[ENU=Specifies the bank account that the check will be drawn from.;
                             ESM=Especifica la cuenta bancaria desde la que se gira el cheque.;
                             FRC=SpÇcifie le compte bancaire Ö partir duquel le chäque sera tirÇ.;
                             ENC=Specifies the bank account that the cheque will be drawn from.];
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Bank Account No.";
                  TableRelation="Bank Account";
                  OnValidate=BEGIN
                               InputBankAccount;
                             END;
                              }

      { 1000000005;2;Field  ;
                  Name=LastCheckNo;
                  CaptionML=[ENU=Last Check No.;
                             ESM=Èlt. n.ß cheque;
                             FRC=N¯ du dernier chäque;
                             ENC=Last Cheque No.];
                  ToolTipML=[ENU=Specifies the value of the Last Check No. field on the bank account card.;
                             ESM=Especifica el valor del campo Èlt. n.ß cheque que consta en la ficha de cuenta bancaria.;
                             FRC=SpÇcifie la valeur du champ N¯ dernier chäque sur la fiche compte bancaire.;
                             ENC=Specifies the value of the Last Cheque No. field on the bank account card.];
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Check No." }

      { 1000000004;2;Field  ;
                  Name=OneCheckPerVendorPerDocumentNo;
                  CaptionML=[ENU=One Check per Vendor per Document No.;
                             ESM=Un cheque por proveedor y n.ß de documento;
                             FRC=Un chäque par fournisseur par n¯ de document;
                             ENC=One Cheque per Vendor per Document No.];
                  ToolTipML=[ENU=Specifies if only one check is printed per vendor for each document number.;
                             ESM=Especifica si solo se imprime un £nico cheque por proveedor para cada n£mero de documento.;
                             FRC=Indique si un seul chäque est imprimÇ par fournisseur et par numÇro de document.;
                             ENC=Specifies if only one Cheque is printed per vendor for each document number.];
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."One Check Per Vendor";
                  MultiLine=Yes;
                  OnValidate=BEGIN
                               Args.TESTFIELD("Test Print", FALSE);
                             END;
                              }

      { 1000000003;2;Field  ;
                  Name=ReprintChecks;
                  CaptionML=[ENU=Reprint Checks;
                             ESM=Reimprimir cheques;
                             FRC=RÇimprimer les chäques;
                             ENC=Reprint Cheques];
                  ToolTipML=[ENU=Specifies if checks are printed again if you canceled the printing due to a problem.;
                             ESM=Especifica si los cheques se imprimen de nuevo despuÇs de cancelar la impresi¢n debido a un problema.;
                             FRC=Indique si les chäques sont rÇimprimÇs si vous avez annulÇ l'impression suite Ö un probläme.;
                             ENC=Specifies if cheques are printed again if you cancelled the printing due to a problem.];
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Reprint Checks" }

      { 1000000002;2;Field  ;
                  Name=TestPrinting;
                  CaptionML=[ENU=Test Print;
                             ESM=Probar impresi¢n;
                             FRC=êpreuve;
                             ENC=Test Print];
                  ToolTipML=[ENU=Specifies if you want to print the checks on blank paper before you print them on check forms.;
                             ESM=Especifica si desea imprimir los cheques con papel en blanco antes de imprimirlos con formularios preimpresos.;
                             FRC=Indique si vous souhaitez imprimer les chäques sur papier blanc avant de les imprimer sous forme de chäque.;
                             ENC=Specifies if you want to print the cheques on blank paper before you print them on cheque forms.];
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Test Print";
                  OnValidate=BEGIN
                               Args."One Check Per Vendor" := FALSE;
                             END;
                              }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    [External]
    PROCEDURE InputBankAccount@8();
    VAR
      BankAccount@1000000000 : Record 270;
    BEGIN
      IF Args."Bank Account No." <> '' THEN BEGIN
        BankAccount.GET(Args."Bank Account No.");
        BankAccount.TESTFIELD(Blocked,FALSE);
        BankAccount.TESTFIELD("Last Check No.");
        Args."Check No." := BankAccount."Last Check No.";
      END;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      CheckSetup@1000000002 : Record 70310;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH CheckSetup DO BEGIN
        GET;
        CALCFIELDS(Watermark);
        IF NOT Watermark.HASVALUE THEN
          EXIT;
      Watermark.CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE CreateGenJnlLnBuffer@1000000000();
    VAR
      GenJnlLn@1000000000 : Record 81;
    BEGIN
      IF Args."Test Print" THEN BEGIN
        GenJnlLnBuffer.INIT;
        GenJnlLnBuffer.INSERT;
      END ELSE
        WITH GenJnlLn DO BEGIN
          COPY(VoidGenJnlLine);
          IF NOT Args."Test Print" THEN BEGIN
            SETRANGE("Bank Payment Type","Bank Payment Type"::"Computer Check");
            SETRANGE("Check Printed",FALSE);
          END;
          SETRANGE("Account Type","Account Type"::"Fixed Asset");
          IF FIND('-') THEN
            FIELDERROR("Account Type");
          SETRANGE("Account Type");
          IF FINDSET THEN REPEAT
            GenJnlLnBuffer := GenJnlLn;
            GenJnlLnBuffer.INSERT;
          UNTIL NEXT = 0;
        END;
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Model': WITH Model DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Discount Amount");
                ReportForNav.AddTotal(DataItemId,2,"Net Amount");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Discount Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Net Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70518 ForNAV Tax Purchase Templ.
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:20;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Tax Purchase Template;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               MaxIteration=1;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70519 ForNAV Sales Templ. Sales Tax
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:20;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Sales Template Sales Tax;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               MaxIteration=1;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>aIEAAO1d63LjNpb+v1X7Doy2ZmzXKjIuvIBpa1K+tNOuuG1vy91JzdaWC6Igm9O0qKWobntmU7VPsw+2T7IACVK8gBIo0YlnNklVYpEEcHC+A+CcD+Dh0fdPj4HxhUULP5wNe3AAegabeeHEn90Pe8t4+i3pff+nf/6no5/jiH5g8zCKF5f0OVzGIxb5NPD/yiJj9eenvCJzgAaWqK10qWdc0Uc27MmazsPoin7pGafhLI7C4PZ5zu+dsS9vn+YRWywGhUYHHy8KP1HfaHjsi2imn7VqDI1Mkr5xugziZcT4tRlb8iJB37hZjgPf+5E934afmXh64niUMIKAMzWZCbj8Z/5iHtDnVG4h8PEnY0QDtjBu2eM8GGQ/6FPPKHUr7zjmAoABNF3e/evxX5gXX4XDngMs6PaMc58Fk5/YmOvwi++xj1Ew7D3E8fy7w8MJW3yOw/m39OHxix+D7xxgksOz5xl99L0FFwNCcHh9RmN6eBo+zunseX/v9MP11cfRHxA4pTM6oX9Ap/zvi5k32DvoGTf0nr1j/v1DPOwhxzXTKz/5k/iBX4CWKy7MWfSjP5sMe5csjlnUM97T6N6fLXg3ANchf6pvIPEXEspJO/xx5vMqb9ksflhcT4/f+0HgP7Kk9Nnc53VbvK1zjvGwdywspW+487hveA80GrF4yOu5nt1ELK1s5EX+nD8p+3Qxm4bRI425Jgc/sHj/4M0f/+XpTPznuPBXiguvbDmvPeVPjX3jJvJn8WV4H+4fHBh/W900jGLRUxp4CSCL/T3x8F6xnl9UDU+XM0/IVmygXL9o/ptiIx8XjHd2Lp5nk0ThlRKGEfEHo5kRR0v2pnjnl2rFp8soStU2SARgQqExH7uL9PdtOBzu3Zyd7710ExH74rOvWzYjH5rSYMG0Fc5hvmT3NOBzx8QXVxYqzaeKzx+8jehsEays6R2jExYNLunsfsnHwmk4YVX7yMVbU1VFkKaeKvpcNIzmWn7p8SnYMI5O6GyySP7kPy5i9gjlfJr2ozKRptOQmCDEo6Isn37ZVzHobxjH1AsjPs4FNLxgbvl8jD6Gy1ls8GkjWIp1wPh0fNtPL/aM2zCmQfakDfo27Bk/ROFyXrqB+ciX7X6iUVnG7MYtHQf8cvI/CFHlxiduTsPe6PrD7cXVD/tX4eBAzDb/ee4H3AKzZvjl/k24ENYoSjMxWz3xKqIEFr7kCI3MfcYfhXyWueDdRaKaBYuFFq6Wj2MWZSpI5qBMhmwW6kltV5RfAOADmyb9Vag+7bFUfKKDs9BbPvJ5MtdFPj2eUO/zaRiEXJzEsuY0YkLfI/9+RsWyxVcMzzWp5U68ieugMcQYT1zExsw0p3DiUG9qTQAxJ2JeFwPzevaWr+vPoqNZF4+DIPyadu1tFIXRIrsxYsmgUguZrhnnwx7BYAAAgL2CFrgeZM8Xpatl/ZhK/dyyp/gkfOqVjPjubMlSLEfco+CtYpK0ikyzb7kDl//Da7sMvQTj8yCkHCaIYXKLkL5hO+mf2ZIzYvchMz5e9A0yj8XFiElFnwRc6UUQ3oXRX48DrnHuoYg+c3PnIg57//vf/5NLJa4kzwgVDXvv/ckkYPJpYT18LCfmWezTICtdURFX0ih+Dvh64IeRHz+nyrJ6Bl8jUuGTOVH+zuVeXawII28cVpE4TKBQ4YPSJm0dfFYrwd0o5kZNo8kpnSdz1R0fZs85Ytxv6tugBhJ3GixxWQnLCoRc5WmddZ0WVqSqHIOkjJaWnbqW1XpDKr3htBLSwq6THlyG4eflfHF3Q58FZLcselycsUUyJHkHikbPVZiMNoSgwt4R16aDE0t3LLtbW28UbivbL/Z70FS1FmTuywwMrALYTJsUy8buCEvzXKGLEmiBDSXIwK5DDMAKYlcJcN9YCCUNT8Jgsh5sJbS5VO2hy4pqwQahJm5qeEwVPJasGrWFJ5+xastMEZMGNNYuLVugkcuwHoF8dmu1jEC8k9otldptWXWb9byidulcVHW/Runp0u7izgZBWQZd3RcL6QGgu5CrAbBVADiyaq0FWwnAdcSvXYWbdN+dtY8ewq/Xy3i+jHPNShm+Ge7tFWDJJdNEJHteDwzFet8CDEcFBpFVb+0FnC4XcfjIIsX60IRJ54OhJoPealAtpgeC7gquBoGoQHDTqlHrhTqJWhd3J34Q3MXh8WQiuMSSD4uSJQEjUnfAUiqMQ2HbRA3FevV/YlEsva/bcF7yxi7ZlBd+vwxi/9Kf5bFbClgRirQDg2oHKq4Prz6tcT2uDZWd0hm/81UKoQUy0l3uW7pprjK+BLJRLUegzimWTKGlDUAMpIf+csYgneviHFpgGhvNhI/rNfbQ6LErONeicWRV6pmBrvvRNowFSjuQRAPS8kwKkWx16k18jobgFSiCVwjazLq1YZ7CVYhopTzGvxp73xl7/H9ykIp1URl+NQ1uvTr1oHwpRkJJSUDJSSC1j3Pje4IOWz+q5UMNHiUouScp7g6/kQ1ii6wPddeEzmJcJnUm+2d/DsPHi0d6r/QyS9SvKKaHhdNezUoGA0oKA2l5L4URc5P0R6oNqUcLtEDTgNmNmLhvzcAV9y9EcT0tvxDVAJVcA5RkA27jw8iVOvPDCh69aSkxSSijDf7jdsjI6UQh0VaEUb0eLczwC/kdUElAQMlA4NYMhNLvJCv0zBShZmZIMhWQYI4n6XiI5UHYVtC1CsnwS3kISuoCSu4Ct9qLULIVLTYkLPhCY65GY2y3L9Ga1MAv5QuU6Y6jQ8WuUn0fo7iHgdX+QjLczsMwLu/EpVd0duBu6CQ9DQP66b/Sbcj35Sxgm9TD0ETEndrApMBziclcywVoPB671BubcCwCiBuOLruYnYQxn9kyj71ps660J5eJm+/FQdMeEIgsvMVuHHY6mbPsldPs5JGQjQfIAQSL0yR1F3rz7k/B3k/ZLOlz2+Dn31cb54qA5tPx7Qd27y/idJP4KjS+GRp7e8b3RlP0kxNO9aLcozaES83/0GrqO2O2DIK+sVbCm4dwxvjD+oJlJTJxlNLk1WoJ8fbuPfUDfRHk82slkM/I9tc2/46v/GIwtFBCXmStDPlTdS38x6BwzCQ5Z7CfnzbZ/0KDA+Nv8tQG//Hml4PBX0J/tr9n/JchTlcp59/MhOsT8O9G+ruR/upGqrfCE+UK39VRA+EFdcXUodIK1EDbELlQ1pcee0XdXMQ08L1tF6J03VGdSHvTemJQ16KFnAl2Rg7pemGo6oVhiZxYjzUOomW/bhIvS5zMyo4blQ6SiUC8dpIsbUJ9jgz31p0jy/xdQ5wcE9UY6cmyrAi/9JmrknGZPMWRNXF7dT5KlB2eX7y9PJPn00QvcMUdq54aq/pipjp+PAknz0V3Vci6EBd1PNYyaV90VW3qMHcCMcFg6hHXRN7UBFNgjykF1IOYAQt7E5dWvM9C67kDygdb3SgbnM9ap3GpXwlQFTX8/EFe3TzAi3SeomHe9Ifwq0qkmlhmSSxeSi1UcmMFw0/yTDUYWLbjcicYm/IPtTippligVJNSLksth6ijKPFdsnlaOXFd8bRXwtqmaxLi2ABC4gBX0K312UhUq+Ke812ljRtZxUkzqY1PcNfJaviJBku2vye6tHdgDIcGKgS3KhKhpB/V/GfvMP+VKleuYjV45IpmVsOpJnhKZ6k0cUIDyIGyEQYYcaQcCzfCtO6olj5eK3qhWN2GfcCNyOziU9SRqRLaNWQkt21WfQ0FMnF2wWw/diximshybdgMCnevLya8d/7UTxa3ps24zXuAOTDlKltjYe3iJdSxqDLaNSwkuW1BzVHyb0vK+xY/7wbHSUBnn//MojBbBRvwWbXWBTR5be1RQZ2iUuWsa6hI+tqqnlxvQkW84xNO3zO6SPbV2kKDoIMwJFjsNjUgUWmhCzjKVbbHxOwUkyotXcNEMtSW7nIv/nPmLzzxZsaNF28xYByHmBgDF+oPmFqjOwBV9A3yF9vSSIG3PHhHF1lLw2HleENVjPbgdussVE/r1cCVJ/csXWdB2C6X2NtisNmQANPFNnD1YS0019XIS6trD0y3vkL15F4NGHmKz9LwFRJgsjehNFGBA+QS13FMC5kAYxHv6WKSv3PVASCyrtZo2N16C9UjfMX760KidR750WFDfNdUSElryFvJngIPqpePM6kAuNULNeqwvv5GWBJpbvU6GLYQgTYiY9cCxKYm4wE9JRbDHkYWYN4YAyjCe1UsX3u1C8IdwnkbK3qjHdRDsDGqN05CsbG8GPbSrbPdwnzbVIjbQbBvHC/j8Fy8Cr0+SGoV+9u6zkD5lPdVeNdkWRVVbj5GnHWZDAiwLD6NYeRAaEJx0LNh5iqT3gr+IG28FpJmMukeh92SKLDVa3+uml+PO7B13YHKWxSr2LwJZ21YkTvAFiSmoIFs5GDiasK6jm/oDt+1b4ltBFrtS3QItC4VYbehItBWQObjkzgYAIgx0gRyPUfRHZQ7EhfOb0NcOLrERXmIZlTAzuMzgxXxIUosiw9STVgbqY0UuroPqYBUPtSM6aqRUzobPUTJDsl2JKGjpkA6HKy6rIijy4qUIRdBz3VGN3SHu4UgJraDdZfb9URKl+BXWtrdAtSES4cWoMvBONu5XRVWotkGqgf+WluFbdvQtrBNHE2r2MTbtLeL9uxNsyXtTOc4apdOeS6xQ3vSpX2c7fy8nEZ5QUuyiGu5xCFIaUnpWwq5FdVnGjVp1PUsI1vZfYZRO4QvbSa6JJSjS0KVzSQld4o2svPqA52BDSEEgmRwEBanprWmGZk8SBxv2i+8alR5dzQSByyeRbol8eTB3svZT3citrY1ovZXOzSrX5VNa+hk+tZFga9q7qmqQ605Oo2kLA2vZAgerU7AFS63JOCo5UDqutw9G5OxQwA1mWuzyXjsIOpQYDObmXQs2KYVzWZX6bhi81sTcAQrevN6CThiKsR9rQQc2ZqAa7As7SnYGZjAtG0XEAfaLnaxbuD36vg28mr4NrI737YrrMgc2AQhDFzThC4Gti6sfwd8G3k1fBtpw7fhncYndkwCsAuBbiimw7d14zrvyLi5vw3j5u7IuHU18bYG9tdl3NrD+WoINnd7gi3nm7qCmRBTsGwusXQ3Pn4rgq094K+GT3O74dMaId+aBcmNAELbWXeQ8/8Vm+a+bjbN3ZVNezk7crAFgWthYfD/8Gya+7rZNFeXTbsKwXYkmTkgwMWYAMIjNASIEvTfWbJ1NpSwD//wNBkEL8STlcNbCDTzoHEPcrZkkzvJFmcnDbOsPm6a+dEhyuQ+ZiHvWUOKH633KhvOKLZMZVE8KtkCD3XyEX0Taw5Hi2EoBFrpRmqA1NKSqXP6QGSBzSCISatv1KFY5YDMmm+fbjsr2ELzigwizQqux4wbmOH12Zwb8qYKd6CeI6RwuSU1TCgiroktm2DoER5aTAiaIj6eTOCa0CUTbE0tQmmBGnb5mLJNsQlX54elDFvzw0kE29VL16aeUf5dmaTCj9llEu7wFXe8SjvUkGrNBBu1/WpnYbgrwdQ0C2+YJNbmFIdV+imFrz4/JHusW80Proscx0Se4wBCLWBDF0OEbWxCTMaMeZgCOGEUF+YHBKwkH5ggceoHuneeIfQyqcufViFdpusMbNt2LJmvDEFcz1iGBhhj6EK+VJmm9CxUX4RqstZCAsAkB/1VqE7cXUypWHy0hUEq3IIdZgKY73SNHuicqXWc3CpvyVnKhMOgrhMxjtN0CKM4YrH3kH/qZXYvsiIIBjepP20wf7xBI+LJTHRLlizmXNjBEdJLWV7PzGrreqU4ve3YfQMlRsbHmKURzCnMLH/FpylvWvuJTuNzIytlqojykh+jl3K8rkyycTUpaJGkQxVpfrGlpJr841Gfjm+/LSttk1bXFG2hb0UCz2Z9q2jr8mcmtDJz1vXtbNQ3TL6lt6O9jpbjJGtKW18pL6evWFV272bFqujh0ockNPN21xTr6ikWmumiKc7OblRs7c2YqqbXqTLRY3tCpx1e2zXSAlx1UKzPT6gI3NJ3KzTzc2u5xqDNZNatJeRrRHGyajWztUFFnXJTHxUVX1r6gEVDqu2tUIFFVLI8qY0DtOUaw/V+S5+aF5K1gycv2EL1rZbtOs+4IQwpT49Hh7VPDNa8AekFSJ9SfHmWd+tkOZ1qff2xOelWLcdWtW5Vti0HJF+HWZNvi6vzkUbPxo/sWebHgr3ku7lhxC+rth02JsyCSB1dVzNm5R2oJM0q7rOVOzl4+8QliyXx/c3QAG/K31+cMG+MKCYOnI6hhwGP3Fw2JmPPmtgOdG0evWEqXvQqxWdlQVZHAdEOb9xCvVTh8qdZHZJZsAbqcUY6LNO8xg0fs9jojvDOClNoHqYVvZc3Hsql9ceqKv/3DqGbXmJv+RM3a1icnFbqeDNBplRu0Uhb67ZUuIVqW0XFG0NBvRTc8idqs8qvtdtObHVr69yR9a4EgA3JrtUqhNUQ2lq3rWO6Onmat7XHbS2w1UJcj+dapXyAIgWqTs6HphV71X71iaO0HcV3hFPnkMmhmndyFC4jj4kv3eenBx6Y9zlP3C5PeRTPh8ivWmcLLsj+Ufqnq2LFLgt1FeUsdr7YpaP0K9KVb1LLbwTykZt86N5tdiBXbZbm3iQ/ZJh8lEWIXSP3KsWyeSXJ3yiLwXIx1We7K7VkQ0tkW0xrcauNZ/NoVvLocNX/o8Of44imzufikj6Hy3jEBLfJR170p/8D</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70526 ForNAV Template - Landscape
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:20;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Template - Landscape;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table2000000026;
               MaxIteration=1 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70527 ForNAV Template
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:20;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table2000000026;
               MaxIteration=1 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70528 ForNAV Purchase Template
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:20;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Purchase Template;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               MaxIteration=1;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70529 ForNAV Sales Template
{
  OBJECT-PROPERTIES
  {
    Date=31-05-18;
    Time=19:08:20;
    Modified=Yes;
    Version List=SHIP,FORNAV3.2.0.1492/1492;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Sales Template;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := ReportForNavAllowDesign;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               MaxIteration=1;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.2.0.1492, Version=3.2.0.1492, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@5013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5014(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5015();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5003(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5016(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code.
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
      ForNavOperation@1000000009 : Text;
    BEGIN
      // This code is created automatically every time Reports ForNAV saves the report.
      // Do not modify this code. Instead change the Create Totals, Total Fields or Group
      // Total Fields properties on the Data item in the ForNAV designer.
      ForNavOperation := Operation;
      CASE DataItemId OF
        'Header': WITH Header DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE ForNavOperation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Codeunit 70000 ForNAV Check Document Discount
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE HasDiscount@1000000001(Rec@1000000000 : Variant) : Boolean;
    VAR
      RecRefLib@1000000002 : Codeunit 70090;
      TestValidDociFace@1000000003 : Codeunit 70080;
      RecRef@1000000001 : RecordRef;
    BEGIN
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      TestValidDociFace.ThrowErrorIfNotValid(RecRef);
      EXIT(CheckLinesTableForDiscount(RecRef, FindDiscountFieldNoInLines(RecRef)));
    END;

    LOCAL PROCEDURE FindDiscountFieldNoInLines@1000000009(RecRef@1000000001 : RecordRef) : Integer;
    VAR
      Field@1000000000 : Record 2000000041;
      NoDiscountFieldErr@1000000002 : TextConst 'ENU=The connected line table does not contain a valid field for Line Discount.';
    BEGIN
      Field.SETRANGE(TableNo, RecRef.NUMBER + 1);
      Field.SETRANGE(FieldName, 'Line Discount %');
      IF NOT Field.FINDFIRST THEN
        ERROR(NoDiscountFieldErr);

      EXIT(Field."No.");
    END;

    LOCAL PROCEDURE CheckLinesTableForDiscount@1000000011(VAR RecRef@1000000000 : RecordRef;FieldNo@1000000001 : Integer) : Boolean;
    VAR
      RecRefLib@1000000004 : Codeunit 70090;
      LineRec@1000000003 : RecordRef;
      FldRef@1000000002 : FieldRef;
    BEGIN
      LineRec.OPEN(RecRef.NUMBER + 1);

      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'No.');
      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'Document Type');

      FldRef := LineRec.FIELD(FieldNo);
      FldRef.SETFILTER('<>0');
      EXIT(NOT LineRec.ISEMPTY);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70001 ForNAV Get Vat Amount Lines
{
  OBJECT-PROPERTIES
  {
    Date=12-12-17;
    Time=12:25:38;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetVatAmountLines@1000000000(Rec@1000000000 : Variant;VAR VATAmountLine@1000000001 : TEMPORARY Record 290);
    VAR
      DocLineBuffer@1000000006 : TEMPORARY Record 70999;
      RecRefLib@1000000002 : Codeunit 70090;
      TestValidDociFace@1000000004 : Codeunit 70080;
      RecRef@1000000003 : RecordRef;
      LineRec@1000000005 : RecordRef;
    BEGIN
      ThrowErrorIfNotTemp(VATAmountLine);
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      TestValidDociFace.ThrowErrorIfNotValid(RecRef);
      FindLinesRecRef(DocLineBuffer, RecRef, LineRec);
      CreateVATAmountLine(DocLineBuffer, VATAmountLine);
    END;

    LOCAL PROCEDURE ThrowErrorIfNotTemp@1000000001(VAR VATAmountLine@1000000000 : Record 290);
    VAR
      CheckTemporary@1000000002 : Codeunit 70008;
    BEGIN
      CheckTemporary.IsTemporary(VATAmountLine, TRUE);
    END;

    LOCAL PROCEDURE FindLinesRecRef@1000000003(VAR DocLineBuffer@1000000004 : Record 70999;VAR RecRef@1000000000 : RecordRef;VAR LineRec@1000000001 : RecordRef);
    VAR
      RecRefLib@1000000002 : Codeunit 70090;
      FldRef@1000000003 : FieldRef;
    BEGIN
      LineRec.OPEN(RecRef.NUMBER + 1);

      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'No.');
      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'Document Type');
      IF LineRec.FINDSET THEN REPEAT
        DocLineBuffer.CreateForRecRef(LineRec);
      UNTIL LineRec.NEXT = 0;
    END;

    LOCAL PROCEDURE CreateVATAmountLine@1000000002(VAR DocLineBuffer@1000000001 : Record 70999;VAR VATAmountLine@1000000000 : Record 290);
    BEGIN
      WITH DocLineBuffer DO
        IF FINDSET THEN REPEAT
          VATAmountLine.INIT;
          VATAmountLine."VAT Identifier" := "VAT Identifier";
          VATAmountLine."VAT Calculation Type" := "VAT Calculation Type";
          VATAmountLine."Tax Group Code" := "Tax Group Code";
          VATAmountLine."VAT %" := "VAT %";
          VATAmountLine."VAT Base" := Amount;
          VATAmountLine."Amount Including VAT" := "Amount Including VAT";
          VATAmountLine."Line Amount" := "Line Amount";
          IF "Allow Invoice Disc." THEN
            VATAmountLine."Inv. Disc. Base Amount" := "Line Amount";
          VATAmountLine."Invoice Discount Amount" := "Inv. Discount Amount";
          VATAmountLine."VAT Clause Code" := "VAT Clause Code";
          IF ("VAT %" <> 0) OR ("VAT Clause Code" <> '') OR (Amount <> "Amount Including VAT") THEN
            VATAmountLine.InsertLine;
        UNTIL NEXT = 0;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70002 ForNAV Get Vat Clause
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      TryGetVATClause@1000000000 : Integer;

    PROCEDURE GetVATClauses@1000000000(VAR VATAmountLine@1000000001 : TEMPORARY Record 290;VAR VATClause@1000000000 : Record 560;LanguageCode@1000000002 : Code[10]);
    BEGIN
      WITH VATAmountLine DO
        IF FINDSET THEN REPEAT
          TryGetVATClauseText(VATClause, "VAT Clause Code", LanguageCode);
        UNTIL NEXT = 0;
    END;

    LOCAL PROCEDURE TryGetVATClauseText@1000000002(VAR VATClausePar@1000000000 : Record 560;VATClauseCode@1000000002 : Code[10];LanguageCode@1000000003 : Code[10]);
    VAR
      VATClause@1000000001 : Record 560;
    BEGIN
      IF NOT VATClause.GET(VATClauseCode) THEN
        EXIT;

      VATClause.TranslateDescription(LanguageCode);

      VATClausePar := VATClause;
      IF VATClausePar.INSERT THEN;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70003 ForNAV Update No. Printed
{
  OBJECT-PROPERTIES
  {
    Date=14-05-18;
    Time=20:06:29;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    Permissions=TableData 36=rm,
                TableData 38=rm,
                TableData 110=rm,
                TableData 112=rm,
                TableData 114=rm,
                TableData 120=rm,
                TableData 122=rm,
                TableData 124=rm;
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE UpdateNoPrinted@1000000001(Rec@1000000000 : Variant;Preview@1000 : Boolean);
    VAR
      RecRefLib@1000000003 : Codeunit 70090;
      RecRef@1000000001 : RecordRef;
    BEGIN
      IF Preview THEN
        EXIT;

      RecRefLib.ConvertToRecRef(Rec, RecRef);
      FindAndUpdateField(RecRef);
    END;

    LOCAL PROCEDURE FindAndUpdateField@1000000003(VAR RecRef@1000000000 : RecordRef);
    VAR
      Field@1000000001 : Record 2000000041;
      FldRef@1000000003 : FieldRef;
      NoPrinted@1000000004 : Integer;
    BEGIN
      Field.SETRANGE(TableNo, RecRef.NUMBER);
      Field.SETRANGE(FieldName, 'No. Printed');
      IF NOT Field.FINDFIRST THEN
        EXIT;

      FldRef := RecRef.FIELD(Field."No.");
      NoPrinted := FldRef.VALUE;
      NoPrinted +=1;
      FldRef.VALUE := NoPrinted;
      RecRef.MODIFY;
      COMMIT;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70004 ForNAV Get Sales Tax Details
{
  OBJECT-PROPERTIES
  {
    Date=12-12-17;
    Time=12:25:24;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetSalesTax@1000000000(Rec@1000000000 : Variant;VAR SalesTaxBuffer@1000000001 : TEMPORARY Record 70998);
    VAR
      DocLineBuffer@1000000006 : TEMPORARY Record 70999;
      RecRefLib@1000000002 : Codeunit 70090;
      TestValidDociFace@1000000004 : Codeunit 70080;
      RecRef@1000000003 : RecordRef;
      LineRec@1000000005 : RecordRef;
    BEGIN
      ThrowErrorIfNotTemp(SalesTaxBuffer);
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      TestValidDociFace.ThrowErrorIfNotValid(RecRef);
      FindLinesRecRef(DocLineBuffer, RecRef, LineRec);
      CreateSalesTaxDetails(DocLineBuffer, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE ThrowErrorIfNotTemp@1000000001(VAR SalesTaxBuffer@1000000000 : Record 70998);
    VAR
      CheckTemporary@1000000001 : Codeunit 70008;
    BEGIN
      CheckTemporary.IsTemporary(SalesTaxBuffer, TRUE);
    END;

    LOCAL PROCEDURE FindLinesRecRef@1000000003(VAR DocLineBuffer@1000000004 : Record 70999;VAR RecRef@1000000000 : RecordRef;VAR LineRec@1000000001 : RecordRef);
    VAR
      RecRefLib@1000000002 : Codeunit 70090;
      FldRef@1000000003 : FieldRef;
    BEGIN
      LineRec.OPEN(RecRef.NUMBER + 1);

      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'No.');
      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'Document Type');
      IF LineRec.FINDSET THEN REPEAT
        DocLineBuffer.CreateForRecRef(LineRec);
      UNTIL LineRec.NEXT = 0;
    END;

    LOCAL PROCEDURE CreateSalesTaxDetails@1000000002(VAR DocLineBuffer@1000000001 : Record 70999;VAR SalesTaxBuffer@1000000000 : Record 70998);
    BEGIN
      SalesTaxBuffer.INIT;
      SalesTaxBuffer.INSERT;

      WITH DocLineBuffer DO
        IF FINDSET THEN REPEAT
          IF "VAT %" = 0 THEN
            SalesTaxBuffer."Exempt Amount" := SalesTaxBuffer."Exempt Amount" + Amount
          ELSE
            SalesTaxBuffer."Taxable Amount" := SalesTaxBuffer."Taxable Amount" + Amount;
          SalesTaxBuffer.MODIFY;
        UNTIL NEXT = 0;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70005 ForNAV Detect Localization
{
  OBJECT-PROPERTIES
  {
    Date=20-07-17;
    Time=19:43:26;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE CheckLocalizationBasedOnTables@1(VAR ForNAVSetup@1000 : Record 70000);
    VAR
      AllObjWithCaption@1001 : Record 2000000058;
    BEGIN
      WITH AllObjWithCaption DO BEGIN
        SETRANGE("Object Type", "Object Type"::Table);
        SETRANGE("Object ID", 10000);
        IF NOT ISEMPTY THEN BEGIN
          ForNAVSetup.Localization := ForNAVSetup.Localization::"North America";
          EXIT;
        END;
        SETRANGE("Object Type", "Object Type"::Table);
        SETRANGE("Object ID", 11000, 49999);
        IF NOT ISEMPTY THEN BEGIN
          ForNAVSetup.Localization := ForNAVSetup.Localization::Other;
          EXIT;
        END;

        ForNAVSetup.Localization := ForNAVSetup.Localization::"World Wide";

      END;
    END;

    PROCEDURE ValidateCurrentLocalization@2(ForNAVSetup@1000 : Record 70000) : Boolean;
    VAR
      ForNAVSetupSetLocalization@1001 : Record 70000;
    BEGIN
      CheckLocalizationBasedOnTables(ForNAVSetupSetLocalization);
      EXIT(ForNAVSetupSetLocalization.Localization = ForNAVSetup.Localization);
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70006 ForNAV Read Watermarks
{
  OBJECT-PROPERTIES
  {
    Date=22-05-18;
    Time=08:53:45;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ReadFromFile@1(VAR ForNAVSetup@1004 : Record 70000;Which@1003 : Integer) : Boolean;
    VAR
      TempBlob@1002 : TEMPORARY Record 99008535;
      FileMgt@1001 : Codeunit 419;
      FileName@1000 : Text;
      InStream@1000000000 : InStream;
      OutStream@1000000001 : OutStream;
    BEGIN
      //FileName := FileMgt.BLOBImport(TempBlob,'');
      UPLOADINTOSTREAM('Select a file', '', 'PDF files (*.pdf)|*.pdf|All files (*.*)|*.*', FileName, InStream);
      TempBlob.Blob.CREATEOUTSTREAM(OutStream);
      COPYSTREAM(OutStream, InStream);

      WITH ForNAVSetup DO
        IF FileName <> '' THEN BEGIN
          CASE Which OF
            FIELDNO(Logo):
              BEGIN
                Logo := TempBlob.Blob;
                "Logo File Name" := GetFileNameFromFile(FileName);
              END;
            FIELDNO("Document Watermark"):
              BEGIN
               "Document Watermark" := TempBlob.Blob;
                "Document Watermark File Name" := GetFileNameFromFile(FileName);
              END;
            FIELDNO("List Report Watermark"):
              BEGIN
                "List Report Watermark" := TempBlob.Blob;
                "List Report Watermark File N." := GetFileNameFromFile(FileName);
              END;
          END;
          EXIT(TRUE);
        END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE GetFileNameFromFile@3(Value@1000 : Text) : Text;
    VAR
      LastPos@1001 : Integer;
      i@1002 : Integer;
    BEGIN
      WHILE i < STRLEN(Value) DO BEGIN
        i := i + 1;
        IF Value[i] = '\' THEN
          LastPos := i;
      END;

      EXIT(COPYSTR(Value, LastPos + 1));
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70007 ForNAV Get No. of Copies
{
  OBJECT-PROPERTIES
  {
    Date=20-12-17;
    Time=12:47:50;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetNoOfCopies@1000000001(Rec@1000000000 : Variant) : Integer;
    VAR
      RecRefLib@1000000003 : Codeunit 70090;
      TestValidDociFace@1000000002 : Codeunit 70080;
      RecRef@1000000001 : RecordRef;
    BEGIN
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      IF NOT TestValidDociFace.CheckValid(RecRef) THEN
        EXIT(0);

      EXIT(FindNoOfCopiesFromBillToCustomerNo(RecRef));
    END;

    LOCAL PROCEDURE FindNoOfCopiesFromBillToCustomerNo@1000000003(VAR RecRef@1000000000 : RecordRef) : Integer;
    VAR
      Customer@1000000002 : Record 18;
      Field@1000000001 : Record 2000000041;
      FldRef@1000000003 : FieldRef;
    BEGIN
      Field.SETRANGE(TableNo, RecRef.NUMBER);
      Field.SETRANGE(FieldName, 'Bill-to Customer No.');
      IF NOT Field.FINDFIRST THEN
        EXIT(0);

      FldRef := RecRef.FIELD(Field."No.");
      Customer.GET(FldRef.VALUE);
      EXIT(Customer."Invoice Copies");
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70008 ForNAV Check Temporary
{
  OBJECT-PROPERTIES
  {
    Date=12-12-17;
    Time=14:30:31;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE IsTemporary@1000000001(Rec@1000000001 : Variant;ThrowError@1000000000 : Boolean) : Boolean;
    VAR
      RecRef@1000000002 : RecordRef;
      RecordRefLibrary@1000000003 : Codeunit 70090;
      RecordShouldBeTempErr@1000000004 : TextConst 'ENU=The Record Variable (%1) must be temporary when callng this API.';
    BEGIN
      RecordRefLibrary.ConvertToRecRef(Rec, RecRef);
      IF RecRef.ISTEMPORARY THEN
        EXIT(FALSE);

      IF ThrowError THEN
        ERROR(RecordShouldBeTempErr, RecRef.NAME);

      EXIT(TRUE);
    END;

    BEGIN
    {
      We use this codeunit because ReportsForNAV is backwards compatible with NAV 2015. This version does not support ISTEMPORARY on record variables
    }
    END.
  }
}

OBJECT Codeunit 70009 ForNAV First Time Setup
{
  OBJECT-PROPERTIES
  {
    Date=14-05-18;
    Time=08:56:55;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            IF CheckIfSetupExists THEN
              EXIT;

            AskForDefault;
            RunWizardIfSetupDoesNotExist;
          END;

  }
  CODE
  {

    LOCAL PROCEDURE CheckIfSetupExists@2() : Boolean;
    VAR
      Setup@1000 : Record 70000;
    BEGIN
      EXIT(Setup.GET);
    END;

    LOCAL PROCEDURE AskForDefault@3();
    VAR
      SetDefaultsQst@1000 : TextConst 'ENU=Do you want to setup ForNAV with default values?';
      Setup@1001 : Record 70000;
      CheckSetup@1000000000 : Record 70310;
    BEGIN
      IF NOT CONFIRM(SetDefaultsQst, TRUE) THEN
        EXIT;

      Setup.InitSetup;
      Setup.CreateWebService;
      Setup.ReplaceReportSelection(TRUE);
      CheckSetup.InitSetup;
      CheckSetup.SetDefault(Setup);
      COMMIT;
    END;

    LOCAL PROCEDURE RunWizardIfSetupDoesNotExist@4();
    VAR
      Setup@1000 : Record 70000;
      SetupWizard@1000000000 : Page 70005;
    BEGIN
      IF Setup.GET THEN
        EXIT;

      SetupWizard.RUNMODAL;

      IF Setup.GET THEN
        COMMIT;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70010 ForNAV Check Setup
{
  OBJECT-PROPERTIES
  {
    Date=14-05-18;
    Time=08:53:04;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    TableNo=70000;
    OnRun=VAR
            CheckSetup@1000000000 : Record 70310;
          BEGIN
            CreateCheckSetupRecord(CheckSetup);
            SetCheckType(Rec, CheckSetup);
          END;

  }
  CODE
  {

    PROCEDURE CreateCheckSetupRecord@1000000001(VAR CheckSetup@1000000000 : Record 70310);
    BEGIN
      CheckSetup.InitSetup;
    END;

    PROCEDURE SetCheckType@1000000002(Setup@1000000001 : Record 70000;VAR CheckSetup@1000000000 : Record 70310);
    BEGIN
      WITH Setup DO BEGIN
        CASE Localization OF
          Localization::"North America":
            IF CheckSetup.Layout = CheckSetup.Layout::" " THEN
              CheckSetup.Layout := CheckSetup.Layout::"Check-Stub-Stub";
          ELSE
            CheckSetup.Layout := CheckSetup.Layout::" ";
        END;

        CheckSetup.MODIFY;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2018 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70011 ForNAV Create Web Services
{
  OBJECT-PROPERTIES
  {
    Date=22-05-18;
    Time=14:02:21;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            CreateWebService;
          END;

  }
  CODE
  {

    LOCAL PROCEDURE CreateWebService@1000000000();
    VAR
      TempWebService@1000000004 : TEMPORARY Record 70002;
      RecRef@1000000000 : RecordRef;
      FldRef@1000000001 : FieldRef;
    BEGIN
      CreateTempWebService(TempWebService);

      RecRef.OPEN(GetObjectID);

      WITH TempWebService DO BEGIN
        FINDSET;
        REPEAT
          FldRef := RecRef.FIELD(FIELDNO("Object Type"));
          FldRef.VALUE := "Object Type";

          FldRef := RecRef.FIELD(FIELDNO("Object ID"));
          FldRef.VALUE := "Object ID";

          FldRef := RecRef.FIELD(FIELDNO("Service Name"));
          FldRef.VALUE := "Service Name";
          FldRef.VALIDATE;

          IF NOT RecRef.INSERT THEN
            EXIT;

          FldRef := RecRef.FIELD(FIELDNO(Published));
          FldRef.VALIDATE(TRUE);

          RecRef.MODIFY;
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE GetObjectID@1000000001() : Integer;
    VAR
      AllObjWithCaption@1000000000 : Record 2000000058;
    BEGIN
      WITH AllObjWithCaption DO BEGIN
        SETRANGE("Object Type", "Object Type"::Table);
        SETRANGE("Object ID", 2000000168);
        IF NOT ISEMPTY THEN
          EXIT(2000000168);
      END;

      EXIT(2000000076);
    END;

    LOCAL PROCEDURE CreateTempWebService@1000000004(VAR WebService@1000000000 : Record 70002);
    BEGIN
      WebService."Object Type" := WebService."Object Type"::Page;
      WebService."Object ID" := PAGE::Fields;
      WebService."Service Name" := 'Fields';
      WebService.INSERT;

      WebService."Object Type" := WebService."Object Type"::Page;
      WebService."Object ID" := PAGE::"ForNAV Fields Webservice";
      WebService."Service Name" := 'FieldsEx';
      WebService.INSERT;
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70019 ForNAV Notifications
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Codeunit,1,OnAfterFindPrinter,"",Skip,Skip)]
    LOCAL PROCEDURE OnFindPrinter@2(ReportID@1000 : Integer;VAR PrinterName@1001 : Text[250]);
    BEGIN
      ShowSetupNotification;
    END;

    LOCAL PROCEDURE ShowSetupNotification@1();
    VAR
      MyNotifications@1006 : Record 1518;
      ForNAVSetup@1001 : Record 70000;
      NotificationIDs@1004 : Codeunit 70022;
      MyNotification@1000 : Notification;
      ForNAVNotSetup@1002 : TextConst 'ENU=ForNAV is installed but not setup. Do you want to do this now?';
      Yes@1003 : TextConst 'ENU=Yes';
      NoAndDontAskAgain@1005 : TextConst 'ENU=No, and please don''t remind me again.';
    BEGIN
      IF ForNAVSetup.GET THEN
        EXIT;

      IF NOT MyNotifications.IsEnabled(NotificationIDs.SetupForNAV) THEN
        EXIT;

      MyNotification.ID := NotificationIDs.SetupForNAV;
      MyNotification.MESSAGE := ForNAVNotSetup;
      MyNotification.ADDACTION(Yes, CODEUNIT::"ForNAV Notification Actions", 'SetupForNAV');
      MyNotification.ADDACTION(NoAndDontAskAgain, CODEUNIT::"ForNAV Notification Actions", 'DisableSetup');
      MyNotification.SEND;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70020 ForNAV Notification Actions
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE SetupForNAV@2(VAR MyNotification@1000 : Notification);
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
    END;

    PROCEDURE DisableSetup@1(VAR MyNotification@1000 : Notification);
    VAR
      MyNotifications@1001 : Record 1518;
      NotificationID@1002 : GUID;
    BEGIN
      MyNotifications.LOCKTABLE;
      NotificationID := MyNotification.ID;
      IF MyNotifications.GET(USERID, NotificationID) THEN BEGIN
        MyNotifications.Enabled := FALSE;
        MyNotifications.MODIFY;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70021 ForNAV Initialize Notification
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Page,1518,OnInitializingNotificationWithDefaultState,"",Skip,Skip)]
    LOCAL PROCEDURE OnInitializingNotificationWithDefaultState@2();
    VAR
      MyNotifications@1000 : Record 1518;
      SetupForNAVTxt@1001 : TextConst 'ENU=Ask to setup ForNAV.';
      SetupForNAVDescriptionTxt@1002 : TextConst 'ENU=If you have ForNAV installed but don''t want to use it, switch off receiving the notification.';
      NotificationIDs@1003 : Codeunit 70022;
    BEGIN
      MyNotifications.InsertDefaultWithTableNum(NotificationIDs.SetupForNAV,
        SetupForNAVTxt,
        SetupForNAVDescriptionTxt,
        DATABASE::"ForNAV Setup");
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70022 ForNAV Notification IDs
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE SetupForNAV@2() : Text;
    BEGIN
      EXIT('cf8edf36-45c2-44c9-8367-cac5748bd597');
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70029 ForNAV Replace Report Sel.
{
  OBJECT-PROPERTIES
  {
    Date=14-06-18;
    Time=20:47:29;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=VAR
            Dlg@1000000000 : Dialog;
          BEGIN
            Dlg.OPEN('#1#####################################');
            Dlg.UPDATE(1, 'Create Object Buffer');

            CreateBuffer;

            ReplaceSalesOrderConfirmation;                          Dlg.UPDATE(1, 'Sales Order Confirmation');
            ReplaceSalesInvoice;                                    Dlg.UPDATE(1, 'Sales Invoice');
            ReplaceSalesCreditMemo;                                 Dlg.UPDATE(1, 'Sales Credit Memo');
            ReplaceSalesShipment;                                   Dlg.UPDATE(1, 'Sales Shipment');
            ReplaceSalesQuote;                                      Dlg.UPDATE(1, 'Sales Quote');
            ReplacePurchaseOrder;                                   Dlg.UPDATE(1, 'Purchase Order');
            ReplacePurchaseInvoice;                                 Dlg.UPDATE(1, 'Purchase Invoice');
            ReplacePurchaseQuote;                                   Dlg.UPDATE(1, 'Purchase Quote');
            ReplacePurchaseCreditMemo;                              Dlg.UPDATE(1, 'Purchase Credit Memo');
            ReplaceCheck;                                           Dlg.UPDATE(1, 'Check');
            ReplaceStatement;                                       Dlg.UPDATE(1, 'Statement');
            //ReplaceReminder;
          END;

  }
  CODE
  {
    VAR
      Object@1000000000 : TEMPORARY Record 70003;

    LOCAL PROCEDURE ReplaceSalesOrderConfirmation@1000000001();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Order");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Order";
        Sequence := '1';
        "Report ID" := FindReportID('Order Confirmation', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesInvoice@1000000000();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Invoice");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Invoice";
        Sequence := '1';
        "Report ID" := FindReportID('Sales Invoice', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesCreditMemo@1000000002();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Cr.Memo");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Cr.Memo";
        Sequence := '1';
        "Report ID" := FindReportID('Credit Memo', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesShipment@1000000009();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Shipment");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Shipment";
        Sequence := '1';
        "Report ID" := FindReportID('Sales Shipment', '');
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesQuote@1000000008();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Quote");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Quote";
        Sequence := '1';
        "Report ID" := FindReportID('Sales Quote', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseOrder@1000000005();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Order");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Order";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Order', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseQuote@1000000010();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Quote");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Quote";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Quote', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseInvoice@1000000003();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Invoice");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Invoice";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Invoice', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseCreditMemo@1000000007();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Cr.Memo");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Cr.Memo";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Cr. Memo', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceCheck@1000000011();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"B.Check");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"B.Check";
        Sequence := '1';
        "Report ID" := FindReportID('US Check', '');
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceStatement@1000000012();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"C.Statement");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"C.Statement";
        Sequence := '1';
        "Report ID" := FindReportID('Statement', '');
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceReminder@1000000006();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::Reminder);
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::Reminder;
        Sequence := '1';
        "Report ID" := FindReportID('Reminder', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE FindReportID@1000000004(ReportName@1000000001 : Text;Prefix@1000 : Text) : Integer;
    BEGIN
      WITH Object DO BEGIN
        SETCURRENTKEY(Name);
        SETRANGE(Name, 'ForNAV ' + Prefix +ReportName);
        FINDFIRST;
        EXIT(ID);
      END;
    END;

    LOCAL PROCEDURE GetPrefix@1() : Text;
    VAR
      ForNAVSetup@1000 : Record 70000;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."VAT Amount Specification" = ForNAVSetup."VAT Amount Specification"::"N/A. (Sales Tax)" THEN
        EXIT('Tax ');

      EXIT('VAT ');
    END;

    LOCAL PROCEDURE CreateBuffer@1000000013();
    VAR
      AllObjWithCaption@1000000000 : Record 2000000058;
    BEGIN
      WITH AllObjWithCaption DO BEGIN
        SETRANGE("Object Type", "Object Type"::Report);
        IF FINDSET THEN REPEAT
          Object.ID := AllObjWithCaption."Object ID";
          Object.Name := AllObjWithCaption."Object Name";
          Object.INSERT;
        UNTIL NEXT = 0;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70080 ForNAV Test Valid Doc iFace
{
  OBJECT-PROPERTIES
  {
    Date=14-05-18;
    Time=20:08:59;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ThrowErrorIfNotValid@1000000000(VAR RecRef@1000000000 : RecordRef);
    VAR
      NotValidTableErr@1000000002 : TextConst 'ENU=This table (%1) is not supported for this function.';
    BEGIN
      IF NOT CheckValid(RecRef) THEN
        ERROR(NotValidTableErr, RecRef.CAPTION);
    END;

    PROCEDURE CheckValid@1000000001(VAR RecRef@1000000000 : RecordRef) : Boolean;
    BEGIN
      CASE RecRef.NUMBER OF
        DATABASE::"Sales Header":
          EXIT(TRUE);
        DATABASE::"Sales Shipment Header":
          EXIT(TRUE);
        DATABASE::"Sales Invoice Header":
          EXIT(TRUE);
        DATABASE::"Sales Cr.Memo Header":
          EXIT(TRUE);
        DATABASE::"Purchase Header":
          EXIT(TRUE);
        DATABASE::"Purch. Rcpt. Header":
          EXIT(TRUE);
        DATABASE::"Purch. Inv. Header":
          EXIT(TRUE);
        DATABASE::"Purch. Cr. Memo Hdr.":
          EXIT(TRUE);
        DATABASE::"Reminder Header":
          EXIT(TRUE);
        DATABASE::"Issued Reminder Header":
          EXIT(TRUE);
        DATABASE::"Finance Charge Memo Header":
          EXIT(TRUE);
        DATABASE::"Issued Fin. Charge Memo Header":
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70090 ForNAV RecordRef Library
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ConvertToRecRef@1000000002(VAR Rec@1000000000 : Variant;RecRef@1000000001 : RecordRef);
    VAR
      WrongDataTypeErr@1000000002 : TextConst 'ENU=Runtime Error: Wrong Datatype. Please contact your ForNAV reseller.';
    BEGIN
      CASE TRUE OF
        Rec.ISRECORDREF:
          RecRef := Rec;
        Rec.ISRECORD:
          RecRef.GETTABLE(Rec);
        ELSE
          ERROR(WrongDataTypeErr);
      END;
    END;

    PROCEDURE FindAndFilterieldNo@1000000003(VAR RecRef@1000000000 : RecordRef;VAR LineRec@1000000004 : RecordRef;VAR FldRef@1000000001 : FieldRef;Value@1000000005 : Text);
    VAR
      Field@1000000003 : Record 2000000041;
      DocumentNoField@1000000002 : FieldRef;
    BEGIN
      Field.SETRANGE(TableNo, RecRef.NUMBER);
      Field.SETRANGE(FieldName, Value);
      IF NOT Field.FINDFIRST THEN
        EXIT;

      DocumentNoField := RecRef.FIELD(Field."No.");

      Field.RESET;
      Field.SETRANGE(TableNo, RecRef.NUMBER + 1);
      Field.SETRANGE("No.", Field."No.");
      IF NOT Field.FINDFIRST THEN
        EXIT;

      FldRef := LineRec.FIELD(Field."No.");
      FldRef.SETRANGE(DocumentNoField.VALUE);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70206 ForNAV Trial Balance
{
  OBJECT-PROPERTIES
  {
    Date=02-02-18;
    Time=11:29:02;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetDataFromGLAccount@1000000000(VAR TrialBalance@1000000000 : Record 70206;VAR GLAccount@1000000001 : Record 15;VAR Args@1000000002 : Record 70205);
    VAR
      PriorFromDate@1000000004 : Date;
      PriorToDate@1000000003 : Date;
    BEGIN
      PriorFromDate := CALCDATE('<-1Y>',Args."From Date" + 1) - 1;
      PriorToDate := CALCDATE('<-1Y>',Args."To Date" + 1) - 1;

      WITH TrialBalance DO BEGIN
        GLAccount.SETRANGE("Date Filter",Args."From Date",Args."To Date");
        IF NOT Args."All Amounts in LCY" THEN BEGIN
          GLAccount.CALCFIELDS("Additional-Currency Net Change","Add.-Currency Balance at Date");
          "Net Change Actual" := GLAccount."Additional-Currency Net Change";
          "Balance at Date Actual" := GLAccount."Add.-Currency Balance at Date";
        END ELSE BEGIN
          GLAccount.CALCFIELDS("Net Change","Balance at Date");
          "Net Change Actual" := GLAccount."Net Change";
          "Balance at Date Actual" := GLAccount."Balance at Date";
        END;
        IF Args."Show by" = Args."Show by"::Budget THEN BEGIN
          GLAccount.CALCFIELDS("Budgeted Amount","Budget at Date");
          "Net Change Actual Last Year" := GLAccount."Budgeted Amount";
          "Balance at Date Act. Last Year" := GLAccount."Budget at Date";
        END ELSE BEGIN
          GLAccount.SETRANGE("Date Filter",PriorFromDate,PriorToDate);
          IF NOT Args."All Amounts in LCY" THEN BEGIN
            GLAccount.CALCFIELDS("Additional-Currency Net Change","Add.-Currency Balance at Date");
            "Net Change Actual Last Year" := GLAccount."Additional-Currency Net Change";
            "Balance at Date Act. Last Year" := GLAccount."Add.-Currency Balance at Date";
          END ELSE BEGIN
            GLAccount.CALCFIELDS("Net Change","Balance at Date");
            "Net Change Actual Last Year" := GLAccount."Net Change";
            "Balance at Date Act. Last Year" := GLAccount."Balance at Date";
          END;
        END;

        IF Args."Variance in Changes" OR Args."% Variance in Changes" THEN
          "Variance in Changes" := "Net Change Actual" - "Net Change Actual Last Year";
        IF Args."% Variance in Changes" AND ("Net Change Actual Last Year" <> 0) THEN
          "% Variance in Changes" := "Variance in Changes" / "Net Change Actual Last Year" * 100;
        IF Args."Variance in Balances" OR Args."% Variance in Balances" THEN
          "Variance in Balances"  := "Balance at Date Actual" - "Balance at Date Act. Last Year";
        IF Args."% Variance in Balances" AND ("Balance at Date Act. Last Year" <> 0) THEN
          "% Variance in Balances"  := "Variance in Balances"  / "Balance at Date Act. Last Year" * 100;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

      This codeunit is based on 10025 Paragraph Handling.
    }
    END.
  }
}

OBJECT Codeunit 70219 ForNAV Aging Calculation
{
  OBJECT-PROPERTIES
  {
    Date=06-12-17;
    Time=10:17:26;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetAging@1000000001(Rec@1000000000 : Variant;VAR AgingBuffer@1000000001 : Record 70220;VAR Args@1000000003 : Record 70219);
    VAR
      CustomerAging@1000000002 : Codeunit 70220;
      VendorAging@1000000004 : Codeunit 70221;
    BEGIN
      CASE GetAccountType(Rec) OF
        AgingBuffer."Account Type"::Customer:
          CustomerAging.GetAging(Rec, AgingBuffer, Args);
        AgingBuffer."Account Type"::Vendor:
          VendorAging.GetAging(Rec, AgingBuffer, Args);
      END;
    END;

    PROCEDURE GetAgingWithCurrency@1000000005(Rec@1000000000 : Variant;VAR AgingBuffer@1000000001 : Record 70220;VAR CurrAgingBuffer@1000000002 : Record 70220;VAR Args@1000000003 : Record 70219;VAR TempCurrency@1000000004 : TEMPORARY Record 4);
    VAR
      CustomerAging@1000000005 : Codeunit 70220;
      VendorAging@1000000006 : Codeunit 70221;
    BEGIN
      CASE GetAccountType(Rec) OF
        AgingBuffer."Account Type"::Customer:
          CustomerAging.GetAgingWithCurrency(Rec, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
        AgingBuffer."Account Type"::Vendor:
          VendorAging.GetAgingWithCurrency(Rec, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
      END;
    END;

    LOCAL PROCEDURE GetAccountType@1000000000(Rec@1000000001 : Variant) : Integer;
    VAR
      AgingBuffer@1000000004 : Record 70220;
      RecordRefLibrary@1000000002 : Codeunit 70090;
      UnsupportedTableErr@1000000000 : TextConst 'ENU=Unsupported Table';
      RecRef@1000000003 : RecordRef;
    BEGIN
      RecordRefLibrary.ConvertToRecRef(Rec, RecRef);
      CASE RecRef.NUMBER OF
        DATABASE::Customer:
          EXIT(AgingBuffer."Account Type"::Customer);
        DATABASE::Vendor:
          EXIT(AgingBuffer."Account Type"::Vendor);
        ELSE
          ERROR(UnsupportedTableErr);;
      END;
    END;

    PROCEDURE UpdateCurrencyTotals@7(VAR AgingBuffer@1000000002 : Record 70220;VAR CurrAgingBuffer@1000000001 : Record 70220;VAR TempCurrency@1000000000 : TEMPORARY Record 4);
    VAR
      i@1000 : Integer;
    BEGIN
      CurrAgingBuffer.RESET;
      CurrAgingBuffer.SETRANGE("Currency Code", AgingBuffer."Currency Code");
      IF NOT TempCurrency.GET(AgingBuffer."Currency Code") THEN BEGIN
        TempCurrency.Code := AgingBuffer."Currency Code";
        TempCurrency.INSERT;
        CurrAgingBuffer."Entry No." :=  TempCurrency.COUNT;
        CurrAgingBuffer."Currency Code" := AgingBuffer."Currency Code";
        CurrAgingBuffer.Amount := AgingBuffer.Amount;
        CurrAgingBuffer.Balance := AgingBuffer.Balance;
        CurrAgingBuffer."Amount 1" := AgingBuffer."Amount 1";
        CurrAgingBuffer."Amount 2" := AgingBuffer."Amount 2";
        CurrAgingBuffer."Amount 3" := AgingBuffer."Amount 3";
        CurrAgingBuffer."Amount 4" := AgingBuffer."Amount 4";
        CurrAgingBuffer."Amount 5" := AgingBuffer."Amount 5";
        CurrAgingBuffer.INSERT;
      END ELSE BEGIN
        CurrAgingBuffer.SETRANGE("Currency Code", AgingBuffer."Currency Code");
        CurrAgingBuffer.FINDFIRST;
        CurrAgingBuffer.Amount += AgingBuffer.Amount;
        CurrAgingBuffer.Balance += AgingBuffer.Balance;
        CurrAgingBuffer."Amount 1" += AgingBuffer."Amount 1";
        CurrAgingBuffer."Amount 2" += AgingBuffer."Amount 2";
        CurrAgingBuffer."Amount 3" += AgingBuffer."Amount 3";
        CurrAgingBuffer."Amount 4" += AgingBuffer."Amount 4";
        CurrAgingBuffer."Amount 5" += AgingBuffer."Amount 5";
        CurrAgingBuffer.MODIFY;
        CurrAgingBuffer.RESET;
      END;
    END;

    PROCEDURE GetCurrencyCode@1000000009(Value@1000000000 : Code[10]) : Code[10];
    VAR
      GLSetup@1000000001 : Record 98;
    BEGIN
      IF Value <> '' THEN
        EXIT(Value);

      GLSetup.GET;
      EXIT(GLSetup."LCY Code");
    END;

    PROCEDURE MoveValuesToPeriod@1000000006(VAR AgingBuffer@1000000000 : Record 70220;PeriodIndex@1000000001 : Integer);
    VAR
      Fld@1000000004 : Record 2000000041;
      RecRef@1000000002 : RecordRef;
      FldRef@1000000003 : FieldRef;
    BEGIN
      RecRef.GETTABLE(AgingBuffer);
      Fld.SETRANGE(TableNo, RecRef.NUMBER);
      Fld.SETRANGE(FieldName, 'Amount ' + FORMAT(PeriodIndex));
      Fld.FINDFIRST;
      FldRef := RecRef.FIELD(Fld."No.");

      FldRef.VALUE := AgingBuffer.Balance;

      Fld.SETRANGE(FieldName, 'Amount ' + FORMAT(PeriodIndex) + ' (LCY)');
      Fld.FINDFIRST;
      FldRef := RecRef.FIELD(Fld."No.");

      FldRef.VALUE := AgingBuffer."Balance (LCY)";

      RecRef.SETTABLE(AgingBuffer);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70220 ForNAV Customer Aging
{
  OBJECT-PROPERTIES
  {
    Date=22-01-18;
    Time=14:24:09;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      TempCustLedgEntry@1000000003 : TEMPORARY Record 21;

    PROCEDURE GetAging@1000000001(VAR Cust@1000000000 : Record 18;VAR AgingBuffer@1000000001 : Record 70220;VAR Args@1000000003 : Record 70219);
    VAR
      CurrAgingBuffer@1000000004 : TEMPORARY Record 70220;
      TempCurrency@1000000002 : TEMPORARY Record 4;
    BEGIN
      GetAgingWithCurrency(Cust, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
    END;

    PROCEDURE GetAgingWithCurrency@1000000005(VAR Cust@1000000000 : Record 18;VAR AgingBuffer@1000000001 : Record 70220;VAR CurrAgingBuffer@1000000002 : Record 70220;VAR Args@1000000003 : Record 70219;VAR TempCurrency@1000000004 : TEMPORARY Record 4);
    BEGIN
      ClearData(AgingBuffer);
      GetBasedOnDetailedEntry(Cust, Args);
      GetBasedOnOpenEntry(Cust, Args);
      CreateAgingBuffer(Cust, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
      AgingBuffer.SetCaptions(Args);
    END;

    LOCAL PROCEDURE GetBasedOnDetailedEntry@1000000002(VAR Cust@1000000002 : Record 18;VAR Args@1000000003 : Record 70219);
    VAR
      DetailedCustLedgEntry@1000000000 : Record 379;
      CustLedgEntry@1000000001 : Record 21;
    BEGIN
      WITH DetailedCustLedgEntry DO BEGIN
        SETCURRENTKEY("Customer No.", "Posting Date", "Entry Type", "Currency Code");
        SETRANGE("Customer No.", Cust."No.");
        SETRANGE("Entry Type", DetailedCustLedgEntry."Entry Type"::Application);
        SETRANGE("Posting Date", 0D, Args."Ending Date");
        SETFILTER("Posting Date", '%1..', Args."Ending Date" + 1);

        IF FINDSET THEN REPEAT
          IF CustLedgEntry.GET("Cust. Ledger Entry No.") THEN
            IF CustLedgEntry.Open THEN BEGIN
              CustLedgEntry.SETRANGE("Date Filter",0D, Args."Ending Date");
              CustLedgEntry.CALCFIELDS("Remaining Amount");
              IF CustLedgEntry."Remaining Amount" <> 0 THEN
                InsertTemp(CustLedgEntry);
          END;
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE GetBasedOnOpenEntry@1000000003(VAR Cust@1000000000 : Record 18;VAR Args@1000000002 : Record 70219);
    VAR
      CustLedgEntry@1000000001 : Record 21;
    BEGIN
      WITH CustLedgEntry DO BEGIN
        SETCURRENTKEY("Customer No.", Open, Positive, "Due Date", "Currency Code");
        SETRANGE("Customer No.", Cust."No.");
        SETRANGE(Open, TRUE);

        IF Args."Aging By" = Args."Aging By"::"Posting Date" THEN BEGIN
          SETRANGE("Posting Date", 0D, Args."Ending Date");
          SETRANGE("Date Filter", 0D, Args."Ending Date");
        END;

        IF FINDSET THEN REPEAT
        IF Args."Aging By" = Args."Aging By"::"Posting Date" THEN BEGIN
           CALCFIELDS("Remaining Amt. (LCY)");
           IF "Remaining Amt. (LCY)" <> 0 THEN
             InsertTemp(CustLedgEntry);
         END ELSE
           InsertTemp(CustLedgEntry);
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE CreateAgingBuffer@1000000015(VAR Cust@1000000002 : Record 18;VAR AgingBuffer@1000000001 : Record 70220;VAR CurrAgingBuffer@1000000000 : Record 70220;VAR Args@1000000003 : Record 70219;VAR TempCurrency@1000000006 : TEMPORARY Record 4);
    VAR
      DetailedCustLedgEntry@1000000004 : Record 379;
      AgingCalculation@1000000007 : Codeunit 70219;
      PeriodIndex@1000000005 : Integer;
    BEGIN
      WITH TempCustLedgEntry DO
        IF FINDSET THEN REPEAT
          AgingBuffer.INIT;
          AgingBuffer."Entry No." := "Entry No.";
          AgingBuffer."Account No." := "Customer No.";
          AgingBuffer.GetAccountName;
          AgingBuffer."Credit Limit (LCY)" := Cust."Credit Limit (LCY)";
          IF NOT Args."Print Amounts in LCY" THEN
            AgingBuffer."Currency Code" := AgingCalculation.GetCurrencyCode("Currency Code");
          AgingBuffer."Document No." := "Document No.";
          AgingBuffer."External Document No." := "External Document No.";
          AgingBuffer."Document Type" := "Document Type";
          AgingBuffer."Document Date" := "Document Date";
          AgingBuffer."Posting Date" := "Posting Date";
          AgingBuffer."Due Date" := "Due Date";

          DetailedCustLedgEntry.SETRANGE("Cust. Ledger Entry No.",TempCustLedgEntry."Entry No.");
          IF DetailedCustLedgEntry.FINDSET THEN REPEAT
            IF (DetailedCustLedgEntry."Entry Type" = DetailedCustLedgEntry."Entry Type"::"Initial Entry") AND
               (TempCustLedgEntry."Posting Date" > Args."Ending Date") AND (Args."Aging By" <> Args."Aging By"::"Posting Date")
            THEN BEGIN
              IF TempCustLedgEntry."Document Date" <= Args."Ending Date" THEN
                DetailedCustLedgEntry."Posting Date" :=  TempCustLedgEntry."Document Date"
              ELSE
                IF (TempCustLedgEntry."Due Date" <= Args."Ending Date") AND (Args."Aging By" = Args."Aging By"::"Due Date") THEN
                  DetailedCustLedgEntry."Posting Date" := TempCustLedgEntry."Due Date";
            END;
            IF (DetailedCustLedgEntry."Posting Date" <= Args."Ending Date") OR
               (TempCustLedgEntry.Open AND (Args."Aging By" = Args."Aging By"::"Due Date") AND (TempCustLedgEntry."Due Date" > Args."Ending Date") AND (TempCustLedgEntry."Posting Date" <= Args."Ending Date"))
            THEN BEGIN
              IF DetailedCustLedgEntry."Entry Type" IN
                 [DetailedCustLedgEntry."Entry Type"::"Initial Entry",
                  DetailedCustLedgEntry."Entry Type"::"Unrealized Loss",
                  DetailedCustLedgEntry."Entry Type"::"Unrealized Gain",
                  DetailedCustLedgEntry."Entry Type"::"Realized Loss",
                  DetailedCustLedgEntry."Entry Type"::"Realized Gain",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount (VAT Excl.)",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount (VAT Adjustment)",
                  DetailedCustLedgEntry."Entry Type"::"Payment Tolerance",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount Tolerance",
                  DetailedCustLedgEntry."Entry Type"::"Payment Tolerance (VAT Excl.)",
                  DetailedCustLedgEntry."Entry Type"::"Payment Tolerance (VAT Adjustment)",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount Tolerance (VAT Excl.)",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount Tolerance (VAT Adjustment)"]
              THEN BEGIN
                IF NOT Args."Print Amounts in LCY" THEN
                  AgingBuffer.Amount += DetailedCustLedgEntry.Amount
                ELSE
                  AgingBuffer.Amount += DetailedCustLedgEntry."Amount (LCY)";
                AgingBuffer."Amount (LCY)" += DetailedCustLedgEntry."Amount (LCY)";
              END;

              IF DetailedCustLedgEntry."Posting Date" <= Args."Ending Date" THEN BEGIN
                IF NOT Args."Print Amounts in LCY" THEN
                  AgingBuffer.Balance += DetailedCustLedgEntry.Amount
                ELSE
                  AgingBuffer.Balance += DetailedCustLedgEntry."Amount (LCY)";
                AgingBuffer."Balance (LCY)" += DetailedCustLedgEntry."Amount (LCY)";

              END;
            END;
          UNTIL DetailedCustLedgEntry.NEXT = 0;

          IF AgingBuffer.Balance <> 0 THEN BEGIN
            CASE Args."Aging By" OF
             Args."Aging By"::"Due Date":
               PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Due Date");
             Args."Aging By"::"Posting Date":
               PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Posting Date");
             Args."Aging By"::"Document Date":
               BEGIN
                 IF AgingBuffer."Document Date" > Args."Ending Date" THEN BEGIN
                   AgingBuffer.Balance := 0;
                   AgingBuffer."Balance (LCY)" := 0;
                   AgingBuffer."Document Date" := AgingBuffer."Posting Date";
                 END;
                 PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Document Date");
               END;
            END;

            AgingCalculation.MoveValuesToPeriod(AgingBuffer, PeriodIndex);

            AgingBuffer.INSERT;
            IF NOT Args."Print Amounts in LCY" THEN
              AgingCalculation.UpdateCurrencyTotals(AgingBuffer, CurrAgingBuffer, TempCurrency);
         END;
        UNTIL NEXT = 0;
    END;

    LOCAL PROCEDURE InsertTemp@1000000004(VAR CustLedgEntry@1000000000 : Record 21);
    BEGIN
      WITH TempCustLedgEntry DO BEGIN
        IF GET(CustLedgEntry."Entry No.") THEN
          EXIT;

        TempCustLedgEntry := CustLedgEntry;

        INSERT;
      END;
    END;

    LOCAL PROCEDURE ClearData@1000000000(VAR AgingBuffer@1000000001 : Record 70220);
    BEGIN
      AgingBuffer.RESET;
      AgingBuffer.DELETEALL;
      TempCustLedgEntry.RESET;
      TempCustLedgEntry.DELETEALL;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70221 ForNAV Vendor Aging
{
  OBJECT-PROPERTIES
  {
    Date=22-01-18;
    Time=14:24:21;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      TempVendorLedgerEntry@1000000003 : TEMPORARY Record 25;

    PROCEDURE GetAging@1000000001(VAR Vend@1000000000 : Record 23;VAR AgingBuffer@1000000001 : Record 70220;VAR Args@1000000003 : Record 70219);
    VAR
      CurrAgingBuffer@1000000004 : TEMPORARY Record 70220;
      TempCurrency@1000000002 : TEMPORARY Record 4;
    BEGIN
      GetAgingWithCurrency(Vend, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
    END;

    PROCEDURE GetAgingWithCurrency@1000000005(VAR Vend@1000000000 : Record 23;VAR AgingBuffer@1000000001 : Record 70220;VAR CurrAgingBuffer@1000000002 : Record 70220;VAR Args@1000000003 : Record 70219;VAR TempCurrency@1000000004 : TEMPORARY Record 4);
    BEGIN
      ClearData(AgingBuffer);
      GetBasedOnDetailedEntry(Vend, Args);
      GetBasedOnOpenEntry(Vend, Args);
      CreateAgingBuffer(Vend, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
      AgingBuffer.SetCaptions(Args);
    END;

    LOCAL PROCEDURE GetBasedOnDetailedEntry@1000000002(VAR Vend@1000000002 : Record 23;VAR Args@1000000003 : Record 70219);
    VAR
      DetailedVendorLedgEntry@1000000000 : Record 380;
      VendorLedgerEntry@1000000001 : Record 25;
    BEGIN
      WITH DetailedVendorLedgEntry DO BEGIN
        SETCURRENTKEY("Vendor No.", "Posting Date", "Entry Type", "Currency Code");
        SETRANGE("Vendor No.", Vend."No.");
        SETRANGE("Entry Type", DetailedVendorLedgEntry."Entry Type"::Application);
        SETRANGE("Posting Date", 0D, Args."Ending Date");
        SETFILTER("Posting Date", '%1..', Args."Ending Date" + 1);

        IF FINDSET THEN REPEAT
          IF VendorLedgerEntry.GET("Vendor Ledger Entry No.") THEN
            IF VendorLedgerEntry.Open THEN BEGIN
              VendorLedgerEntry.SETRANGE("Date Filter",0D, Args."Ending Date");
              VendorLedgerEntry.CALCFIELDS("Remaining Amount");
              IF VendorLedgerEntry."Remaining Amount" <> 0 THEN
                InsertTemp(VendorLedgerEntry);
          END;
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE GetBasedOnOpenEntry@1000000003(VAR Vend@1000000000 : Record 23;VAR Args@1000000002 : Record 70219);
    VAR
      VendorLedgerEntry@1000000001 : Record 25;
    BEGIN
      WITH VendorLedgerEntry DO BEGIN
        SETCURRENTKEY("Vendor No.", Open, Positive, "Due Date", "Currency Code");
        SETRANGE("Vendor No.", Vend."No.");
        SETRANGE(Open, TRUE);

        IF Args."Aging By" = Args."Aging By"::"Posting Date" THEN BEGIN
          SETRANGE("Posting Date", 0D, Args."Ending Date");
          SETRANGE("Date Filter", 0D, Args."Ending Date");
        END;

        IF FINDSET THEN REPEAT
        IF Args."Aging By" = Args."Aging By"::"Posting Date" THEN BEGIN
           CALCFIELDS("Remaining Amt. (LCY)");
           IF "Remaining Amt. (LCY)" <> 0 THEN
             InsertTemp(VendorLedgerEntry);
         END ELSE
           InsertTemp(VendorLedgerEntry);
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE CreateAgingBuffer@1000000015(VAR Vend@1000000002 : Record 23;VAR AgingBuffer@1000000001 : Record 70220;VAR CurrAgingBuffer@1000000000 : Record 70220;VAR Args@1000000003 : Record 70219;VAR TempCurrency@1000000006 : TEMPORARY Record 4);
    VAR
      DetailedVendorLedgEntry@1000000004 : Record 380;
      AgingCalculation@1000000007 : Codeunit 70219;
      PeriodIndex@1000000005 : Integer;
    BEGIN
      WITH TempVendorLedgerEntry DO
        IF FINDSET THEN REPEAT
          AgingBuffer.INIT;
          AgingBuffer."Entry No." := "Entry No.";
          AgingBuffer."Account Type" := AgingBuffer."Account Type"::Vendor;
          AgingBuffer."Account No." := "Vendor No.";
          AgingBuffer.GetAccountName;
      //    AgingBuffer."Customer Credit Limit (LCY)" := Vend."Credit Limit (LCY)";
          IF NOT Args."Print Amounts in LCY" THEN
            AgingBuffer."Currency Code" := AgingCalculation.GetCurrencyCode("Currency Code");
          AgingBuffer."Document No." := "Document No.";
          AgingBuffer."External Document No." := "External Document No.";
          AgingBuffer."Document Type" := "Document Type";
          AgingBuffer."Document Date" := "Document Date";
          AgingBuffer."Posting Date" := "Posting Date";
          AgingBuffer."Due Date" := "Due Date";

          DetailedVendorLedgEntry.SETRANGE("Vendor Ledger Entry No.",TempVendorLedgerEntry."Entry No.");
          IF DetailedVendorLedgEntry.FINDSET THEN REPEAT
            IF (DetailedVendorLedgEntry."Entry Type" = DetailedVendorLedgEntry."Entry Type"::"Initial Entry") AND
               (TempVendorLedgerEntry."Posting Date" > Args."Ending Date") AND (Args."Aging By" <> Args."Aging By"::"Posting Date")
            THEN BEGIN
              IF TempVendorLedgerEntry."Document Date" <= Args."Ending Date" THEN
                DetailedVendorLedgEntry."Posting Date" :=  TempVendorLedgerEntry."Document Date"
              ELSE
                IF (TempVendorLedgerEntry."Due Date" <= Args."Ending Date") AND (Args."Aging By" = Args."Aging By"::"Due Date") THEN
                  DetailedVendorLedgEntry."Posting Date" := TempVendorLedgerEntry."Due Date";
            END;
            IF (DetailedVendorLedgEntry."Posting Date" <= Args."Ending Date") OR
               (TempVendorLedgerEntry.Open AND (Args."Aging By" = Args."Aging By"::"Due Date") AND (TempVendorLedgerEntry."Due Date" > Args."Ending Date") AND (TempVendorLedgerEntry."Posting Date" <= Args."Ending Date"))
            THEN BEGIN
              IF DetailedVendorLedgEntry."Entry Type" IN
                 [DetailedVendorLedgEntry."Entry Type"::"Initial Entry",
                  DetailedVendorLedgEntry."Entry Type"::"Unrealized Loss",
                  DetailedVendorLedgEntry."Entry Type"::"Unrealized Gain",
                  DetailedVendorLedgEntry."Entry Type"::"Realized Loss",
                  DetailedVendorLedgEntry."Entry Type"::"Realized Gain",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount (VAT Excl.)",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount (VAT Adjustment)",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Tolerance",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount Tolerance",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Tolerance (VAT Excl.)",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Tolerance (VAT Adjustment)",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount Tolerance (VAT Excl.)",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount Tolerance (VAT Adjustment)"]
              THEN BEGIN
                IF NOT Args."Print Amounts in LCY" THEN
                  AgingBuffer.Amount += DetailedVendorLedgEntry.Amount
                ELSE
                  AgingBuffer.Amount += DetailedVendorLedgEntry."Amount (LCY)";
                AgingBuffer."Amount (LCY)" += DetailedVendorLedgEntry."Amount (LCY)";
              END;

              IF DetailedVendorLedgEntry."Posting Date" <= Args."Ending Date" THEN BEGIN
                IF NOT Args."Print Amounts in LCY" THEN
                  AgingBuffer.Balance += DetailedVendorLedgEntry.Amount
                ELSE
                  AgingBuffer.Balance += DetailedVendorLedgEntry."Amount (LCY)";
                AgingBuffer."Balance (LCY)" += DetailedVendorLedgEntry."Amount (LCY)";

              END;
            END;
          UNTIL DetailedVendorLedgEntry.NEXT = 0;

          IF AgingBuffer.Balance <> 0 THEN BEGIN
            CASE Args."Aging By" OF
             Args."Aging By"::"Due Date":
               PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Due Date");
             Args."Aging By"::"Posting Date":
               PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Posting Date");
             Args."Aging By"::"Document Date":
               BEGIN
                 IF AgingBuffer."Document Date" > Args."Ending Date" THEN BEGIN
                   AgingBuffer.Balance := 0;
                   AgingBuffer."Balance (LCY)" := 0;
                   AgingBuffer."Document Date" := AgingBuffer."Posting Date";
                 END;
                 PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Document Date");
               END;
            END;

            AgingCalculation.MoveValuesToPeriod(AgingBuffer, PeriodIndex);

            AgingBuffer.INSERT;
            IF NOT Args."Print Amounts in LCY" THEN
              AgingCalculation.UpdateCurrencyTotals(AgingBuffer, CurrAgingBuffer, TempCurrency);
         END;
        UNTIL NEXT = 0;
    END;

    LOCAL PROCEDURE InsertTemp@1000000004(VAR VendorLedgerEntry@1000000000 : Record 25);
    BEGIN
      WITH TempVendorLedgerEntry DO BEGIN
        IF GET(VendorLedgerEntry."Entry No.") THEN
          EXIT;

        TempVendorLedgerEntry := VendorLedgerEntry;

        INSERT;
      END;
    END;

    LOCAL PROCEDURE ClearData@1000000000(VAR AgingBuffer@1000000001 : Record 70220);
    BEGIN
      AgingBuffer.RESET;
      AgingBuffer.DELETEALL;
      TempVendorLedgerEntry.RESET;
      TempVendorLedgerEntry.DELETEALL;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70300 ForNAV Test Void Check
{
  OBJECT-PROPERTIES
  {
    Date=15-03-18;
    Time=18:43:57;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE TestVoidCheck@1000000001(VAR GenJnlLn@1000000001 : Record 81;VAR Args@1000000006 : Record 70300;Preview@1000000005 : Boolean) : Boolean;
    VAR
      Text000Err@1000000004 : TextConst 'ENU=Preview is not allowed.;ESM=No se permite la vista previa.;FRC=Impossible d''afficher Ö l''Çcran.;ENC=Preview is not allowed.';
      Text001Err@1000000003 : TextConst 'ENU=Last Check No. must be filled in.;ESM=Se debe rellenar el campo Èlt. n.ß cheque.;FRC=Le numÇro du dernier chäque doit àtre renseignÇ.;ENC=Last Cheque No. must be filled in.';
      Text002Err@1000000002 : TextConst '@@@="%1=Field caption for Line No. field.; %2=Field caption for Document No. field.";ENU=Filters on %1 and %2 are not allowed.;ESM=No se permiten filtros en %1 y %2.;FRC=Les filtres sur %1 et %2 ne sont pas permis.;ENC=Filters on %1 and %2 are not allowed.';
      USText004Err@1000000007 : TextConst 'ENU=Last Check No. must include at least one digit, so that it can be incremented.;ESM=El campo Èlt. n.ß cheque debe incluir al menos un d°gito, de modo que pueda incrementarse.;FRC=Le n¯ du dernier chäque doit comprendre au moins un chiffre afin de pouvoir àtre incrÇmentÇ.;ENC=Last Cheque No. must include at least one digit, so that it can be incremented.';
    BEGIN
      IF Preview THEN
        EXIT(FALSE);

      IF Args."Check No." = '' THEN
        ERROR(Text001Err);
      IF INCSTR(Args."Check No.") = '' THEN
        ERROR(USText004Err);
      IF Args."Test Print" THEN
        EXIT(FALSE);
      IF NOT Args."Reprint Checks" THEN
        EXIT(FALSE);
      WITH GenJnlLn DO BEGIN

        IF (GETFILTER("Line No.") <> '') OR (GETFILTER("Document No.") <> '') THEN
          ERROR(
            Text002Err,FIELDCAPTION("Line No."),FIELDCAPTION("Document No."));

        SETRANGE("Bank Payment Type", "Bank Payment Type"::"Computer Check");
        SETRANGE("Check Printed",TRUE);
      END;

      EXIT(TRUE);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70301 ForNAV Check Update Journal
{
  OBJECT-PROPERTIES
  {
    Date=04-03-18;
    Time=15:17:19;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE UpdateJournal@1000000001(Args@1000000003 : Record 70300;VAR Check@1000000001 : Record 70301;VAR GenJnlLine@1000000000 : Record 81);
    VAR
      GenJnlLine2@1000000002 : Record 81;
      Text013@1000000004 : TextConst 'DAN=%1 findes allerede.;DEU=%1 ist schon vorhanden.;ENU=%1 already exists.;NLD=%1 bestaat reeds.';
      GenJnlLine3@1000000006 : Record 81;
      BankAcc@1000000008 : Record 270;
      HighestLineNo@1000000007 : Integer;
      BalancingType@1000000009 : 'G/L Account,Customer,Vendor,Bank Account';
      Text014@1000000010 : TextConst 'DAN=Undersõg for %1 %2;DEU=Scheck fÅr %1 %2;ENU=Check for %1 %2;NLD=Cheque voor %1 %2';
      Text062@1000000011 : TextConst 'DAN=Finanskonto,Debitor,Kreditor,Bankkonto;DEU=Sachkonto,Debitor,Kreditor,Bankkonto;ENU=G/L Account,Customer,Vendor,Bank Account;NLD=Grootboekrekening,Klant,Leverancier,Bank';
    BEGIN
      IF Args."Test Print" THEN
        EXIT;

      WITH Check DO BEGIN
        BankAcc.GET("Bank Account No.");
        BankAcc."Last Check No." := "Check No.";
        BankAcc.MODIFY;
        IF Args."Test Print" THEN
          EXIT;
        IF "Check No." <> GenJnlLine."Document No." THEN BEGIN
          GenJnlLine3.RESET;
          GenJnlLine3.SETCURRENTKEY("Journal Template Name","Journal Batch Name","Posting Date","Document No.");
          GenJnlLine3.SETRANGE("Journal Template Name",GenJnlLine."Journal Template Name");
          GenJnlLine3.SETRANGE("Journal Batch Name",GenJnlLine."Journal Batch Name");
          GenJnlLine3.SETRANGE("Posting Date",GenJnlLine."Posting Date");
          GenJnlLine3.SETRANGE("Document No.","Check No.");
          IF GenJnlLine3.FIND('-') THEN
            GenJnlLine3.FIELDERROR("Document No.",STRSUBSTNO(Text013,"Check No."));
        END;

        IF "Application Method" <> "Application Method"::MoreLinesOneEntry THEN BEGIN
          GenJnlLine3 := GenJnlLine;
          GenJnlLine3.TESTFIELD("Posting No. Series",'');
          GenJnlLine3."Document No." := "Check No.";
          GenJnlLine3."Check Printed" := TRUE;
          GenJnlLine3.MODIFY;
        END ELSE BEGIN
          GenJnlLine2.RESET;
          GenJnlLine2.SETCURRENTKEY("Journal Template Name","Journal Batch Name","Posting Date","Document No.");
          GenJnlLine2.SETRANGE("Journal Template Name",GenJnlLine."Journal Template Name");
          GenJnlLine2.SETRANGE("Journal Batch Name",GenJnlLine."Journal Batch Name");
          GenJnlLine2.SETRANGE("Posting Date",GenJnlLine."Posting Date");
          GenJnlLine2.SETRANGE("Document No.",GenJnlLine."Document No.");
          GenJnlLine2.SETRANGE("Account Type",GenJnlLine."Account Type");
          GenJnlLine2.SETRANGE("Account No.",GenJnlLine."Account No.");
          GenJnlLine2.SETRANGE("Bal. Account Type",GenJnlLine."Bal. Account Type");
          GenJnlLine2.SETRANGE("Bal. Account No.",GenJnlLine."Bal. Account No.");
          GenJnlLine2.SETRANGE("Bank Payment Type",GenJnlLine."Bank Payment Type");
          IF GenJnlLine2.FIND('-') THEN BEGIN
            HighestLineNo := GenJnlLine2."Line No.";
            REPEAT
              IF GenJnlLine2."Line No." > HighestLineNo THEN
                HighestLineNo := GenJnlLine2."Line No.";
              GenJnlLine3 := GenJnlLine2;
              GenJnlLine3.TESTFIELD("Posting No. Series",'');
              GenJnlLine3."Bal. Account No." := '';
              GenJnlLine3."Bank Payment Type" := GenJnlLine3."Bank Payment Type"::" ";
              GenJnlLine3."Document No." := "Check No.";
              GenJnlLine3."Check Printed" := TRUE;
              GenJnlLine3.VALIDATE(Amount);
              GenJnlLine3.MODIFY;
            UNTIL GenJnlLine2.NEXT = 0;
          END;

          GenJnlLine3.RESET;
          GenJnlLine3 := GenJnlLine;
          GenJnlLine3.SETRANGE("Journal Template Name",GenJnlLine."Journal Template Name");
          GenJnlLine3.SETRANGE("Journal Batch Name",GenJnlLine."Journal Batch Name");
          GenJnlLine3."Line No." := HighestLineNo;
          IF GenJnlLine3.NEXT = 0 THEN
            GenJnlLine3."Line No." := HighestLineNo + 10000
          ELSE BEGIN
            WHILE GenJnlLine3."Line No." = HighestLineNo + 1 DO BEGIN
              HighestLineNo := GenJnlLine3."Line No.";
              IF GenJnlLine3.NEXT = 0 THEN
                GenJnlLine3."Line No." := HighestLineNo + 20000;
            END;
            GenJnlLine3."Line No." := (GenJnlLine3."Line No." + HighestLineNo) DIV 2;
          END;
          GenJnlLine3.INIT;
          GenJnlLine3.VALIDATE("Posting Date",GenJnlLine."Posting Date");
          GenJnlLine3."Document Type" := GenJnlLine."Document Type";
          GenJnlLine3."Document No." := "Check No.";
          GenJnlLine3."Account Type" := GenJnlLine3."Account Type"::"Bank Account";
          GenJnlLine3.VALIDATE("Account No.",BankAcc."No.");
          IF BalancingType <> BalancingType::"G/L Account" THEN
            GenJnlLine3.Description := STRSUBSTNO(Text014,SELECTSTR(BalancingType + 1,Text062),"Balancing No.");
          GenJnlLine3.VALIDATE(Amount,- Amount);
          GenJnlLine3."Bank Payment Type" := GenJnlLine3."Bank Payment Type"::"Computer Check";
          GenJnlLine3."Check Printed" := TRUE;
          GenJnlLine3."Source Code" := GenJnlLine."Source Code";
          GenJnlLine3."Reason Code" := GenJnlLine."Reason Code";
          GenJnlLine3."Allow Zero-Amount Posting" := TRUE;
          GenJnlLine3.INSERT;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70302 ForNAV Create Stub
{
  OBJECT-PROPERTIES
  {
    Date=04-03-18;
    Time=15:40:01;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE FromCheck@1000000001(Args@1000000004 : Record 70300;VAR Check@1000000000 : Record 70301;VAR Stub@1000000001 : Record 70302;GenJnlLine@1000000006 : Record 81);
    VAR
      CustLedgerEntry@1000000003 : Record 21;
      VendorLedgerEntry@1000000002 : Record 25;
      FoundLast@1000000005 : Boolean;
      FoundNegative@1000000008 : Boolean;
      RemainingAmount@1000000007 : Decimal;
    BEGIN
      InitCode(Args, Check, GenJnlLine, CustLedgerEntry, VendorLedgerEntry, FoundLast, FoundNegative);
      RemainingAmount := Check.Amount;
      RepeatCode(Args, Check, Stub, GenJnlLine, CustLedgerEntry, VendorLedgerEntry, FoundLast, RemainingAmount, FoundNegative);
    END;

    LOCAL PROCEDURE InitCode@1000000000(Args@1000000002 : Record 70300;Check@1000000004 : Record 70301;GenJnlLine@1000000005 : Record 81;VAR CustLedgEntry@1000000000 : Record 21;VAR VendLedgEntry@1000000001 : Record 25;VAR FoundLast@1000000003 : Boolean;VAR FoundNegative@1000000006 : Boolean);
    BEGIN
      IF NOT Args."Test Print" THEN
        IF TRUE THEN BEGIN
          FoundLast := TRUE;
          CASE Check."Application Method" OF
            Check."Application Method"::OneLineOneEntry:
              FoundLast := FALSE;
            Check."Application Method"::OneLineID:
              CASE Check."Balancing Type" OF
                Check."Balancing Type"::Customer:
                  BEGIN
                    CustLedgEntry.RESET;
                    CustLedgEntry.SETCURRENTKEY("Customer No.",Open,Positive);
                    CustLedgEntry.SETRANGE("Customer No.",Check."Balancing No.");
                    CustLedgEntry.SETRANGE(Open,TRUE);
                    CustLedgEntry.SETRANGE(Positive,TRUE);
                    CustLedgEntry.SETRANGE("Applies-to ID",GenJnlLine."Applies-to ID");
                    FoundLast := NOT CustLedgEntry.FIND('-');
                    IF FoundLast THEN BEGIN
                      CustLedgEntry.SETRANGE(Positive,FALSE);
                      FoundLast := NOT CustLedgEntry.FIND('-');
                      FoundNegative := TRUE;
                    END ELSE
                      FoundNegative := FALSE;
                  END;
                Check."Balancing Type"::Vendor:
                  BEGIN
                    VendLedgEntry.RESET;
                    VendLedgEntry.SETCURRENTKEY("Vendor No.",Open,Positive);
                    VendLedgEntry.SETRANGE("Vendor No.",Check."Balancing No.");
                    VendLedgEntry.SETRANGE(Open,TRUE);
                    VendLedgEntry.SETRANGE(Positive,TRUE);
                    VendLedgEntry.SETRANGE("Applies-to ID",GenJnlLine."Applies-to ID");
                    FoundLast := NOT VendLedgEntry.FIND('-');
                    IF FoundLast THEN BEGIN
                      VendLedgEntry.SETRANGE(Positive,FALSE);
                      FoundLast := NOT VendLedgEntry.FIND('-');
                      FoundNegative := TRUE;
                    END ELSE
                      FoundNegative := FALSE;
                  END;
              END;
            Check."Application Method"::MoreLinesOneEntry:
              FoundLast := FALSE;
          END;
        END
      ELSE
        FoundLast := FALSE;
    END;

    LOCAL PROCEDURE RepeatCode@1000000002(Args@1000000003 : Record 70300;Check@1000000006 : Record 70301;VAR Stub@1000000005 : Record 70302;GenJnlLine@1000000007 : Record 81;VAR CustLedgEntry@1000000001 : Record 21;VAR VendLedgEntry@1000000000 : Record 25;VAR FoundLast@1000000002 : Boolean;VAR RemainingAmount@1000000004 : Decimal;FoundNegative@1000000010 : Boolean);
    VAR
      LineAmount2@1000000008 : Decimal;
      CurrentLineAmount@1000000009 : Decimal;
      GenJnlLine2@1000000011 : Record 81;
      Text016@1000000013 : TextConst 'ENU=In the Check report, One Check per Vendor and Document No.\;ESM=En informe de cheques, Un cheque por proveedor y nß documento\;FRC=Dans l''Çtat Chäque, un chäque par fournisseur et par n¯ document\;ENC=In the Cheque report, One Cheque per Vendor and Document No.\';
      Text017@1000000012 : TextConst 'ENU=must not be activated when Applies-to ID is specified in the journal lines.;ESM=no se debe activar cuando se ha usado Liq. por id. en las l°neas de diario.;FRC=ne doit pas àtre activÇ lorsque Code affectÇ Ö est spÇcifiÇ dans les lignes du journal.;ENC=must not be activated when Applies-to ID is specified in the journal lines.';
    BEGIN
      IF Check."Application Method" = Check."Application Method"::MoreLinesOneEntry THEN
        GetGenJnlLnForMoreLinesOneEntry(GenJnlLine, GenJnlLine2);

      REPEAT
        IF NOT Args."Test Print" THEN BEGIN
          IF FoundLast THEN BEGIN
            IF RemainingAmount <> 0 THEN BEGIN
              Stub."Document No." := '';
              Stub."External Document No." := '';
              Stub.Amount := RemainingAmount;
              LineAmount2 := RemainingAmount;
              CurrentLineAmount := LineAmount2;
              Stub."Discount Amount" := 0;
              Stub."Currency Code" := GenJnlLine."Currency Code";
              Stub.INSERT;
              RemainingAmount := 0;
            END ELSE
              EXIT;
          END ELSE BEGIN
            CASE Check."Application Method" OF
              Check."Application Method"::OneLineOneEntry:
                BEGIN
                  CASE Check."Balancing Type" OF
                    Check."Balancing Type"::Customer:
                      BEGIN
                        CustLedgEntry.RESET;
                        CustLedgEntry.SETCURRENTKEY("Document No.");
                        CustLedgEntry.SETRANGE("Document Type",GenJnlLine."Applies-to Doc. Type");
                        CustLedgEntry.SETRANGE("Document No.",GenJnlLine."Applies-to Doc. No.");
                        CustLedgEntry.SETRANGE("Customer No.",Check."Balancing No.");
                        CustLedgEntry.FIND('-');
                        Stub.CustUpdateAmounts(CustLedgEntry,RemainingAmount,LineAmount2);
                      END;
                    Check."Balancing Type"::Vendor:
                      BEGIN
                        VendLedgEntry.RESET;
                        VendLedgEntry.SETCURRENTKEY("Document No.");
                        VendLedgEntry.SETRANGE("Document Type",GenJnlLine."Applies-to Doc. Type");
                        VendLedgEntry.SETRANGE("Document No.",GenJnlLine."Applies-to Doc. No.");
                        VendLedgEntry.SETRANGE("Vendor No.",Check."Balancing No.");
                        VendLedgEntry.FIND('-');
                        Stub.VendUpdateAmounts(VendLedgEntry,RemainingAmount,LineAmount2);
                      END;
                  END;
                  RemainingAmount := RemainingAmount - LineAmount2;
                  CurrentLineAmount := LineAmount2;
                  FoundLast := TRUE;
                END;
              Check."Application Method"::OneLineID:
                BEGIN
                  CASE Check."Balancing Type" OF
                    Check."Balancing Type"::Customer:
                      BEGIN
                        Stub."Currency Code" := GenJnlLine."Currency Code";
                        Stub.CustUpdateAmounts(CustLedgEntry,RemainingAmount,LineAmount2);
                        FoundLast := (CustLedgEntry.NEXT = 0) OR (RemainingAmount <= 0);
                        IF FoundLast AND NOT FoundNegative THEN BEGIN
                          CustLedgEntry.SETRANGE(Positive,FALSE);
                          FoundLast := NOT CustLedgEntry.FIND('-');
                          FoundNegative := TRUE;
                        END;
                      END;
                    Check."Balancing Type"::Vendor:
                      BEGIN
                        Stub."Currency Code" := GenJnlLine."Currency Code";
                        Stub.VendUpdateAmounts(VendLedgEntry,RemainingAmount,LineAmount2);
                        FoundLast := (VendLedgEntry.NEXT = 0) OR (RemainingAmount <= 0);
                        IF FoundLast AND NOT FoundNegative THEN BEGIN
                          VendLedgEntry.SETRANGE(Positive,FALSE);
                          FoundLast := NOT VendLedgEntry.FIND('-');
                          FoundNegative := TRUE;
                        END;
                      END;
                  END;
                  RemainingAmount := RemainingAmount - LineAmount2;
                  CurrentLineAmount := LineAmount2
                END;
              Check."Application Method"::MoreLinesOneEntry:
                BEGIN
                  CurrentLineAmount := GenJnlLine2.Amount;
                  LineAmount2 := CurrentLineAmount;
                  IF GenJnlLine2."Applies-to ID" <> '' THEN
                    ERROR(
                      Text016 +
                      Text017);
                  GenJnlLine2.TESTFIELD("Check Printed",FALSE);
                  GenJnlLine2.TESTFIELD("Bank Payment Type",GenJnlLine2."Bank Payment Type"::"Computer Check");
                  IF GenJnlLine2."Applies-to Doc. No." = '' THEN BEGIN
                    Stub."Document No." := '';
                    Stub."External Document No." := '';
                    Stub.Amount := CurrentLineAmount;
                    Stub."Discount Amount" := 0;
                    Stub."Currency Code" := GenJnlLine."Currency Code";
                    Stub.INSERT;
                  END ELSE BEGIN
                    CASE Check."Balancing Type" OF
                      Check."Balancing Type"::"G/L Account":
                        BEGIN
                          Stub."Document No." := GenJnlLine2."Document No.";
                          Stub."External Document No." := GenJnlLine2."External Document No.";
                          Stub.Amount := CurrentLineAmount;
                          Stub."Discount Amount" := 0;
                          Stub."Currency Code" := GenJnlLine."Currency Code";
                          Stub.INSERT;
                        END;
                      Check."Balancing Type"::Customer:
                        BEGIN
                          CustLedgEntry.RESET;
                          CustLedgEntry.SETCURRENTKEY("Document No.");
                          CustLedgEntry.SETRANGE("Document Type",GenJnlLine2."Applies-to Doc. Type");
                          CustLedgEntry.SETRANGE("Document No.",GenJnlLine2."Applies-to Doc. No.");
                          CustLedgEntry.SETRANGE("Customer No.",Check."Balancing No.");
                          CustLedgEntry.FIND('-');
                          Stub."Currency Code" := GenJnlLine."Currency Code";
                          Stub.CustUpdateAmounts(CustLedgEntry,CurrentLineAmount,LineAmount2);
                          Stub.Amount := CurrentLineAmount;
                        END;
                      Check."Balancing Type"::Vendor:
                        BEGIN
                          VendLedgEntry.RESET;
                          VendLedgEntry.SETCURRENTKEY("Document No.");
                          VendLedgEntry.SETRANGE("Document Type",GenJnlLine2."Applies-to Doc. Type");
                          VendLedgEntry.SETRANGE("Document No.",GenJnlLine2."Applies-to Doc. No.");
                          VendLedgEntry.SETRANGE("Vendor No.",Check."Balancing No.");
                          VendLedgEntry.FIND('-');
                          Stub."Currency Code" := GenJnlLine."Currency Code";
                          Stub.VendUpdateAmounts(VendLedgEntry,CurrentLineAmount,LineAmount2);
                          Stub.Amount := CurrentLineAmount; // WTF??
                        END;
                      Check."Balancing Type"::"Bank Account":
                        BEGIN
                          Stub."Document No." := GenJnlLine2."Document No.";
                          Stub."External Document No." := GenJnlLine2."External Document No.";
                          Stub.Amount := CurrentLineAmount;
                          Stub."Discount Amount" := 0;
                          Stub."Currency Code" := GenJnlLine."Currency Code";
                          Stub.INSERT;
                        END;
                    END;
                  END;
                  FoundLast := GenJnlLine2.NEXT = 0;
                END;
            END;
          END;
        END ELSE BEGIN
          IF FoundLast THEN
            EXIT;
          FoundLast := TRUE;
          Stub."Document No." := 'XXXXXXXXXX';
          Stub."External Document No." := 'XXXXXXXXXX';
          Stub.Amount := 0;
          Stub."Discount Amount" := 0;
          Stub."Currency Code" := GenJnlLine."Currency Code";
          Stub.INSERT;
        END;
      UNTIL FoundLast;
    END;

    LOCAL PROCEDURE GetGenJnlLnForMoreLinesOneEntry@1000000020(GenJnlLine@1000000000 : Record 81;VAR GenJnlLine2@1000000001 : Record 81);
    BEGIN
      WITH GenJnlLine DO BEGIN

        GenJnlLine2.RESET;
        GenJnlLine2.SETCURRENTKEY("Journal Template Name","Journal Batch Name","Posting Date","Document No.");
        GenJnlLine2.SETRANGE("Journal Template Name","Journal Template Name");
        GenJnlLine2.SETRANGE("Journal Batch Name","Journal Batch Name");
        GenJnlLine2.SETRANGE("Posting Date","Posting Date");
        GenJnlLine2.SETRANGE("Document No.","Document No.");
        GenJnlLine2.SETRANGE("Account Type","Account Type");
        GenJnlLine2.SETRANGE("Account No.","Account No.");
        GenJnlLine2.SETRANGE("Bal. Account Type","Bal. Account Type");
        GenJnlLine2.SETRANGE("Bal. Account No.","Bal. Account No.");
        GenJnlLine2.SETRANGE("Bank Payment Type","Bank Payment Type");
        GenJnlLine2.FIND('-');
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70303 ForNAV Create Check Ledg. Ent.
{
  OBJECT-PROPERTIES
  {
    Date=04-03-18;
    Time=15:40:22;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE CreateCheckLedgerEntry@1000000000(Args@1000000000 : Record 70300;Check@1000000003 : Record 70301;GenJnlLine@1000000001 : Record 81);
    VAR
      CheckLedgEntry@1000000002 : Record 272;
      CheckManagement@1000000004 : Codeunit 367;
    BEGIN
      IF NOT Args."Test Print" THEN BEGIN
        WITH GenJnlLine DO BEGIN
          CheckLedgEntry.INIT;
          CheckLedgEntry."Bank Account No." := Args."Bank Account No.";
          CheckLedgEntry."Posting Date" := "Posting Date";
          CheckLedgEntry."Document Type" := "Document Type";
          CheckLedgEntry."Document No." := Args."Check No.";
          CheckLedgEntry.Description := Description;
          CheckLedgEntry."Bank Payment Type" := "Bank Payment Type";
          CheckLedgEntry."Bal. Account Type" := Check."Balancing Type";
          CheckLedgEntry."Bal. Account No." := Check."Balancing No.";
          IF Check.Amount > 0 THEN BEGIN
            CheckLedgEntry."Entry Status" := CheckLedgEntry."Entry Status"::Printed;
            CheckLedgEntry.Amount := Check.Amount;
          END ELSE BEGIN
            CheckLedgEntry."Entry Status" := CheckLedgEntry."Entry Status"::Voided;
            CheckLedgEntry.Amount := 0;
          END;
          CheckLedgEntry."Check Date" := "Posting Date";
          CheckLedgEntry."Check No." := Args."Check No.";
          CheckManagement.InsertCheck(CheckLedgEntry,RECORDID);

        END;
      END ELSE
        WITH GenJnlLine DO BEGIN
          CheckLedgEntry.INIT;
          CheckLedgEntry."Bank Account No." := Args."Bank Account No.";
          CheckLedgEntry."Posting Date" := "Posting Date";
          CheckLedgEntry."Document No." := Args."Check No.";
          CheckLedgEntry.Description := 'XXXXXX';
          CheckLedgEntry."Bank Payment Type" := "Bank Payment Type"::"Computer Check";
          CheckLedgEntry."Entry Status" := CheckLedgEntry."Entry Status"::"Test Print";
          CheckLedgEntry."Check Date" := "Posting Date";
          CheckLedgEntry."Check No." := Args."Check No.";
          CheckManagement.InsertCheck(CheckLedgEntry,RECORDID);
        END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70304 ForNAV Create Check Model
{
  OBJECT-PROPERTIES
  {
    Date=22-05-18;
    Time=12:46:57;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE CreateFromGenJnlLn@1000000006(VAR Args@1000000002 : Record 70300;VAR GenJnlLn@1000000001 : Record 81;VAR Model@1000000000 : Record 70303) : Boolean;
    VAR
      Check@1000000004 : TEMPORARY Record 70301;
      Stub@1000000003 : TEMPORARY Record 70302;
    BEGIN
      IF NOT ValidLine(Args, GenJnlLn, Model) THEN
        EXIT(FALSE);

      CLEAR(Model);

      Check.CreateFromGenJnlLn(Args, GenJnlLn);
      Check.GetStub(Args, Stub, GenJnlLn);
      Check.UpdateJournal(Args, GenJnlLn);
      Check.CreateCheckLedgerEntry(Args, GenJnlLn);
      CreateModel(Check, Stub, Model);

      EXIT(TRUE);
    END;

    PROCEDURE CreateModel@1000000001(VAR Check@1000000000 : Record 70301;VAR Stub@1000000001 : Record 70302;VAR Model@1000000002 : Record 70303);
    VAR
      NextLineNo@1000000004 : Integer;
    BEGIN
      Model.DELETEALL;

      ForEachStubCreateModel(Check, Stub, Model, NextLineNo);
      CreateEmptyLinesInStub(Model, NextLineNo);
      SetDataInModel(Model);
    END;

    LOCAL PROCEDURE ForEachStubCreateModel@1000000005(VAR Check@1000000003 : Record 70301;VAR Stub@1000000001 : Record 70302;VAR Model@1000000000 : Record 70303;VAR NextLineNo@1000000005 : Integer);
    VAR
      CheckSetup@1000000004 : Record 70310;
    BEGIN
      CheckSetup.GET;

      WITH Stub DO BEGIN
        FINDSET;
        REPEAT
          CreateModelFromStub(Stub, Model, NextLineNo);
          UpdateModelWithCheck(Check, Model);
        UNTIL (NEXT = 0) OR (CheckSetup.Layout = CheckSetup.Layout::"3 Checks");
      END;
    END;

    LOCAL PROCEDURE CreateModelFromStub@1000000000(VAR Stub@1000000001 : Record 70302;VAR Model@1000000000 : Record 70303;VAR NextLineNo@1000000002 : Integer);
    BEGIN
      WITH Model DO BEGIN
        INIT;
        "Document Date" := Stub."Document Date";
        "Document No." := Stub."Document No.";
        "External Document No." := Stub."External Document No.";
        Amount := Stub.Amount;
        "Discount Amount" := Stub."Discount Amount";
        "Net Amount" := Stub.Amount - Stub."Discount Amount";
        "Document Type" := Stub."Document Type";
        "Amount Paid" := Stub."Amount Paid";
        "Job No." := Stub."Job No.";
        "Currency Code" := Stub."Currency Code";
        SetPageAndLineNo(NextLineNo);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE UpdateModelWithCheck@1000000003(VAR Check@1000000002 : Record 70301;VAR Model@1000000000 : Record 70303);
    BEGIN
      WITH Model DO BEGIN
        "Posting Date" := Check."Posting Date";
        Test := Check.Test;
        "Check No." := Check."Check No.";
        "Amount Written in Text" := Check."Amount as Text (LCY)";
        "Amount in Numbers" := Check."Amount Filled as Text";
        "Pay-to Vendor No." := Check."Pay-to Vendor No.";
        "Pay-to Name" := Check."Pay-to Name";
        "Pay-to Name 2" := Check."Pay-to Name 2";
        "Pay-to Address" := Check."Pay-to Address";
        "Pay-to Address 2" := Check."Pay-to Address 2";
        "Pay-to Post Code" := Check."Pay-to Post Code";
        "Pay-to City" := Check."Pay-to City";
        "Pay-to County" := Check."Pay-to County";
        "Pay-to Country/Region Code" := Check."Pay-to Country/Region Code";
        "Bank Name" := Check."Bank Name";
        MODIFY;
        Duplicate;
      END;
    END;

    LOCAL PROCEDURE SetDataInModel@1000000004(VAR Model@1000000000 : Record 70303);
    BEGIN
      WITH Model DO BEGIN
        RESET;
        FINDSET;
        REPEAT
          SetType;
          SetIsVoid;
          SetAddress;
          SetPayToAddress;
          VoidCheckFields;
          MODIFY;
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE CreateEmptyLinesInStub@1000000002(VAR Model@1000000001 : Record 70303;VAR NextLineNo@1000000000 : Integer);
    VAR
      CheckSetup@1000000002 : Record 70310;
    BEGIN
      CheckSetup.GET;
      IF NextLineNo >= CheckSetup."No. of Lines (Stub)" THEN
        EXIT;

      WHILE NextLineNo < CheckSetup."No. of Lines (Stub)" DO
        WITH Model DO BEGIN
          INIT;
          "Part No." := 1;
          NextLineNo  += 1;
          "Line No." := NextLineNo;
          INSERT;
          Duplicate;
        END;
    END;

    LOCAL PROCEDURE ValidLine@1000000007(VAR Args@1000000001 : Record 70300;VAR GenJnlLn@1000000000 : Record 81;VAR Model@1000000003 : Record 70303) : Boolean;
    BEGIN
      WITH Args DO
        IF NOT "One Check Per Vendor" THEN
          EXIT(TRUE);

      IF NOT Model.FINDFIRST THEN
        EXIT(TRUE);

      EXIT(GenJnlLn."Account No." <> Model."Pay-to Vendor No.");
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70305 ForNAV Amount as Text
{
  OBJECT-PROPERTIES
  {
    Date=11-03-18;
    Time=19:35:18;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      OnesText@1000000005 : ARRAY [20] OF Text[30];
      TensText@1000000004 : ARRAY [10] OF Text[30];
      ExponentText@1000000003 : ARRAY [5] OF Text[30];

    [External]
    PROCEDURE FormatNoText@1(VAR NoText@1000 : ARRAY [2] OF Text[80];No@1001 : Decimal;CurrencyCode@1002 : Code[10]);
    VAR
      PrintExponent@1003 : Boolean;
      Ones@1004 : Integer;
      Tens@1005 : Integer;
      Hundreds@1006 : Integer;
      Exponent@1007 : Integer;
      NoTextIndex@1008 : Integer;
      DecimalPosition@1010 : Decimal;
      Text026@1000000002 : TextConst 'DAN=NUL;DEU=NULL;ENU=ZERO;NLD=NUL';
      Text027@1000000001 : TextConst 'DAN=HUNDREDE;DEU=HUNDERT;ENU=HUNDRED;NLD=HONDERD';
      Text028@1000000000 : TextConst 'DAN=OG;DEU=UND;ENU=AND;NLD=EN';
    BEGIN
      CLEAR(NoText);
      NoTextIndex := 1;
      NoText[1] := '****';

      IF No < 1 THEN
        AddToNoText(NoText,NoTextIndex,PrintExponent,Text026)
      ELSE
        FOR Exponent := 4 DOWNTO 1 DO BEGIN
          PrintExponent := FALSE;
          Ones := No DIV POWER(1000,Exponent - 1);
          Hundreds := Ones DIV 100;
          Tens := (Ones MOD 100) DIV 10;
          Ones := Ones MOD 10;
          IF Hundreds > 0 THEN BEGIN
            AddToNoText(NoText,NoTextIndex,PrintExponent,OnesText[Hundreds]);
            AddToNoText(NoText,NoTextIndex,PrintExponent,Text027);
          END;
          IF Tens >= 2 THEN BEGIN
            AddToNoText(NoText,NoTextIndex,PrintExponent,TensText[Tens]);
            IF Ones > 0 THEN
              AddToNoText(NoText,NoTextIndex,PrintExponent,OnesText[Ones]);
          END ELSE
            IF (Tens * 10 + Ones) > 0 THEN
              AddToNoText(NoText,NoTextIndex,PrintExponent,OnesText[Tens * 10 + Ones]);
          IF PrintExponent AND (Exponent > 1) THEN
            AddToNoText(NoText,NoTextIndex,PrintExponent,ExponentText[Exponent]);
          No := No - (Hundreds * 100 + Tens * 10 + Ones) * POWER(1000,Exponent - 1);
        END;

      AddToNoText(NoText,NoTextIndex,PrintExponent,Text028);
      DecimalPosition := GetAmtDecimalPosition;
      AddToNoText(NoText,NoTextIndex,PrintExponent,(FORMAT(No * DecimalPosition) + '/' + FORMAT(DecimalPosition)));

      IF CurrencyCode <> '' THEN
        AddToNoText(NoText,NoTextIndex,PrintExponent,CurrencyCode);
    END;

    LOCAL PROCEDURE AddToNoText@2(VAR NoText@1000 : ARRAY [2] OF Text[80];VAR NoTextIndex@1001 : Integer;VAR PrintExponent@1002 : Boolean;AddText@1003 : Text[30]);
    VAR
      Text029@1000000000 : TextConst 'DAN=%1 resulterer i et skrevet tal, der er for langt.;DEU=%1 ist das Ergebnis einer zu langen Nummer.;ENU=%1 results in a written number that is too long.;NLD=Het uitgeschreven getal %1 te lang.';
    BEGIN
      PrintExponent := TRUE;

      WHILE STRLEN(NoText[NoTextIndex] + ' ' + AddText) > MAXSTRLEN(NoText[1]) DO BEGIN
        NoTextIndex := NoTextIndex + 1;
        IF NoTextIndex > ARRAYLEN(NoText) THEN
          ERROR(Text029,AddText);
      END;

      NoText[NoTextIndex] := DELCHR(NoText[NoTextIndex] + ' ' + AddText,'<');
    END;

    LOCAL PROCEDURE GetAmtDecimalPosition@22() : Decimal;
    VAR
      Currency@1000 : Record 4;
    BEGIN
      //IF GenJnlLine."Currency Code" = '' THEN
        Currency.InitRoundingPrecision;
      //ELSE BEGIN
      //  Currency.GET(GenJnlLine."Currency Code");
      //  Currency.TESTFIELD("Amount Rounding Precision");
      //END;
      EXIT(1 / Currency."Amount Rounding Precision");
    END;

    [External]
    PROCEDURE InitTextVariable@5();
    VAR
      Text032@1000000029 : TextConst 'DAN=EN;DEU=EINS;ENU=ONE;NLD=EEN';
      Text033@1000000028 : TextConst 'DAN=TO;DEU=ZWEI;ENU=TWO;NLD=TWEE';
      Text034@1000000027 : TextConst 'DAN=TRE;DEU=DREI;ENU=THREE;NLD=DRIE';
      Text035@1000000026 : TextConst 'DAN=FIRE;DEU=VIER;ENU=FOUR;NLD=VIER';
      Text036@1000000025 : TextConst 'DAN=FEM;DEU=FöNF;ENU=FIVE;NLD=VIJF';
      Text037@1000000024 : TextConst 'DAN=SEKS;DEU=SECHS;ENU=SIX;NLD=ZES';
      Text038@1000000023 : TextConst 'DAN=SYV;DEU=SIEBEN;ENU=SEVEN;NLD=ZEVEN';
      Text039@1000000022 : TextConst 'DAN=OTTE;DEU=ACHT;ENU=EIGHT;NLD=ACHT';
      Text040@1000000021 : TextConst 'DAN=NI;DEU=NEUN;ENU=NINE;NLD=NEGEN';
      Text041@1000000020 : TextConst 'DAN=TI;DEU=ZEHN;ENU=TEN;NLD=TIEN';
      Text042@1000000019 : TextConst 'DAN=ELLEVE;DEU=ELF;ENU=ELEVEN;NLD=ELF';
      Text043@1000000018 : TextConst 'DAN=TOLV;DEU=ZWôLF;ENU=TWELVE;NLD=TWAALF';
      Text044@1000000017 : TextConst 'DAN=TRETTEN;DEU=DREIZEHN;ENU=THIRTEEN;NLD=DERTIEN';
      Text045@1000000016 : TextConst 'DAN=FJORTEN;DEU=VIERZEHN;ENU=FOURTEEN;NLD=VEERTIEN';
      Text046@1000000015 : TextConst 'DAN=FEMTEN;DEU=FöNFZEHN;ENU=FIFTEEN;NLD=VIJFTIEN';
      Text047@1000000014 : TextConst 'DAN=SEKSTEN;DEU=SECHZEHN;ENU=SIXTEEN;NLD=ZESTIEN';
      Text048@1000000013 : TextConst 'DAN=SYTTEN;DEU=SIEBZEHN;ENU=SEVENTEEN;NLD=ZEVENTIEN';
      Text049@1000000012 : TextConst 'DAN=ATTEN;DEU=ACHTZEHN;ENU=EIGHTEEN;NLD=ACHTTIEN';
      Text050@1000000011 : TextConst 'DAN=NITTEN;DEU=NEUNZEHN;ENU=NINETEEN;NLD=NEGENTIEN';
      Text051@1000000010 : TextConst 'DAN=TOTI;DEU=ZWANZIG;ENU=TWENTY;NLD=TWINTIG';
      Text052@1000000009 : TextConst 'DAN=TRETI;DEU=DREI·IG;ENU=THIRTY;NLD=DERTIG';
      Text053@1000000008 : TextConst 'DAN=FIRTI;DEU=VIERZIG;ENU=FORTY;NLD=VEERTIG';
      Text054@1000000007 : TextConst 'DAN=FEMTI;DEU=FöNFZIG;ENU=FIFTY;NLD=VIJFTIG';
      Text055@1000000006 : TextConst 'DAN=SEKSTI;DEU=SECHZIG;ENU=SIXTY;NLD=ZESTIG';
      Text056@1000000005 : TextConst 'DAN=SYVTI;DEU=SIEBZIG;ENU=SEVENTY;NLD=ZEVENTIG';
      Text057@1000000004 : TextConst 'DAN=OTTI;DEU=ACHTZIG;ENU=EIGHTY;NLD=TACHTIG';
      Text058@1000000003 : TextConst 'DAN=NITI;DEU=NEUNZIG;ENU=NINETY;NLD=NEGENTIG';
      Text059@1000000002 : TextConst 'DAN=TUSIND;DEU=TAUSEND;ENU=THOUSAND;NLD=DUIZEND';
      Text060@1000000001 : TextConst 'DAN=MILLION;DEU=MILLION;ENU=MILLION;NLD=MILJOEN';
      Text061@1000000000 : TextConst 'DAN=MILLIARD;DEU=MILLIARDE;ENU=BILLION;NLD=MILJARD';
    BEGIN
      OnesText[1] := Text032;
      OnesText[2] := Text033;
      OnesText[3] := Text034;
      OnesText[4] := Text035;
      OnesText[5] := Text036;
      OnesText[6] := Text037;
      OnesText[7] := Text038;
      OnesText[8] := Text039;
      OnesText[9] := Text040;
      OnesText[10] := Text041;
      OnesText[11] := Text042;
      OnesText[12] := Text043;
      OnesText[13] := Text044;
      OnesText[14] := Text045;
      OnesText[15] := Text046;
      OnesText[16] := Text047;
      OnesText[17] := Text048;
      OnesText[18] := Text049;
      OnesText[19] := Text050;

      TensText[1] := '';
      TensText[2] := Text051;
      TensText[3] := Text052;
      TensText[4] := Text053;
      TensText[5] := Text054;
      TensText[6] := Text055;
      TensText[7] := Text056;
      TensText[8] := Text057;
      TensText[9] := Text058;

      ExponentText[1] := '';
      ExponentText[2] := Text059;
      ExponentText[3] := Text060;
      ExponentText[4] := Text061;
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70306 ForNAV Read Check Watermarks
{
  OBJECT-PROPERTIES
  {
    Date=04-03-18;
    Time=15:26:57;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ReadFromFile@1(VAR ForNAVCheckSetup@1004 : Record 70310;Which@1003 : Integer) : Boolean;
    VAR
      TempBlob@1002 : TEMPORARY Record 99008535;
      FileMgt@1001 : Codeunit 419;
      FileName@1000 : Text;
    BEGIN
      FileName := FileMgt.BLOBImport(TempBlob,'');

      WITH ForNAVCheckSetup DO
        IF FileName <> '' THEN BEGIN
          CASE Which OF
            FIELDNO(Watermark):
              BEGIN
                Watermark := TempBlob.Blob;
                "Watermark File Name" := GetFileNameFromFile(FileName);
              END;
            FIELDNO(Signature):
              BEGIN
                Signature := TempBlob.Blob;
                "Signature File Name" := GetFileNameFromFile(FileName);
              END;
          END;
          EXIT(TRUE);
        END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE GetFileNameFromFile@3(Value@1000 : Text) : Text;
    VAR
      LastPos@1001 : Integer;
      i@1002 : Integer;
    BEGIN
      WHILE i < STRLEN(Value) DO BEGIN
        i := i + 1;
        IF Value[i] = '\' THEN
          LastPos := i;
      END;

      EXIT(COPYSTR(Value, LastPos + 1));
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT MenuSuite 1060 ForNAV
{
  OBJECT-PROPERTIES
  {
    Date=14-05-18;
    Time=09:14:32;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  MENUNODES
  {
    {                ;[{7FD6154D-F047-4A31-B857-0DA1E0BA97D8}] ;NextNodeID=[{E55ED739-BBB9-4063-AF58-225E99C5FE72}] }
    { MenuItem       ;[{E55ED739-BBB9-4063-AF58-225E99C5FE72}] ;Name=Document Sending Profiles;
                                                                CaptionML=[ENU=Document Sending Profiles;
                                                                           NLD=Verzendprofielen van documenten];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=359;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{379BBC3B-5EBB-4617-8419-8D76352F8337}] ;Name=Electronic Document Formats;
                                                                CaptionML=[ENU=Electronic Document Formats;
                                                                           NLD=Elektronische documentindelingen];
                                                                ApplicationArea=#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=363;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{8A3934DD-BE0A-4851-B8E0-50A64106B98A}] ;Name=Data Exchange Types;
                                                                CaptionML=[ENU=Data Exchange Types;
                                                                           NLD=Typen gegevensuitwisseling];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1213;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{0D3D0EB4-59D7-4D3E-95AC-49CD269C6C04}] ;Name=Data Migration Settings;
                                                                AccessByPermission=TableData 1806=R;
                                                                CaptionML=[ENU=Data Migration Settings;
                                                                           NLD=Instellingen van gegevensmigratie];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1807;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{00646221-3EEF-4883-8640-FECFD9BEC705}] ;Name=Report Configuration;
                                                                AccessByPermission=TableData 2000000196=IMD;
                                                                CaptionML=[ENU=Report Settings;
                                                                           NLD=Rapportinstellingen];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1560;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{A1E3A413-B0C4-4D20-8B1F-AFF7DFFDB43C}] ;Name=Setup and Help Resources;
                                                                CaptionML=[ENU=Setup and Help Resources;
                                                                           NLD=Instellings- en Help-resources];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1822;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    {                ;[{19A352FE-D90D-424E-B85F-CF3B8E98CF0E}] ;NextNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}] }
    { Menu           ;[{0691571E-EDD6-473D-A139-81B1E9B887F2}] ;Name=ForNAV;
                                                                CaptionML=ENU=ForNAV;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                Image=15;
                                                                IsShortcut=No;
                                                                Visible=Yes;
                                                                Enabled=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{E849D80C-A6A0-4A75-9313-4A9691856383}] }
    { MenuItem       ;[{CC9EF159-165D-4DCB-8A3B-05D408AB94F8}] ;Name=ForNAV Setup;
                                                                CaptionML=ENU=ForNAV Setup;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70000;
                                                                ParentNodeID=[{E849D80C-A6A0-4A75-9313-4A9691856383}];
                                                                Visible=Yes;
                                                                NextNodeID=[{E2F52C7B-393D-4590-AFDD-5C476AB94898}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{E849D80C-A6A0-4A75-9313-4A9691856383}] ;Name=Application Setup;
                                                                CaptionML=ENU=Application Setup;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}];
                                                                FirstChild=[{CC9EF159-165D-4DCB-8A3B-05D408AB94F8}] }
    { MenuItem       ;[{E6D918CF-B1F7-4171-A3E9-3C6E9B592EB1}] ;Name=Transformation Rules;
                                                                CaptionML=ENU=Transformation Rules;
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1237;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{C331F6D8-9B94-4792-89D9-CEDBB101436C}] ;Name=ForNAV Legal Cond. Translation;
                                                                CaptionML=ENU=ForNAV Legal Cond. Translation;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70001;
                                                                ParentNodeID=[{E849D80C-A6A0-4A75-9313-4A9691856383}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}] ;Name=Document Reports;
                                                                CaptionML=ENU=Document Reports;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                Visible=Yes;
                                                                NextNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                FirstChild=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}] }
    { MenuItem       ;[{62E72610-35DE-4B65-A0A8-4A4464FD467C}] ;Name=Sales Order Confirmation;
                                                                CaptionML=ENU=Sales Order Confirmation;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70000;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{D30D76B6-37A6-4333-B5F6-F6688007A102}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{596FD082-176B-47D1-B4BA-5DABB301A6C3}] ;Name=Sales;
                                                                CaptionML=ENU=Sales;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                FirstChild=[{62E72610-35DE-4B65-A0A8-4A4464FD467C}] }
    { MenuItem       ;[{D30D76B6-37A6-4333-B5F6-F6688007A102}] ;Name=Sales Invoice;
                                                                CaptionML=ENU=Sales Invoice;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70001;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{D689D68B-B7E6-44FA-A12E-412B7F969A7A}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{D689D68B-B7E6-44FA-A12E-412B7F969A7A}] ;Name=Sales Credit Memo;
                                                                CaptionML=ENU=Sales Credit Memo;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70002;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{1D3B52D4-9A4A-45D3-A4EA-4EBB5B792BBA}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{1D3B52D4-9A4A-45D3-A4EA-4EBB5B792BBA}] ;Name=Sales Shipment;
                                                                CaptionML=ENU=Sales Shipment;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70003;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{BB66C103-03B0-4D34-BAA5-44DE7EB35EB2}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{BB66C103-03B0-4D34-BAA5-44DE7EB35EB2}] ;Name=Sales Quote;
                                                                CaptionML=ENU=Sales Quote;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70004;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{420A2BFA-3FD3-4AD3-914D-DACF3DC2A358}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}] ;Name=Purchase;
                                                                CaptionML=ENU=Purchase;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{458B34B1-AD78-4D59-83D7-A7E5279B9AAF}];
                                                                FirstChild=[{3C3B5DC6-21F5-4E37-8C08-8E5938133520}] }
    { MenuItem       ;[{3C3B5DC6-21F5-4E37-8C08-8E5938133520}] ;Name=Purchase Order;
                                                                CaptionML=ENU=Purchase Order;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70100;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{59F08D28-DEAC-4A3B-96E2-A6D597DDE1F6}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{59F08D28-DEAC-4A3B-96E2-A6D597DDE1F6}] ;Name=Purchase Invoice;
                                                                CaptionML=ENU=Purchase Invoice;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70101;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{4CC18C18-81F4-4235-ADCD-5168C7501B6E}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{4CC18C18-81F4-4235-ADCD-5168C7501B6E}] ;Name=Purchase Credit Memo;
                                                                CaptionML=ENU=Purchase Credit Memo;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70102;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F10C4BA6-49D1-41DC-834C-A7F72C44B7C5}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{F10C4BA6-49D1-41DC-834C-A7F72C44B7C5}] ;Name=Purchase Quote;
                                                                CaptionML=ENU=Purchase Quote;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70104;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}] ;Name=Reports;
                                                                CaptionML=ENU=Reports;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{BA687EE2-5570-4962-B8FF-C27DE3ABC6F3}] }
    { MenuItem       ;[{BA687EE2-5570-4962-B8FF-C27DE3ABC6F3}] ;Name=ForNAV Trial Balance;
                                                                CaptionML=ENU=ForNAV Trial Balance;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70206;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{80F41632-02B7-4B65-9469-B637CEA37A37}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{80F41632-02B7-4B65-9469-B637CEA37A37}] ;Name=ForNAV Customer/Item Statistics;
                                                                CaptionML=ENU=ForNAV Customer/Item Statistics;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70248;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{8EBA2FA7-A319-4BFA-8379-B9A253503879}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{8EBA2FA7-A319-4BFA-8379-B9A253503879}] ;Name=ForNav Salesperson-Commission;
                                                                CaptionML=ENU=ForNav Salesperson-Commission;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70215;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{3E0EA722-316D-4835-B87E-31E12BE27FF9}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{3E0EA722-316D-4835-B87E-31E12BE27FF9}] ;Name=ForNAV Aged Accounts Receivable;
                                                                CaptionML=ENU=ForNAV Aged Accounts Receivable;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70220;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F84E0725-FFC0-482E-A802-8C3F918E698E}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{F84E0725-FFC0-482E-A802-8C3F918E698E}] ;Name=ForNAV Aged Accounts Payable;
                                                                CaptionML=ENU=ForNAV Aged Accounts Payable;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70221;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{41CABE99-FB5D-4D56-853C-5D1F4736CD42}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{41CABE99-FB5D-4D56-853C-5D1F4736CD42}] ;Name=Debitor - top 10-liste;
                                                                CaptionML=[CSY=ForNAV Nejlep °ch 10 z†kazn°ku;
                                                                           DAN=ForNAV Debitor - top 10-liste;
                                                                           DEU=ForNAV Top 10 Liste (Debitoren);
                                                                           ENU=ForNAV Customer Top 10 List;
                                                                           FIN=ForNAV Asiakkaat - 10 pÑÑasiakasta;
                                                                           FRA=ForNAV Clients - Palmaräs;
                                                                           ISL=ForNAV Vi˜skiptama˜ur - 10 efstu;
                                                                           ITA=ForNAV Lista primi 10 clienti;
                                                                           NLD=ForNAV Klanten - Top 10;
                                                                           NOR=ForNAV Kunde - ti pÜ topp-liste;
                                                                           RUS=‡âäÜ°ï - ãÜ˜ÉÖò ÑÜ§òïàÖ;
                                                                           SVE=ForNAV Kunder, 10 i topp;
                                                                           DES=ForNAV Top 10 Liste (Debitoren);
                                                                           ENG=ForNAV Customer Top 10 List;
                                                                           FRB=ForNAV Clients - Palmaräs;
                                                                           ITS=ForNAV Lista primi 10 clienti;
                                                                           NLB=ForNAV Klanten - Top 10;
                                                                           DEA=ForNAV Top 10 Liste (Debitoren);
                                                                           ENA=ForNAV Customer Top 10 List;
                                                                           ESN=ForNAV Los 10 mejores clientes;
                                                                           FRS=ForNAV Clients - Palmaräs;
                                                                           ENZ=ForNAV Customer Top 10 List];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70201;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{45294869-9463-4CF8-B506-43F3CEDF442B}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{45294869-9463-4CF8-B506-43F3CEDF442B}] ;Name=Kreditor - top 10-liste;
                                                                CaptionML=[CSY=ForNAV Dodavatel - nejlep °ch 10;
                                                                           DAN=ForNAV Kreditor - top 10-liste;
                                                                           DEU=ForNAV HÑndler Top-10-Liste;
                                                                           ENU=ForNAV Vendor Top 10 List;
                                                                           FIN=ForNAV 10 pÑÑtoimittajaa;
                                                                           FRA=ForNAV Palmaräs fournisseurs;
                                                                           ISL=ForNAV 10 efstu l†nardrottnar;
                                                                           ITA=ForNAV Lista primi 10 fornitori;
                                                                           NLD=ForNAV Lijst top 10 leveranciers;
                                                                           NOR=ForNAV Leverand˚r - topp 10-liste;
                                                                           RUS=Áå§ïÖÉóäàä - ãÜ˜ÉÖò ÑÜ§òïàÖ;
                                                                           SVE=ForNAV 10 i topp leverantîrer;
                                                                           DES=ForNAV HÑndler Top-10-Liste;
                                                                           ENG=ForNAV Vendor Top 10 List;
                                                                           FRB=ForNAV Palmaräs fournisseurs;
                                                                           ITS=ForNAV Lista primi 10 fornitori;
                                                                           NLB=ForNAV Lijst top 10 leveranciers;
                                                                           DEA=ForNAV HÑndler Top-10-Liste;
                                                                           ENA=ForNAV Vendor Top 10 List;
                                                                           ESN=ForNAV Listado 10 mejores proveedores;
                                                                           FRS=ForNAV Palmaräs fournisseurs;
                                                                           ENZ=ForNAV Vendor Top 10 List];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70202;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{C4C965B8-22F8-4D48-A792-BCEAF9E1BEB6}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{6FBB60D4-3684-4106-BEFF-237518F7236E}] ;Name=Data Migration Overview;
                                                                CaptionML=[ENU=Data Migration Overview;
                                                                           NLD=Overzicht van gegevensmigratie];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1799;
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{420A2BFA-3FD3-4AD3-914D-DACF3DC2A358}] ;Name=Customer Statement;
                                                                CaptionML=ENU=Customer Statement;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70250;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{E2F52C7B-393D-4590-AFDD-5C476AB94898}] ;Name=ForNAV Check Setup;
                                                                CaptionML=ENU=ForNAV Check Setup;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70310;
                                                                ParentNodeID=[{E849D80C-A6A0-4A75-9313-4A9691856383}];
                                                                Visible=Yes;
                                                                NextNodeID=[{C331F6D8-9B94-4792-89D9-CEDBB101436C}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{458B34B1-AD78-4D59-83D7-A7E5279B9AAF}] ;Name=Warehouse;
                                                                CaptionML=ENU=Warehouse;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{5B332954-49C2-42C1-B0B7-A1ED7D621C19}] }
    { MenuItem       ;[{5B332954-49C2-42C1-B0B7-A1ED7D621C19}] ;Name=Warehouse Shipment;
                                                                CaptionML=ENU=Warehouse Shipment;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70010;
                                                                ParentNodeID=[{458B34B1-AD78-4D59-83D7-A7E5279B9AAF}];
                                                                Visible=Yes;
                                                                NextNodeID=[{8313BC09-4DC0-438F-9A4E-2B98853DCDEA}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{8313BC09-4DC0-438F-9A4E-2B98853DCDEA}] ;Name=Warehouse Shipment;
                                                                CaptionML=ENU=Warehouse Receipt;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70011;
                                                                ParentNodeID=[{458B34B1-AD78-4D59-83D7-A7E5279B9AAF}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{C4C965B8-22F8-4D48-A792-BCEAF9E1BEB6}] ;Name=ForNAV Customer Payments;
                                                                CaptionML=ENU=ForNAV Customer Payments;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70210;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{5C9B4069-E62F-4CFE-8137-3B0E9F8D9DA3}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{5C9B4069-E62F-4CFE-8137-3B0E9F8D9DA3}] ;Name=ForNAV Sales Statistics;
                                                                CaptionML=ENU=ForNAV Sales Statistics;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70230;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{B5905093-C95D-4014-9089-C77A854BFADD}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{B5905093-C95D-4014-9089-C77A854BFADD}] ;Name=ForNAV Purchase Statistics;
                                                                CaptionML=ENU=ForNAV Purchase Statistics;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70235;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{98CE957F-C3B8-4CC1-80DA-CC34AABEECFA}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{98CE957F-C3B8-4CC1-80DA-CC34AABEECFA}] ;Name=ForNAV Inv. to G/L Reconcile;
                                                                CaptionML=ENU=ForNAV Inv. to G/L Reconcile;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70240;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{5D927B13-F422-4557-9A91-1EB0C4A6660C}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{5D927B13-F422-4557-9A91-1EB0C4A6660C}] ;Name=ForNAV Item Variants;
                                                                CaptionML=ENU=ForNAV Item Variants;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70270;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
  }
}
OBJECT Page 70000 ForNAV Setup
{
  OBJECT-PROPERTIES
  {
    Date=20-12-17;
    Time=17:44:41;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table70000;
    PageType=Card;
    OnOpenPage=BEGIN
                 InitSetup;
               END;

    OnAfterGetRecord=BEGIN
                       WrongLocalization := NOT ValidateCurrentLocalization;
                     END;

    ActionList=ACTIONS
    {
      { 1       ;    ;ActionContainer;
                      Name=ActionItems;
                      ActionContainerType=ActionItems }
      { 11      ;1   ;ActionGroup;
                      Name=Watermark }
      { 10      ;2   ;Action    ;
                      Name=DownloadWatermark;
                      CaptionML=ENU=Download Watermarks;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Link;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DownloadWatermarks;
                               END;
                                }
      { 8       ;1   ;ActionGroup;
                      Name=Delete Visuals }
      { 14      ;2   ;Action    ;
                      Name=DeleteDocWatermark;
                      CaptionML=ENU=Document Watermark;
                      Image=Delete;
                      OnAction=VAR
                                 AreYouSureQst@1000 : TextConst 'ENU=Are you sure you want to clear %1?';
                               BEGIN
                                 IF NOT CONFIRM(AreYouSureQst, FALSE, FIELDCAPTION("Document Watermark")) THEN
                                   EXIT;

                                 "Document Watermark File Name" := 'Click to import...';
                                 CLEAR("Document Watermark");
                                 MODIFY;
                               END;
                                }
      { 15      ;2   ;Action    ;
                      Name=DeleteListWatermark;
                      CaptionML=ENU=List Watermark;
                      Image=Delete;
                      OnAction=VAR
                                 AreYouSureQst@1000 : TextConst 'ENU=Are you sure you want to clear %1?';
                               BEGIN
                                 IF NOT CONFIRM(AreYouSureQst, FALSE, FIELDCAPTION("List Report Watermark")) THEN
                                   EXIT;

                                 "List Report Watermark File N." := 'Click to import...';
                                 CLEAR("List Report Watermark");
                                 MODIFY;
                               END;
                                }
      { 16      ;2   ;Action    ;
                      Name=DeleteLogo;
                      CaptionML=ENU=Logo;
                      Image=Delete;
                      OnAction=VAR
                                 AreYouSureQst@1000 : TextConst 'ENU=Are you sure you want to clear %1?';
                               BEGIN
                                 IF NOT CONFIRM(AreYouSureQst, FALSE, FIELDCAPTION(Logo)) THEN
                                   EXIT;

                                 "Logo File Name" := 'Click to import...';
                                 CLEAR(Logo);
                                 MODIFY;
                               END;
                                }
      { 12      ;1   ;ActionGroup;
                      Name=System }
      { 2       ;2   ;Action    ;
                      Name=ReplaceReports;
                      CaptionML=ENU=Replace Reportselection;
                      Image=SwitchCompanies;
                      OnAction=BEGIN
                                 ReplaceReportSelection(FALSE);
                               END;
                                }
      { 7       ;2   ;Action    ;
                      Name=CheckLocalization;
                      CaptionML=ENU=Check Localization;
                      Image=MapSetup;
                      OnAction=BEGIN
                                 CheckLocalizationBasedOnTables;
                                 MODIFY;
                               END;
                                }
      { 9       ;2   ;Action    ;
                      Name=CreateWebservice;
                      CaptionML=ENU=Create ForNAV Webservice;
                      Image=ServiceSetup;
                      OnAction=BEGIN
                                 CreateWebService;
                               END;
                                }
      { 13      ;1   ;ActionGroup;
                      Name=Template }
      { 1000000014;2 ;Action    ;
                      Name=DesignTemplatePortrait;
                      CaptionML=ENU=Design General Template (Portrait);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=UnitOfMeasure;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignTemplatePortrait;
                               END;
                                }
      { 21      ;2   ;Action    ;
                      Name=DesignTemplateLandscape;
                      CaptionML=ENU=Design General Template (Landscape);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=VATPostingSetup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignTemplateLandscape;
                               END;
                                }
      { 4       ;2   ;Action    ;
                      Name=DesignSalesTemplate;
                      CaptionML=ENU=Design Sales Template;
                      ToolTipML=ENU=Use this option to change the sales template, for example when you want to move the address or change the font.;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Design;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignSalesTemplate;
                               END;
                                }
      { 1000000009;2 ;Action    ;
                      Name=DesignPurchaseTemplate;
                      CaptionML=ENU=Design Purchase Template;
                      ToolTipML=ENU=Use this option to change the purchase template, for example when you want to move the address or change the font.;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=DesignCodeBehind;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignPurchaseTemplate;
                               END;
                                }
      { 1000000011;  ;ActionContainer;
                      Name=RelatedInformation;
                      ActionContainerType=RelatedInformation }
      { 1000000013;1 ;Action    ;
                      Name=Translations;
                      CaptionML=ENU=Translations;
                      ToolTipML=ENU=View or edit translated legal conditions. Translated legal conditions are automatically inserted on documents according to the language code.;
                      RunObject=Page 70001;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Translations;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                GroupType=Group }

    { 6   ;2   ;Field     ;
                SourceExpr=Localization;
                Style=Unfavorable;
                StyleExpr=WrongLocalization }

    { 1000000010;2;Field  ;
                SourceExpr="Use ForNAV Languages" }

    { 1000000012;2;Field  ;
                SourceExpr="Use Preprinted Paper" }

    { 1000000002;1;Group  ;
                Name=VAT/Sales Tax;
                GroupType=Group }

    { 1000000003;2;Field  ;
                SourceExpr="VAT Amount Specification" }

    { 1000000004;1;Group  ;
                Name=Document Texts;
                GroupType=Group }

    { 5   ;2   ;Field     ;
                SourceExpr="Payment Note";
                MultiLine=Yes }

    { 1000000005;2;Field  ;
                SourceExpr="Legal Conditions";
                MultiLine=Yes }

    { 17  ;1   ;Group     ;
                Name=Visuals;
                GroupType=Group }

    { 18  ;2   ;Field     ;
                CaptionML=ENU=Logo;
                SourceExpr="Logo File Name";
                OnDrillDown=VAR
                              TempBlob@1001 : Record 99008535;
                              FileManagement@1000 : Codeunit 419;
                            BEGIN
                              CALCFIELDS(Logo);
                              IF "Logo File Name" <> 'Click to import...' THEN BEGIN
                                TempBlob.Blob := Logo;
                                HYPERLINK(FileManagement.BLOBExport(TempBlob, "Logo File Name", FALSE));
                              END ELSE
                                ImportWatermarkFromClientFile(FIELDNO(Logo));
                              MODIFY;
                            END;
                             }

    { 19  ;2   ;Field     ;
                CaptionML=ENU=Document Watermark;
                SourceExpr="Document Watermark File Name";
                Editable=FALSE;
                OnDrillDown=VAR
                              TempBlob@1001 : Record 99008535;
                              FileManagement@1000 : Codeunit 419;
                            BEGIN
                              CALCFIELDS("Document Watermark");
                              IF "Document Watermark File Name" <> 'Click to import...' THEN BEGIN
                                TempBlob.Blob := "Document Watermark";
                                HYPERLINK(FileManagement.BLOBExport(TempBlob, "Document Watermark File Name", FALSE));
                              END ELSE
                                ImportWatermarkFromClientFile(FIELDNO("Document Watermark"));
                              MODIFY;
                            END;
                             }

    { 20  ;2   ;Field     ;
                CaptionML=ENU=List Report Watermark;
                SourceExpr="List Report Watermark File N.";
                OnDrillDown=VAR
                              TempBlob@1001 : Record 99008535;
                              FileManagement@1000 : Codeunit 419;
                            BEGIN
                              CALCFIELDS("List Report Watermark");
                              IF "List Report Watermark File N." <> 'Click to import...' THEN BEGIN
                                TempBlob.Blob := "List Report Watermark";
                                HYPERLINK(FileManagement.BLOBExport(TempBlob, "List Report Watermark File N.", FALSE));
                              END ELSE
                                ImportWatermarkFromClientFile(FIELDNO("List Report Watermark"));
                              MODIFY;
                            END;
                             }

    { 1000000006;0;Container;
                ContainerType=FactBoxArea }

    { 1000000007;1;Part   ;
                PartType=System;
                SystemPartID=MyNotes }

    { 1000000008;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

  }
  CODE
  {
    VAR
      WrongLocalization@1000 : Boolean INDATASET;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Page 70001 ForNAV Legal Cond. Translation
{
  OBJECT-PROPERTIES
  {
    Date=14-07-17;
    Time=10:56:09;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    SourceTable=Table70001;
    PageType=List;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr="Language Code" }

    { 1000000003;2;Field  ;
                SourceExpr="Legal Conditions" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Page 70005 ForNAV Setup Wizard
{
  OBJECT-PROPERTIES
  {
    Date=14-05-18;
    Time=09:07:02;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    SourceTable=Table70000;
    PageType=NavigatePage;
    SourceTableTemporary=Yes;
    OnInit=BEGIN
             LoadTopBanners;
           END;

    OnOpenPage=BEGIN
                 INIT;
                 IF ForNAVSetup.GET THEN BEGIN
                   TRANSFERFIELDS(ForNAVSetup);
                   WrongLocalization := NOT ValidateCurrentLocalization;
                 END ELSE BEGIN
                   CheckLocalizationBasedOnTables;
                   "Legal Conditions" := LegalConditionsTxt;
                   "Payment Note" := PaymentNoteTxt;
                   "VAT Amount Specification" := "VAT Amount Specification"::"Multiple Lines";
                   VALIDATE(Localization);
                 END;
                 INSERT;

                 Step := Step::Start;
                 EnableControls;
               END;

    ActionList=ACTIONS
    {
      { 19      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 18      ;1   ;Action    ;
                      Name=ActionBack;
                      CaptionML=ENU=Back;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=BackActionEnabled;
                      InFooterBar=Yes;
                      Image=PreviousRecord;
                      OnAction=BEGIN
                                 NextStep(TRUE);
                               END;
                                }
      { 16      ;1   ;Action    ;
                      Name=ActionNext;
                      CaptionML=ENU=Next;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NextActionEnabled;
                      InFooterBar=Yes;
                      Image=NextRecord;
                      OnAction=BEGIN
                                 NextStep(FALSE);
                               END;
                                }
      { 8       ;1   ;Action    ;
                      Name=ActionFinish;
                      CaptionML=ENU=Finish;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=FinishActionEnabled;
                      InFooterBar=Yes;
                      Image=Approve;
                      OnAction=BEGIN
                                 FinishAction;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 5   ;0   ;Container ;
                ContainerType=ContentArea }

    { 4   ;1   ;Group     ;
                Visible=TopBannerVisible AND NOT FinalStepVisible;
                Editable=FALSE;
                GroupType=Group }

    { 3   ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaRepositoryStandard.Image;
                Editable=FALSE;
                ShowCaption=No }

    { 2   ;1   ;Group     ;
                Visible=TopBannerVisible AND FinalStepVisible;
                Editable=FALSE;
                GroupType=Group }

    { 1   ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaRepositoryDone.Image;
                Editable=FALSE;
                ShowCaption=No }

    { 11  ;1   ;Group     ;
                Visible=FirstStepVisible;
                GroupType=Group }

    { 10  ;2   ;Group     ;
                CaptionML=ENU=Welcome to ForNAV Setup;
                Visible=FirstStepVisible;
                GroupType=Group }

    { 9   ;3   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU="The ForNAV report package contains several documents that are optimized to work with our designer. " }

    { 7   ;2   ;Group     ;
                CaptionML=ENU=Let's go!;
                GroupType=Group }

    { 6   ;3   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU=Choose Next so you can set up the ForNAV report package. }

    { 15  ;1   ;Group     ;
                Visible=FinalStepVisible;
                GroupType=Group }

    { 13  ;2   ;Group     ;
                CaptionML=ENU=That's it!;
                GroupType=Group }

    { 12  ;3   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU=To enable the ForNAV report package choose Finish. }

    { 24  ;1   ;Group     ;
                Visible=Step1Visible;
                GroupType=Group;
                InstructionalTextML=ENU=Select your localization... }

    { 25  ;2   ;Field     ;
                SourceExpr=Localization;
                OnValidate=BEGIN
                             WrongLocalization := NOT ValidateCurrentLocalization;
                           END;
                            }

    { 27  ;2   ;Group     ;
                Visible=WrongLocalization;
                GroupType=Group;
                InstructionalTextML=ENU=WARNING! This is not the localization we detected! }

    { 21  ;1   ;Group     ;
                Visible=Step2Visible;
                GroupType=Group;
                InstructionalTextML=ENU=Select your VAT printing preferences and legal clause. }

    { 22  ;2   ;Field     ;
                SourceExpr="VAT Amount Specification" }

    { 14  ;2   ;Field     ;
                SourceExpr="Payment Note" }

    { 23  ;2   ;Field     ;
                SourceExpr="Legal Conditions" }

    { 1000000003;1;Group  ;
                Visible=StepCheckVisible;
                GroupType=Group;
                InstructionalTextML=ENU=Which check layout are you using? }

    { 1000000002;2;Field  ;
                Name=CheckLayout;
                CaptionML=ENU=Layout;
                SourceExpr=CheckSetup.Layout }

    { 17  ;1   ;Group     ;
                Visible=Step3Visible;
                GroupType=Group;
                InstructionalTextML=ENU=Do you want to replace the current report selections with the ForNAV reports? }

    { 20  ;2   ;Field     ;
                Name=ReplaceReports;
                CaptionML=ENU=Replace Reports;
                SourceExpr=ReplaceReports }

    { 30  ;1   ;Group     ;
                Visible=Step3Visible;
                GroupType=Group;
                InstructionalTextML=ENU=Do you want to create the fields webservice? }

    { 29  ;2   ;Field     ;
                SourceExpr=CreateTheWebService }

    { 1000000001;1;Group  ;
                Visible=Step2Visible;
                GroupType=Group;
                InstructionalTextML=ENU=A watermark can make your reports look nicer. Do you want to import one? }

    { 1000000000;2;Field  ;
                Name=ImportWatermark;
                SourceExpr=WatermarkTxt;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              ImportWatermarkFromClientFile(FIELDNO("Document Watermark"));
                            END;

                ShowCaption=No }

    { 28  ;2   ;Field     ;
                Name=ImportWatermarkList;
                SourceExpr=WatermarkListTxt;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              ImportWatermarkFromClientFile(FIELDNO("List Report Watermark"));
                            END;

                ShowCaption=No }

    { 26  ;2   ;Field     ;
                Name=ImportCompanyLogo;
                SourceExpr=CompanyLogoTxt;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              ImportWatermarkFromClientFile(FIELDNO(Logo));
                            END;

                ShowCaption=No }

  }
  CODE
  {
    VAR
      MediaRepositoryStandard@1001 : Record 9400;
      MediaRepositoryDone@1000 : Record 9400;
      ForNAVSetup@1005 : Record 70000;
      CheckSetup@1000000001 : Record 70310;
      TopBannerVisible@1003 : Boolean;
      FinalStepVisible@1002 : Boolean;
      FirstStepVisible@1004 : Boolean;
      FinishActionEnabled@1007 : Boolean;
      BackActionEnabled@1008 : Boolean;
      NextActionEnabled@1009 : Boolean;
      Step1Visible@1011 : Boolean;
      Step2Visible@1010 : Boolean;
      StepCheckVisible@1000000002 : Boolean;
      Step3Visible@1013 : Boolean;
      ReplaceReports@1012 : Boolean;
      CreateTheWebService@1019 : Boolean;
      WrongLocalization@1014 : Boolean INDATASET;
      Step@1006 : 'Start,Step1,Step2,StepCheck,Step3,Finish';
      WatermarkTxt@1000000000 : TextConst 'ENU=Click to import a watermark for document reports';
      WatermarkListTxt@1018 : TextConst 'ENU=Click to import a watermark for list reports';
      CompanyLogoTxt@1017 : TextConst 'ENU=Click to import a company logo';
      PaymentNoteTxt@1015 : TextConst 'ENU=- You can print a payment note here -';
      LegalConditionsTxt@1016 : TextConst 'ENU=- You can print your legal conditions here -';

    LOCAL PROCEDURE LoadTopBanners@40();
    BEGIN
      IF MediaRepositoryStandard.GET('AssistedSetup-NoText-400px.png',FORMAT(CURRENTCLIENTTYPE)) AND
         MediaRepositoryDone.GET('AssistedSetupDone-NoText-400px.png',FORMAT(CURRENTCLIENTTYPE))
      THEN
        TopBannerVisible := MediaRepositoryDone.Image.HASVALUE;
    END;

    LOCAL PROCEDURE EnableControls@2();
    BEGIN
      ResetControls;

      CASE Step OF
        Step::Start:
          ShowStartStep;
        Step::Step1:
          ShowStep1;
        Step::Step2:
          ShowStep2;
        Step::StepCheck:
          ShowStepCheck;
        Step::Step3:
          ShowStep3;
        Step::Finish:
          ShowFinishStep;
      END;
    END;

    LOCAL PROCEDURE ShowStartStep@24();
    BEGIN
      FirstStepVisible := TRUE;
      FinishActionEnabled := FALSE;
      BackActionEnabled := FALSE;
    END;

    LOCAL PROCEDURE ShowStep1@33();
    BEGIN
      Step1Visible := TRUE;
    END;

    LOCAL PROCEDURE ShowStep2@34();
    BEGIN
      Step2Visible := TRUE;
    END;

    LOCAL PROCEDURE ShowStepCheck@1000000000();
    BEGIN
      IF Localization = Localization::"North America" THEN
        StepCheckVisible := TRUE
      ELSE
        NextStep(FALSE);
    END;

    LOCAL PROCEDURE ShowStep3@4();
    BEGIN
      Step3Visible := TRUE;
    END;

    LOCAL PROCEDURE ShowFinishStep@35();
    BEGIN
      FinalStepVisible := TRUE;
      NextActionEnabled := FALSE;
    END;

    LOCAL PROCEDURE ResetControls@1();
    BEGIN
      FinishActionEnabled := 1=1;
      BackActionEnabled := TRUE;
      NextActionEnabled := TRUE;

      FirstStepVisible := FALSE;
      Step1Visible := FALSE;
      Step2Visible := FALSE;
      StepCheckVisible := FALSE;
      Step3Visible := FALSE;
      FinalStepVisible := FALSE;
    END;

    LOCAL PROCEDURE NextStep@41(Backwards@1000 : Boolean);
    BEGIN
      IF Backwards THEN
        Step := Step - 1
      ELSE
        Step := Step + 1;

      EnableControls;
    END;

    LOCAL PROCEDURE FinishAction@12();
    BEGIN
      StoreSetup;
      CurrPage.CLOSE;
    END;

    LOCAL PROCEDURE StoreSetup@3();
    VAR
      SetCheckSetup@1000000000 : Codeunit 70010;
    BEGIN
      IF NOT ForNAVSetup.GET THEN BEGIN
        ForNAVSetup.INIT;
        ForNAVSetup.INSERT;
      END;

      ForNAVSetup.TRANSFERFIELDS(Rec,FALSE);
      IF NOT ForNAVSetup.Logo.HASVALUE THEN
        ForNAVSetup.GetCompanyLogo;

      ForNAVSetup.MODIFY;
      IF ReplaceReports THEN
        ForNAVSetup.ReplaceReportSelection(TRUE);
      IF CreateTheWebService THEN
        CreateWebService;

      SetCheckSetup.SetCheckType(ForNAVSetup, CheckSetup);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Page 70006 ForNAV Fields Webservice
{
  OBJECT-PROPERTIES
  {
    Date=15-01-18;
    Time=09:16:03;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=FieldsEx;
    SourceTable=Table2000000041;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                CaptionML=ENU=TableNo;
                SourceExpr=TableNo }

    { 4   ;2   ;Field     ;
                CaptionML=ENU=No.;
                SourceExpr="No." }

    { 6   ;2   ;Field     ;
                CaptionML=ENU=TableName;
                SourceExpr=TableName }

    { 8   ;2   ;Field     ;
                CaptionML=ENU=FieldName;
                SourceExpr=FieldName }

    { 10  ;2   ;Field     ;
                CaptionML=ENU=Type;
                SourceExpr=Type }

    { 12  ;2   ;Field     ;
                CaptionML=ENU=Class;
                SourceExpr=Class }

    { 3   ;2   ;Field     ;
                SourceExpr=RelationTableNo }

    { 5   ;2   ;Field     ;
                SourceExpr=RelationFieldNo }

    { 7   ;2   ;Field     ;
                SourceExpr=OptionString }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70310 ForNAV Check Setup
{
  OBJECT-PROPERTIES
  {
    Date=02-03-18;
    Time=17:35:37;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table70310;
    PageType=Card;
    OnOpenPage=BEGIN
                 InitSetup;
               END;

    ActionList=ACTIONS
    {
      { 1000000025;  ;ActionContainer;
                      Name=ActionItems;
                      ActionContainerType=ActionItems }
      { 1000000024;1 ;ActionGroup;
                      Name=Watermark }
      { 1000000023;2 ;Action    ;
                      Name=DownloadWatermark;
                      CaptionML=ENU=Download Watermarks;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Link;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DownloadWatermarks;
                               END;
                                }
      { 1000000022;1 ;ActionGroup;
                      Name=Delete Visuals }
      { 1000000019;2 ;Action    ;
                      Name=DeleteWatermark;
                      CaptionML=ENU=Watermark;
                      Image=Delete;
                      OnAction=VAR
                                 AreYouSureQst@1000 : TextConst 'ENU=Are you sure you want to clear %1?';
                               BEGIN
                                 IF NOT CONFIRM(AreYouSureQst, FALSE, FIELDCAPTION(Watermark)) THEN
                                   EXIT;

                                 "Watermark File Name" := 'Click to import...';
                                 CLEAR(Watermark);
                                 MODIFY;
                               END;
                                }
      { 1000000011;2 ;Action    ;
                      Name=DeleteSignature;
                      CaptionML=ENU=Signature;
                      Image=Delete;
                      OnAction=VAR
                                 AreYouSureQst@1000 : TextConst 'ENU=Are you sure you want to clear %1?';
                               BEGIN
                                 IF NOT CONFIRM(AreYouSureQst, FALSE, FIELDCAPTION(Signature)) THEN
                                   EXIT;

                                 "Signature File Name" := 'Click to import...';
                                 CLEAR(Signature);
                                 MODIFY;
                               END;
                                }
      { 1000000018;1 ;ActionGroup;
                      Name=System }
      { 1000000017;2 ;Action    ;
                      Name=ReplaceReports;
                      CaptionML=ENU=Replace Reportselection;
                      Image=SwitchCompanies;
                      OnAction=BEGIN
                                 ERROR('TODO');
                                 //ReplaceReportSelection(FALSE);
                               END;
                                }
      { 1000000014;1 ;ActionGroup;
                      Name=Template }
      { 1000000013;2 ;Action    ;
                      Name=DesignTemplateCheck;
                      CaptionML=ENU=Design Check;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=UnitOfMeasure;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignTemplatePortrait;
                               END;
                                }
      { 1000000012;2 ;Action    ;
                      Name=DesignTemplateStub;
                      CaptionML=ENU=Design Stub;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=VATPostingSetup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignTemplateLandscape;
                               END;
                                }
      { 1000000007;  ;ActionContainer;
                      Name=RelatedInformation;
                      ActionContainerType=RelatedInformation }
      { 1000000006;1 ;Action    ;
                      Name=Translations;
                      CaptionML=ENU=Translations;
                      ToolTipML=ENU=View or edit translated legal conditions. Translated legal conditions are automatically inserted on documents according to the language code.;
                      RunObject=Page 70001;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Translations;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                GroupType=Group }

    { 1000000002;2;Field  ;
                SourceExpr=Layout }

    { 1000000015;2;Field  ;
                SourceExpr="No. of Lines (Stub)" }

    { 1000000009;1;Group  ;
                Name=Visuals;
                GroupType=Group }

    { 1000000008;2;Field  ;
                CaptionML=ENU=Watermark;
                SourceExpr="Watermark File Name";
                OnDrillDown=VAR
                              TempBlob@1001 : Record 99008535;
                              FileManagement@1000 : Codeunit 419;
                            BEGIN
                              CALCFIELDS(Watermark);
                              IF "Watermark File Name" <> 'Click to import...' THEN BEGIN
                                TempBlob.Blob := Watermark;
                                HYPERLINK(FileManagement.BLOBExport(TempBlob, "Watermark File Name", FALSE));
                              END ELSE
                                ImportWatermarkFromClientFile(FIELDNO(Watermark));
                              MODIFY;
                            END;
                             }

    { 1000000010;2;Field  ;
                SourceExpr="Signature File Name";
                OnDrillDown=VAR
                              TempBlob@1000000001 : Record 99008535;
                              FileManagement@1000000000 : Codeunit 419;
                            BEGIN
                              CALCFIELDS(Signature);
                              IF "Signature File Name" <> 'Click to import...' THEN BEGIN
                                TempBlob.Blob := Signature;
                                HYPERLINK(FileManagement.BLOBExport(TempBlob, "Signature File Name", FALSE));
                              END ELSE
                                ImportWatermarkFromClientFile(FIELDNO(Signature));
                              MODIFY;
                            END;
                             }

    { 1000000005;0;Container;
                ContainerType=FactBoxArea }

    { 1000000004;1;Part   ;
                PartType=System;
                SystemPartID=MyNotes }

    { 1000000003;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Query 70240 ForNAV Inventory to G/L Recon.
{
  OBJECT-PROPERTIES
  {
    Date=17-04-18;
    Time=11:25:56;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  ELEMENTS
  {
    { 1000000004;;DataItem;                  ;
               DataItemTable=Table27 }

    { 1000000001;1;Column;                   ;
               DataSource=No. }

    { 1000000003;1;Filter;                   ;
               DataSource=Date Filter }

    { 1000000002;1;DataItem;                 ;
               DataItemTable=Table5802;
               DataItemLink=Item No.=Item."No.",
                            Posting Date=Item."Date Filter",
                            Location Code=Item."Location Filter",
                            Variant Code=Item."Variant Filter" }

    { 1000000016;2;Column;                   ;
               DataSource=Variant Code }

    { 1000000005;2;Column;                   ;
               DataSource=Location Code }

    { 1000000017;2;Filter;                   ;
               ColumnFilter=Item_Ledger_Entry_No=FILTER(<>0);
               DataSource=Item Ledger Entry No. }

    { 1000000000;2;Filter;                   ;
               ColumnFilter=Valued_Quantity=FILTER(<0);
               DataSource=Valued Quantity }

    { 1000000006;2;Column;                   ;
               DataSource=Cost Amount (Expected);
               MethodType=Totals;
               Method=Sum }

    { 1000000007;2;Column;                   ;
               DataSource=Cost Amount (Expected) (ACY);
               MethodType=Totals;
               Method=Sum }

    { 1000000008;2;Column;                   ;
               DataSource=Expected Cost Posted to G/L;
               MethodType=Totals;
               Method=Sum }

    { 1000000009;2;Column;                   ;
               DataSource=Exp. Cost Posted to G/L (ACY);
               MethodType=Totals;
               Method=Sum }

    { 1000000010;2;Column;                   ;
               DataSource=Valued Quantity;
               MethodType=Totals;
               Method=Sum }

    { 1000000011;2;Column;                   ;
               DataSource=Invoiced Quantity;
               MethodType=Totals;
               Method=Sum }

    { 1000000012;2;Column;                   ;
               DataSource=Cost Amount (Actual);
               MethodType=Totals;
               Method=Sum }

    { 1000000013;2;Column;                   ;
               DataSource=Cost Amount (Actual) (ACY);
               MethodType=Totals;
               Method=Sum }

    { 1000000014;2;Column;                   ;
               DataSource=Cost Posted to G/L;
               MethodType=Totals;
               Method=Sum }

    { 1000000015;2;Column;                   ;
               DataSource=Cost Posted to G/L (ACY);
               MethodType=Totals;
               Method=Sum }

  }
  CODE
  {

    BEGIN
    END.
  }
}

