OBJECT Table 70000 ForNAV Setup
{
  OBJECT-PROPERTIES
  {
    Date=15-01-18;
    Time=09:20:38;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=ENU=Primary Key }
    { 9   ;   ;Localization        ;Option        ;OnValidate=BEGIN
                                                                IF Localization = Localization::"North America" THEN
                                                                  "VAT Amount Specification" := "VAT Amount Specification"::"N/A. (Sales Tax)";
                                                              END;

                                                   CaptionML=ENU=Localization;
                                                   OptionString=World Wide,North America,Other }
    { 10  ;   ;VAT Amount Specification;Option    ;CaptionML=ENU=VAT Amount Specification;
                                                   OptionString=Multiple Lines,Always,Never,N/A. (Sales Tax) }
    { 14  ;   ;Use ForNAV Languages;Boolean       ;InitValue=Yes;
                                                   CaptionML=ENU=Use ForNAV Languages }
    { 15  ;   ;Use Preprinted Paper;Boolean       ;CaptionML=ENU=Use Preprinted Paper }
    { 20  ;   ;Logo                ;BLOB          ;CaptionML=ENU=Logo }
    { 21  ;   ;Logo File Name      ;Text250       ;InitValue=Click to import...;
                                                   CaptionML=ENU=Logo File Name;
                                                   Editable=No }
    { 50  ;   ;Document Watermark File Name;Text250;
                                                   InitValue=Click to import...;
                                                   CaptionML=ENU=Document Watermark File Name;
                                                   Editable=No }
    { 51  ;   ;List Report Watermark File N.;Text250;
                                                   InitValue=Click to import...;
                                                   CaptionML=ENU=List Report Watermark File Name;
                                                   Editable=No }
    { 60  ;   ;Document Watermark  ;BLOB          ;CaptionML=ENU=Document Watermark }
    { 61  ;   ;List Report Watermark;BLOB         ;CaptionML=ENU=List Report Watermark }
    { 70  ;   ;Payment Note        ;Text250       ;CaptionML=ENU=Payment Note }
    { 80  ;   ;Legal Conditions    ;Text250       ;CaptionML=ENU=Legal Conditions }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE InitSetup@1000000000();
    BEGIN
      IF GET THEN
        EXIT;

      INIT;
      INSERT;
    END;

    PROCEDURE ReplaceReportSelection@1(HideDialog@1000 : Boolean);
    VAR
      DoYouWantToQst@1001 : TextConst 'ENU=Do you want to replace the current reports with the ForNAV reports?';
      ReplaceReportSel@1002 : Codeunit 70029;
    BEGIN
      IF NOT HideDialog THEN
        IF NOT CONFIRM(DoYouWantToQst, TRUE) THEN
          EXIT;

      ReplaceReportSel.RUN;
    END;

    PROCEDURE DesignTemplatePortrait@1000000003();
    VAR
      Template@1000 : Report 70527;
    BEGIN
      Template.RUNMODAL;
    END;

    PROCEDURE DesignTemplateLandscape@9();
    VAR
      Template@1000 : Report 70526;
    BEGIN
      Template.RUNMODAL;
    END;

    PROCEDURE DesignSalesTemplate@3();
    VAR
      SalesTemplateVAT@1000 : Report 70529;
      SalesTemplSalesTax@1001 : Report 70519;
    BEGIN
      IF Localization = Localization::"North America" THEN
        SalesTemplSalesTax.RUNMODAL
      ELSE
        SalesTemplateVAT.RUNMODAL;
    END;

    PROCEDURE DesignPurchaseTemplate@1000000001();
    VAR
      PurchaseTemplVAT@1000 : Report 70528;
      PurchaseTemplTax@1001 : Report 70518;
    BEGIN
      IF Localization = Localization::"North America" THEN
        PurchaseTemplTax.RUNMODAL
      ELSE
        PurchaseTemplVAT.RUNMODAL;
    END;

    PROCEDURE ImportWatermarkFromClientFile@21(Which@1000 : Integer) : Boolean;
    VAR
      ForNAVReadWatermarks@1002 : Codeunit 70006;
    BEGIN
      EXIT(ForNAVReadWatermarks.ReadFromFile(Rec, Which));
    END;

    PROCEDURE GetLegalConditions@1000000002(LanguageCode@1000000001 : Code[10]) : Text;
    VAR
      LegalCondTranslation@1000000000 : Record 70001;
    BEGIN
      IF LegalCondTranslation.GET(LanguageCode) THEN
        EXIT(LegalCondTranslation."Legal Conditions");

      EXIT("Legal Conditions");
    END;

    PROCEDURE CheckLocalizationBasedOnTables@5();
    VAR
      DetectLocalization@1001 : Codeunit 70005;
    BEGIN
      DetectLocalization.CheckLocalizationBasedOnTables(Rec);
    END;

    PROCEDURE ValidateCurrentLocalization@4() : Boolean;
    VAR
      DetectLocalization@1001 : Codeunit 70005;
    BEGIN
      EXIT(DetectLocalization.ValidateCurrentLocalization(Rec));
    END;

    PROCEDURE DownloadWatermarks@6();
    BEGIN
      HYPERLINK('http://www.fornav.com/report-watermarks/');
    END;

    PROCEDURE CreateWebService@7();
    VAR
      WebService@1000 : Record 2000000076;
    BEGIN
      WebService."Object Type" := WebService."Object Type"::Page;
      WebService."Object ID" := PAGE::Fields;
      WebService."Service Name" := 'FIELDS';
      WebService.VALIDATE("Service Name", 'Fields');
      IF NOT WebService.INSERT THEN
        EXIT;

      WebService.Published := TRUE;
      WebService.MODIFY;

      WebService."Object Type" := WebService."Object Type"::Page;
      WebService."Object ID" := PAGE::"ForNAV Fields Webservice";
      WebService."Service Name" := 'FIELDSEX';
      WebService.VALIDATE("Service Name", 'FieldsEx');
      IF NOT WebService.INSERT THEN
        EXIT;

      WebService.Published := TRUE;
      WebService.MODIFY;
    END;

    PROCEDURE GetCompanyLogo@8();
    VAR
      CompanyInformation@1000 : Record 79;
    BEGIN
      CompanyInformation.GET;
      CompanyInformation.CALCFIELDS(Picture);
      Logo := CompanyInformation.Picture;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70001 ForNAV Legal Cond. Translation
{
  OBJECT-PROPERTIES
  {
    Date=14-07-17;
    Time=10:55:28;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 2   ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=ENU=Language Code }
    { 80  ;   ;Legal Conditions    ;Text250        }
  }
  KEYS
  {
    {    ;Language Code                           ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70205 ForNAV Trial Balance Args.
{
  OBJECT-PROPERTIES
  {
    Date=02-02-18;
    Time=10:23:01;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Show by             ;Option        ;CaptionML=[DAN=Vis efter;
                                                              DEU=Anzeigen nach;
                                                              ENU=Show by;
                                                              ESP=Mostrar por;
                                                              FIN=NÑyttîperuste;
                                                              FRA=Afficher par;
                                                              ISL=SÏna eftir;
                                                              ITA=Mostra per;
                                                              NLD=Tonen op;
                                                              NOR=Vis etter];
                                                   OptionCaptionML=[DAN=Sidste Ür,Budget;
                                                                    DEU=Vorjahr,Budget;
                                                                    ENU=Last Year,Budget;
                                                                    ESP=El a§o pasado,Presupuesto;
                                                                    FIN=Edellinen vuosi,Budjetti;
                                                                    ISL=S°–asta †r,µëtlun;
                                                                    ITA=Anno prec.,Budget;
                                                                    NLD=Vorig jaar,Budget;
                                                                    NOR=I fjor,Budsjett;
                                                                    SVE=FîregÜende Ür,Budget];
                                                   OptionString=Last Year,Budget }
    { 2   ;   ;Net Change Actual   ;Boolean       ;CaptionML=[DAN=Faktisk bevëgelse;
                                                              DEU=NettoÑnderung - Ist;
                                                              ENU=Net Change Actual;
                                                              ESP=Saldo periodo real;
                                                              FIN=Nettomuutos, toteutunut;
                                                              FRA=Solde pÇriode - RÇel;
                                                              ISL=Raunveruleg nett¢breyting;
                                                              ITA=Saldo periodo effettivo;
                                                              NLD=Mutatie werkelijk;
                                                              NOR=Faktisk bevegelse] }
    { 3   ;   ;Net Change Actual Last Year;Boolean;CaptionML=[DAN=Faktisk bevëgelse sidste Ür;
                                                              DEU=NettoÑnderung - Ist - Vorjahr;
                                                              ENU=Net Change Actual Last Year;
                                                              ESP=Saldo periodo real el a§o anterior;
                                                              FIN=Nettomuutos, toteutunut edellisenÑ vuonna;
                                                              FRA=Solde pÇriode - RÇel dernier exercice;
                                                              ISL=Raunveruleg nett¢breyting s°–asta †rs;
                                                              ITA=Saldo periodo effettivo anno precedente;
                                                              NLD=Mutatie werkelijk vorig jaar;
                                                              NOR=Faktisk bevegelse i fjor] }
    { 4   ;   ;Variance in Changes ;Boolean       ;CaptionML=[DAN=Difference;
                                                              DEU=Abweichung;
                                                              ENU=Difference;
                                                              ESP=Diferencia;
                                                              FIN=Ero;
                                                              FRA=DiffÇrence;
                                                              ISL=Mismunur;
                                                              ITA=Differenza;
                                                              NLD=Verschil;
                                                              NOR=Differanse] }
    { 5   ;   ;% Variance in Changes;Boolean      ;CaptionML=[DAN=Variansprocent;
                                                              DEU=Abweichung %;
                                                              ENU=Variance %;
                                                              ESP=% de desviaci¢n;
                                                              FIN=Vaihtelu-%;
                                                              FRA=% Çcart;
                                                              ISL=Fr†vik ° %;
                                                              ITA=% scostamento;
                                                              NLD=Verschil %;
                                                              NOR=Avviks-%] }
    { 6   ;   ;Balance at Date Actual;Boolean     ;CaptionML=[DAN=Faktisk saldo til dato;
                                                              DEU=Saldo bis Datum - Ist;
                                                              ENU=Balance at Date Actual;
                                                              ESP=Saldo a la fecha real;
                                                              FIN=Pvm:n saldo, toteutunut;
                                                              FRA=Solde au - RÇel;
                                                              ISL=Raunsta–a til dags;
                                                              ITA=Saldo alla data effettivo;
                                                              NLD=Saldo op datum werkelijk;
                                                              NOR=Faktisk saldo per dato] }
    { 7   ;   ;Balance at Date Act. Last Year;Boolean;
                                                   CaptionML=[DAN=Faktisk saldo til dato sidste Ür;
                                                              DEU=Saldo bis Datum - Ist - Vorjahr;
                                                              ENU=Balance at Date Act. Last Year;
                                                              ESP=Saldo a la fecha real del a§o anterior;
                                                              FIN=Pvm:n saldo, toteutunut edellisenÑ vuonna;
                                                              FRA=Solde au - RÇel dernier exercice;
                                                              ISL=Nett¢sta–a til dags fyrir s°–asta †r;
                                                              ITA=Saldo alla data anno precedente effet.;
                                                              NLD=Saldo op datum werkelijk vorig jaar;
                                                              NOR=Fakt. saldo per dato i fjor] }
    { 8   ;   ;Variance in Balances;Boolean       ;CaptionML=[DAN=Difference;
                                                              DEU=Abweichung;
                                                              ENU=Difference;
                                                              ESP=Diferencia;
                                                              FIN=Ero;
                                                              FRA=DiffÇrence;
                                                              ISL=Mismunur;
                                                              ITA=Differenza;
                                                              NLD=Verschil;
                                                              NOR=Differanse] }
    { 9   ;   ;% Variance in Balances;Boolean     ;CaptionML=[DAN=Variansprocent;
                                                              DEU=Abweichung %;
                                                              ENU=Variance %;
                                                              ESP=% de desviaci¢n;
                                                              FIN=Vaihtelu-%;
                                                              FRA=% Çcart;
                                                              ISL=Fr†vik ° %;
                                                              ITA=% scostamento;
                                                              NLD=Verschil %;
                                                              NOR=Avviks-%] }
    { 10  ;   ;Rounding Factor     ;Option        ;CaptionML=[DAN=Afrundingsfaktor;
                                                              DEU=Rundungsfaktor;
                                                              ENU=Rounding Factor;
                                                              ESP=Factor redondeo;
                                                              FIN=Pyîristyskerroin;
                                                              FRA=UnitÇ d'affichage;
                                                              ISL=SlÇttunarstu–ull;
                                                              ITA=Fattore arrotondamento;
                                                              NLD=Afrondingsfactor;
                                                              NOR=Avrundingsfaktor];
                                                   OptionCaptionML=[DAN=Ingen,1,1000,1000000;
                                                                    DEU=Kein,1,1000,1000000;
                                                                    ENU=None,1,1000,1000000;
                                                                    NLD=Geen,1,1000,1000000];
                                                   OptionString=None,1,1000,1000000 }
    { 11  ;   ;Skip Accounts with all zero;Boolean;CaptionML=ENU=Skip Accounts with all zero Amounts }
    { 12  ;   ;All Amounts in LCY  ;Boolean       ;InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                GetReportingCurrency;
                                                              END;

                                                   CaptionML=[DAN=Alle belõb i RV;
                                                              DEU=Alle BetrÑge in MW;
                                                              ENU=All Amounts in LCY;
                                                              FIN=Kaikki summat PVA;
                                                              FRA=Tous les montants DS;
                                                              ISL=Allar upphë–ir ° SGM;
                                                              ITA=Tutti gli importi in VL;
                                                              NLD=Alle bedragen in LV;
                                                              NOR=Alle belõp i NOK;
                                                              SVE=Alla belopp i BVA] }
    { 13  ;   ;From Date           ;Date           }
    { 14  ;   ;To Date             ;Date           }
    { 15  ;   ;Currency Code       ;Code10        ;CaptionML=[DAN=Valutakode;
                                                              DEU=WÑhrungscode;
                                                              ENU=Currency Code;
                                                              ESP=C¢d. divisa;
                                                              FIN=Valuutan koodi;
                                                              FRA=Code devise;
                                                              ISL=Gjaldmi–ilsk¢ti;
                                                              ITA=Cod. valuta;
                                                              NLD=Valutacode;
                                                              NOR=Valutakode] }
  }
  KEYS
  {
    {    ;Show by                                 ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE GetNoOfColumns@1000000000() : Integer;
    VAR
      NoOfColumns@1000000000 : Integer;
    BEGIN
      IF "Net Change Actual" THEN
        NoOfColumns += 1;
      IF "Net Change Actual Last Year" THEN
        NoOfColumns += 1;
      IF "Variance in Changes" THEN
        NoOfColumns += 1;
      IF "% Variance in Changes" THEN
        NoOfColumns += 1;
      IF "Balance at Date Actual" THEN
        NoOfColumns += 1;
      IF "Balance at Date Act. Last Year" THEN
        NoOfColumns += 1;
      IF "Variance in Balances" THEN
        NoOfColumns += 1;
      IF "% Variance in Balances" THEN
        NoOfColumns += 1;

      EXIT(NoOfColumns);
    END;

    LOCAL PROCEDURE GetReportingCurrency@1000000001();
    VAR
      GLSetup@1000000000 : Record 98;
    BEGIN
      "Currency Code" := '';

      IF "All Amounts in LCY" THEN
        EXIT;

      GLSetup.GET;
      GLSetup.TESTFIELD("Additional Reporting Currency");
      "Currency Code" := GLSetup."Additional Reporting Currency";
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70206 ForNAV Trial Balance
{
  OBJECT-PROPERTIES
  {
    Date=01-02-18;
    Time=20:26:03;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;G/L Account No.     ;Code20         }
    { 4   ;   ;Description         ;Text80         }
    { 11  ;   ;Net Change Actual   ;Decimal       ;CaptionML=[DAN=Faktisk bevëgelse;
                                                              DEU=NettoÑnderung - Ist;
                                                              ENU=Net Change Actual;
                                                              ESP=Saldo periodo real;
                                                              FIN=Nettomuutos, toteutunut;
                                                              FRA=Solde pÇriode - RÇel;
                                                              ISL=Raunveruleg nett¢breyting;
                                                              ITA=Saldo periodo effettivo;
                                                              NLD=Mutatie werkelijk;
                                                              NOR=Faktisk bevegelse] }
    { 13  ;   ;Net Change Actual Last Year;Decimal;CaptionML=[DAN=Faktisk bevëgelse sidste Ür;
                                                              DEU=NettoÑnderung - Ist - Vorjahr;
                                                              ENU=Net Change Actual Last Year;
                                                              ESP=Saldo periodo real el a§o anterior;
                                                              FIN=Nettomuutos, toteutunut edellisenÑ vuonna;
                                                              FRA=Solde pÇriode - RÇel dernier exercice;
                                                              ISL=Raunveruleg nett¢breyting s°–asta †rs;
                                                              ITA=Saldo periodo effettivo anno precedente;
                                                              NLD=Mutatie werkelijk vorig jaar;
                                                              NOR=Faktisk bevegelse i fjor] }
    { 14  ;   ;Variance in Changes ;Decimal       ;CaptionML=[DAN=Difference;
                                                              DEU=Abweichung;
                                                              ENU=Difference;
                                                              ESP=Diferencia;
                                                              FIN=Ero;
                                                              FRA=DiffÇrence;
                                                              ISL=Mismunur;
                                                              ITA=Differenza;
                                                              NLD=Verschil;
                                                              NOR=Differanse] }
    { 15  ;   ;% Variance in Changes;Decimal      ;CaptionML=[DAN=Variansprocent;
                                                              DEU=Abweichung %;
                                                              ENU=Variance %;
                                                              ESP=% de desviaci¢n;
                                                              FIN=Vaihtelu-%;
                                                              FRA=% Çcart;
                                                              ISL=Fr†vik ° %;
                                                              ITA=% scostamento;
                                                              NLD=Verschil %;
                                                              NOR=Avviks-%] }
    { 17  ;   ;Balance at Date Actual;Decimal     ;CaptionML=[DAN=Faktisk saldo til dato;
                                                              DEU=Saldo bis Datum - Ist;
                                                              ENU=Balance at Date Actual;
                                                              ESP=Saldo a la fecha real;
                                                              FIN=Pvm:n saldo, toteutunut;
                                                              FRA=Solde au - RÇel;
                                                              ISL=Raunsta–a til dags;
                                                              ITA=Saldo alla data effettivo;
                                                              NLD=Saldo op datum werkelijk;
                                                              NOR=Faktisk saldo per dato] }
    { 19  ;   ;Balance at Date Act. Last Year;Decimal;
                                                   CaptionML=[DAN=Faktisk saldo til dato sidste Ür;
                                                              DEU=Saldo bis Datum - Ist - Vorjahr;
                                                              ENU=Balance at Date Act. Last Year;
                                                              ESP=Saldo a la fecha real del a§o anterior;
                                                              FIN=Pvm:n saldo, toteutunut edellisenÑ vuonna;
                                                              FRA=Solde au - RÇel dernier exercice;
                                                              ISL=Nett¢sta–a til dags fyrir s°–asta †r;
                                                              ITA=Saldo alla data anno precedente effet.;
                                                              NLD=Saldo op datum werkelijk vorig jaar;
                                                              NOR=Fakt. saldo per dato i fjor] }
    { 21  ;   ;Print Amount 1      ;Text30        ;CaptionClass=GetCaptionClass(1) }
    { 22  ;   ;Print Amount 2      ;Text30        ;CaptionClass=GetCaptionClass(2) }
    { 23  ;   ;Print Amount 3      ;Text30        ;CaptionClass=GetCaptionClass(3) }
    { 24  ;   ;Print Amount 4      ;Text30        ;CaptionClass=GetCaptionClass(4) }
    { 25  ;   ;Print Amount 5      ;Text30        ;CaptionClass=GetCaptionClass(5) }
    { 26  ;   ;Print Amount 6      ;Text30        ;CaptionClass=GetCaptionClass(6) }
    { 27  ;   ;Print Amount 7      ;Text30        ;CaptionClass=GetCaptionClass(7) }
    { 28  ;   ;Print Amount 8      ;Text30        ;CaptionClass=GetCaptionClass(8) }
    { 31  ;   ;RoundTo             ;Option        ;OptionString=Pennies,Dollars,Thousands }
    { 32  ;   ;No. of Columns      ;Integer        }
    { 41  ;   ;Variance in Balances;Decimal       ;CaptionML=[DAN=Difference;
                                                              DEU=Abweichung;
                                                              ENU=Difference;
                                                              ESP=Diferencia;
                                                              FIN=Ero;
                                                              FRA=DiffÇrence;
                                                              ISL=Mismunur;
                                                              ITA=Differenza;
                                                              NLD=Verschil;
                                                              NOR=Differanse] }
    { 42  ;   ;% Variance in Balances;Decimal     ;CaptionML=[DAN=Variansprocent;
                                                              DEU=Abweichung %;
                                                              ENU=Variance %;
                                                              ESP=% de desviaci¢n;
                                                              FIN=Vaihtelu-%;
                                                              FRA=% Çcart;
                                                              ISL=Fr†vik ° %;
                                                              ITA=% scostamento;
                                                              NLD=Verschil %;
                                                              NOR=Avviks-%] }
    { 43  ;   ;Bold                ;Boolean        }
    { 102 ;   ;Caption 1           ;Text80         }
    { 103 ;   ;Caption 2           ;Text80         }
    { 104 ;   ;Caption 3           ;Text80         }
    { 105 ;   ;Caption 4           ;Text80         }
    { 106 ;   ;Caption 5           ;Text80         }
    { 107 ;   ;Caption 6           ;Text80         }
    { 108 ;   ;Caption 7           ;Text80         }
    { 109 ;   ;Caption 8           ;Text80         }
  }
  KEYS
  {
    {    ;G/L Account No.                         ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE CreateForGLAccount@1(VAR GLAccount@1000000000 : Record 15;Args@1000000001 : Record 70205);
    VAR
      TrialBalance@1000000004 : Codeunit 70206;
    BEGIN
      INIT;
      "G/L Account No." := GLAccount."No.";

      TrialBalance.GetDataFromGLAccount(Rec, GLAccount, Args);

      Description := PADSTR('',GLAccount.Indentation) + GLAccount.Name;

      IF HasNumbers THEN BEGIN
        FormatAmounts(Args);
        "No. of Columns" := Args.GetNoOfColumns;
        Bold := GLAccount."Account Type" <> GLAccount."Account Type"::Posting;//GLA.AccountType != 0)
        INSERT;
      END;
    END;

    LOCAL PROCEDURE FormatAmounts@1000000000(VAR Args@1000000000 : Record 70205);
    VAR
      i@1000000001 : Integer;
    BEGIN
      IF Args."Net Change Actual" THEN
        AddToNext(FormatAsNumber(Args, "Net Change Actual"), FIELDCAPTION("Net Change Actual"), i);
      IF Args."Net Change Actual Last Year" THEN
        AddToNext(FormatAsNumber(Args, "Net Change Actual Last Year"), FIELDCAPTION("Net Change Actual Last Year"), i);
      IF Args."Variance in Changes" THEN
        AddToNext(FormatAsNumber(Args, "Variance in Changes"), FIELDCAPTION("Variance in Changes"), i);
      IF Args."% Variance in Changes" THEN
        AddToNext(FormatAsPct("% Variance in Changes"), FIELDCAPTION("% Variance in Changes"), i);
      IF Args."Balance at Date Actual" THEN
        AddToNext(FormatAsNumber(Args, "Balance at Date Actual"), FIELDCAPTION("Balance at Date Actual"), i);
      IF Args."Balance at Date Act. Last Year" THEN
        AddToNext(FormatAsNumber(Args, "Balance at Date Act. Last Year"), FIELDCAPTION("Balance at Date Act. Last Year"), i);
      IF Args."Variance in Balances" THEN
        AddToNext(FormatAsNumber(Args, "Variance in Changes"), FIELDCAPTION("Variance in Balances"), i);
      IF Args."% Variance in Balances" THEN
        AddToNext(FormatAsPct("% Variance in Changes"), FIELDCAPTION("% Variance in Balances"), i);
    END;

    LOCAL PROCEDURE AddToNext@1000000005(Value@1000000001 : Text;Caption@1000000002 : Text;VAR i@1000000000 : Integer);
    BEGIN
      i += 1;
      CASE i OF
        1:
          BEGIN
            "Print Amount 1" := Value;
            "Caption 1" := Caption;
          END;
        2:
          BEGIN
            "Print Amount 2" := Value;
            "Caption 2" := Caption;
          END;
        3:
          BEGIN
            "Print Amount 3" := Value;
            "Caption 3" := Caption;
          END;
        4:
          BEGIN
            "Print Amount 4" := Value;
            "Caption 4" := Caption;
          END;
        5:
          BEGIN
            "Print Amount 5" := Value;
            "Caption 5" := Caption;
          END;
        6:
          BEGIN
            "Print Amount 6" := Value;
            "Caption 6" := Caption;
          END;
        7:
          BEGIN
            "Print Amount 7" := Value;
            "Caption 7" := Caption;
          END;
        8:
          BEGIN
            "Print Amount 8" := Value;
            "Caption 8" := Caption;
          END;
      END;
    END;

    LOCAL PROCEDURE RoundAmounts@1000000001(Value@1000000001 : Decimal;Args@1000000000 : Record 70205) : Decimal;
    BEGIN
      CASE Args."Rounding Factor" OF
        Args."Rounding Factor"::None:
          EXIT(ROUND(Value, 0.01));
        Args."Rounding Factor"::"1":
          EXIT(ROUND(Value, 1));
        Args."Rounding Factor"::"1000":
          EXIT(ROUND(Value / 1000, 1));
        Args."Rounding Factor"::"1000000":
          EXIT(ROUND(Value / 10000000, 0.01));
      END;
    END;

    LOCAL PROCEDURE HasNumbers@1000000002() : Boolean;
    BEGIN
      EXIT(("Net Change Actual" <> 0) OR
        ("Net Change Actual Last Year" <> 0) OR
        ("Balance at Date Actual" <> 0) OR
        ("Balance at Date Act. Last Year" <> 0) OR
        ("Variance in Changes" <> 0) OR
        ("% Variance in Changes" <> 0));
    END;

    LOCAL PROCEDURE FormatAsNumber@1000000003(Args@1000000002 : Record 70205;Value@1000000000 : Decimal) TheText : Text;
    VAR
      j@1000000001 : Integer;
    BEGIN
      IF Value = 0 THEN
        TheText := ''
      ELSE
        TheText := FORMAT(RoundAmounts(Value, Args));
    END;

    LOCAL PROCEDURE FormatAsPct@1000000004(Value@1000000000 : Decimal) : Text;
    VAR
      Args@1000000001 : Record 70205;
    BEGIN
      IF Value = 0 THEN
        EXIT('');

      EXIT(FormatAsNumber(Args, Value) + '%');
    END;

    PROCEDURE GetCaptionClass@1000000007(FieldNo@1000000000 : Integer) : Text;
    BEGIN
      CASE FieldNo OF
        1:
          EXIT('3,' + "Caption 1");
        2:
          EXIT('3,' + "Caption 2");
        3:
          EXIT('3,' + "Caption 3");
        4:
          EXIT('3,' + "Caption 4");
        5:
          EXIT('3,' + "Caption 5");
        6:
          EXIT('3,' + "Caption 6");
        7:
          EXIT('3,' + "Caption 7");
        8:
          EXIT('3,' + "Caption 8");
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70215 ForNAV Salesperson-Comm. Args.
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=13:37:13;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;New Page per Person ;Boolean       ;CaptionML=[DAN=Skift side pr. sëlger;
                                                              DEU=Neue Seite pro VerkÑufer;
                                                              ENU=New Page per Person;
                                                              NLD=Nieuwe pagina per persoon] }
  }
  KEYS
  {
    {    ;New Page per Person                     ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70219 ForNAV Aged Accounts Args.
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=10:40:54;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Print Amounts in LCY;Boolean       ;CaptionML=[DAN=Udskriv belõb i RV;
                                                              DEU=BetrÑge in MW drucken;
                                                              ENU=Print Amounts in LCY;
                                                              ESP=Imprimir importes en DL;
                                                              FIN=Tulosta summat PVA;
                                                              FRA=Imprimer montants DS;
                                                              ISL=Prenta upphë–ir ° SGM;
                                                              ITA=Stampa importi in VL;
                                                              NLD=Bedragen in LV afdrukken;
                                                              NOR=Skriv ut belõp i NOK;
                                                              SVE=Skriv ut belopp i BVA];
                                                   Description=Done }
    { 2   ;   ;Ending Date         ;Date          ;CaptionML=[DAN=Slutdato;
                                                              DEU=Enddatum;
                                                              ENU=Ending Date;
                                                              ESP=Fecha final;
                                                              FIN=Lopetuspvm;
                                                              FRA=Date fin;
                                                              ISL=Lokadagsetning;
                                                              ITA=Data fine;
                                                              NLD=Einddatum;
                                                              NOR=Sluttdato];
                                                   Description=Done }
    { 3   ;   ;Aging By            ;Option        ;CaptionML=[DAN=Aldersford.intv. efter;
                                                              DEU=SaldenrÅckblick nach;
                                                              ENU=Aging Band by;
                                                              ESP=Rango antigÅedad por;
                                                              FIN=ErÑÑntymisjakso per;
                                                              FRA=Cumul par;
                                                              ISL=T°mabil aldursgreiningar eftir;
                                                              ITA=Periodo scadenziario per;
                                                              NLD=Vervaldatuminterval per;
                                                              NOR=Aldersfordeling pÜ basis av;
                                                              SVE=èldersspann per];
                                                   OptionCaptionML=[DAN=Forfaldsdato,Bogfõringsdato,Bilagsdato;
                                                                    DEU=FÑlligkeitsdatum,Buchungsdatum,Belegdatum;
                                                                    ENU=Due Date,Posting Date,Document Date;
                                                                    ESP=Fecha vencimiento,Fecha registro,Fecha documento;
                                                                    FIN=ErÑpÑivÑ,Kirjauspvm.,Asiakirjan pvm.;
                                                                    FRA=Date d'ÇchÇance,Date comptabilisation,Date document;
                                                                    ISL=Gjalddagi,B¢kunardagsetning,Dags. fylgiskjals;
                                                                    ITA=Data scadenza,Data registrazione,Data documento;
                                                                    NLD=Vervaldatum,Boekingsdatum,Documentdatum;
                                                                    NOR=Forfallsdato,Bokfõringsdato,Bilagsdato;
                                                                    SVE=Fîrfallodatum,Bokfîringsdatum,Dokumentdatum];
                                                   OptionString=Due Date,Posting Date,Document Date;
                                                   Description=Done }
    { 4   ;   ;Period Length       ;DateFormula   ;CaptionML=[DAN=Periodelëngde;
                                                              DEU=PeriodenlÑnge;
                                                              ENU=Period Length;
                                                              ESP=Longitud periodo;
                                                              FIN=Jakson pituus;
                                                              FRA=Base pÇriode;
                                                              ISL=Lengd t°mabils;
                                                              ITA=Durata periodo;
                                                              NLD=Periodelengte;
                                                              NOR=Periodelengde];
                                                   Description=Done }
    { 5   ;   ;Print Details       ;Boolean       ;CaptionML=[DAN=Udskriv detaljer;
                                                              DEU=Details drucken;
                                                              ENU=Print Details;
                                                              ESP=Imprimir detalles;
                                                              FIN=Tulosta yksityiskohdat;
                                                              FRA=Imprimer dÇtails;
                                                              ISL=Prenta sundurli–un;
                                                              ITA=Stampa dettagli;
                                                              NLD=Details afdrukken;
                                                              NOR=Skriv ut spesifikasjoner;
                                                              SVE=Skriv ut detaljer];
                                                   Description=Done }
    { 6   ;   ;Heading Type        ;Option        ;CaptionML=[DAN=Overskriftstype;
                                                              DEU=öberschriftsart;
                                                              ENU=Heading Type;
                                                              ESP=Tipo cabecera;
                                                              FIN=Otsikon tyyppi;
                                                              FRA=Type titre;
                                                              ISL=Tegund yfirskriftar;
                                                              ITA=Tipo testata;
                                                              NLD=Type kop;
                                                              NOR=Overskriftstype;
                                                              SVE=Rubriktyp];
                                                   OptionString=Date Interval,Number of Days;
                                                   Description=Done }
    { 7   ;   ;New Page Per Customer;Boolean      ;CaptionML=[DAN=Skift side pr. debitor;
                                                              DEU=Neue Seite pro Debitor;
                                                              ENU=New Page Per Customer;
                                                              NLD=Nieuwe pagina per klant];
                                                   Description=Done }
    { 9   ;   ;Period Start Date   ;Date          ;CaptionML=[DAN=Periodes startdato;
                                                              DEU=Periodenstartdatum;
                                                              ENU=Period Start Date;
                                                              ESP=Fecha inicial del periodo;
                                                              FIN=Jakson aloituspvm;
                                                              FRA=Date dÇbut pÇriode;
                                                              ISL=Upphafsdagur t°mabils;
                                                              ITA=Data inizio periodo;
                                                              NLD=Begindatum periode;
                                                              NOR=Periodens startdato];
                                                   Description=Done }
    { 12  ;   ;Currency Code       ;Code10        ;CaptionML=[DAN=Valutakode;
                                                              DEU=WÑhrungscode;
                                                              ENU=Currency Code;
                                                              ESP=C¢d. divisa;
                                                              FIN=Valuutan koodi;
                                                              FRA=Code devise;
                                                              ISL=Gjaldmi–ilsk¢ti;
                                                              ITA=Cod. valuta;
                                                              NLD=Valutacode;
                                                              NOR=Valutakode];
                                                   Description=Done }
    { 13  ;   ;Column Count        ;Integer       ;CaptionML=[DAN=Antal kolonner;
                                                              DEU=Anzahl Spalten;
                                                              ENU=Column Count;
                                                              ESP=Recuento de columnas;
                                                              FIN=SarakemÑÑrÑ;
                                                              FRA=Nombre colonnes;
                                                              ISL=D†lkafjîldi;
                                                              ITA=Conteggio colonne;
                                                              NLD=Kolomtelling;
                                                              NOR=Antall kolonner];
                                                   MinValue=1;
                                                   MaxValue=31;
                                                   Description=Done }
  }
  KEYS
  {
    {    ;Print Amounts in LCY                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      PeriodStartDate@1000000001 : ARRAY [31] OF Date;
      PeriodEndDate@1000000000 : ARRAY [31] OF Date;
      HeaderText@1000000002 : ARRAY [31] OF Text;

    PROCEDURE CalcDates@5();
    VAR
      i@1000 : Integer;
      PeriodLength2@1001 : DateFormula;
      Text010@1000000001 : TextConst 'ENU=The Date Formula %1 cannot be used. Try to restate it. E.g. 1M+CM instead of CM+1M.';
      Text032@1000000000 : TextConst '@@@=Negating the period length: %1 is the period length;ENU=-%1';
    BEGIN
      EVALUATE(PeriodLength2,STRSUBSTNO(Text032, "Period Length"));

      IF "Aging By" = "Aging By"::"Due Date" THEN BEGIN
        PeriodEndDate[1] := DMY2DATE(31,12,9999);
        PeriodStartDate[1] := "Ending Date" + 1;
      END ELSE BEGIN
        PeriodEndDate[1] := "Ending Date";
        PeriodStartDate[1] := CALCDATE(PeriodLength2, "Ending Date" + 1);
      END;

      FOR i := 2 TO "Column Count" DO BEGIN
        PeriodEndDate[i] := PeriodStartDate[i - 1] - 1;
        PeriodStartDate[i] := CALCDATE(PeriodLength2,PeriodEndDate[i] + 1);
      END;

      PeriodStartDate[i] := 0D;
      FOR i := 1 TO "Column Count" DO
        IF PeriodEndDate[i] < PeriodStartDate[i] THEN
          ERROR(Text010, "Period Length");

      CreateHeadings;
    END;

    PROCEDURE GetPeriodIndex@8(Date@1040000 : Date) : Integer;
    VAR
      i@1000 : Integer;
    BEGIN
      FOR i := 1 TO "Column Count" DO
        IF Date IN [PeriodStartDate[i]..PeriodEndDate[i]] THEN
          EXIT(i);
    END;

    PROCEDURE GetCaption@1000000000(i@1000000000 : Integer) : Text;
    BEGIN
      EXIT(HeaderText[i]);
    END;

    LOCAL PROCEDURE CreateHeadings@10();
    VAR
      i@1000 : Integer;
      NotDueTxt@1000000015 : TextConst 'DAN=Ikke forfalden;DEU=Nicht fÑllig;ENU=Not Due;NLD=Niet vervallen';
      BeforeTxt@1000000014 : TextConst 'DAN=Fõr;DEU=Vor;ENU=Before;NLD=Voor';
      DaysTxt@1000000013 : TextConst 'ENU=days';
      MoreThanTxt@1000000012 : TextConst 'ENU=More than';
    BEGIN
      IF "Aging By" = "Aging By"::"Due Date" THEN BEGIN
        HeaderText[1] := NotDueTxt;
        i := 2;
      END ELSE
        i := 1;

      WHILE i < "Column Count" DO BEGIN
        IF "Heading Type" = "Heading Type"::"Date Interval" THEN
          HeaderText[i] := STRSUBSTNO('%1\..%2',PeriodStartDate[i],PeriodEndDate[i])
        ELSE
          HeaderText[i] :=
            STRSUBSTNO('%1 - %2 %3', "Ending Date" - PeriodEndDate[i] + 1, "Ending Date" - PeriodStartDate[i] + 1, DaysTxt);
        i := i + 1;
      END;

      IF "Heading Type" = "Heading Type"::"Date Interval" THEN
        HeaderText["Column Count"] := STRSUBSTNO('%1 \%2', BeforeTxt, PeriodStartDate[i - 1])
      ELSE
        HeaderText["Column Count"] := STRSUBSTNO('%1 \%2 %3', MoreThanTxt, "Ending Date" - PeriodStartDate[i - 1] + 1, DaysTxt);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70220 ForNAV Aging Buffer
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:17:42;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[DAN=Lõbenr.;
                                                              DEU=Lfd. Nr.;
                                                              ENU=Entry No.;
                                                              ESP=Nß mov.;
                                                              FIN=Tapahtumanro;
                                                              FRA=N¯ sÇquence;
                                                              ISL=Fërslunr.;
                                                              ITA=Nr. movimento;
                                                              NLD=Volgnummer;
                                                              NOR=Lõpenr.] }
    { 20  ;   ;Account Type        ;Option        ;CaptionML=[DAN=Kontotype;
                                                              DEU=Kontoart;
                                                              ENU=Account Type;
                                                              ESP=Tipo mov.;
                                                              FIN=Tilityyppi;
                                                              FRA=Type compte;
                                                              ISL=Tegund reiknings;
                                                              ITA=Tipo conto;
                                                              NLD=Rekeningsoort;
                                                              NOR=Kontotype];
                                                   OptionString=Customer,Vendor }
    { 30  ;   ;Account No.         ;Code20        ;TableRelation=IF (Account Type=CONST(Customer)) Customer
                                                                 ELSE IF (Account Type=CONST(Vendor)) Vendor;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[DAN=Nummer;
                                                              DEU=Nr.;
                                                              ENU=No.;
                                                              ESP=Nß;
                                                              FIN=Nro;
                                                              FRA=N¯;
                                                              ISL=Nr.;
                                                              ITA=Nr.;
                                                              NLD=Nr.;
                                                              NOR=Nr.] }
    { 31  ;   ;Account Name        ;Text50        ;CaptionML=[DAN=Navn;
                                                              DEU=Name;
                                                              ENU=Name;
                                                              ESP=Nombre;
                                                              FIN=Nimi;
                                                              FRA=Nom;
                                                              ISL=Heiti;
                                                              ITA=Nome;
                                                              NLD=Naam;
                                                              NOR=Navn] }
    { 35  ;   ;Credit Limit (LCY)  ;Decimal       ;CaptionML=[DAN=Kreditmaksimum (RV);
                                                              DEU=Kreditlimit (MW);
                                                              ENU=Credit Limit (LCY);
                                                              ESP=CrÇdito m†ximo (DL);
                                                              FIN=Luottoraja (PVA);
                                                              FRA=CrÇdit autorisÇ DS;
                                                              ISL=H†marksskuld (SGM);
                                                              ITA=Limite credito (VL);
                                                              NLD=Kredietlimiet (LV);
                                                              NOR=Kredittgrense (NOK)] }
    { 40  ;   ;Currency Code       ;Code10        ;CaptionML=[DAN=Valutakode;
                                                              DEU=WÑhrungscode;
                                                              ENU=Currency Code;
                                                              ESP=C¢d. divisa;
                                                              FIN=Valuutan koodi;
                                                              FRA=Code devise;
                                                              ISL=Gjaldmi–ilsk¢ti;
                                                              ITA=Cod. valuta;
                                                              NLD=Valutacode;
                                                              NOR=Valutakode] }
    { 50  ;   ;Document Type       ;Option        ;CaptionML=[DAN=Bilagstype;
                                                              DEU=Belegart;
                                                              ENU=Document Type;
                                                              FIN=Asiakirjatyyppi;
                                                              FRA=Type document;
                                                              ISL=Tegund fylgiskjals;
                                                              ITA=Tipo di documento;
                                                              NLD=Documenttype;
                                                              NOR=Bilagstype;
                                                              SVE=Dokumenttyp];
                                                   OptionCaptionML=ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 60  ;   ;Document No.        ;Code20        ;CaptionML=[DAN=Bilagsnr.;
                                                              DEU=Belegnr.;
                                                              ENU=Document No.;
                                                              ESP=Nß documento;
                                                              FIN=Asiakirjan nro;
                                                              FRA=N¯ document;
                                                              ISL=N£mer fylgiskjals;
                                                              ITA=Nr. documento;
                                                              NLD=Documentnr.;
                                                              NOR=Bilagsnr.] }
    { 61  ;   ;External Document No.;Code35       ;CaptionML=[DAN=Eksternt bilagsnr.;
                                                              DEU=Externe Belegnummer;
                                                              ENU=External Document No.;
                                                              ESP=Nß documento externo;
                                                              FIN=Ulkoisen asiakirjan nro;
                                                              FRA=N¯ doc. externe;
                                                              ISL=N£mer utana–k. skjals;
                                                              ITA=Nr. documento esterno;
                                                              NLD=Extern documentnr.;
                                                              NOR=Eksterndokumentnr.] }
    { 65  ;   ;Document Date       ;Date          ;CaptionML=[DAN=Bilagsdato;
                                                              DEU=Belegdatum;
                                                              ENU=Document Date;
                                                              FIN=Asiakirjan pvm;
                                                              FRA=Date document;
                                                              ISL=Dags. fylgiskjals;
                                                              ITA=Data documento;
                                                              NLD=Documentdatum;
                                                              NOR=Bilagsdato;
                                                              SVE=Dokumentdatum] }
    { 70  ;   ;Posting Date        ;Date          ;CaptionML=[DAN=Bogfõringsdato;
                                                              DEU=Buchungsdatum;
                                                              ENU=Posting Date;
                                                              FIN=Kirjauspvm.;
                                                              FRA=Date comptabilisation;
                                                              ISL=B¢kunardags.;
                                                              ITA=Data di registrazione;
                                                              NLD=Boekingsdatum;
                                                              NOR=Bokfõringsdato;
                                                              SVE=Bokfîringsdatum] }
    { 80  ;   ;Due Date            ;Date          ;CaptionML=[DAN=Forfaldsdato;
                                                              DEU=FÑlligkeitsdatum;
                                                              ENU=Due Date;
                                                              FIN=ErÑpÑivÑ;
                                                              FRA=Date d'ÇchÇance;
                                                              ISL=Gjalddagi;
                                                              ITA=Data scadenza;
                                                              NLD=Vervaldatum;
                                                              NOR=Forfallsdato;
                                                              SVE=Fîrfallodatum] }
    { 90  ;   ;Amount              ;Decimal       ;CaptionML=[DAN=Belõb;
                                                              DEU=Betrag;
                                                              ENU=Amount;
                                                              ESP=Importe;
                                                              FIN=Summa;
                                                              FRA=Montant;
                                                              ISL=Upphë–;
                                                              ITA=Importo;
                                                              NLD=Bedrag;
                                                              NOR=Belõp] }
    { 95  ;   ;Amount (LCY)        ;Decimal       ;CaptionML=[DAN=Belõb (RV);
                                                              DEU=Betrag (MW);
                                                              ENU=Amount (LCY);
                                                              ESP=Importe (DL);
                                                              FIN=Summa (PVA);
                                                              FRA=Montant DS;
                                                              ISL=Upphë– (SGM);
                                                              ITA=Importo (VL);
                                                              NLD=Bedrag (LV);
                                                              NOR=Belõp (NOK)] }
    { 100 ;   ;Balance             ;Decimal       ;CaptionML=[DAN=Saldo;
                                                              DEU=Saldo;
                                                              ENU=Balance;
                                                              ESP=Saldo;
                                                              FIN=Saldo;
                                                              FRA=Solde;
                                                              ISL=Sta–a;
                                                              ITA=Saldo;
                                                              NLD=Saldo;
                                                              NOR=Saldo] }
    { 105 ;   ;Balance (LCY)       ;Decimal       ;CaptionML=[DAN=Saldo (RV);
                                                              DEU=Saldo (MW);
                                                              ENU=Balance (LCY);
                                                              ESP=Saldo (DL);
                                                              FIN=Saldo (PVA);
                                                              FRA=Solde DS;
                                                              ISL=Sta–a (SGM);
                                                              ITA=Saldo (VL);
                                                              NLD=Saldo (LV);
                                                              NOR=Saldo (NOK)] }
    { 110 ;   ;Amount 1            ;Decimal       ;CaptionClass=GetCaptionClass(1) }
    { 115 ;   ;Amount 1 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(1) }
    { 120 ;   ;Amount 2            ;Decimal       ;CaptionClass=GetCaptionClass(2) }
    { 125 ;   ;Amount 2 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(2) }
    { 130 ;   ;Amount 3            ;Decimal       ;CaptionClass=GetCaptionClass(3) }
    { 135 ;   ;Amount 3 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(3) }
    { 140 ;   ;Amount 4            ;Decimal       ;CaptionClass=GetCaptionClass(4) }
    { 145 ;   ;Amount 4 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(4) }
    { 150 ;   ;Amount 5            ;Decimal       ;CaptionClass=GetCaptionClass(5) }
    { 155 ;   ;Amount 5 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(5) }
    { 160 ;   ;Amount 6            ;Decimal       ;CaptionClass=GetCaptionClass(6) }
    { 165 ;   ;Amount 6 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(6) }
    { 167 ;   ;Amount 7            ;Decimal       ;CaptionClass=GetCaptionClass(7) }
    { 170 ;   ;Amount 7 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(7) }
    { 175 ;   ;Amount 8            ;Decimal       ;CaptionClass=GetCaptionClass(8) }
    { 180 ;   ;Amount 8 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(8) }
    { 182 ;   ;Amount 9            ;Decimal       ;CaptionClass=GetCaptionClass(9) }
    { 185 ;   ;Amount 9 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(9) }
    { 190 ;   ;Amount 10           ;Decimal       ;CaptionClass=GetCaptionClass(10) }
    { 195 ;   ;Amount 10 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(10) }
    { 200 ;   ;Amount 11           ;Decimal       ;CaptionClass=GetCaptionClass(11) }
    { 205 ;   ;Amount 11 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(11) }
    { 210 ;   ;Amount 12           ;Decimal       ;CaptionClass=GetCaptionClass(12) }
    { 215 ;   ;Amount 12 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(12) }
    { 220 ;   ;Amount 13           ;Decimal       ;CaptionClass=GetCaptionClass(13) }
    { 225 ;   ;Amount 13 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(13) }
    { 230 ;   ;Amount 14           ;Decimal       ;CaptionClass=GetCaptionClass(14) }
    { 235 ;   ;Amount 14 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(14) }
    { 240 ;   ;Amount 15           ;Decimal       ;CaptionClass=GetCaptionClass(15) }
    { 245 ;   ;Amount 15 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(15) }
    { 250 ;   ;Amount 16           ;Decimal       ;CaptionClass=GetCaptionClass(16) }
    { 255 ;   ;Amount 16 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(16) }
    { 260 ;   ;Amount 17           ;Decimal       ;CaptionClass=GetCaptionClass(17) }
    { 265 ;   ;Amount 17 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(17) }
    { 270 ;   ;Amount 18           ;Decimal       ;CaptionClass=GetCaptionClass(18) }
    { 275 ;   ;Amount 18 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(18) }
    { 280 ;   ;Amount 19           ;Decimal       ;CaptionClass=GetCaptionClass(19) }
    { 285 ;   ;Amount 19 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(19) }
    { 290 ;   ;Amount 20           ;Decimal       ;CaptionClass=GetCaptionClass(20) }
    { 295 ;   ;Amount 20 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(20) }
    { 300 ;   ;Amount 21           ;Decimal       ;CaptionClass=GetCaptionClass(21) }
    { 305 ;   ;Amount 21 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(21) }
    { 310 ;   ;Amount 22           ;Decimal       ;CaptionClass=GetCaptionClass(22) }
    { 315 ;   ;Amount 22 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(22) }
    { 320 ;   ;Amount 23           ;Decimal       ;CaptionClass=GetCaptionClass(23) }
    { 325 ;   ;Amount 23 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(23) }
    { 330 ;   ;Amount 24           ;Decimal       ;CaptionClass=GetCaptionClass(24) }
    { 335 ;   ;Amount 24 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(24) }
    { 340 ;   ;Amount 25           ;Decimal       ;CaptionClass=GetCaptionClass(25) }
    { 345 ;   ;Amount 25 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(25) }
    { 350 ;   ;Amount 26           ;Decimal       ;CaptionClass=GetCaptionClass(26) }
    { 355 ;   ;Amount 26 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(26) }
    { 360 ;   ;Amount 27           ;Decimal       ;CaptionClass=GetCaptionClass(27) }
    { 365 ;   ;Amount 27 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(27) }
    { 370 ;   ;Amount 28           ;Decimal       ;CaptionClass=GetCaptionClass(28) }
    { 375 ;   ;Amount 28 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(28) }
    { 380 ;   ;Amount 29           ;Decimal       ;CaptionClass=GetCaptionClass(29) }
    { 385 ;   ;Amount 29 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(29) }
    { 390 ;   ;Amount 30           ;Decimal       ;CaptionClass=GetCaptionClass(30) }
    { 395 ;   ;Amount 30 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(30) }
    { 400 ;   ;Amount 31           ;Decimal       ;CaptionClass=GetCaptionClass(31) }
    { 405 ;   ;Amount 31 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(31) }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      HeaderText@1000000000 : ARRAY [31] OF Text;

    PROCEDURE GetCaptionClass@1000000000(FieldNo@1000000000 : Integer) : Text;
    BEGIN
      EXIT('3,' + HeaderText[FieldNo]);
    END;

    PROCEDURE SetCaptions@1000000001(VAR Args@1000000000 : Record 70219);
    VAR
      i@1000000001 : Integer;
    BEGIN
      FOR i := 1 TO ARRAYLEN(HeaderText) DO
        HeaderText[i] := Args.GetCaption(i);
    END;

    PROCEDURE GetAccountName@1000000002();
    VAR
      Customer@1000000000 : Record 18;
      Vendor@1000000001 : Record 23;
    BEGIN
      CASE "Account Type" OF
        "Account Type"::Customer:
          BEGIN
            Customer.GET("Account No.");
            "Account Name" := Customer.Name;
          END;
        "Account Type"::Vendor:
          BEGIN
            Vendor.GET("Account No.");
            "Account Name" := Vendor.Name;
          END;
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70248 ForNAV Cust./Item Stat. Args.
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=11:48:50;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Print Details       ;Boolean       ;CaptionML=[DAN=Udskriv detaljer;
                                                              DEU=Details drucken;
                                                              ENU=Print Details;
                                                              ESP=Imprimir detalles;
                                                              FIN=Tulosta yksityiskohdat;
                                                              FRA=Imprimer dÇtails;
                                                              ISL=Prenta sundurli–un;
                                                              ITA=Stampa dettagli;
                                                              NLD=Details afdrukken;
                                                              NOR=Skriv ut spesifikasjoner;
                                                              SVE=Skriv ut detaljer] }
    { 2   ;   ;New Page Per Customer;Boolean      ;CaptionML=[ENU="ENU=""New Page per Customer"";DAN=""Skift side pr. debitor"";DEU=""Neue Seite pro Debitor"";ESP=""P†gina nueva por cliente"";FIN=""Uusi sivu asiakasta kohti"";FRA=""Nouvelle page par client"";ISL=""NÏ bla–s°–a † hvern vi–skiptamann"";ITA=""Nuova pagina per cliente"";NLD=""Nieuwe pagina per klant"";NOR=""Sideskift per kunde"";SVE=""Ny sida per kund"""] }
  }
  KEYS
  {
    {    ;Print Details                           ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70250 ForNAV Statement Arguments
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=10:45:57;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Start Date          ;Date          ;CaptionML=[DAN=Startdato;
                                                              DEU=Startdatum;
                                                              ENU=Start Date;
                                                              ESP=Fecha inicial;
                                                              FIN=Aloituspvm;
                                                              FRA=Date dÇbut;
                                                              ISL=Upphafsdagur;
                                                              ITA=Data di inizio;
                                                              NLD=Begindatum;
                                                              NOR=Startdato] }
    { 2   ;   ;Ending Date         ;Date          ;CaptionML=[DAN=Slutdato;
                                                              DEU=Enddatum;
                                                              ENU=Ending Date;
                                                              ESP=Fecha final;
                                                              FIN=Lopetuspvm;
                                                              FRA=Date fin;
                                                              ISL=Lokadagsetning;
                                                              ITA=Data fine;
                                                              NLD=Einddatum;
                                                              NOR=Sluttdato] }
    { 3   ;   ;Document Date       ;Date          ;CaptionML=[DAN=Bilagsdato;
                                                              DEU=Belegdatum;
                                                              ENU=Document Date;
                                                              FIN=Asiakirjan pvm;
                                                              FRA=Date document;
                                                              ISL=Dags. fylgiskjals;
                                                              ITA=Data documento;
                                                              NLD=Documentdatum;
                                                              NOR=Bilagsdato;
                                                              SVE=Dokumentdatum] }
    { 4   ;   ;Print All Having Balance;Boolean   ;CaptionML=[DAN=Medtag ogsÜ debitorer, der kun har saldo;
                                                              DEU=Alle Debitoren mit Saldo einbeziehen;
                                                              ENU=Include All Customers with a Balance;
                                                              NLD=Alle klanten met saldo] }
    { 5   ;   ;Print All Having Entries;Boolean   ;CaptionML=[DAN=Medtag alle debitorer, der har poster;
                                                              DEU=Alle Debitoren mit Buchungen einbeziehen;
                                                              ENU=Include All Customers with Ledger Entries;
                                                              NLD=Alle klanten met posten] }
    { 6   ;   ;Print Entries Due   ;Boolean       ;CaptionML=[DAN=Vis forfaldne poster;
                                                              DEU=FÑllige Posten drucken;
                                                              ENU=Show Overdue Entries;
                                                              NLD=Vervallen posten weergeven] }
    { 7   ;   ;Print Unapplied Entries;Boolean     }
    { 8   ;   ;Print Reversed Entries;Boolean      }
    { 9   ;   ;Include Aging Band  ;Boolean       ;CaptionML=[DAN=Medtag aldersford.intv.;
                                                              DEU=Mit SaldenrÅckblick;
                                                              ENU=Include Aging Band;
                                                              ESP=Incluye rango antigÅedad;
                                                              FIN=Sis. erÑÑntymisjakso;
                                                              FRA=Inclure cumul date;
                                                              ISL=Taka aldursgreiningart°mabil me–;
                                                              ITA=Includi periodo scadenziario;
                                                              NLD=Vervaldatuminterval opnemen;
                                                              NOR=Vis aldersfordeling;
                                                              SVE=Ta med Üldersspann] }
    { 10  ;   ;Date                ;Option        ;CaptionML=[DAN=Dato;
                                                              DEU=Datum;
                                                              ENU=Date;
                                                              ESP=Fecha;
                                                              FIN=Pvm;
                                                              FRA=Date;
                                                              ISL=Dagsetning;
                                                              ITA=Data;
                                                              NLD=Datum;
                                                              NOR=Dato];
                                                   OptionCaptionML=[DAN=Forfaldsdato,Bogfõringsdato;
                                                                    DEU=FÑlligkeitsdatum,Buchungsdatum;
                                                                    ENU=Due Date,Posting Date;
                                                                    ESP=Fecha vto,Fecha registro;
                                                                    FIN=ErÑpÑivÑ,Kirjauspvm.;
                                                                    FRA=Date d'ÇchÇance,Date comptabilisation;
                                                                    ISL=Gjalddagi,B¢kunardagsetning;
                                                                    ITA=Data scadenza,Data registrazione;
                                                                    NLD=Vervaldatum,Boekingsdatum;
                                                                    NOR=Forfallsdato,Bokfõringsdato;
                                                                    SVE=Fîrfallodatum,Bokfîringsdatum];
                                                   OptionString=Due Date,Posting Date }
    { 11  ;   ;Period Length       ;DateFormula   ;CaptionML=[DAN=Periodelëngde;
                                                              DEU=PeriodenlÑnge;
                                                              ENU=Period Length;
                                                              ESP=Longitud periodo;
                                                              FIN=Jakson pituus;
                                                              FRA=Base pÇriode;
                                                              ISL=Lengd t°mabils;
                                                              ITA=Durata periodo;
                                                              NLD=Periodelengte;
                                                              NOR=Periodelengde] }
  }
  KEYS
  {
    {    ;Start Date                              ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70900 ForNAV Captions
{
  OBJECT-PROPERTIES
  {
    Date=14-01-18;
    Time=14:49:20;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    DataPerCompany=No;
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=NLD=Primary Key }
    { 2   ;   ;Unit Price          ;Boolean       ;CaptionML=[ENU=Unit Price;
                                                              NLD=Unit Price;
                                                              ESM=Precio unitario;
                                                              FRC=Prix unitaire;
                                                              ENC=Unit Price] }
    { 3   ;   ;No.                 ;Boolean       ;CaptionML=[ENU=No.;
                                                              NLD=Nr.] }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70998 ForNAV Sales Tax Buffer
{
  OBJECT-PROPERTIES
  {
    Date=17-07-17;
    Time=15:23:01;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10         }
    { 2   ;   ;Exempt Amount       ;Decimal        }
    { 3   ;   ;Taxable Amount      ;Decimal        }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70999 ForNAV Document Line Buffer
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;VAT %               ;Decimal       ;CaptionML=[ENU=VAT %;
                                                              NLD=Btw %];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 2   ;   ;VAT Base            ;Decimal       ;CaptionML=[ENU=VAT Base;
                                                              NLD=Basisbedrag btw];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 3   ;   ;VAT Amount          ;Decimal       ;CaptionML=[ENU=VAT Amount;
                                                              NLD=Btw-bedrag];
                                                   AutoFormatType=1 }
    { 4   ;   ;Amount Including VAT;Decimal       ;CaptionML=[ENU=Amount Including VAT;
                                                              NLD=Bedrag incl. btw];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5   ;   ;VAT Identifier      ;Code10        ;CaptionML=[ENU=VAT Identifier;
                                                              NLD=Btw-identificatie];
                                                   Editable=No }
    { 6   ;   ;Line Amount         ;Decimal       ;CaptionML=[ENU=Line Amount;
                                                              NLD=Regelbedrag];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 7   ;   ;Inv. Disc. Base Amount;Decimal     ;CaptionML=[ENU=Inv. Disc. Base Amount;
                                                              NLD=Basisbedrag factuurkorting];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 8   ;   ;Invoice Discount Amount;Decimal    ;CaptionML=[ENU=Invoice Discount Amount;
                                                              NLD=Bedrag factuurkorting];
                                                   AutoFormatType=1 }
    { 9   ;   ;VAT Calculation Type;Option        ;CaptionML=[ENU=VAT Calculation Type;
                                                              NLD=Btw-berekening];
                                                   OptionCaptionML=[ENU=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                                    NLD=Normaal,Verlegging,Volledig,Sales tax];
                                                   OptionString=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                   Editable=No }
    { 10  ;   ;Tax Group Code      ;Code10        ;TableRelation="Tax Group";
                                                   CaptionML=[ENU=Tax Group Code;
                                                              NLD=Tax Group Code];
                                                   Editable=No }
    { 11  ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NLD=Aantal];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 12  ;   ;Modified            ;Boolean       ;CaptionML=[ENU=Modified;
                                                              NLD=Gewijzigd] }
    { 13  ;   ;Use Tax             ;Boolean       ;CaptionML=[ENU=Use Tax;
                                                              NLD=Use Tax] }
    { 14  ;   ;Calculated VAT Amount;Decimal      ;CaptionML=[ENU=Calculated VAT Amount;
                                                              NLD=Berekend btw-bedrag];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 15  ;   ;VAT Difference      ;Decimal       ;CaptionML=[ENU=VAT Difference;
                                                              NLD=Btw-verschil];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 16  ;   ;Positive            ;Boolean       ;CaptionML=[ENU=Positive;
                                                              NLD=Positief] }
    { 17  ;   ;Includes Prepayment ;Boolean       ;CaptionML=[ENU=Includes Prepayment;
                                                              NLD=Inclusief vooruitbetaling] }
    { 18  ;   ;VAT Clause Code     ;Code10        ;TableRelation="VAT Clause";
                                                   CaptionML=[ENU=VAT Clause Code;
                                                              NLD=Code btw-clausule] }
    { 19  ;   ;Tax Category        ;Code10        ;CaptionML=[ENU=Tax Category;
                                                              NLD=Belastingcategorie] }
    { 70000;  ;Line No.            ;Integer        }
    { 70001;  ;Amount              ;Decimal        }
    { 70002;  ;Allow Invoice Disc. ;Boolean        }
    { 70003;  ;Inv. Discount Amount;Decimal        }
  }
  KEYS
  {
    {    ;Line No.                                ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE CreateForRecRef@1000000000(VAR RecRef@1000000000 : RecordRef);
    VAR
      Fld@1000000002 : Record 2000000041;
    BEGIN
      FindAndSetField(RecRef, 'Line No.', 70000);

      Fld.SETRANGE(TableNo, DATABASE::"ForNAV Document Line Buffer");
      Fld.SETFILTER("No.", '<>70000');
      Fld.FINDSET;
      REPEAT
        FindAndSetField(RecRef, Fld.FieldName, Fld."No.");
      UNTIL Fld.NEXT = 0;
    END;

    LOCAL PROCEDURE FindAndSetField@1000000004(VAR RecRef@1000000003 : RecordRef;FieldName@1000000002 : Text;FieldNo@1000000004 : Integer);
    VAR
      FldRef@1000000001 : FieldRef;
      Fld@1000000000 : Record 2000000041;
      ThisRecRef@1000000006 : RecordRef;
      ThisFld@1000000005 : FieldRef;
    BEGIN
      Fld.SETRANGE(TableNo, RecRef.NUMBER);
      Fld.SETRANGE(FieldName, FieldName);
      IF NOT Fld.FINDFIRST THEN
        EXIT;

      FldRef := RecRef.FIELD(Fld."No.");

      ThisRecRef.GETTABLE(Rec);
      ThisFld := ThisRecRef.FIELD(FieldNo);
      ThisFld.VALUE := FldRef.VALUE;

      ThisRecRef.SETTABLE(Rec);
      IF FieldNo = 70000 THEN
        INSERT
      ELSE
        MODIFY;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Report 70000 ForNAV VAT Order Confirmation
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:10;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Objedn†vka;
               DAN=Ordre;
               DEU=Auftrag;
               ENU=Order;
               FIN=Tilaus;
               FRA=Commande;
               ISL=Pîntun;
               ITA=Ordine;
               NLD=Order;
               NOR=Ordre;
               SVE=Order;
               DES=Auftrag;
               ENG=Order;
               ESM=Pedido;
               FRB=Commande;
               ITS=Ordine;
               NLB=Order;
               DEA=Auftrag;
               ENA=Order;
               ESN=Pedido;
               FRC=Commande;
               ENC=Order;
               FRS=Commande;
               ENZ=Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Order));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70001 ForNAV VAT Sales Invoice
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:10;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Faktura;
               DAN=Faktura;
               DEU=Rechnung;
               ENU=Invoice;
               FIN=Lasku;
               FRA=Facture;
               ISL=Reikningur;
               ITA=Fattura;
               NLD=Factuur;
               NOR=Faktura;
               SVE=Faktura;
               DES=Rechnung;
               ENG=Invoice;
               ESM=Factura;
               FRB=Facture;
               ITS=Fattura;
               NLB=Factuur;
               DEA=Rechnung;
               ENA=Invoice;
               ESN=Factura;
               FRC=Facture;
               ENC=Invoice;
               FRS=Facture;
               ENZ=Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  Name=NoOfCopies;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE GetNoOfCopies@1000000006() : Integer;
    VAR
      GetNoofCopies@1000000000 : Codeunit 70007;
    BEGIN
      EXIT(NoOfCopies + GetNoofCopies.GetNoOfCopies(Header));
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70002 ForNAV VAT Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Dobropis;
               DAN=Kreditnota;
               DEU=Gutschrift;
               ENU=Credit Memo;
               FIN=Hyvityslasku;
               FRA=Avoir;
               ISL=Kreditreikningur;
               ITA=Nota credito;
               NLD=Creditnota;
               NOR=Kreditnota;
               SVE=Kreditnota;
               DES=Gutschrift;
               ENG=Credit Memo;
               ESM=Nota de crÇdito;
               FRB=Avoir;
               ITS=Nota credito;
               NLB=Creditnota;
               DEA=Gutschrift;
               ENA=CR/Adj Note;
               ESN=Abono;
               FRC=Note de crÇdit;
               ENC=Credit Memo;
               FRS=Avoir;
               ENZ=Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table114;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table115;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70003 ForNAV Sales Shipment
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Prodejn° dod†vka;
               DAN=Salgsleverance;
               DEU=Verkaufslieferung;
               ENU=Sales Shipment;
               FIN=Myyntitoimitus;
               FRA=ExpÇdition vente;
               ISL=Sîluafhending;
               ITA=Spedizione vendita;
               NLD=Verkoopverzending;
               NOR=F˚lgeseddel;
               SVE=Utleverans;
               DES=Verkaufslieferung;
               ENG=Sales Shipment;
               ESM=Remisi¢n de venta;
               FRB=ExpÇdition vente;
               ITS=Spedizione vendita;
               NLB=Verkoopverzending;
               DEA=Verkaufslieferung;
               ENA=Sales Shipment;
               ESN=Albar†n de venta;
               FRC=Livraison de vente;
               ENC=Sales Shipment;
               FRS=ExpÇdition vente;
               ENZ=Sales Shipment];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table110;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table111;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70004 ForNAV VAT Sales Quote
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=ENU=Quote;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>c50AAO1de3PbOJL//6ruO/B0VWe7VqsQIB7kTLRTfiQT1yW2x3aSqb25SlEkaHNDi16KSuLdvar7NPfB7pMcwJf4ACVQpGzPzSQVx6IIoNG/BtDdaDRe/vDtLtC+sGjhh/PpCEz0kcbmTuj685vpaBl7fzRHP/zpn//p5c9xZF+y+zCKF2/th3AZX7HItwP/byzSVr9+KCpCEzjBorbKo5F2Zt+x6Sir6XUYndlfRtpxOI+jMLh+uOffnbAvr77dR2yxmJQanbw/LX2EY63ltS+imXHeqjbVckrG2vEyiJcR48/mbMmLBGPtYjkLfOff2cN1+JmJt13q2CYzoU49xJDO6T/xF/eB/ZDSLQg+/KB9OLzWruyALbSflmHMRlqlP0WPjYnO/wIEzZF2PvsLc+KzcDqiuq6jkfbaZ4H7kc048774DnsfBdPRT9/9cj5nJ5H/hf1yEYWixOKXtM1f+D+oA3MSf4tH2oV9w94w/+Y2no6gRfX0yUffjW/5AyDofmdHN/58wanQed+B+AGzH7xxzvDp6FDANtas+3isObd2dMXiqejxvc8rwSjv1vu5z1++ZvP4dnHuHb7zg8C/YzGLeK/mFxFL33pnL/ijKyfy7+OCUSmTrtkdZyHnExckTXt5ZM/dRfIr/3AaszuQScUbZrui1oo4pDw9sWNbvCrKciFiX0V/L1h0yZwwcqejOFpyGI7twEn4yrt9eBcu57F2OneCpZBmAdo4fTjSrsPYDvI3iT4mYKT9GIXL+8oXBudF1u4HO6rSmH9xbc8C/jj5zyC15x989nU6ujq/vD49+3H/LJwcaB/fvLp8tX8SOss7zlAt6ePx+dnV9X4iSgcHgut/fe0HnJk5Hbzg+CJcxKIXJ4KPnEP3PuPfAA7XKe8+FKUWLBZcOVvezViUsyRBKCcqR2eUcb8GRgmQS+Yl/ZdAkXIgAyLhSd6bgjeFAB3ZzufjMAg5OUdcXBOI5le3kT//PB15drDgTy74Jy49387njkBUdKH63fn8FZ+gHtIv0l5lwsbHRzLQpNI2rpN1GATh15QFr6IojBZ5bVf+zdwWU8N05JjIoTPEPMthLjU86gFIkYf5cw9SYDDbJhZ1RKG0cTkH0rH5ejoyDT4F6DoYlVjMmZyxdVF5WmU+kjL/mn2Lj8Jvo8qI+XSyZKlcXPFJmLdqmEmrEKExtiYW/8Nrexs6tqD4dRDaXAaAAZKvTHOsEZr+mk8MV+wmZNr707Fm3sfiYcRyFAOOaBlhQdBhwBkouj8dvfNdN2CXovecC2H0t+Q7PuGnT8Tb09H//vf/FBQL0eTzTiLq5T5N8jdqLOJMuoofAsYlI4z8+CFlFh5p7xcsJT4TneRzQffqYY3g7IsXdSReJFDI8IFpk0QFn+NlFKXT46ermI8YO3KP7XuBwuITH8MPBWJ8qRkTvQESn68x0VtgqYKQsDWts8nTFR2TOh2TpIwSl2mTy3K+QRnfjLQSs4NcJz14G4afl/eLTxf2g4DsmkV3ixO2SMYx70BZ6DkLk9EGIZDIO+TcpEYi6RSTx5P1VsJbZb/c70lbcSXIrN0MDEMGMEqbFGtSf4Qz8VyhCxNodQIykHXShFjXVxBbUoDH2kIwaXoUBu5msBvwFVR1hy4vqgQbAIq4yeFBMnhwVjXsCk8xYzWWmTImLWisXVq2QGPzwlGhudsyAoxebMcytpOs6i7reY3tmXJR5/0apqdLu2UMNgiqNKjyvlxIDQDVhVwOAJEBQLOqlRZsKQDnEX92Fm7i/Q7mnqJlRY7n76sxW7Ked2A2lTHbzKruvMoXzOZm2iW78RfcQE/0axW2Dz3JSGhQBKBZUg0K1XVaDoUpg8JKq4ZbL8fHy0Uc3rFIshS34TD4vNOgQW3hrRdTAgH2W3QtqTGnZ3Vvv+qWRkCLlQAnhsGtOTDW2kyFzbyWSvNZqP1B2/tO2+P/ZS90GAvy0mpQ9FuIgS7FIrOsYeelOHENLT4d+UHwKQ4PXVe4HSuowEQVMqDZNDyE9y2xwgkx5eOik9VxHd6/ZV6cOFbjzOLgzyoWSPpCE9i0H5N6P9bjKS+kBuOu7HKpYQ4yyxyqmebh3b09fzide2F0l+BVwbojyMDQM9NzcLQzc3IN3HWDcw2wzV5XQO6Grqr+0BVdqfsAZP4DqKRalBwv9eVrjatFl8+f3dathocgHY0tw1Osce1rW8lv020p25HdD6SGP8gsf0Oualz4jnCurh972UstBk1lVyLDkfIv8qGGze29M3nDvNpk0+vPYXh3emffSO0cyfjJK1ACxgDdeS615kFmzhtKikVpOFwkPct4COVjAWB9zXDYkZOsheGrEZC8osZlVfWhKxRSCx9kJr7RRa/IltNcUS0reViKSeK+3KBgD49MpghIqG1VGprvqmG2K11B6hQAmVfA6OwVkOqCqIzeGp9YCuKj77Z0sWe3tGCNXSkDUjcDyPwMRmc/gxQ+cwUfSgdYu5M5c3oC0xhrFOVgPx6Wm11CnZxAxq40BalPAmROCdTFKSH3f3bY4sTgCWZOdadpdzcpUvVUdAWt6sN4+UKyT93cGS3viiK5OvI6DONqzED6ZH2swAXHgZ3Oj8KYryT5Zn1bSMC6MIJm0IFSAEFOYyk+ALsOYNi2TYf/xZZlW/rMAHim69iGkBJADOrOgFOLD8hrKuICINa3CAmQB2R0ne1IMYhAokMjqTGktuvcGBXH/Pekp6thkT96twxi/60/LyBLB8p//Nu/fjv5nv84/F6mXd+Gc3YWatq/TLW9Pe0Hrc2CLdxOeYk/aHta6nxaV+132nwZBGNtLRGvPr2z/UCdhOz9tRRk72Ttr23+DdejhDx3YEJRZC0NxVtKXGhoBurkNIvmdMkJa76vROHp0eGZOlHJ22v5k7yh1PLVx9PX18eh2wWjVZm1RKxeSylZ0fGfk9XvXhIxtu8t58m0o+1/sYMD7e8R4/PWXOMfvv+vg8lfQn++v6f9Q9s7kK1Hv4/E30fi7yPx0UeimsqHpCrfUNFsCA/nM4dV/ULuawWWRMEgK1/raWwHvtNH3Ui1ix9Z/Jbd2AHvnOsnaO8ffC+b/OQvqmFDemMDVRVvWFe8jQwboVgphE7nny7siFMlYofzmNVK6LNwIDdin9MmpJHPdG3kcxHuLCKZRS3il4NVEf7oM+ck4yQ5khjrt4nmXq5k+vr01duTJKJ6rFWDqdNvKs8OtDRK2qip3PXY54a+LfcuHIXuQ9mUER1aiIcbrJnhDZRSyyUbxdWhCaHnAEBsUzc9Sj1AmAcxAQ4wgUWsmQs8d1azUUqVFWYK0SUjoMVSaXDPqjAoEYsaP3++zJ5umC/SDW6KCaluBUgo4DRchl9ltNXp4xZYmT5eSk5d8sUK2I/ZsQt9ggm1dAANlP0iJydlGQuk/JLSBeR0iDrKFCeBASu6pMZa4YoQ75Yot4gJKaJEh9AyoIllE6JoI9nu77KpxQWZLwZfCzG+ug2/ni/j+2WcVcin2fNk1f1gB0u2vye6uHegTafaGv4lLJKFfcMeE2+lcukC2UAoWyxx3Q5vQ6ga7asIVaVQjhmcYJNADA0+qE2LItKKWKV4DY7uDJZoHZv5WN+/bfAx28rFdaWjjY8/Le15zIlSZ+KqRFPqkYEInwYpH2dHgT3//GcWhblLooWpq+q6uQJ787+PZtEEpr572wAm28jFVBEYcTQs9N4xe5FsoaqiUytWhwjrBuG/ACqCZlsQqVXxyLCYg8JS3+BtwJLt9WJLERbx48RfOOKw24UTqwPTKNgcPQYxTYyR2HlRHT2NWnuhVVlTTh7m9p3vLDI9lzc+eWMv8sam04SuzvgKFWRAfOu7xg18sw1korryC+HnFDsdh1xWpIkppboFsEU7YFqq73HHHhl2za/vDjewyTaKieqanx8xVQUmfz9HBUyAZRCMdRMiqOtcXVcHpTje+riI9HFNNBGpb/iWv1+nR6/T4V6+aDEK2gpJLfDsq2Qfg9t2y7t5xgC81QFCeehB83htYp4Mf7ZW3cLM2y7ZmJQ5ps3V0BkEhmMRF3LTzfaIYRvOjFqWST1qGowRmY3ZOCQrzqtvbWYSKuGTsrGZHJWXbn6VGB2KDfUFZ3OyEdnP6iSmhNwBbE/tcBmHr8VB/fVLXidTlKgqHPWI9U9tMltj5eZoS6kFSyamjqClUwsTw7CQiOJp7C62zJH1GPXGbJmS1oixzineZPJ2nj6pXNkoWPV4di1V1T9q59NWFmcb7uowy61fa4JMDLFpEmRYUBfHA7bDu1L9UwMv12QGBF7VEKeqyk0V+Nwq7o9601zPh7hhAT5HQ2NrxFtN9xTXZnS9BO+VopSvr3m+kZ4SINecBpQAVYufqrpiqhIgrIDz3ArvLwYtfoFcFgjA/B/UxWm57YRhvdfgOUiE3OEzoESoOhuoqg+oKhE1W79dJurRdupS0uqkyOUEmwACZCARjLadnGzyWGwlKY/sxKByJ5U0SHBA+VJ1dtDtdMvC77ALyZI4SQqZ0hFBlGK0tarZ7jF5BvOOKVdCdy0sqt4XczvNNPWHlCWl5xolgTXLMyYCR/ZLJ11rx5EjsbX9kIeYHOyV/D3GhOgmn7L4HxMCaG4tYNtSMvTc1l34dq4IP6pPqaWT6ZmkktemvaeyDnX2VCmkYmo5sBTZ80XTDVV6/OiBDpW2S24oAwOIHA/pyDRMBlzPspHhUog8RnSXzQxAdai7uOaGqlS3ckP1iXYQe+iNyp+vG0rMMg1yn6sbytxOFT0LP7XIbD+vE9ANRDAFeGsz5Bl4nUy5dvgEXidzO0Ww7HXqDfNarxOhJjVNaohTN79+r5O1c3ejqtfJ2k6pK7xOvVH/1Xid+gG+c+1K1clkbedmrDht+qOu6mR6Rj6mfvjv3Mmo6lKytnMy1l1KrRLwCC4l/Fv2KFly5+Rz8ShZ26mJK4/SDgTrt+tRsp7G/ajqUbJUtc6zUH9ejiLD5PJjoSQw6DfmKErM5P/3niKgg924iqp2F9DVUgfxN/z5krmfMg9qHmSWpxCy0mwm1JRmEkKlvGgb0mspHvnanHehCMFbGyXXAQ95OiF1EWu3i8r2ENCVEgg1AKknOAPyBEIAYn0zCGISG2tyKLIU81nz3fPM5wU7cF6SFKidwU07ZINzdH0a85bUQEJJaOazKD1+Gu+oJFmFNZtRR0fuTHe4poGZbgqTduYR13WJBx2KPMswZ0zmHW1krLD4OCYI0u1dpECvK2g9DpkiNXH/VQm7RGPqM73XNZwe3DZWeXdaMsYhfSO3n+38DvqG+7fN7xumn7Vp+kHdO9aWSSfZ0XyimafSdnlfRkczl1EwIzM8AzPbhJCxGRcS4EFiQ8NkNkAzG8rCg5u5cnScZNmyJCcElecetWsPso94NbkAPb9VBAKjmQ1MrKgIZQqQ7F6tdaJfvl7iLJTniEr5zp8t7yflVztIt0R76TGtiDNZKWlXt/Y9k7M1+aq6xYWlvKsm9hSl0mrE6E+Pm2d5CIvPV3HEYuc2N3gO5zfiFLol2bpLOSLqzEnHWRvl4+w99DW1KwWaqWiJqvJspF9TMtZgImQWFIF6G21QiZi1z5mZ9dd91lS4DmjFTJmPuKJuqV0Z0GSmuXFpKnHRTIcqVLxRqcKa4ia5D4fXf6wybRNX1xTtwG9Jpr52fst8stVrYJRS8DX5TTfyO71rsKe8Xi1nSUKKropXUU6dsbK8/+2MlXkjKxe9qKX6bzLWUmMsQOlqaMhzTlYZ2zhvUef0OlYmfOzuJeqG13aNdABXbruru1FkDsXKvTJq1wmo6dl6l8lsWEko1ojyZNVpZuuCijzZrzoqMjdd5QKaIS8BAGVU8qyjrQO04xrD+X5tf2tfSNYOnqJgB9Z3WrbrWVw32jTV6fHli8b9og1tINMC0t5yMUp7NGw6IzAmY2MMJTmNag3KkhtBETKxJruRuA341OXN+57PorH4KC6iXQaJbCQZiMYcqfSCWU3MYmMOgMYfiVtd/dj/wg7SBEUi2X3yB4wSGyuM7OhBFkq1MXURgHLrv567iBP7JJmLinZLRiObIWJCYJrAQthzkUN0gG3+d+aR2WzmeZRQ2yNuzWgsqhokaxEwirRAsYC6ZctaJcXZYJmKgJjhSzTxYi1kPXauItC4fqB9Gw2rn4nnkK4GVLkbiIrdL2xRHSALYkOauKgypCe1unpvQcnuFhguGA40LhFoZyjpxNBaOo/tOJlU0p+Fil79KgtVw8pAI6d/Owtpt9Qo9VwNW7GxXFF/Viqu5lVWqgZsgUZ+/XZWmp2kcRBOlurpz0hF67rKSNXIJ9BIeN/OSKsTI4/sBevPxrSW3kyU5aXvE9/zXBN+AHGysHvGD9CSwL151oJD8kQJP0otl3cSTcIom9kusU3bNZ2ZZcwo/6fbmDHTtlwbQezNaFM1a5yyoH2UM4QqilDLRK+Uf3Y47QzhunbWQteja2dIdSUsBaivPXPSIfJtSB2ukcJ6UI0Oya+uUXFGFPV2U/IaiWUVcAHD4dJfFWwAMoxiiOSX0XRHQllXxKrrcgkJOBASg2mUzUjjwdQiLL9ppjsiyionVrUoS4gYw42NHQAypJqKt3dnV/FQ1lyxqkFawgMNh8cA+m0DjYG0Xby9E7uKxfNWgDefIwZY7mxvxqpw5j9RpEqp5ZJeK+LfdMMwuCRhbkt7ADk2oZiJ27RNGyIXW66HxHJd12sbUSq9nI6YVlTIloMMj+t0xGZdrW0h69HVWpU8uHH+QK43JVcoS43rFfkWItggxKJIxzpESUKcvnNGS2bZJzh2C5SzzZYmdtrGzLG2ZnZX0XkgMQ3TwAhBQDB8ZC9aS07ZHeqdyulkS8w3+zK/Tb0p816eWX53freW5LE7VDCJ6inEEuutAVgv0WS6Cv1wugtRyzPWR498PrpLVTTa9qTLPck04AKD48BeLvrtR8t2nvNqZbvOmKzfdRb7yPVtY9h725ioXXlT0P5Um8fl1stX30DDsSzH8ggGDjWoTQyPr9wGtxkYBMzx7Bm1DZFxta7PlSscRqdrJM/d7rZOoKj19Q+833iXVsGmckKLJHZLhG5Jv22b1LrXox7h0pJQt2s4f989ApFNV2WPoG0+WlmF9Tdepu0s6hMW0NJwLJYZu6uj4eEyctirb/dRPqSOb5nzubh4ODsXXj4jvp8KZn2G0aURYati5S4LdpXpLHe+3KWXl8zh607xWnkQifDRszDNFtgWsrVqs6LfilSaSdGU7EY4fa1YrpkJNT8vBqrFivvhkhNSQaVxvmYVvXj54uc4stOgrcVb+yFcxldMnAng4zj60/8B</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70010 ForNAV Warehouse Shipment
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=NLD=Warehouse Shipment;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;Header            ;
               DataItemTable=Table7320;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                END;

               ReqFilterFields=No.,Location Code }

    { 1000000001;1;DataItem;Line             ;
               DataItemTable=Table7321;
               DataItemTableView=SORTING(No.,Bin Code);
               CalcFields=Pick Qty.;
               DataItemLink=No.=FIELD(No.) }

    { 1000000002;2;DataItem;BOMComponent     ;
               DataItemTable=Table90;
               DataItemTableView=SORTING(Parent Item No.,Line No.);
               DataItemLink=Parent Item No.=FIELD(Item No.) }

    { 1000000003;2;DataItem;CommentLine      ;
               DataItemTable=Table44;
               DataItemTableView=SORTING(Document Type,No.,Document Line No.,Line No.)
                                 WHERE(Document Type=CONST(Order));
               DataItemLink=No.=FIELD(Source No.),
                            Document Line No.=FIELD(Source Line No.) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             PLK=Opcje;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Line': WITH Line DO CASE Operation OF
        END;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70011 ForNAV Warehouse Receipt
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=NLD=Warehouse Shipment;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;Header            ;
               DataItemTable=Table7316;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                END;

               ReqFilterFields=No.,Location Code }

    { 1000000001;1;DataItem;Line             ;
               DataItemTable=Table7317;
               DataItemTableView=SORTING(No.,Bin Code);
               DataItemLink=No.=FIELD(No.) }

    { 1000000002;2;DataItem;BOMComponent     ;
               DataItemTable=Table90;
               DataItemTableView=SORTING(Parent Item No.,Line No.);
               DataItemLink=Parent Item No.=FIELD(Item No.) }

    { 1000000003;2;DataItem;CommentLine      ;
               DataItemTable=Table43;
               DataItemTableView=SORTING(Document Type,No.,Document Line No.,Line No.)
                                 WHERE(Document Type=CONST(Order));
               DataItemLink=No.=FIELD(Source No.),
                            Document Line No.=FIELD(Source Line No.) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             PLK=Opcje;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Line': WITH Line DO CASE Operation OF
        END;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70050 ForNAV Tax Order Confirmation
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Objedn†vka;
               DAN=Ordre;
               DEU=Auftrag;
               ENU=Order;
               FIN=Tilaus;
               FRA=Commande;
               ISL=Pîntun;
               ITA=Ordine;
               NLD=Order;
               NOR=Ordre;
               SVE=Order;
               DES=Auftrag;
               ENG=Order;
               ESM=Pedido;
               FRB=Commande;
               ITS=Ordine;
               NLB=Order;
               DEA=Auftrag;
               ENA=Order;
               ESN=Pedido;
               FRC=Commande;
               ENC=Order;
               FRS=Commande;
               ENZ=Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Order));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70051 ForNAV Tax Sales Invoice
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Faktura;
               DAN=Faktura;
               DEU=Rechnung;
               ENU=Invoice;
               FIN=Lasku;
               FRA=Facture;
               ISL=Reikningur;
               ITA=Fattura;
               NLD=Factuur;
               NOR=Faktura;
               SVE=Faktura;
               DES=Rechnung;
               ENG=Invoice;
               ESM=Factura;
               FRB=Facture;
               ITS=Fattura;
               NLB=Factuur;
               DEA=Rechnung;
               ENA=Invoice;
               ESN=Factura;
               FRC=Facture;
               ENC=Invoice;
               FRS=Facture;
               ENZ=Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>H4QAAO1d63LbOJb+v1X7Dhxt1dqp0Si48AJOrOnyJe52tWN7bCfdNdtbLoqEbE4oUkNRiT27W7VPMw82T7IACVK8gBQoyY53ptPViUQRwMH5DoBzPoCHB989zgLtC40XfhSOB3AEBhoN3cjzw/vxYJlMf0cG3/3hX//l4Ockdq7pPIqTxbnzFC2TGxr7TuD/lcba6uOnoiJ9hEYGr61yaaBdODM6HoiaTqP4wvky0I6jMImj4PZpzn47oV/eP85juliMSo2OPp6VvqKh1nLbF97MMG9VG2u5JEPteBkky5iyayFdsiLBULtaTgLf/ZE+3UafKb/bs1yHUIKANdWpDpj8J/5iHjhPmdxc4MNP2q3zqN04AV1oZ+GXyHfpQKv0qOgzHgH2H9QRGWiXkz9TN7mIxgMLAAMOtFOfBt5PdMLU94XV8TEOxoM//v6Xy5CexP4X+stVHPESi1+yVn9h/yMAySh5TAbalXNPf6D+/UMyHiDL1rMrP/le8sAuQMPmF+Y0/tEPvfHgnCYJjQfaBye+98MFEwwwhbC7hhrinxDv6SlDYTw45FgONXueDDX3wYlvaDLmapj7rF5Dz3v6MfTZzbc0TB4Wl9PDD34Q+DOaNnIZXsU0u+uDs2CXbtzYnyeF9jLN3dLZPBjlX5zHAbMyTTs4ckJvkX5kX84SOoPCZH6gjsdrr9hKpu4TJ3H4rbwsszD6laviisbX1I1i1vskXjKEjp3ATVXOun84i5ZhwtBzgyU3de3T4e0wuzjQbqPECfI7TTA0GVbfx9FyXvkBM52Idj85cVXG/IdbZxKwy+k/EKLaD598+nU8uLm8vj27+H7/Ihq94cr9y6kfMJ3lzbDLw6tokXAhWWnej2juU/YLZKicsd4hXmpBE97pi+VsQuO8xykQeZM5CAOh3JquS/q+ptO0exJNZx0Uek67fBK5yxmzgqLrhZ0cOe7n4yiImDhHzFBTBMKbh9gPP48HUydYsCtX7BszksfL0OWA8S5Uf7sM37PJ6Sn7IeuVsCk2MtIh1mlUw7p4h0EQfc1U8T6Oo3iR13rj34cOnx7GA093TI/YOjVN4hhgApBFsO4YEFKILUhMz5sYbJ5ghTIh5JrIRufpeEAwmwQAgIOSqpmyhXoXlatVEHQpCLf0MTmKHgeVgXF3sqSZfdywiZi1iknaKtL1oWGPbPaH1XYeuQ6X+DSIHGYLEMP0J0KGmmllH/N54IbeR1T7eDbUyDzhF2OaoxkwZMtIc4EOA6ZA3v3x4IPveQG95r1nWojiv6a/sUk/u8LvHg/+/r9/KyTmJsqmmdTky30a5XfUVMSUdJM8BZRZSBT7yVOmLGOgfVzQTHhhQun3Qu7VxZrA4oe3dSTeplDI8EFZk6YKPsfLOM5mw7ubhI0cJ/aOnTlHYXHHxvJTgRhbboYmaIDEpmfDBC2wVEFI1ZrV2dTpSo5RXY5RWkZJy1ZTy3K9IZnecFYJ6WHXaQ/Oo+jzcr64u3KeOGS3NJ4tTugiHcesA2WjZypMRxtCUGLviGnTwqmlW4b5crbeKnir7Zf7PWorrgSZ/TwDA8sA1rMm+dq0PcLCPFfoohRaYEIBMjCbEAOwgtiWAjzUFlxJ46Mo8NaD3YCvkKo/dHlRJdggVMRNDo8ug8cQVaO+8BQzVmOZKWPSgkbn0rIBGusXjorM/ZYRiLdSuyFTuymq7rOe19QunIu67juUni3tNt7ZIKjKoKr7ciE1AFQXcjkApgwAS1SttGBLAbiM2bWLaJ3un8Hai5YVNZ7fr6ZsyXreQ9mWTNlEVL3xKn+8XCTRjMaS+b9N5zs39oYMarN9vZgaCKortBwEIgPBzqpGvRfiwuJLxt7imaIRxiyCgEOtzT1dr2qpCV9E2m+1vd9re+wfcUOPASAvrYQE2m7NtaWxHBB19150U9JhcXfkB8FdEh16Hme7KqCgdPXFiDR93YzfYaOCRbHyUdHL0b2N5ud0mqR8XiKcXHat4vRmNzRxzfoxqvejG055ITUUVZfwvqEgkOIrgnWktLofR7O5Ez6dhdMonqV4VbDuCTLEQEQ7O0dbRDAdcNdjnA5gm72ugNwP3ecK9KWRPhShPuob69cXr47oHsinz36rViMozUZjy/DkK1z7ylaiCnotZEjVm+gLjZRMgIJNQHJH48p3OZ/XPfbETS0+dIX3Fjha7Id8qBlkY0LgPLrP1td0o+VPUTQ7mzn3Ur86YzjZteV8lBZTw8Lur2ZpSA9FTI+VXInSCLhK+yPUhuTmDw3QMQKeiYqRq7lk9OktSlrGqg5DXyik4TsU8Tvu40qIFTT3TMtunSHFJCXJ1njUu0dGrP0SaVv9hOa9apg9l3sgjf2hCP5x7+Bf6v6RFXp6hlA7Fya4GUgww5O84BBbH7L2ClLxc634Uq4ACrIA9yEL5PxMjy0YA36DMadO6vSncfBz+QJVzuHgrWQfrblzU961wXJ/4TSKkureZnale0/ziuFAz8KjKGFzUL6Z2LZ12bXd2dwc7bXRmcta2sc0gAXQBGCDgAm2IdQ9ywTENCfABrrnEdew6QTykwiVfcy8pmL/Ehmg/9Ylt+EdTHdmMZhg6njpUg9abXesMTqO2ee0p6vhkV/6sAwS/9wPC+iyAfMf//5vjyfv2F+H79RCGk37zVjb29O+09ruL2iLvMRvtT0tIy9KHslpWkjcsr+n1vjecG+o7b3RWHXhMgiGWqf0nw5vr+m9v0ji9PtFpC56s2jeCd4LlaaUJLx6iELKblYXLC9R0mlHtUpCvL/74PiBugji/k4JxD2i/c7mf2CeDp83eiihKNIpQ3FXUwv/OVp9nqanU/anyzCdMrT9L07wRvuvmEUncaixL+/+583oz5Ef7u9p/82MT7am/DqKfh1Fv46iXqNIyeXii6PE5drVaRcd7o7gRNV1XU6MQVuysJsrYuwscQLf3WaZz1b172lyTu+dgHXO81O099+8k01c8hvVsEFbY4NUHV9Ud3yxwIY7NAonKPNvV07MpOJnDPMzbZUTkJxhahyBzJqQH4DEg64DkHmIofEjj7waLTsSmRdhlz4zVVImkys5a3meus7lSsanZ+/PT8TBSt4LXHNj6+cf6z6sLg/ZjyLvqRwmcFkX/OKaSOH5nP+SBCX/3yFw6njEoVPdQtS2TGPKwkxXNydTR/cMS7epY0LdqPn/pcqKEMAEEitviQIaWjQqikqRr+n152txdf2cUKZkJQ2zpq+jrzKRGmKZFbFYKblQ6Q8rXH8SZ67ByDAtG0CEdfFBLk6mKRpI1SSVy5LLwesoS5zuz67kksY/RZTP711Jbuq2TggLBiEkFrD51kZzruNtpLuufTYXmB2zef5rYcU3D9HXy2UyXyaiQjaDXqYL6icnWNL9Pd5F5luNx1qH/lIVyeZUssWcWqlcuvY1EMrXwXpo24ZQ9aCfIlSVQjlmaAQZaCbCACOGmmXgVsgq5Wt49NawIfEo1iuyvlvTUKTYuDHqDoVEkUl+QVdXIXOMzzyGvT/1+QrRMHyD6DoybBO2a7FWRT9ybWutb+MrNOGo7+o04BAbPEb9zH+bXf9x6TDNJE/qiKxKdIJxFDjh5z/ROMpZlxZ0VtW9MDD6ToGp7/E0gBHbPYahCAx/KCeafqDOIt3TVEWnVqwBEYIWwpBgvtHagkitiheGxdwpLPVtnAYsYkfHUF2p+V8n/sLljxdduYk6MI2CzdFjWUTHGNhQffQ0at0Krcoaf/IUOjPfXYiQgjU++sFZ5I2Nx6lc/fHd7Tpf3/Vp4Cs2gAzVdZ4bP5PY7TnkRJGmXwYJ0G1sAlsd01J9Lzv2zG04hyY29QOlDWzE4VJTwXVIsckf6lMFJr8/RwWOkE1sy9INpAOMddgDlOKBwpdFZLfeQ/10afn3rrimy6c+eNsSpLUVkpId4qd0q4aF2stZKBSAN3qWSx7sN594TMPF3T/u2D/gz2Uoh/yTiTHFQIfIJLaJyRRh15i4LgSOiT3HhgaFDp16spC/8dwiBFtE/aYh0Zdy7M+bXhP8a0cRP0OwYOpO9163YwNMUyLuDjgB7XCZRKf8Uenupa8XRWCqOh71A913bbZbU+X604hSZoGMCDAMNlFiZEHIjBBKNlJb5sr6Ee7GrJmJ1jiDnEu8joroP43KnY5CVS/HN5iqfkjtkaEVEdCGuzrMclbCHmEDEp3TSCayMD95vBneleq/MfCW3KPZIfCq/IjVhx9BmwHbwpUUQ5lYGACI+YnDzaDtZlJeHNxvQ61YqtRKdQjnPMf247dJwOQIIzZ+iWGwEbwpwq1sTIZi80ECCbor3zd3mfKkHVviLWdsdjiYVUkcS5XEqZoAD+wuc2JleztooXoKYzAQxMS08MYrdzcR9BosQk4W7dAiVPkjazM3rkbftNtE/ayoupW08k65nZimCU0Dm8Ta1E7WkVAbWcoL81KW3EWUHnHdoX2p8lfWZn5jQSU9h2VJeK/cpgxiGzaxCFKzqSxALuypOQvJ6bBXMAMRuYP53GajSq0RVWqtajYZ2VW2mS1XK8mkIdJ28RNY+6Wne2tPYMf8hMjTceSlZ7Xe7JXIPGtkQgiBgQjf0uCPZGw2e20qyK4nuf62J/d/d2hmL8oXtnQye8CnxMi191TWod4spELGo5anf2InXDQpxtLlb3amqCJDiWK0JwBgd8oDfsMh0PXsqQcsbLkQu4gCG7jYIK7j1ijGSnUrinGbg0XEkOjr9VKMxJSI+1opRrIxxdhiu5sxitZIB7pp2oBY0LSxjTcOUl8Bo0heDaNItmcUt4ZZzijqI5MghIGt69DGwNwY79fEKNqvhlG0+zCKeKeMYj6UsaUTgG0INg4dVRjFl/Sp7G/DKdpbcopbj+Amp7g7jHfLKW4H76uhEO3NKcSCktse9hYKUWBPiM55RJsYG28GPQOFuJ0BvBrG0N4NY9hqAs/AGBZmAaFppYc8/3n5Qvt184X2tnzhM9iVhC/MLcrCBgS2gfms+A/NF6aR6ismDCFQZQwvIvBKiEB9RICNMQGExZUIEDUb+kdiAiH4Z6ACIXgmLrAaUEOglN2H3+GHS+rdCYY8PyGaJ8mys9SxFpHmytJLyf7W5IxTfDR2fX6Y4vxs5xHXHnjIc/mom1h7wFsOdCFQy9dXB6SetQ/KU2RBZID1IPBJbKjJoRCp+kXz/fP15wV7aF4hdf9Kwc0odA373Z0OviUXMHcYmnl3Spe/Lf0tSaoDmA870XVCkT0BEx26HpwSPMUYOBB7uudB17SnfJulSX83MuvYbDybOrI258AhUMqzo/ZQvq5m9v+fjB4qPsCoOM3DHaZAwKs8YS25EXWwVtuvdp6H25JibfP8mmmo87UHUP5Wo+YMlO5cf+MZqCJDaQbCU3vqTAiCtuMRCDxC2HzkTi3dMz2L/esxD8HU+bPRzTP+zdxewEiTB9qSx6+V5yC19xqIr8ZqkgG2NTJN0zJECkMEcTOJ4SrJONR14R3J3lXWNR7K7/C4iOSJ7spZVsu39jB5iWuzzVxT7BfePDhzKk/5mf5U3dg0pKlUqqlseamsGj4lZDk7RBrO4vtNEtPEfcijocPwnqfysCUbtplGeJ256JZoo5wTZAtnTu1VAs3ky6aqZ42zny1zqKHUyGzEz2uuDVAlZtY+kYrQsP9UKnk9QB/HreaLqb0SoKlMsna9KmmRZEMVKb62qqKa4q18nw5vf1dV2jqtdhRV17fsJQDt+paR99V37Sgl623q21qrb5i+unFLe71ZTtKsPn29saJcD8VKEu+2K1ZGilfepqOYcL+hWFtNsVDPlkZ+FnqtYhtPUNU13aXKVI/9KaR+eG3WSA9w5YG9Oscio6krL+9RTMGv5HyDPpPZbi2hWCPKk1Wvma0PKvIsvOqoyEjgCvnbkn1/I1RgGZU8dXLrAO25xjC9M7e6fSHpHDxFwR6q77VsN7nSNYFOdXo8eNt4mWvDGxBegPApeZzBunW0nE6VXqvbnhSukQOuXrcsG5wF0ldkdeSDY+qcOfGT9iN9Evnb4CCNkqKYXZaddlub0A1iefxez+hWdGBtUrfypmG126P3j0zWROwP/GasgXfPGi5WZS7Fi1AnnuU4wPNMavKtsynRddNybc9j36COPNa36RTU4sVqfasTm2iLE5tQ7cUF4qtenw3yOBE0Q5xsRsiyrLe8AGetJ8Q6y62wfYaoAVzdCKqWVp8mZG8j2CJqVHvNgPiK2zXM65HqWOVdNRLllkdDb91WCvdQba+AfG0UqvZCAPEV9XEwOu12J7a6sXVuuWlQiz1bUu/LVQjr0bvRtSum26p54Dexx00tsJcP0Awle+U9SZPjqyQ+aXMWVu3X7zjI2pG8LD7zS6kYqqvDNNEydun7x3lcnLx4oO7n4jUS4iRN+VTNfuZP5Gs9yP9IXeNVsXKXubrKcpY7X+7SwTV1mQdc3FZeonjS14soe3quzXddtVmZe9NMp1H6iigudoNXrBXL55U0E6koBqvFimzD6f5RIGs8H1o8b2hWi11vPJ9H85IHb1f9P3j7cxI7md+7OHeeomVyQzmtykZe/If/Aw==</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70052 ForNAV Tax Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Dobropis;
               DAN=Kreditnota;
               DEU=Gutschrift;
               ENU=Credit Memo;
               FIN=Hyvityslasku;
               FRA=Avoir;
               ISL=Kreditreikningur;
               ITA=Nota credito;
               NLD=Creditnota;
               NOR=Kreditnota;
               SVE=Kreditnota;
               DES=Gutschrift;
               ENG=Credit Memo;
               ESM=Nota de crÇdito;
               FRB=Avoir;
               ITS=Nota credito;
               NLB=Creditnota;
               DEA=Gutschrift;
               ENA=CR/Adj Note;
               ESN=Abono;
               FRC=Note de crÇdit;
               ENC=Credit Memo;
               FRS=Avoir;
               ENZ=Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table114;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table115;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70054 ForNAV Tax Sales Quote
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=ENU=Quote;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70100 ForNAV VAT Purchase Order
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° objedn†vka;
               DAN=K˚bsordre;
               DEU=Einkaufsbestellung;
               ENU=Purchase Order;
               FIN=Ostotilaus;
               FRA=Commande achat;
               ISL=Innkaupapîntun;
               ITA=Ordine acquisto;
               NLD=Inkooporder;
               NOR=Bestilling;
               SVE=Inkîpsorder;
               DES=Einkaufsbestellung;
               ENG=Purchase Order;
               ESM=Pedido compra;
               FRB=Commande achat;
               ITS=Ordine acquisto;
               NLB=Inkooporder;
               DEA=Einkaufsbestellung;
               ENA=Purchase Order;
               ESN=Pedido compra;
               FRC=Bon de commande;
               ENC=Purchase Order;
               FRS=Commande achat;
               ENZ=Purchase Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(Document Type,No.)
                                 WHERE(Document Type=CONST(Order));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70101 ForNAV VAT Purchase Invoice
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° faktura;
               DAN=K˚bsfaktura;
               DEU=Einkaufsrechnung;
               ENU=Purchase Invoice;
               FIN=Ostolasku;
               FRA=Facture achat;
               ISL=Innkaupareikningur;
               ITA=Fattura acquisto;
               NLD=Inkoopfactuur;
               NOR=Kj˚psfaktura;
               SVE=Inkîpsfaktura;
               DES=Einkaufsrechnung;
               ENG=Purchase Invoice;
               ESM=Factura compra;
               FRB=Facture achat;
               ITS=Fattura acquisto;
               NLB=Inkoopfactuur;
               DEA=Einkaufsrechnung;
               ENA=Purchase Invoice;
               ESN=Factura compra;
               FRC=Facture achat;
               ENC=Purchase Invoice;
               FRS=Facture achat;
               ENZ=Purchase Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70102 ForNAV VAT Purchase Cr. Memo
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° dobropis;
               DAN=K˚bskreditnota;
               DEU=Einkaufsgutschrift;
               ENU=Purchase Credit Memo;
               FIN=Ostohyvityslasku;
               FRA=Avoir achat;
               ISL=Innkaupakreditreikningur;
               ITA=Nota credito acquisto;
               NLD=Inkoopcreditnota;
               NOR=Kj˚pskreditnota;
               SVE=Inkîpskreditnota;
               DES=Einkaufsgutschrift;
               ENG=Purchase Credit Memo;
               ESM=Nota crÇdito compra;
               FRB=Avoir achat;
               ITS=Nota credito acquisto;
               NLB=Inkoopcreditnota;
               DEA=Einkaufsgutschrift;
               ENA=Purchase CR/Adj Note;
               ESN=Abono compra;
               FRC=Note de crÇdit d'achat;
               ENC=Purchase Credit Memo;
               FRS=Avoir achat;
               ENZ=Purchase Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table124;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table125;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70104 ForNAV VAT Purchase Quote
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° popt†vka;
               DAN=K˚bsrekvisition;
               DEU=Einkaufsanfrage;
               ENU=Purchase Quote;
               FIN=Ostotarjous;
               FRA=Demande de prix;
               ISL=Innkaupabei˜ni;
               ITA=Offerta acquisto;
               NLD=Inkoopofferte;
               NOR=Foresp˚rsel;
               SVE=Inkîpsoffert;
               DES=Einkaufsofferte;
               ENG=Purchase Quote;
               ESM=Cotizaci¢n compra;
               FRB=Demande de prix;
               ITS=Offerta acquisto;
               NLB=Inkoopofferte;
               DEA=Einkaufsanfrage;
               ENA=Purchase Quote;
               ESN=Oferta compra;
               FRC=Devis d'achat;
               ENC=Purchase Quote;
               FRS=Demande de prix;
               ENZ=Purchase Quote];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70150 ForNAV Tax Purchase Order
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° objedn†vka;
               DAN=K˚bsordre;
               DEU=Einkaufsbestellung;
               ENU=Purchase Order;
               FIN=Ostotilaus;
               FRA=Commande achat;
               ISL=Innkaupapîntun;
               ITA=Ordine acquisto;
               NLD=Inkooporder;
               NOR=Bestilling;
               SVE=Inkîpsorder;
               DES=Einkaufsbestellung;
               ENG=Purchase Order;
               ESM=Pedido compra;
               FRB=Commande achat;
               ITS=Ordine acquisto;
               NLB=Inkooporder;
               DEA=Einkaufsbestellung;
               ENA=Purchase Order;
               ESN=Pedido compra;
               FRC=Bon de commande;
               ENC=Purchase Order;
               FRS=Commande achat;
               ENZ=Purchase Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(Document Type,No.)
                                 WHERE(Document Type=CONST(Order));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70151 ForNAV Tax Purchase Invoice
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° faktura;
               DAN=K˚bsfaktura;
               DEU=Einkaufsrechnung;
               ENU=Purchase Invoice;
               FIN=Ostolasku;
               FRA=Facture achat;
               ISL=Innkaupareikningur;
               ITA=Fattura acquisto;
               NLD=Inkoopfactuur;
               NOR=Kj˚psfaktura;
               SVE=Inkîpsfaktura;
               DES=Einkaufsrechnung;
               ENG=Purchase Invoice;
               ESM=Factura compra;
               FRB=Facture achat;
               ITS=Fattura acquisto;
               NLB=Inkoopfactuur;
               DEA=Einkaufsrechnung;
               ENA=Purchase Invoice;
               ESN=Factura compra;
               FRC=Facture achat;
               ENC=Purchase Invoice;
               FRS=Facture achat;
               ENZ=Purchase Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70152 ForNAV Tax Purchase Cr. Memo
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° dobropis;
               DAN=K˚bskreditnota;
               DEU=Einkaufsgutschrift;
               ENU=Purchase Credit Memo;
               FIN=Ostohyvityslasku;
               FRA=Avoir achat;
               ISL=Innkaupakreditreikningur;
               ITA=Nota credito acquisto;
               NLD=Inkoopcreditnota;
               NOR=Kj˚pskreditnota;
               SVE=Inkîpskreditnota;
               DES=Einkaufsgutschrift;
               ENG=Purchase Credit Memo;
               ESM=Nota crÇdito compra;
               FRB=Avoir achat;
               ITS=Nota credito acquisto;
               NLB=Inkoopcreditnota;
               DEA=Einkaufsgutschrift;
               ENA=Purchase CR/Adj Note;
               ESN=Abono compra;
               FRC=Note de crÇdit d'achat;
               ENC=Purchase Credit Memo;
               FRS=Avoir achat;
               ENZ=Purchase Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table124;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table125;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70154 ForNAV Tax Purchase Quote
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:11;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N†kupn° popt†vka;
               DAN=K˚bsrekvisition;
               DEU=Einkaufsanfrage;
               ENU=Purchase Quote;
               FIN=Ostotarjous;
               FRA=Demande de prix;
               ISL=Innkaupabei˜ni;
               ITA=Offerta acquisto;
               NLD=Inkoopofferte;
               NOR=Foresp˚rsel;
               SVE=Inkîpsoffert;
               DES=Einkaufsofferte;
               ENG=Purchase Quote;
               ESM=Cotizaci¢n compra;
               FRB=Demande de prix;
               ITS=Offerta acquisto;
               NLB=Inkoopofferte;
               DEA=Einkaufsanfrage;
               ENA=Purchase Quote;
               ESN=Oferta compra;
               FRC=Devis d'achat;
               ENC=Purchase Quote;
               FRS=Demande de prix;
               ENZ=Purchase Quote];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70201 ForNAV Customer Top 10 List
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=10:52:51;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Nejlep °ch 10 z†kazn°ku;
               DAN=Debitor - top 10-liste;
               DEU=Top 10 Liste (Debitoren);
               ENU=Customer Top 10 List;
               FIN=Asiakkaat - 10 pÑÑasiakasta;
               FRA=Clients - Palmaräs;
               ISL=Vi˜skiptama˜ur - 10 efstu;
               ITA=Lista primi 10 clienti;
               NLD=Klanten - Top 10;
               NOR=Kunde - ti pÜ topp-liste;
               RUS=‡âäÜ°ï - ãÜ˜ÉÖò ÑÜ§òïàÖ;
               SVE=Kunder, 10 i topp;
               DES=Top 10 Liste (Debitoren);
               ENG=Customer Top 10 List;
               FRB=Clients - Palmaräs;
               ITS=Lista primi 10 clienti;
               NLB=Klanten - Top 10;
               DEA=Top 10 Liste (Debitoren);
               ENA=Customer Top 10 List;
               ESN=Los 10 mejores clientes;
               FRS=Clients - Palmaräs;
               ENZ=Customer Top 10 List];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;                    ;
               DataItemTable=Table18;
               DataItemTableView=SORTING(Net Change (LCY))
                                 ORDER(Descending);
               OnAfterGetRecord=BEGIN
                                  i += 1;
                                  IF i = NoOfRecordsToPrint THEN
                                    CurrReport.BREAK;
                                END;

               ReqFilterFields=No.,Name,Customer Posting Group,Country/Region Code,Date Filter;
               CalcFields=Balance (LCY),Net Change (LCY) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   IF NoOfRecordsToPrint = 0 THEN
                     NoOfRecordsToPrint := 10;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 1   ;2   ;Field     ;
                  CaptionML=[DAN=Antal;
                             DEU=Menge;
                             ENU=Quantity;
                             ESP=Cantidad;
                             FIN=MÑÑrÑ;
                             FRA=QuantitÇ;
                             ISL=Magn;
                             ITA=QuantitÖ;
                             NLD=Aantal;
                             NOR=Antall];
                  ToolTipML=ENU=Specifies the number of customers that will be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfRecordsToPrint }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      NoOfRecordsToPrint@1000 : Integer;
      i@1001 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70202 ForNAV Vendor Top 10 List
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=10:53:03;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Dodavatel - nejlep °ch 10;
               DAN=Kreditor - top 10-liste;
               DEU=HÑndler Top-10-Liste;
               ENU=Vendor Top 10 List;
               FIN=10 pÑÑtoimittajaa;
               FRA=Palmaräs fournisseurs;
               ISL=10 efstu l†nardrottnar;
               ITA=Lista primi 10 fornitori;
               NLD=Lijst top 10 leveranciers;
               NOR=Leverand˚r - topp 10-liste;
               RUS=Áå§ïÖÉóäàä - ãÜ˜ÉÖò ÑÜ§òïàÖ;
               SVE=10 i topp leverantîrer;
               DES=HÑndler Top-10-Liste;
               ENG=Vendor Top 10 List;
               FRB=Palmaräs fournisseurs;
               ITS=Lista primi 10 fornitori;
               NLB=Lijst top 10 leveranciers;
               DEA=HÑndler Top-10-Liste;
               ENA=Vendor Top 10 List;
               ESN=Listado 10 mejores proveedores;
               FRS=Palmaräs fournisseurs;
               ENZ=Vendor Top 10 List];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;                    ;
               DataItemTable=Table23;
               DataItemTableView=SORTING(Net Change (LCY))
                                 ORDER(Descending);
               OnAfterGetRecord=BEGIN
                                  i += 1;
                                  IF i = NoOfRecordsToPrint THEN
                                    CurrReport.BREAK;
                                END;

               ReqFilterFields=No.,Name,Vendor Posting Group,Country/Region Code,Date Filter;
               CalcFields=Balance (LCY),Net Change (LCY) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   IF NoOfRecordsToPrint = 0 THEN
                     NoOfRecordsToPrint := 10;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 1   ;2   ;Field     ;
                  CaptionML=[DAN=Antal;
                             DEU=Menge;
                             ENU=Quantity;
                             ESP=Cantidad;
                             FIN=MÑÑrÑ;
                             FRA=QuantitÇ;
                             ISL=Magn;
                             ITA=QuantitÖ;
                             NLD=Aantal;
                             NOR=Antall];
                  ToolTipML=ENU=Specifies the number of vendors that will be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfRecordsToPrint }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      NoOfRecordsToPrint@1000 : Integer;
      i@1001 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70206 ForNAV Trial Balance
{
  OBJECT-PROPERTIES
  {
    Date=07-02-18;
    Time=11:38:02;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Predvaha;
               DAN=Balance;
               DEU=Rohbilanz;
               ENU=Trial Balance;
               FIN=Alustava saldo;
               FRA=Balance;
               ISL=Pr¢fjîfnu˜ur;
               ITA=Bilancio di verifica;
               NLD=Proefbalans;
               NOR=RÜbalanse;
               RUS=Á˜å†°ñÇ †ÖâÖ°§;
               SVE=RÜbalans;
               DES=Bilanz;
               ENG=Trial Balance;
               FRB=Balance;
               ITS=Bilancio di verifica;
               NLB=Proefbalans;
               DEA=Rohbilanz;
               ENA=Trial Balance;
               ESN=Balance comprobaci¢n;
               FRS=Balance;
               ENZ=Trial Balance];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  Args."From Date" := "G/L Account".GETRANGEMIN("Date Filter");
                  Args."To Date" := "G/L Account".GETRANGEMAX("Date Filter");
                  "G/L Account".SETRANGE("Date Filter");

                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000001;;DataItem;Args              ;
               DataItemTable=Table70205;
               DataItemTableView=SORTING(Show by);
               OnPreDataItem=BEGIN
                               INSERT;
                             END;

               Temporary=Yes }

    { 6710;1   ;DataItem;                    ;
               DataItemTable=Table15;
               DataItemTableView=SORTING(No.);
               PrintOnlyIfDetail=Yes;
               OnAfterGetRecord=BEGIN
                                  TrialBalance.CreateForGLAccount("G/L Account", Args);
                                END;

               ReqFilterFields=No.,Account Type,Date Filter,Global Dimension 1 Filter,Global Dimension 2 Filter,Budget Filter }

    { 1000000002;1;DataItem;TrialBalance     ;
               DataItemTable=Table70206;
               DataItemTableView=SORTING(G/L Account No.);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   IF Args.GetNoOfColumns = 0 THEN BEGIN
                     Args."Net Change Actual" := TRUE;
                     Args."Net Change Actual Last Year" := TRUE;
                   END;
                   Args."All Amounts in LCY" := TRUE;
                 END;

    }
    CONTROLS
    {
      { 1020001;0;Container ;
                  ContainerType=ContentArea }

      { 1020000;1;Group     ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 4   ;2   ;Field     ;
                  Name=ShowComaprison;
                  CaptionML=[DAN=Vis efter;
                             DEU=Anzeigen nach;
                             ENU=Show by;
                             ESP=Mostrar por;
                             FIN=NÑyttîperuste;
                             FRA=Afficher par;
                             ISL=SÏna eftir;
                             ITA=Mostra per;
                             NLD=Tonen op;
                             NOR=Vis etter];
                  ToolTipML=ENU=Specifies if figures either from the prior year or for the defined budget are included.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Show by" }

      { 19  ;2   ;Group     ;
                  CaptionML=[DAN=Kolonneindstilling;
                             DEU=Spaltenoption;
                             ENU=Column Option;
                             ESP=Opci¢n columna;
                             FIN=Sarakevaihtoehto;
                             FRA=Option colonne;
                             ISL=D†lka–ger–;
                             ITA=Opzione colonna;
                             NLD=kolomoptie;
                             NOR=Kolonnealternativ] }

      { 1000000000;3;Field  ;
                  CaptionML=[DAN=Faktisk bevëgelse;
                             DEU=NettoÑnderung - Ist;
                             ENU=Net Change Actual;
                             ESP=Saldo periodo real;
                             FIN=Nettomuutos, toteutunut;
                             FRA=Solde pÇriode - RÇel;
                             ISL=Raunveruleg nett¢breyting;
                             ITA=Saldo periodo effettivo;
                             NLD=Mutatie werkelijk;
                             NOR=Faktisk bevegelse];
                  SourceExpr=Args."Net Change Actual" }

      { 1000000001;3;Field  ;
                  CaptionML=[DAN=Faktisk bevëgelse sidste Ür;
                             DEU=NettoÑnderung - Ist - Vorjahr;
                             ENU=Net Change Actual Last Year;
                             ESP=Saldo periodo real el a§o anterior;
                             FIN=Nettomuutos, toteutunut edellisenÑ vuonna;
                             FRA=Solde pÇriode - RÇel dernier exercice;
                             ISL=Raunveruleg nett¢breyting s°–asta †rs;
                             ITA=Saldo periodo effettivo anno precedente;
                             NLD=Mutatie werkelijk vorig jaar;
                             NOR=Faktisk bevegelse i fjor];
                  SourceExpr=Args."Net Change Actual Last Year" }

      { 1000000002;3;Field  ;
                  CaptionML=[DAN=Difference;
                             DEU=Abweichung;
                             ENU=Difference;
                             ESP=Diferencia;
                             FIN=Ero;
                             FRA=DiffÇrence;
                             ISL=Mismunur;
                             ITA=Differenza;
                             NLD=Verschil;
                             NOR=Differanse];
                  SourceExpr=Args."Variance in Changes" }

      { 1000000003;3;Field  ;
                  CaptionML=[DAN=Variansprocent;
                             DEU=Abweichung %;
                             ENU=Variance %;
                             ESP=% de desviaci¢n;
                             FIN=Vaihtelu-%;
                             FRA=% Çcart;
                             ISL=Fr†vik ° %;
                             ITA=% scostamento;
                             NLD=Verschil %;
                             NOR=Avviks-%];
                  SourceExpr=Args."% Variance in Changes" }

      { 1000000004;3;Field  ;
                  CaptionML=[DAN=Faktisk saldo til dato;
                             DEU=Saldo bis Datum - Ist;
                             ENU=Balance at Date Actual;
                             ESP=Saldo a la fecha real;
                             FIN=Pvm:n saldo, toteutunut;
                             FRA=Solde au - RÇel;
                             ISL=Raunsta–a til dags;
                             ITA=Saldo alla data effettivo;
                             NLD=Saldo op datum werkelijk;
                             NOR=Faktisk saldo per dato];
                  SourceExpr=Args."Balance at Date Actual" }

      { 1000000005;3;Field  ;
                  CaptionML=[DAN=Faktisk saldo til dato sidste Ür;
                             DEU=Saldo bis Datum - Ist - Vorjahr;
                             ENU=Balance at Date Act. Last Year;
                             ESP=Saldo a la fecha real del a§o anterior;
                             FIN=Pvm:n saldo, toteutunut edellisenÑ vuonna;
                             FRA=Solde au - RÇel dernier exercice;
                             ISL=Nett¢sta–a til dags fyrir s°–asta †r;
                             ITA=Saldo alla data anno precedente effet.;
                             NLD=Saldo op datum werkelijk vorig jaar;
                             NOR=Fakt. saldo per dato i fjor];
                  SourceExpr=Args."Balance at Date Act. Last Year" }

      { 1000000006;3;Field  ;
                  CaptionML=[DAN=Difference;
                             DEU=Abweichung;
                             ENU=Difference;
                             ESP=Diferencia;
                             FIN=Ero;
                             FRA=DiffÇrence;
                             ISL=Mismunur;
                             ITA=Differenza;
                             NLD=Verschil;
                             NOR=Differanse];
                  SourceExpr=Args."Variance in Balances" }

      { 1000000007;3;Field  ;
                  CaptionML=[DAN=Variansprocent;
                             DEU=Abweichung %;
                             ENU=Variance %;
                             ESP=% de desviaci¢n;
                             FIN=Vaihtelu-%;
                             FRA=% Çcart;
                             ISL=Fr†vik ° %;
                             ITA=% scostamento;
                             NLD=Verschil %;
                             NOR=Avviks-%];
                  SourceExpr=Args."% Variance in Balances" }

      { 1000000008;2;Field  ;
                  CaptionML=[DAN=Afrundingsfaktor;
                             DEU=Rundungsfaktor;
                             ENU=Rounding Factor;
                             ESP=Factor redondeo;
                             FIN=Pyîristyskerroin;
                             FRA=UnitÇ d'affichage;
                             ISL=SlÇttunarstu–ull;
                             ITA=Fattore arrotondamento;
                             NLD=Afrondingsfactor;
                             NOR=Avrundingsfaktor];
                  SourceExpr=Args."Rounding Factor" }

      { 1000000009;2;Field  ;
                  CaptionML=ENU=Skip Accounts with all zero Amounts;
                  SourceExpr=Args."Skip Accounts with all zero";
                  Visible=FALSE }

      { 1000000010;2;Field  ;
                  CaptionML=[DAN=Alle belõb i RV;
                             DEU=Alle BetrÑge in MW;
                             ENU=All Amounts in LCY;
                             FIN=Kaikki summat PVA;
                             FRA=Tous les montants DS;
                             ISL=Allar upphë–ir ° SGM;
                             ITA=Tutti gli importi in VL;
                             NLD=Alle bedragen in LV;
                             NOR=Alle belõp i NOK;
                             SVE=Alla belopp i BVA];
                  SourceExpr=Args."All Amounts in LCY" }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      This report is based on 10022 Trial Balance.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70210 ForNAV Customer Payments
{
  OBJECT-PROPERTIES
  {
    Date=02-02-18;
    Time=12:02:49;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[DAN=Debitor Betalinger;
               DEU=Debitor Zahlungen;
               ENU=Customer Payments;
               ESP=Cliente Pagos;
               FIN=Asiakas Maksut;
               FRA=Client Paiements;
               ISL=Vi˜skiptama˜ur Grei˜slur;
               ITA=Cliente Pagamenti;
               NLD=Klant Betalingen;
               NOR=Kunde Betalinger];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  SalespersonFilterString := CustLedgerEntry.GETFILTER("Salesperson Code");
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 8503;    ;DataItem;CustLedgerEntry     ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Customer No.,Document Type,Posting Date)
                                 WHERE(Document Type=FILTER(Payment|Credit Memo));
               OnPreDataItem=BEGIN
                               SETRANGE("Salesperson Code");
                             END;

               OnAfterGetRecord=BEGIN
                                  CALCFIELDS("Amount (LCY)");
                                  GetAppliedCustEntries(CustLedgerEntry,TRUE);
                                END;

               ReqFilterFields=Posting Date,Global Dimension 1 Code,Global Dimension 2 Code,Salesperson Code,Customer No.;
               CalcFields=Remaining Amt. (LCY),Amount (LCY) }

    { 1000000000;1;DataItem;TempAppliedCustLedgEntry;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Entry No.);
               OnPreDataItem=BEGIN
                               SETFILTER("Salesperson Code", SalespersonFilterString);
                             END;

               OnAfterGetRecord=BEGIN
                                  CALCFIELDS("Remaining Amt. (LCY)", "Amount (LCY)");
                                END;

               CalcFields=Original Amt. (LCY),Amount (LCY);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      SalespersonFilterString@1480002 : Text;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    PROCEDURE GetAppliedCustEntries@1020000(CustLedgEntry@1020001 : Record 21;UseLCY@1480000 : Boolean);
    VAR
      DtldCustLedgEntry@1020003 : Record 379;
      PmtDtldCustLedgEntry@1020004 : Record 379;
      PmtCustLedgEntry@1020015 : Record 21;
      ClosingCustLedgEntry@1020002 : Record 21;
      AmountToApply@1020005 : Decimal;
      AppliedDtldCustLedgEntry@1000000001 : Record 379;
    BEGIN
      TempAppliedCustLedgEntry.RESET;
      TempAppliedCustLedgEntry.DELETEALL;
      DtldCustLedgEntry.SETCURRENTKEY("Cust. Ledger Entry No.");
      DtldCustLedgEntry.SETRANGE("Cust. Ledger Entry No.",CustLedgEntry."Entry No.");
      DtldCustLedgEntry.SETRANGE(Unapplied,FALSE);
      IF DtldCustLedgEntry.FIND('-') THEN
        REPEAT
          IF DtldCustLedgEntry."Cust. Ledger Entry No." = DtldCustLedgEntry."Applied Cust. Ledger Entry No." THEN BEGIN
            AppliedDtldCustLedgEntry.INIT;
            AppliedDtldCustLedgEntry.SETCURRENTKEY("Applied Cust. Ledger Entry No.","Entry Type");
            AppliedDtldCustLedgEntry.SETRANGE("Applied Cust. Ledger Entry No.",DtldCustLedgEntry."Applied Cust. Ledger Entry No.");
            AppliedDtldCustLedgEntry.SETRANGE("Entry Type",AppliedDtldCustLedgEntry."Entry Type"::Application);
            AppliedDtldCustLedgEntry.SETRANGE(Unapplied,FALSE);
            IF AppliedDtldCustLedgEntry.FIND('-') THEN
              REPEAT
                IF AppliedDtldCustLedgEntry."Cust. Ledger Entry No." <> AppliedDtldCustLedgEntry."Applied Cust. Ledger Entry No."
                THEN BEGIN
                  IF ClosingCustLedgEntry.GET(AppliedDtldCustLedgEntry."Cust. Ledger Entry No.") THEN BEGIN
                    TempAppliedCustLedgEntry := ClosingCustLedgEntry;
                    IF UseLCY THEN
                      TempAppliedCustLedgEntry."Amount to Apply" := -AppliedDtldCustLedgEntry."Amount (LCY)"
                    ELSE
                      TempAppliedCustLedgEntry."Amount to Apply" := -AppliedDtldCustLedgEntry.Amount;
                    IF TempAppliedCustLedgEntry.INSERT THEN ;
                  END;
                END;
              UNTIL AppliedDtldCustLedgEntry.NEXT = 0;
          END ELSE BEGIN
            IF ClosingCustLedgEntry.GET(DtldCustLedgEntry."Applied Cust. Ledger Entry No.") THEN BEGIN
              TempAppliedCustLedgEntry := ClosingCustLedgEntry;
              IF UseLCY THEN
                TempAppliedCustLedgEntry."Amount to Apply" := DtldCustLedgEntry."Amount (LCY)"
              ELSE
                TempAppliedCustLedgEntry."Amount to Apply" := DtldCustLedgEntry.Amount;
              IF TempAppliedCustLedgEntry.INSERT THEN ;
            END;
          END;
        UNTIL DtldCustLedgEntry.NEXT = 0;
      IF CustLedgEntry."Closed by Entry No." <> 0 THEN BEGIN
        IF ClosingCustLedgEntry.GET(CustLedgEntry."Closed by Entry No.") THEN BEGIN
          TempAppliedCustLedgEntry := ClosingCustLedgEntry;
          IF UseLCY THEN
            TempAppliedCustLedgEntry."Amount to Apply" := -CustLedgEntry."Closed by Amount (LCY)"
          ELSE
            TempAppliedCustLedgEntry."Amount to Apply" := -CustLedgEntry."Closed by Amount";
          IF TempAppliedCustLedgEntry.INSERT THEN ;
        END;
      END;
      ClosingCustLedgEntry.RESET;
      ClosingCustLedgEntry.SETCURRENTKEY("Closed by Entry No.");
      ClosingCustLedgEntry.SETRANGE("Closed by Entry No.",CustLedgEntry."Entry No.");
      IF ClosingCustLedgEntry.FIND('-') THEN
        REPEAT
          TempAppliedCustLedgEntry := ClosingCustLedgEntry;
          IF UseLCY THEN
            TempAppliedCustLedgEntry."Amount to Apply" := ClosingCustLedgEntry."Closed by Amount (LCY)"
          ELSE
            TempAppliedCustLedgEntry."Amount to Apply" := ClosingCustLedgEntry."Closed by Amount";
          IF TempAppliedCustLedgEntry.INSERT THEN ;
        UNTIL ClosingCustLedgEntry.NEXT = 0;
      IF TempAppliedCustLedgEntry.ISEMPTY THEN BEGIN
        TempAppliedCustLedgEntry.INIT;
        TempAppliedCustLedgEntry."Entry No." := 0;
        TempAppliedCustLedgEntry."Salesperson Code" := CustLedgEntry."Salesperson Code";
        TempAppliedCustLedgEntry.INSERT;
      //  ApplicationExist := FALSE;
      END;
      // ELSE
      //  ApplicationExist := TRUE;
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'CustLedgerEntry': WITH CustLedgerEntry DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Amount (LCY)");
                ReportForNav.AddTotal(DataItemId,1,"Remaining Amt. (LCY)");
              END;
           'Restore': BEGIN
                 "Amount (LCY)" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Remaining Amt. (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70215 ForNAV Salesperson-Commission
{
  OBJECT-PROPERTIES
  {
    Date=07-02-18;
    Time=09:24:55;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Provize prodejce;
               DAN=Salgsprovision;
               DEU=VerkÑufer - Provision;
               ENU=Salesperson Commission;
               FIN=MyyjÑn provisio;
               FRA=Commission vendeurs;
               ISL=Sîlumenn - Sîlulaun;
               ITA=Commissioni agente;
               NLD=Verkoper - Provisie;
               NOR=Selgerprovisjon;
               RUS=‡åçä§§äå°°ñÜ çÜ°ÜÑëÜ˜Ö ãå ã˜åÑÖëÖç;
               SVE=SÑljarprovision;
               DES=VerkÑufer - Provision;
               ENG=Salesperson Commission;
               ESM=Vendedor: comisi¢n;
               FRB=Commission vendeurs;
               ITS=Commissioni agente;
               NLB=Verkoper - Provisie;
               DEA=VerkÑufer - Provision;
               ENA=Salesperson Commission;
               ESN=Vendedor: comisi¢n;
               FRC=Commission du reprÇsentant;
               ENC=Salesperson Commission;
               FRS=Commission vendeurs;
               ENZ=Salesperson Commission];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;Args              ;
               DataItemTable=Table70215;
               OnPreDataItem=BEGIN
                               INSERT;
                             END;

               Temporary=Yes }

    { 3065;    ;DataItem;SalespersonPurchaser;
               DataItemTable=Table13;
               DataItemTableView=SORTING(Code);
               PrintOnlyIfDetail=Yes;
               OnPreDataItem=BEGIN
                               ReportForNav.GetDataItem('SalespersonPurchaser').NewPagePerRecord := Args."New Page per Person";
                             END;

               ReqFilterFields=Code }

    { 8503;1   ;DataItem;CustLedgerEntry     ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Salesperson Code,Posting Date)
                                 WHERE(Document Type=FILTER(Invoice|Credit Memo));
               OnAfterGetRecord=VAR
                                  CostCalcMgt@1000 : Codeunit 5836;
                                BEGIN
                                END;

               ReqFilterFields=Posting Date;
               DataItemLink=Salesperson Code=FIELD(Code) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1000000000;2;Field  ;
                  Name=NewPagePerPerson;
                  CaptionML=[DAN=Skift side pr. sëlger;
                             DEU=Neue Seite pro VerkÑufer;
                             ENU=New Page per Person;
                             NLD=Nieuwe pagina per persoon];
                  ToolTipML=[DAN=Angiver, om oplysninger om hver enkelt person udskrives pÜ en ny side, hvis du har valgt to eller flere personer, der skal medtages i rapporten.;
                             DEU=Gibt an, ob die Informationen der einzelnen Personen jeweils auf einer neuen Seite gedruckt werden, wenn Sie fÅr den Bericht zwei oder mehr Personen ausgewÑhlt haben.;
                             ENU=Specifies if each person's information is printed on a new page if you have chosen two or more persons to be included in the report.;
                             NLD=Hiermee wordt opgegeven of de gegevens van de persoon op een nieuwe pagina moeten worden afgedrukt als u hebt opgegeven dat u twee of meer personen in het rapport wilt opnemen.];
                  SourceExpr=Args."New Page per Person" }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'SalespersonPurchaser': WITH SalespersonPurchaser DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,CustLedgerEntry."Sales (LCY)");
                ReportForNav.AddTotal(DataItemId,1,CustLedgerEntry."Profit (LCY)");
              END;
           'Restore': BEGIN
                 CustLedgerEntry."Sales (LCY)" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 CustLedgerEntry."Profit (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'CustLedgerEntry': WITH CustLedgerEntry DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Sales (LCY)");
                ReportForNav.AddTotal(DataItemId,1,"Profit (LCY)");
                ReportForNav.AddTotal(DataItemId,2,"Sales (LCY)");
                ReportForNav.AddTotal(DataItemId,3,"Profit (LCY)");
              END;
           'Restore': BEGIN
                 "Sales (LCY)" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Profit (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Sales (LCY)" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Profit (LCY)" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>nWIAAO1dbW/jSHL+HiD/gacgN1bWI5PdTbI5Ht3CrzPG2h7B9nguCYJBi2zaHFOijqI8491bID9mcd8CHBDgkO/+J/klqeaLxJcmRdry5j6svWubzX6peqq6u6q6WvP2+28TX7nn4dwLpsOeNlB7Cp/ageNNb4a9ReS+pr3v//CP//D2j1HILvgsCKP5KXsIFtElDz3mez/yUFn9eb3siAzQQBe9FYp6yjmb8GEv7ek4CM/ZfU85CKZRGPhXDzN4d8jvj77NQj6fD3KDDj6e5B7RtlJT7V4Ms52NqgyVjJJt5WDhR4uQQ9mUL6CJv62MFmPfs3/gD1fBHRe1HdNmlFOkmi7hRAX6D735zGcPCd2C4L1r5ZL5fD6DIYLp64NgMvHmYrCeUmBryTgeqPCtEUR7yofxF25H58GwZ6pI03vKscd95xMfA4b3ns0/hv6wdxtFszc7Ow6f30XB7DW7ndx7kfrGVAndOXyYsolnz4EMTVN3PhyyiO0ADTM2fdh6dXDx4fzj5T8j9Zw7PPTZ1IG/969f9XvKiN3w99y7uY2GPWSZalLyyXOiWyjQBKtnLLzxpnN4VLVtJf2hxj8y3j5OPWh/xafR7fyDu3fm+b434REPAaiZBy110lP2/K/sYX7K3WjP+bKYRweBw6+Zv+DQdRQuOHANAh/2LvlNwJWPJ9sKnUWAzXQU8mSYSzv0ZlCjUHjG5jBQ9ioVxRWfgHgi3gMlVZS3+8DyPP4THk4iPtFSjdsLb+YlRUvEJAAUFUVLYCJ9umZhvl1WfMXGPhTGv1IBFl5de/yroPqC/+nY84Ha95yJqXR2KkpPHJgFavbVi2kPQhY+pLCkdGdsKDsZIzsxJ3m2UMpWThNHi9C+ZXMhirVsjkJvGn2Y+g8n7iGPmOdngjkIOYB5FUTMB2H9/k+LINo9ABGecueGh0fQ7UNSOEh+xeMrW6cH/9pPCrbXtxmFgetF+UYS3OWMyeSgYakQLj9cXJ2cv9sSytevk8iyNJ6GwLGonQgKq4aeql/We6Z69yxUbkIAMsEJlo2f5oLc1VLwBmbNLGYzX/bzrlKW8fJxqa4X3B32iFSGgnQeJhJMUEqmRFKen4H7zL47CPwgHPb2Yc4DS5fezZSJ5Q86p5blOKpjaQYxHFu1x0jnCLuYMoPr47Ghk7Fr2VgsCPGMgxUrXshKU267OHqqU0ewmTyIpSVTqbS5jOBkPToGopHay0EBYKTszwulRZB0KUhX/Fu0H3zLEPoIenPiLAsvYZc6TmbhtgFT8DSwmaDu2A8YSBbEpmnWwIIvbEmXqW0FdBEgiYZqHvD3Qfjjng8YD3ti3RNz+xs0/d///EtCQFIQ15hw0emZ5zg+T+oK/YIeYx1MqD5YhGGy6A3S9iUcAInL6MHnAHoQetFDgojRU6B6QrULmsnj59LI6YudMrKFRaaAN0p6N9vgffSN2wuB6BXsC2XYYUPd1hN4TRn2q3ebQP4qcNjD04FPmrfCnT4bdyTDHSe9W1LcR54tpnMO+tQKOJm6QTiJkf2cVqpgHeu/UsAxFZEJL7RYDoah0xr0LsS0LUCfliyxPw1ugrjP2I78tyCYnEyYWIeqkCerCpQtZoO4WSvINbUzxliGMUm709oo90o7Ph+wWRTbfOtXFLVGneeCq+F+4DuiQsizBduHxbudhi+JeKqOZx20gxxJ1TxH+tN0n8jkoqdj4o5yGbFkt8uUeQBy0UAw4req6bhmKmQqT+WrvkxA+0EImxjYDPtBFAWTGomVJ0ZCX9OsahRY3LydtEh7aS1ZeZoA9eLWvSPZu6u7S35n0eRbedXeqVo6ebvGRapNXTo2GNFci7rERoatEst2qUFtS8W6ZboYl0ySijFiPMEW0QwpB6dszP2M+L1JsJhG8/MgAkfvM1i/hX1RtnYIpcUIvDXTLK3W6cQVVuzR+cfhnu8rLOleYeDielMF+t893DsXr7gCVDz+z1gBX91TLq4Hu4dHH5MX+zwKH3+5iVucfdo9uhwNT4RTEoFVDw6x4917c6b4QJe/e3xyPvyBeXd3njJfTGCHUYJ7+DG63ts9vtgbXgWLuSK8gQngwAQlYLtHopfDy92Ty1MxIBjOi9ns9vEvj3/1QiBnoTz+l3L57mz35Ao6WESRp9z4nuLFJHiig0BQdn26e356mLHihDAJpsqP3pdpzOj17vmHixyfs4TP8w8/7F5eH8XDihfBbKY8/iLe7F/vZTNSDlxZ0RtUGpVVOt20Nbm1VFXp2NGJXZzEE5nXaDc1TWyoDhobrmkYTGdjS3Ucy+KixzEiNmcuhv+g0W3w9cMimi2Av99tyRypwTuxvsSjbfWV4VBJ3LDkZ780PyQEPm+q0DZLennU1UZrNkwWqpqEEFSaLImo64BIpxIA8Z2SAvEm/Q0la+GTLdgvNlRrtcRltczsHLkxWVXLkgPfrJuGgzBVie7ahKiUIZUQCrstI67BMLVsTgyNI07KulkapJNa1hH4LN0EN7SVuSEZ+vkKKkEjrzAVfWlCT25GbLL/1qpIyqqYmnZIbnLXbfqobl3UVYc4nJgWNbHrqg42dE1n2HDGqo1dajtYNanOWwYoloMt9UijT1EktN4eGJUCRAWTABngh9GqFmkww4QiGVo7x2KF2dnCj7xTb7rku2RDpGG5FT1JhC4xIu7Z1OazMABzAN7MU3ti6+K6H9sSh/uvR9lLZevsUz+2JKArKHn87ylsv1PuerYXzJWtw9N+bEpcLYTdnPWpbIEd0Y8NiRUFYEuwEIyT1IA4DtnE5zePf2WhzxYwEFgO/dh0WDXhadwtgh6vYSRhN3zypvMoHYgDV0C0sBj2QzA4AnCWoy9A3jzir0Xb+4GyBaZDP7YdckyB0dCXWfbXPIzSkswRKNnOSXHBEajBup1lj/CLhnmQPPhYUN3LYrizneZCYWzQmpvW3CQILVVceHUzr9dbEN4dW7irGjLlvQc8WU5xzx4eppG3RnFFo6XiXj7+zV80qCxUdryIrTR2VFHWHCNfBJlLFT1+/Fs4f/zF/zL1pjd5RjaqsHKIW+qr/qLhMSR3vUp7djLjgOhy4KZOXS2UxAy6L7QSgKtSqOi03AaIt++U5PkgYSKZbU0yW7/31/bbTqLmsyXaFIxD7T2EDgI1jJaxuF9DkjHxmxfkqtt2crSeLcem4B1ubU0HEx6eB2VJYlUuSfzrSlIEWpc0blZeuX5bCQxrzxaYLhOYkXYvt1pLAjsM7IUYqCowpNVs/XpLgY2Yk2Se4O3kOxbexsS4onyzYsz1206Mcgtuyf3TJGvIJGumI8qNuvImGcwjIADY55XzDV0u2kqM8oVlnBxq1Is4x0KNjOuPRRq3yFy/7WQst3qeKWOzrdetl73ubIrLraXjIIiKXvd+yNldUlzjeSOKGGKaSTXNIti2LQ25FiNMNU2Lc0PHiLmqLmyFpS+N8YAgVdMMUnK786N1drZxq5Ppc/61cDgE7Gzn6ZEe3JVjNJ6rbImUoEHa24yHozhi11eUn37/T98Od+HH3q6gMHdqk1be6u+uqvws08GNdt86QmOUdSVbNOR2WFVXGtVEUy1DI3hs6irFLjcRsZlFDN0e245lGpQTx9ItRvMhFxGHK+jHk1XDKtIYJwiVuPrjRVqaLXWGFechaHp2bqjXBPN0QiyEthVc0JRc8s075oHTGYSyfeEi+FqmvEw9UYvUQxM57fGLFQWf0jw/dWCqmqkTjJEKs9RAsA1IhhRQcr+Co5SictAuJUC0z2hNsqLy9CwXPbSdfovStTvFig2CMLU0YhrwhTTLQGuOSS8j0E4WrpbvmKZCboh4rmFYvqAT+fH3kxf04hwsR2QK4KeRGVI+DK8DP3ONNioDzTAsapqGbhGdwAQmbTbRkp/TVKGbMCSn280Al0MIBYDTUAIpn0PXAbyMJrwEwqDluoZ0pLVCuBwTaKzRDWNJOlkzxmWnvoBx6tyT8mYtwbgUXtybRC+iyRSpyKC6bspwziV4DkrZnbl1pPymG8CSvLFmgMvedgHg1Osm5SM+CcDlo4eXQtgwNdggDXHq2IxwOVk2B3HlVSeMdbUrxmUHOXtXt0XWrd9vd6Q7vJTIxK3PGQ4dovcNhp1ZNuxoOp7cz68adkm6btW8q+YXt0oVzjoa+czmJ9PEH8tcuNrjudw5s6taTLPBbsQMjAGMmatjBoalS1WRBOHiMRtTledNSVI2JQukdE86bpWQlpwifo6V/V0YLGbzzyP28DkK9hxHXFkxiqfFMZFtEwdzmWdXwawm7exAHD+EtY7yv1dzRQej22DKzwNF+d1QefVK+V6R1Cn5xGmL75RXyhv4/ztZk2W3b5Tpwve3lZWPIql99PmMeX57EtL6jRSkddLxG4d/H0y40L0OICybNNKwrNUKheu9qwt+482jMH4G9FqTU22a0SUnrFq/FYUn+3vn7YmKazfiE9doNfLlp5PjK3FNo4OMVm0aiVhVSyj5j8GKEjfOfNhyF9N4KVG27pnfV34KOaxMUwUedn/uD74E3nTrlfJnRVy4kuZ4ZvOyuhv+NiV/m5K/TckXnZLtbDF53vQzU6Rbm2y0bLJZ8qSzDncZRywEAsWdNvmlutgEzy7AaXQ7zhGU3AOsu+snu88XGz2FjlHuruTyll+FKdkFP5Eo1nDBL8eUIjRlOw3Viza8r3x6f3RxtJWd0CgxXMcnp1dHF1sn0/vAs/mfgVkHGDjjk6DfX40FZtNdAbO4e2h8dHrY8VphnqTkeiHVVSyuF+65UO0djy64DRqW3TBscD6V74aVzLxlEEX5F3kW6ar5yI6UHUVT1VysuMkRkw23Cih0Ga9ka5evP1YMbflBxX7gPBSOKeC5JvBsmxbBuuUS5qqUMj62xpSYNna5q+vEUjV7zCxbXHIqHkXEPebSSJMQsCx0WucwVHgx8+S2ikGnV1foKgaN155RyB3XmjhzhUaap7F7pFkjyBBJwISaWDdNqjX46U3R5gpdbcIZ+UO/dWGMFcmqYehIxQiw1TSkUgO3Crg1nDAWjTyJPyY/p6wLSCyxSAPARjmhQoJF/oy7AxQW1hAl2MIYE2RZVG8DRcN5etuLgvku1sKQhmmNFocQ+YyN9jBoGKtENSisVzrRTDEn1qPQkBzSFoV8F2tRSAOpRjmIUxdIbRWmzmGg6VjVYHkkOjYxoZuO869nMA1kGi2OOzoE4kscIlW1TISIhUgrXe8UZ1/PY3ocb5TzMtZHw5/GrG6qlqqamEpDsZswKNZKvlNfawFMz6iNFkc25Wj30yYERYYOfwCY3dRlAxA+sbN6DOuj2cnb+hPJmqh2Uxi81kh6G0cnDwJ/MZmm0jSekrFuyPM/Yh+kep0kV1xjOI7HVNOYo7kas3VkuggMBdNwKDM5Ni1mqNywmW2gYsZCbKWh8u3S/GhPth+NpW0WxZ940tJ4RGQ7T9eaBJdcTP/TrRfxy0lwJ8l1imlraVMaVoFuaFWzZ9VblRjp4tb2ZmxJs4X9FGUF2mZPxCg1KbVEqpGJMEbSM8eaqe0UUlHFYwO/8qiGKUkcbVxiG5MSlrhmnwzSwhRZ4oo2iis2zdjbELf7Tc3SpSa8FFfxKodr/NgdV0km53pc63IRlrimhq7ZwjpY4oq77WmggsLUR+AhI0ol626FqNTuNFvsuEuiSBeiLKSrhk4NcNsxNTVkPEEexmaSclayqjtyf84mWpo9ZnmVrDF8f61Vspz217hKqp3UrroKtvV9zRZxgBVVLRbvTawhpWz+vBFWWLIL5W3dXNppt5IvqzSfY904/VvvRhUeaz54puFjawp9dJ7jVNv0HK/LW1pKJF36aJd9Tu8ikOrS1wXa7hDiv69lUr4h1voaNUyRllk0q3E7uCvrLyJS+afYxB5ANbUmV1zjhnDd5fClGxp2XBNz7FqY2g5HjOpjTInObOaCIyLzOLKONxrGpq1uWqaPaJVo3/LTbdZafXIPpemicNFq7mRxt1c7+WXI56lhce+jRf+vZhVa+X8kSWDHVtPhAUqcRPLybiCtuIFazdb2K1k4Vped1diov4KoaVFkYc1SCTYNsya6urFM9jqtteQ3CTe4I7R1Hq0um6pIbt1onioyTaxRC6w/ixhSM+glUtprpfKi7qTVxZ3UWxj2T0e63cnKZnLba8GW3NDbnK1olTfLRrA3GxTJwDaIahFdJd30+v8r5t9dgJKd9zmWavH4yeriBustoi/dBWjqFqFYNeruO/3dHTl0F6HkEwjWi1Ceop+83/jBhpzwGLqOZl51nV7jbRTXmrc7lY8Mj2tZy5Jijfyg+Tdvk1yj0sfkp1yBHsf/OsHSZKsm5a1YLHyGp0rSpsmH21c+3DdrBkAvx3+70/DvSvzh/wA=</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70220 ForNAV Aged Accounts Receivbl.
{
  OBJECT-PROPERTIES
  {
    Date=07-02-18;
    Time=09:19:52;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=SplatnÇ pohled†vky;
               DAN=Aldersfordelte tilgodehavender;
               DEU=Debitor - SaldenrÅckblick;
               ENU=Aged Accounts Receivables;
               FIN=Myyntisaatavien tilanne;
               FRA=ComptabilitÇ client ÉgÇe;
               ISL=Aldursgreindar krîfur;
               ITA=Scadenziario clienti;
               NLD=Vervallen vorderingen;
               NOR=Aldersford. saldoliste - kunde;
               RUS=éÜ†äïå˜§àÖò áÖÑåâëÜ°°å§ïÅ ãå §˜åàÖç ÑÖÉ°å§ïä;
               SVE=Kundfordringar - Ülder;
               DES=Debitor - SaldenrÅckblick;
               ENG=Aged Accounts Receivable;
               ESM=AntigÅedad cobros;
               FRB=ComptabilitÇ client ÉgÇe;
               ITS=Scadenziario clienti;
               NLB=Vervallen vorderingen;
               DEA=Debitor - SaldenrÅckblick;
               ENA=Aged Accounts Receivable;
               ESN=AntigÅedad cobros;
               FRC=Comptes clients classÇs chronologiquement;
               ENC=Aged Accounts Receivable;
               FRS=ComptabilitÇ client ÉgÇe;
               ENZ=Aged Accounts Receivable];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=VAR
                  CaptionManagement@1000 : Codeunit 42;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000001;;DataItem;Args              ;
               DataItemTable=Table70219;
               DataItemTableView=SORTING(Print Amounts in LCY);
               OnPreDataItem=BEGIN
                               Args.INSERT;
                               Args.CalcDates;
                             END;

               Temporary=Yes }

    { 6836;1   ;DataItem;Account             ;
               DataItemTable=Table18;
               OnAfterGetRecord=BEGIN
                                  AgingCalculation.GetAgingWithCurrency(Account, AgingBuffer, CurrencyTotalsBuffer, Args, TempCurrency);
                                  IF AgingBuffer.ISEMPTY THEN
                                    CurrReport.SKIP;
                                END;

               ReqFilterFields=No. }

    { 70220;2  ;DataItem;AgingBuffer         ;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Currency Code);
               Temporary=Yes }

    { 1000000000;1;DataItem;CurrencyTotalsBuffer;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Currency Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   InitRequestPage;
                 END;

    }
    CONTROLS
    {
      { 4   ;0   ;Container ;
                  ContainerType=ContentArea }

      { 2   ;1   ;Group     ;
                  CaptionML=ENU=Options }

      { 1   ;2   ;Field     ;
                  Name=AgedAsOf;
                  CaptionML=[DAN=Slutdato;
                             DEU=Enddatum;
                             ENU=Ending Date;
                             ESP=Fecha final;
                             FIN=Lopetuspvm;
                             FRA=Date fin;
                             ISL=Lokadagsetning;
                             ITA=Data fine;
                             NLD=Einddatum;
                             NOR=Sluttdato];
                  ToolTipML=ENU=Specifies the date that you want the aging calculated for.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Ending Date" }

      { 3   ;2   ;Field     ;
                  Name=Agingby;
                  CaptionML=[DAN=Aldersfordelt efter;
                             DEU=RÅckblick nach;
                             ENU=Aging by;
                             ESP=AntigÅedad por;
                             FIN=Tilanne per;
                             FRA=AgÇe par;
                             ISL=Aldursgreining eftir;
                             ITA=Scadenziario per;
                             NLD=Vervallen per;
                             NOR=Aldersfordeling pÜ basis av;
                             SVE=èlder per];
                  ToolTipML=ENU=Specifies if the aging will be calculated from the due date, the posting date, or the document date.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Aging By" }

      { 7   ;2   ;Field     ;
                  Name=PeriodLength;
                  CaptionML=[DAN=Periodelëngde;
                             DEU=PeriodenlÑnge;
                             ENU=Period Length;
                             ESP=Longitud periodo;
                             FIN=Jakson pituus;
                             FRA=Base pÇriode;
                             ISL=Lengd t°mabils;
                             ITA=Durata periodo;
                             NLD=Periodelengte;
                             NOR=Periodelengde];
                  ToolTipML=ENU=Specifies the length of each period, for example, enter "1M" for one month.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Period Length" }

      { 9   ;2   ;Field     ;
                  Name=AmountsinLCY;
                  CaptionML=[DAN=Alle belõb i RV;
                             DEU=Alle BetrÑge in MW;
                             ENU=All Amounts in LCY;
                             FIN=Kaikki summat PVA;
                             FRA=Tous les montants DS;
                             ISL=Allar upphë–ir ° SGM;
                             ITA=Tutti gli importi in VL;
                             NLD=Alle bedragen in LV;
                             NOR=Alle belõp i NOK;
                             SVE=Alla belopp i BVA];
                  ToolTipML=ENU=Specifies if you want the report in customer's currencies. Report totals calculated in LCY.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Amounts in LCY" }

      { 11  ;2   ;Field     ;
                  Name=PrintDetails;
                  CaptionML=[DAN=Udskriv detaljer;
                             DEU=Details drucken;
                             ENU=Print Details;
                             ESP=Imprimir detalles;
                             FIN=Tulosta yksityiskohdat;
                             FRA=Imprimer dÇtails;
                             ISL=Prenta sundurli–un;
                             ITA=Stampa dettagli;
                             NLD=Details afdrukken;
                             NOR=Skriv ut spesifikasjoner;
                             SVE=Skriv ut detaljer];
                  ToolTipML=ENU=Specifies if you want the report to show the detailed entries that add up the total balance for each customer.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Details" }

      { 15  ;2   ;Field     ;
                  Name=HeadingType;
                  CaptionML=[DAN=Overskriftstype;
                             DEU=öberschriftsart;
                             ENU=Heading Type;
                             ESP=Tipo cabecera;
                             FIN=Otsikon tyyppi;
                             FRA=Type titre;
                             ISL=Tegund yfirskriftar;
                             ITA=Tipo testata;
                             NLD=Type kop;
                             NOR=Overskriftstype;
                             SVE=Rubriktyp];
                  ToolTipML=ENU=Specifies if the column heading for the report periods will indicate a date interval or the number of days overdue.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Heading Type";
                  Visible=FALSE }

      { 13  ;2   ;Field     ;
                  Name=perCustomer;
                  CaptionML=[DAN=Skift side pr. debitor;
                             DEU=Neue Seite pro Debitor;
                             ENU=New Page per Customer;
                             ESP=P†gina nueva por cliente;
                             FIN=Uusi sivu asiakasta kohti;
                             FRA=Nouvelle page par client;
                             ISL=NÏ bla–s°–a † hvern vi–skiptamann;
                             ITA=Nuova pagina per cliente;
                             NLD=Nieuwe pagina per klant;
                             NOR=Sideskift per kunde;
                             SVE=Ny sida per kund];
                  ToolTipML=ENU=Specifies if each customer's information is printed on a new page if you have chosen two or more customers to be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."New Page Per Customer" }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
    { 747 ;AgedOverdueAmounts  ;CaptionML=ENU=Aged Overdue Amounts }
    { 742 ;AmnsInLCY           ;CaptionML=ENU=All Amounts in LCY. }
  }
  CODE
  {
    VAR
      TempCurrency@1000000001 : TEMPORARY Record 4;
      AgingCalculation@1000000007 : Codeunit 70219;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE OnPostSectionAccountsReceivblBuffer_ColumnsHeading@5010(VAR AccountsReceivblBuffer@1000000000 : Record 70220);
    BEGIN
      WITH AccountsReceivblBuffer DO BEGIN
      END;// Autogenerated by ForNav;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE InitRequestPage@1000000001();
    VAR
      Blank@1000000000 : DateFormula;
    BEGIN
      WITH Args DO BEGIN
        IF "Ending Date" = 0D THEN
          "Ending Date" := WORKDATE;
        "Column Count" := 5;
        IF "Period Length" = Blank THEN
          EVALUATE("Period Length", '<1M>');
      END;
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'AgingBuffer': WITH AgingBuffer DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount (LCY)");
                ReportForNav.AddTotal(DataItemId,2,Balance);
                ReportForNav.AddTotal(DataItemId,3,"Balance (LCY)");
                ReportForNav.AddTotal(DataItemId,4,"Amount 1");
                ReportForNav.AddTotal(DataItemId,5,"Amount 1 (LCY)");
                ReportForNav.AddTotal(DataItemId,6,"Amount 2");
                ReportForNav.AddTotal(DataItemId,7,"Amount 2 (LCY)");
                ReportForNav.AddTotal(DataItemId,8,"Amount 3");
                ReportForNav.AddTotal(DataItemId,9,"Amount 3 (LCY)");
                ReportForNav.AddTotal(DataItemId,10,"Amount 4");
                ReportForNav.AddTotal(DataItemId,11,"Amount 4 (LCY)");
                ReportForNav.AddTotal(DataItemId,12,"Amount 5");
                ReportForNav.AddTotal(DataItemId,13,"Amount 5 (LCY)");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 Balance := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Balance (LCY)" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Amount 1" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
                 "Amount 1 (LCY)" := ReportForNav.RestoreTotal(DataItemId,5,GroupTotalFieldNo);
                 "Amount 2" := ReportForNav.RestoreTotal(DataItemId,6,GroupTotalFieldNo);
                 "Amount 2 (LCY)" := ReportForNav.RestoreTotal(DataItemId,7,GroupTotalFieldNo);
                 "Amount 3" := ReportForNav.RestoreTotal(DataItemId,8,GroupTotalFieldNo);
                 "Amount 3 (LCY)" := ReportForNav.RestoreTotal(DataItemId,9,GroupTotalFieldNo);
                 "Amount 4" := ReportForNav.RestoreTotal(DataItemId,10,GroupTotalFieldNo);
                 "Amount 4 (LCY)" := ReportForNav.RestoreTotal(DataItemId,11,GroupTotalFieldNo);
                 "Amount 5" := ReportForNav.RestoreTotal(DataItemId,12,GroupTotalFieldNo);
                 "Amount 5 (LCY)" := ReportForNav.RestoreTotal(DataItemId,13,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70221 ForNAV Aged Accounts Payables
{
  OBJECT-PROPERTIES
  {
    Date=07-02-18;
    Time=09:18:50;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=SplatnÇ pohled†vky;
               DAN=Aldersfordelte tilgodehavender;
               DEU=Debitor - SaldenrÅckblick;
               ENU=Aged Accounts Payables;
               FIN=Myyntisaatavien tilanne;
               FRA=ComptabilitÇ client ÉgÇe;
               ISL=Aldursgreindar krîfur;
               ITA=Scadenziario clienti;
               NLD=Vervallen vorderingen;
               NOR=Aldersford. saldoliste - kunde;
               RUS=éÜ†äïå˜§àÖò áÖÑåâëÜ°°å§ïÅ ãå §˜åàÖç ÑÖÉ°å§ïä;
               SVE=Kundfordringar - Ülder;
               DES=Debitor - SaldenrÅckblick;
               ENG=Aged Accounts Receivable;
               ESM=AntigÅedad cobros;
               FRB=ComptabilitÇ client ÉgÇe;
               ITS=Scadenziario clienti;
               NLB=Vervallen vorderingen;
               DEA=Debitor - SaldenrÅckblick;
               ENA=Aged Accounts Receivable;
               ESN=AntigÅedad cobros;
               FRC=Comptes clients classÇs chronologiquement;
               ENC=Aged Accounts Receivable;
               FRS=ComptabilitÇ client ÉgÇe;
               ENZ=Aged Accounts Receivable];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=VAR
                  CaptionManagement@1000 : Codeunit 42;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000001;;DataItem;Args              ;
               DataItemTable=Table70219;
               DataItemTableView=SORTING(Print Amounts in LCY);
               OnPreDataItem=BEGIN
                               Args.INSERT;
                               Args.CalcDates;
                             END;

               Temporary=Yes }

    { 6836;1   ;DataItem;Account             ;
               DataItemTable=Table23;
               OnAfterGetRecord=BEGIN
                                  AgingCalculation.GetAgingWithCurrency(Account, AgingBuffer, CurrencyTotalsBuffer, Args, TempCurrency);
                                  IF AgingBuffer.ISEMPTY THEN
                                    CurrReport.SKIP;
                                END;

               ReqFilterFields=No. }

    { 70220;2  ;DataItem;AgingBuffer         ;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Currency Code);
               Temporary=Yes }

    { 1000000000;1;DataItem;CurrencyTotalsBuffer;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Currency Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   InitRequestPage;
                 END;

    }
    CONTROLS
    {
      { 1000000009;0;Container;
                  ContainerType=ContentArea }

      { 1000000008;1;Group  ;
                  CaptionML=ENU=Options }

      { 1000000007;2;Field  ;
                  Name=AgedAsOf;
                  CaptionML=[DAN=Slutdato;
                             DEU=Enddatum;
                             ENU=Ending Date;
                             ESP=Fecha final;
                             FIN=Lopetuspvm;
                             FRA=Date fin;
                             ISL=Lokadagsetning;
                             ITA=Data fine;
                             NLD=Einddatum;
                             NOR=Sluttdato];
                  ToolTipML=ENU=Specifies the date that you want the aging calculated for.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Ending Date" }

      { 1000000006;2;Field  ;
                  Name=Agingby;
                  CaptionML=[DAN=Aldersfordelt efter;
                             DEU=RÅckblick nach;
                             ENU=Aging by;
                             ESP=AntigÅedad por;
                             FIN=Tilanne per;
                             FRA=AgÇe par;
                             ISL=Aldursgreining eftir;
                             ITA=Scadenziario per;
                             NLD=Vervallen per;
                             NOR=Aldersfordeling pÜ basis av;
                             SVE=èlder per];
                  ToolTipML=ENU=Specifies if the aging will be calculated from the due date, the posting date, or the document date.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Aging By" }

      { 1000000005;2;Field  ;
                  Name=PeriodLength;
                  CaptionML=[DAN=Periodelëngde;
                             DEU=PeriodenlÑnge;
                             ENU=Period Length;
                             ESP=Longitud periodo;
                             FIN=Jakson pituus;
                             FRA=Base pÇriode;
                             ISL=Lengd t°mabils;
                             ITA=Durata periodo;
                             NLD=Periodelengte;
                             NOR=Periodelengde];
                  ToolTipML=ENU=Specifies the length of each period, for example, enter "1M" for one month.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Period Length" }

      { 1000000004;2;Field  ;
                  Name=AmountsinLCY;
                  CaptionML=[DAN=Alle belõb i RV;
                             DEU=Alle BetrÑge in MW;
                             ENU=All Amounts in LCY;
                             FIN=Kaikki summat PVA;
                             FRA=Tous les montants DS;
                             ISL=Allar upphë–ir ° SGM;
                             ITA=Tutti gli importi in VL;
                             NLD=Alle bedragen in LV;
                             NOR=Alle belõp i NOK;
                             SVE=Alla belopp i BVA];
                  ToolTipML=ENU=Specifies if you want the report in customer's currencies. Report totals calculated in LCY.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Amounts in LCY" }

      { 1000000003;2;Field  ;
                  Name=PrintDetails;
                  CaptionML=[DAN=Udskriv detaljer;
                             DEU=Details drucken;
                             ENU=Print Details;
                             ESP=Imprimir detalles;
                             FIN=Tulosta yksityiskohdat;
                             FRA=Imprimer dÇtails;
                             ISL=Prenta sundurli–un;
                             ITA=Stampa dettagli;
                             NLD=Details afdrukken;
                             NOR=Skriv ut spesifikasjoner;
                             SVE=Skriv ut detaljer];
                  ToolTipML=ENU=Specifies if you want the report to show the detailed entries that add up the total balance for each customer.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Details" }

      { 1000000002;2;Field  ;
                  Name=HeadingType;
                  CaptionML=[DAN=Overskriftstype;
                             DEU=öberschriftsart;
                             ENU=Heading Type;
                             ESP=Tipo cabecera;
                             FIN=Otsikon tyyppi;
                             FRA=Type titre;
                             ISL=Tegund yfirskriftar;
                             ITA=Tipo testata;
                             NLD=Type kop;
                             NOR=Overskriftstype;
                             SVE=Rubriktyp];
                  ToolTipML=ENU=Specifies if the column heading for the report periods will indicate a date interval or the number of days overdue.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Heading Type";
                  Visible=FALSE }

      { 1000000001;2;Field  ;
                  Name=perCustomer;
                  CaptionML=[DAN=Skift side pr. debitor;
                             DEU=Neue Seite pro Debitor;
                             ENU=New Page per Customer;
                             ESP=P†gina nueva por cliente;
                             FIN=Uusi sivu asiakasta kohti;
                             FRA=Nouvelle page par client;
                             ISL=NÏ bla–s°–a † hvern vi–skiptamann;
                             ITA=Nuova pagina per cliente;
                             NLD=Nieuwe pagina per klant;
                             NOR=Sideskift per kunde;
                             SVE=Ny sida per kund];
                  ToolTipML=ENU=Specifies if each customer's information is printed on a new page if you have chosen two or more customers to be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."New Page Per Customer" }

      { 1000000000;2;Field  ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
    { 747 ;AgedOverdueAmounts  ;CaptionML=ENU=Aged Overdue Amounts }
    { 742 ;AmnsInLCY           ;CaptionML=ENU=All Amounts in LCY. }
  }
  CODE
  {
    VAR
      TempCurrency@1000000001 : TEMPORARY Record 4;
      AgingCalculation@1000000007 : Codeunit 70219;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE OnPostSectionAccountsReceivblBuffer_ColumnsHeading@5010(VAR AccountsReceivblBuffer@1000000000 : Record 70220);
    BEGIN
      WITH AccountsReceivblBuffer DO BEGIN
      END;// Autogenerated by ForNav;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE InitRequestPage@1000000001();
    VAR
      Blank@1000000000 : DateFormula;
    BEGIN
      WITH Args DO BEGIN
        IF "Ending Date" = 0D THEN
          "Ending Date" := WORKDATE;
        "Column Count" := 5;
        IF "Period Length" = Blank THEN
          EVALUATE("Period Length", '<1M>');
      END;
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'AgingBuffer': WITH AgingBuffer DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount (LCY)");
                ReportForNav.AddTotal(DataItemId,2,Balance);
                ReportForNav.AddTotal(DataItemId,3,"Balance (LCY)");
                ReportForNav.AddTotal(DataItemId,4,"Amount 1");
                ReportForNav.AddTotal(DataItemId,5,"Amount 1 (LCY)");
                ReportForNav.AddTotal(DataItemId,6,"Amount 2");
                ReportForNav.AddTotal(DataItemId,7,"Amount 2 (LCY)");
                ReportForNav.AddTotal(DataItemId,8,"Amount 3");
                ReportForNav.AddTotal(DataItemId,9,"Amount 3 (LCY)");
                ReportForNav.AddTotal(DataItemId,10,"Amount 4");
                ReportForNav.AddTotal(DataItemId,11,"Amount 4 (LCY)");
                ReportForNav.AddTotal(DataItemId,12,"Amount 5");
                ReportForNav.AddTotal(DataItemId,13,"Amount 5 (LCY)");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 Balance := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Balance (LCY)" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Amount 1" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
                 "Amount 1 (LCY)" := ReportForNav.RestoreTotal(DataItemId,5,GroupTotalFieldNo);
                 "Amount 2" := ReportForNav.RestoreTotal(DataItemId,6,GroupTotalFieldNo);
                 "Amount 2 (LCY)" := ReportForNav.RestoreTotal(DataItemId,7,GroupTotalFieldNo);
                 "Amount 3" := ReportForNav.RestoreTotal(DataItemId,8,GroupTotalFieldNo);
                 "Amount 3 (LCY)" := ReportForNav.RestoreTotal(DataItemId,9,GroupTotalFieldNo);
                 "Amount 4" := ReportForNav.RestoreTotal(DataItemId,10,GroupTotalFieldNo);
                 "Amount 4 (LCY)" := ReportForNav.RestoreTotal(DataItemId,11,GroupTotalFieldNo);
                 "Amount 5" := ReportForNav.RestoreTotal(DataItemId,12,GroupTotalFieldNo);
                 "Amount 5 (LCY)" := ReportForNav.RestoreTotal(DataItemId,13,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70248 ForNAV Cust./Item Statistics
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=13:33:12;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Statistika z†kazn°k/zboŒ°;
               DAN=Kunde/Varestatistik;
               DEU=Debitor/Artikelstatistik;
               ENU=Customer/Item Statistics;
               FIN=Asiakas/Nimikkeen tilastot;
               FRA=Statistiques client/article;
               ISL=Vi˜skiptama˜ur/Birg˜auppl¸singar;
               ITA=Statistiche cliente/articolo;
               NLD=Klant/Artikelstatistiek;
               NOR=Kunde/Varestatistikk;
               SVE=Kunde/Artikelstatistik;
               ESN=Estad°sticas cliente/producto];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;Args              ;
               DataItemTable=Table70248;
               OnPreDataItem=BEGIN
                               INSERT;
                             END;

               Temporary=Yes }

    { 6836;    ;DataItem;                    ;
               DataItemTable=Table18;
               PrintOnlyIfDetail=Yes;
               OnPreDataItem=BEGIN
                               ReportForNav.GetDataItem('Customer').NewPagePerRecord := Args."New Page Per Customer";
                             END;

               ReqFilterFields=No.,Search Name,Customer Posting Group }

    { 8894;1   ;DataItem;                    ;
               DataItemTable=Table5802;
               DataItemTableView=SORTING(Source Type,Source No.,Item Ledger Entry Type,Item No.,Posting Date)
                                 WHERE(Source Type=CONST(Customer),
                                       Item Ledger Entry Type=CONST(Sale),
                                       Expected Cost=CONST(No));
               ReqFilterFields=Item No.,Inventory Posting Group,Posting Date;
               DataItemLink=Source No.=FIELD(No.),
                            Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Code=FIELD(Global Dimension 2 Filter) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1000000002;2;Field  ;
                  Name=PrintDetails;
                  CaptionML=[DAN=Udskriv detaljer;
                             DEU=Details drucken;
                             ENU=Print Details;
                             ESP=Imprimir detalles;
                             FIN=Tulosta yksityiskohdat;
                             FRA=Imprimer dÇtails;
                             ISL=Prenta sundurli–un;
                             ITA=Stampa dettagli;
                             NLD=Details afdrukken;
                             NOR=Skriv ut spesifikasjoner;
                             SVE=Skriv ut detaljer];
                  SourceExpr=Args."Print Details" }

      { 1000000001;2;Field  ;
                  Name=NewPagePerCustomer;
                  CaptionML=[DAN=Skift side pr. debitor;
                             DEU=Neue Seite pro Debitor;
                             ENU=New Page per Customer;
                             ESP=P†gina nueva por cliente;
                             FIN=Uusi sivu asiakasta kohti;
                             FRA=Nouvelle page par client;
                             ISL=NÏ bla–s°–a † hvern vi–skiptamann;
                             ITA=Nuova pagina per cliente;
                             NLD=Nieuwe pagina per klant;
                             NOR=Sideskift per kunde;
                             SVE=Ny sida per kund];
                  SourceExpr=Args."New Page Per Customer" }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text000@1480002 : TextConst 'ENU=Invalid Item';
      Text001@1480013 : TextConst 'ENU=Data';
      Text002@1480012 : TextConst 'ENU=Customer/Item Statistics';
      Text003@1480011 : TextConst 'ENU=Company Name';
      Text004@1480010 : TextConst 'ENU=Report No.';
      Text005@1480009 : TextConst 'ENU=Report Name';
      Text006@1480008 : TextConst 'ENU=User ID';
      Text007@1480007 : TextConst 'ENU=Date / Time';
      Text008@1480006 : TextConst 'ENU=Customer Filters';
      Text009@1480005 : TextConst 'ENU=Value Entry Filters';
      Text010@1480004 : TextConst 'ENU=Contribution Margin';
      Text011@1480003 : TextConst 'ENU=Contribution Ratio';
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000000();
    VAR
      ForNAVSetup@1000000001 : Record 70000;
      OutStream@1000000000 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Customer': WITH Customer DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Value Entry"."Sales Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,1,"Value Entry"."Discount Amount");
              END;
           'Restore': BEGIN
                 "Value Entry"."Sales Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Value Entry"."Discount Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'ValueEntry': WITH "Value Entry" DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Invoiced Quantity");
                ReportForNav.AddTotal(DataItemId,1,"Sales Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,2,"Discount Amount");
                ReportForNav.AddTotal(DataItemId,3,"Cost Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,4,"Invoiced Quantity");
                ReportForNav.AddTotal(DataItemId,5,"Sales Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,6,"Cost Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,7,"Discount Amount");
              END;
           'Restore': BEGIN
                 "Invoiced Quantity" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Sales Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Discount Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Cost Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Invoiced Quantity" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
                 "Sales Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,5,GroupTotalFieldNo);
                 "Cost Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,6,GroupTotalFieldNo);
                 "Discount Amount" := ReportForNav.RestoreTotal(DataItemId,7,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70250 ForNAV Statement
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=10:49:46;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=ENU=Statement;
    OnInitReport=BEGIN
                   GLSetup.GET;
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                  COMMIT;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000001;;DataItem;Args              ;
               DataItemTable=Table70250;
               DataItemTableView=SORTING(Start Date) }

    { 2   ;    ;DataItem;                    ;
               DataItemTable=Table18;
               PrintOnlyIfDetail=Yes;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  ProcessCustomer;
                                  UpdateAging;
                                END;

               ReqFilterFields=No.;
               CalcFields=Balance }

    { 6523;1   ;DataItem;CurrencyLoop        ;
               DataItemTable=Table4;
               DataItemTableView=SORTING(Code);
               PrintOnlyIfDetail=Yes;
               OnAfterGetRecord=BEGIN
                                  Customer.SETRANGE("Date Filter",0D, Args."Start Date" - 1);
                                  Customer.SETRANGE("Currency Filter",CurrencyLoop.Code);
                                  Customer.CALCFIELDS("Net Change");
                                END;

               OnPostDataItem=BEGIN
                                Customer.SETRANGE("Currency Filter");
                              END;

               Temporary=Yes }

    { 3   ;2   ;DataItem;                    ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Customer No.,Posting Date,Currency Code);
               OnPreDataItem=BEGIN
                               SETRANGE("Customer No.", Customer."No.");
                               SETRANGE("Posting Date", Args."Start Date", Args."Ending Date");
                               SETRANGE("Currency Code",CurrencyLoop.Code);
                               SETRANGE("Date Filter", Args."Start Date", Args."Ending Date");
                             END;

               CalcFields=Remaining Amount,Original Amount }

    { 9065;2   ;DataItem;OverdueEntry        ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Customer No.,Open,Positive,Due Date);
               OnPreDataItem=BEGIN
                               SETRANGE("Customer No.", Customer."No.");
                               IF NOT Args."Include Aging Band" THEN
                                 SETRANGE("Due Date", 0D, Args."Ending Date"- 1);
                               SETRANGE("Currency Code", CurrencyLoop.Code);
                               IF (NOT Args."Print Entries Due") AND (NOT Args."Include Aging Band") THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF Args."Include Aging Band" THEN BEGIN
                                    IF ("Posting Date" > Args."Ending Date") AND ("Due Date" >= Args."Ending Date") THEN
                                      CurrReport.SKIP;
                                    IF Args.Date = Args.Date::"Due Date" THEN
                                      IF "Due Date" >= Args."Ending Date" THEN
                                        CurrReport.SKIP;
                                  END;

                                  CALCFIELDS("Remaining Amount");
                                  IF "Remaining Amount" = 0 THEN
                                    CurrReport.SKIP;

                                  IF "Due Date" >= Args."Ending Date" THEN
                                    CurrReport.SKIP;
                                END;

               CalcFields=Original Amount,Remaining Amount;
               DataItemLinkReference=Customer;
               DataItemLink=Customer No.=FIELD(No.) }

    { 1000000000;1;DataItem;AgingBuffer      ;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Entry No.);
               DataItemLink=Account No.=FIELD(No.);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   InitRequestPageDataInternal
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             PLK=Opcje;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 1000000001;2;Field  ;
                  Name=DocumentDate;
                  CaptionML=[DAN=Bilagsdato;
                             DEU=Belegdatum;
                             ENU=Document Date;
                             FIN=Asiakirjan pvm;
                             FRA=Date document;
                             ISL=Dags. fylgiskjals;
                             ITA=Data documento;
                             NLD=Documentdatum;
                             NOR=Bilagsdato;
                             SVE=Dokumentdatum];
                  SourceExpr=Args."Document Date" }

      { 1000000000;2;Field  ;
                  Name=StartDate;
                  CaptionML=[DAN=Startdato;
                             DEU=Startdatum;
                             ENU=Start Date;
                             ESP=Fecha inicial;
                             FIN=Aloituspvm;
                             FRA=Date dÇbut;
                             ISL=Upphafsdagur;
                             ITA=Data di inizio;
                             NLD=Begindatum;
                             NOR=Startdato];
                  SourceExpr=Args."Start Date" }

      { 17  ;2   ;Field     ;
                  Name=EndDate;
                  CaptionML=[DAN=Slutdato;
                             DEU=Enddatum;
                             ENU=Ending Date;
                             ESP=Fecha final;
                             FIN=Lopetuspvm;
                             FRA=Date fin;
                             ISL=Lokadagsetning;
                             ITA=Data fine;
                             NLD=Einddatum;
                             NOR=Sluttdato];
                  ToolTipML=ENU=Specifies the date to which the report or batch job processes information.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Ending Date" }

      { 16  ;2   ;Field     ;
                  Name=ShowOverdueEntries;
                  CaptionML=[DAN=Vis forfaldne poster;
                             DEU=FÑllige Posten drucken;
                             ENU=Show Overdue Entries;
                             ESP=Muestra movs. vencidos;
                             FIN=NÑytÑ erÑÑntyneet tapahtumat;
                             FRA=Afficher Çcritures Çchues;
                             ISL=SÏna gjaldf. fërslur;
                             ITA=Mostra movimenti scaduti;
                             NLD=Vervallen posten weergeven;
                             NOR=Vis forfalte poster;
                             SVE=Visa fîrfallna transaktioner];
                  ToolTipML=ENU=Specifies if you want overdue entries to be shown separately for each currency.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Entries Due" }

      { 15  ;2   ;Group     ;
                  Name=Include;
                  CaptionML=[DAN=Inkluder;
                             DEU=Einschlie·en;
                             ENU=Include;
                             ESP=Incluye;
                             FIN=SisÑllytÑ;
                             FRA=Inclure;
                             ISL=Hafa me–;
                             ITA=Includi;
                             NLD=Invoegen;
                             NOR=Inkluder;
                             SVE=Inkludera];
                  GroupType=Group }

      { 14  ;3   ;Field     ;
                  Name=IncludeAllCustomerswithLE;
                  CaptionML=[DAN=Medtag ogsÜ debitorer, der kun har saldo;
                             DEU=Alle Debitoren mit Saldo einbeziehen;
                             ENU=Include All Customers with a Balance;
                             ESP=Incluye todos los clientes con saldo;
                             FIN=SisÑllytÑ kaikki asiakkaat, joilla on saldo;
                             FRA=Inclure tous les clients ayant un solde.;
                             ISL=Skrifa £t alla me– stî–u;
                             ITA=Includi tutti i clienti con saldo;
                             NLD=Alle klanten met saldo;
                             NOR=Ta med alle kunder med saldo;
                             SVE=Ta med alla kunder med ett saldo];
                  ToolTipML=ENU=Specifies if you want entries displayed for customers that have ledger entries at the end of the selected period.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print All Having Balance";
                  MultiLine=Yes;
                  OnValidate=BEGIN
                               IF NOT Args."Print All Having Entries" THEN
                                 Args."Print All Having Balance" := TRUE;
                             END;
                              }

      { 13  ;3   ;Field     ;
                  Name=IncludeAllCustomerswithBalance;
                  CaptionML=[DAN=Medtag alle debitorer, der har poster;
                             DEU=Alle Debitoren mit Buchungen einbeziehen;
                             ENU=Include All Customers with Ledger Entries;
                             ESP=Incluye todos los clientes con movs.;
                             FIN=SisÑllytÑ kaikki asiakkaat, joilla on tapahtumakirjauksia;
                             FRA=Inclure tous les clients mouvementÇs.;
                             ISL=Skrifa £t alla vskm. me– fërslur;
                             ITA=Includi tutti i clienti con movimenti contabili;
                             NLD=Alle klanten met posten;
                             NOR=Ta med alle kunder med poster;
                             SVE=Ta med alla kunder med reskontratransaktioner];
                  ToolTipML=ENU=Specifies if you want entries displayed for customers that have a balance at the end of the selected period.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print All Having Entries";
                  MultiLine=Yes;
                  OnValidate=BEGIN
                               IF NOT Args."Print All Having Balance" THEN
                                 Args."Print All Having Entries" := TRUE;
                             END;
                              }

      { 10  ;2   ;Group     ;
                  CaptionML=[DAN=Aldersford.intv. efter;
                             DEU=SaldenrÅckblick nach;
                             ENU=Aging Band by;
                             ESP=Rango antigÅedad por;
                             FIN=ErÑÑntymisjakso per;
                             FRA=Cumul par;
                             ISL=T°mabil aldursgreiningar eftir;
                             ITA=Periodo scadenziario per;
                             NLD=Vervaldatuminterval per;
                             NOR=Aldersfordeling pÜ basis av;
                             SVE=èldersspann per];
                  GroupType=Group }

      { 9   ;3   ;Field     ;
                  Name=IncludeAgingBand;
                  CaptionML=[DAN=Medtag aldersford.intv.;
                             DEU=Mit SaldenrÅckblick;
                             ENU=Include Aging Band;
                             ESP=Incluye rango antigÅedad;
                             FIN=Sis. erÑÑntymisjakso;
                             FRA=Inclure cumul date;
                             ISL=Taka aldursgreiningart°mabil me–;
                             ITA=Includi periodo scadenziario;
                             NLD=Vervaldatuminterval opnemen;
                             NOR=Vis aldersfordeling;
                             SVE=Ta med Üldersspann];
                  ToolTipML=ENU=Specifies if you want an aging band to be included in the document. If you place a check mark here, you must also fill in the Aging Band Period Length and Aging Band by fields.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Include Aging Band" }

      { 8   ;3   ;Field     ;
                  Name=AgingBandPeriodLengt;
                  CaptionML=[DAN=Periodelëngde;
                             DEU=PeriodenlÑnge;
                             ENU=Period Length;
                             ESP=Longitud periodo;
                             FIN=Jakson pituus;
                             FRA=Base pÇriode;
                             ISL=Lengd t°mabils;
                             ITA=Durata periodo;
                             NLD=Periodelengte;
                             NOR=Periodelengde];
                  ToolTipML=ENU=Specifies the length of each of the four periods in the aging band, for example, enter "1M" for one month. The most recent period will end on the last day of the period in the Date Filter field.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Period Length" }

      { 7   ;3   ;Field     ;
                  Name=AgingBandby;
                  CaptionML=[DAN=Aldersford.intv. efter;
                             DEU=SaldenrÅckblick nach;
                             ENU=Aging Band by;
                             ESP=Rango antigÅedad por;
                             FIN=ErÑÑntymisjakso per;
                             FRA=Cumul par;
                             ISL=T°mabil aldursgreiningar eftir;
                             ITA=Periodo scadenziario per;
                             NLD=Vervaldatuminterval per;
                             NOR=Aldersfordeling pÜ basis av;
                             SVE=èldersspann per];
                  ToolTipML=ENU=Specifies if the aging band will be calculated from the due date or from the posting date.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args.Date }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      GLSetup@1002 : Record 98;
      Language@1013 : Record 8;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE ProcessCustomer@1();
    VAR
      Currency@1000 : Record 4;
    BEGIN
      CurrencyLoop.RESET;
      CurrencyLoop.DELETEALL;
      WITH Customer DO BEGIN
        CurrReport.LANGUAGE := Language.GetLanguageID("Language Code");
        IF NOT CurrReport.PREVIEW THEN BEGIN
          LOCKTABLE;
          FIND;
          "Last Statement No." := "Last Statement No." + 1;
          MODIFY;
          COMMIT;
        END ELSE
          "Last Statement No." := "Last Statement No." + 1;
        SETRANGE("Date Filter",0D, Args."Ending Date");
        CALCFIELDS("Net Change");
        IF ("Net Change" <> 0) OR Args."Print All Having Balance" THEN BEGIN
          CurrencyLoop.Code := '';
          CurrencyLoop.INSERT;
          COPYFILTER("Currency Filter", Currency.Code);
          IF Currency.FINDSET THEN
            REPEAT
              CurrencyLoop := Currency;
              CurrencyLoop.INSERT;
            UNTIL Currency.NEXT = 0;
        END;
      END;
    END;

    LOCAL PROCEDURE GetDate@3(PostingDate@1000 : Date;DueDate@1001 : Date) : Date;
    BEGIN
      IF Args.Date = Args.Date::"Posting Date" THEN
        EXIT(PostingDate);
      EXIT(DueDate);
    END;

    LOCAL PROCEDURE InitRequestPageDataInternal@1091();
    BEGIN
      WITH Args DO BEGIN
        IF (NOT "Print All Having Entries") AND (NOT "Print All Having Balance") THEN
          "Print All Having Balance" := TRUE;
        IF FORMAT("Period Length") = '' THEN
          EVALUATE("Period Length",'<1M+CM>');
        IF "Document Date" = 0D THEN
          "Document Date" := TODAY;
      END;
    END;

    LOCAL PROCEDURE UpdateAging@1000000001();
    VAR
      AgingArgs@1000000001 : Record 70219;
      CustomerAging@1000000000 : Codeunit 70220;
    BEGIN
      IF NOT Args."Include Aging Band" THEN
        EXIT;
      CASE Args.Date OF
        Args.Date::"Due Date":
          AgingArgs."Aging By" := AgingArgs."Aging By"::"Due Date";
        Args.Date::"Posting Date":
          AgingArgs."Aging By" := AgingArgs."Aging By"::"Posting Date";
      END;
      AgingArgs."Ending Date" := Args."Ending Date";
      AgingArgs."Period Length" := Args."Period Length";
      AgingArgs."Column Count" := 5;
      AgingArgs.CalcDates;
      CustomerAging.GetAging(Customer, AgingBuffer, AgingArgs);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
      "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'OverdueEntry': WITH OverdueEntry DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Remaining Amount");
                ReportForNav.AddTotal(DataItemId,1,"Remaining Amount");
              END;
           'Restore': BEGIN
                 "Remaining Amount" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Remaining Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'AgingBuffer': WITH AgingBuffer DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Amount 1");
                ReportForNav.AddTotal(DataItemId,1,"Amount 2");
                ReportForNav.AddTotal(DataItemId,2,"Amount 3");
                ReportForNav.AddTotal(DataItemId,3,"Amount 4");
                ReportForNav.AddTotal(DataItemId,4,"Amount 5");
              END;
           'Restore': BEGIN
                 "Amount 1" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount 2" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Amount 3" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Amount 4" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Amount 5" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70518 ForNAV Tax Purchase Templ.
{
  OBJECT-PROPERTIES
  {
    Date=09-02-18;
    Time=17:40:51;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Tax Purchase Template;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               MaxIteration=1;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70519 ForNAV Sales Templ. Sales Tax
{
  OBJECT-PROPERTIES
  {
    Date=09-02-18;
    Time=17:40:26;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Sales Template Sales Tax;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               MaxIteration=1;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70526 ForNAV Template - Landscape
{
  OBJECT-PROPERTIES
  {
    Date=31-01-18;
    Time=08:40:12;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Template - Landscape;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table2000000026;
               MaxIteration=1 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70527 ForNAV Template
{
  OBJECT-PROPERTIES
  {
    Date=02-02-18;
    Time=09:27:27;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table2000000026;
               MaxIteration=1 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moßnosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70528 ForNAV Purchase Template
{
  OBJECT-PROPERTIES
  {
    Date=09-02-18;
    Time=17:40:05;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Purchase Template;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               MaxIteration=1;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70529 ForNAV Sales Template
{
  OBJECT-PROPERTIES
  {
    Date=09-02-18;
    Time=17:39:41;
    Modified=Yes;
    Version List=SHIP,FORNAV3.0.0.1428/1428;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Sales Template;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := ReportForNavAllowDesign;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               MaxIteration=1;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi°;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukumÑÑrÑ;
                             FRA=Nombre de copies;
                             ISL=Fjîldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=Nß copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=Nß copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1428, Version=3.0.0.1428, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Codeunit 70000 ForNAV Check Document Discount
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE HasDiscount@1000000001(Rec@1000000000 : Variant) : Boolean;
    VAR
      RecRefLib@1000000002 : Codeunit 70090;
      TestValidDociFace@1000000003 : Codeunit 70080;
      RecRef@1000000001 : RecordRef;
    BEGIN
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      TestValidDociFace.ThrowErrorIfNotValid(RecRef);
      EXIT(CheckLinesTableForDiscount(RecRef, FindDiscountFieldNoInLines(RecRef)));
    END;

    LOCAL PROCEDURE FindDiscountFieldNoInLines@1000000009(RecRef@1000000001 : RecordRef) : Integer;
    VAR
      Field@1000000000 : Record 2000000041;
      NoDiscountFieldErr@1000000002 : TextConst 'ENU=The connected line table does not contain a valid field for Line Discount.';
    BEGIN
      Field.SETRANGE(TableNo, RecRef.NUMBER + 1);
      Field.SETRANGE(FieldName, 'Line Discount %');
      IF NOT Field.FINDFIRST THEN
        ERROR(NoDiscountFieldErr);

      EXIT(Field."No.");
    END;

    LOCAL PROCEDURE CheckLinesTableForDiscount@1000000011(VAR RecRef@1000000000 : RecordRef;FieldNo@1000000001 : Integer) : Boolean;
    VAR
      RecRefLib@1000000004 : Codeunit 70090;
      LineRec@1000000003 : RecordRef;
      FldRef@1000000002 : FieldRef;
    BEGIN
      LineRec.OPEN(RecRef.NUMBER + 1);

      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'No.');
      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'Document Type');

      FldRef := LineRec.FIELD(FieldNo);
      FldRef.SETFILTER('<>0');
      EXIT(NOT LineRec.ISEMPTY);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70001 ForNAV Get Vat Amount Lines
{
  OBJECT-PROPERTIES
  {
    Date=12-12-17;
    Time=12:25:38;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetVatAmountLines@1000000000(Rec@1000000000 : Variant;VAR VATAmountLine@1000000001 : TEMPORARY Record 290);
    VAR
      DocLineBuffer@1000000006 : TEMPORARY Record 70999;
      RecRefLib@1000000002 : Codeunit 70090;
      TestValidDociFace@1000000004 : Codeunit 70080;
      RecRef@1000000003 : RecordRef;
      LineRec@1000000005 : RecordRef;
    BEGIN
      ThrowErrorIfNotTemp(VATAmountLine);
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      TestValidDociFace.ThrowErrorIfNotValid(RecRef);
      FindLinesRecRef(DocLineBuffer, RecRef, LineRec);
      CreateVATAmountLine(DocLineBuffer, VATAmountLine);
    END;

    LOCAL PROCEDURE ThrowErrorIfNotTemp@1000000001(VAR VATAmountLine@1000000000 : Record 290);
    VAR
      CheckTemporary@1000000002 : Codeunit 70008;
    BEGIN
      CheckTemporary.IsTemporary(VATAmountLine, TRUE);
    END;

    LOCAL PROCEDURE FindLinesRecRef@1000000003(VAR DocLineBuffer@1000000004 : Record 70999;VAR RecRef@1000000000 : RecordRef;VAR LineRec@1000000001 : RecordRef);
    VAR
      RecRefLib@1000000002 : Codeunit 70090;
      FldRef@1000000003 : FieldRef;
    BEGIN
      LineRec.OPEN(RecRef.NUMBER + 1);

      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'No.');
      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'Document Type');
      IF LineRec.FINDSET THEN REPEAT
        DocLineBuffer.CreateForRecRef(LineRec);
      UNTIL LineRec.NEXT = 0;
    END;

    LOCAL PROCEDURE CreateVATAmountLine@1000000002(VAR DocLineBuffer@1000000001 : Record 70999;VAR VATAmountLine@1000000000 : Record 290);
    BEGIN
      WITH DocLineBuffer DO
        IF FINDSET THEN REPEAT
          VATAmountLine.INIT;
          VATAmountLine."VAT Identifier" := "VAT Identifier";
          VATAmountLine."VAT Calculation Type" := "VAT Calculation Type";
          VATAmountLine."Tax Group Code" := "Tax Group Code";
          VATAmountLine."VAT %" := "VAT %";
          VATAmountLine."VAT Base" := Amount;
          VATAmountLine."Amount Including VAT" := "Amount Including VAT";
          VATAmountLine."Line Amount" := "Line Amount";
          IF "Allow Invoice Disc." THEN
            VATAmountLine."Inv. Disc. Base Amount" := "Line Amount";
          VATAmountLine."Invoice Discount Amount" := "Inv. Discount Amount";
          VATAmountLine."VAT Clause Code" := "VAT Clause Code";
          IF ("VAT %" <> 0) OR ("VAT Clause Code" <> '') OR (Amount <> "Amount Including VAT") THEN
            VATAmountLine.InsertLine;
        UNTIL NEXT = 0;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70002 ForNAV Get Vat Clause
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      TryGetVATClause@1000000000 : Integer;

    PROCEDURE GetVATClauses@1000000000(VAR VATAmountLine@1000000001 : TEMPORARY Record 290;VAR VATClause@1000000000 : Record 560;LanguageCode@1000000002 : Code[10]);
    BEGIN
      WITH VATAmountLine DO
        IF FINDSET THEN REPEAT
          TryGetVATClauseText(VATClause, "VAT Clause Code", LanguageCode);
        UNTIL NEXT = 0;
    END;

    LOCAL PROCEDURE TryGetVATClauseText@1000000002(VAR VATClausePar@1000000000 : Record 560;VATClauseCode@1000000002 : Code[10];LanguageCode@1000000003 : Code[10]);
    VAR
      VATClause@1000000001 : Record 560;
    BEGIN
      IF NOT VATClause.GET(VATClauseCode) THEN
        EXIT;

      VATClause.TranslateDescription(LanguageCode);

      VATClausePar := VATClause;
      IF VATClausePar.INSERT THEN;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70003 ForNAV Update No. Printed
{
  OBJECT-PROPERTIES
  {
    Date=14-09-17;
    Time=12:08:51;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    Permissions=TableData 36=rm,
                TableData 38=rm,
                TableData 110=rm,
                TableData 112=rm,
                TableData 114=rm,
                TableData 120=rm,
                TableData 122=rm,
                TableData 124=rm;
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE UpdateNoPrinted@1000000001(Rec@1000000000 : Variant;Preview@1000 : Boolean);
    VAR
      RecRefLib@1000000003 : Codeunit 70090;
      TestValidDociFace@1000000002 : Codeunit 70080;
      RecRef@1000000001 : RecordRef;
    BEGIN
      IF Preview THEN
        EXIT;

      RecRefLib.ConvertToRecRef(Rec, RecRef);
      TestValidDociFace.ThrowErrorIfNotValid(RecRef);
      FindAndUpdateField(RecRef);
    END;

    LOCAL PROCEDURE FindAndUpdateField@1000000003(VAR RecRef@1000000000 : RecordRef);
    VAR
      Field@1000000001 : Record 2000000041;
      FldRef@1000000003 : FieldRef;
      NoPrinted@1000000004 : Integer;
    BEGIN
      Field.SETRANGE(TableNo, RecRef.NUMBER);
      Field.SETRANGE(FieldName, 'No. Printed');
      IF NOT Field.FINDFIRST THEN
        EXIT;

      FldRef := RecRef.FIELD(Field."No.");
      NoPrinted := FldRef.VALUE;
      NoPrinted +=1;
      FldRef.VALUE := NoPrinted;
      RecRef.MODIFY;
      COMMIT;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70004 ForNAV Get Sales Tax Details
{
  OBJECT-PROPERTIES
  {
    Date=12-12-17;
    Time=12:25:24;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetSalesTax@1000000000(Rec@1000000000 : Variant;VAR SalesTaxBuffer@1000000001 : TEMPORARY Record 70998);
    VAR
      DocLineBuffer@1000000006 : TEMPORARY Record 70999;
      RecRefLib@1000000002 : Codeunit 70090;
      TestValidDociFace@1000000004 : Codeunit 70080;
      RecRef@1000000003 : RecordRef;
      LineRec@1000000005 : RecordRef;
    BEGIN
      ThrowErrorIfNotTemp(SalesTaxBuffer);
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      TestValidDociFace.ThrowErrorIfNotValid(RecRef);
      FindLinesRecRef(DocLineBuffer, RecRef, LineRec);
      CreateSalesTaxDetails(DocLineBuffer, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE ThrowErrorIfNotTemp@1000000001(VAR SalesTaxBuffer@1000000000 : Record 70998);
    VAR
      CheckTemporary@1000000001 : Codeunit 70008;
    BEGIN
      CheckTemporary.IsTemporary(SalesTaxBuffer, TRUE);
    END;

    LOCAL PROCEDURE FindLinesRecRef@1000000003(VAR DocLineBuffer@1000000004 : Record 70999;VAR RecRef@1000000000 : RecordRef;VAR LineRec@1000000001 : RecordRef);
    VAR
      RecRefLib@1000000002 : Codeunit 70090;
      FldRef@1000000003 : FieldRef;
    BEGIN
      LineRec.OPEN(RecRef.NUMBER + 1);

      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'No.');
      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'Document Type');
      IF LineRec.FINDSET THEN REPEAT
        DocLineBuffer.CreateForRecRef(LineRec);
      UNTIL LineRec.NEXT = 0;
    END;

    LOCAL PROCEDURE CreateSalesTaxDetails@1000000002(VAR DocLineBuffer@1000000001 : Record 70999;VAR SalesTaxBuffer@1000000000 : Record 70998);
    BEGIN
      SalesTaxBuffer.INIT;
      SalesTaxBuffer.INSERT;

      WITH DocLineBuffer DO
        IF FINDSET THEN REPEAT
          IF "VAT %" = 0 THEN
            SalesTaxBuffer."Exempt Amount" := SalesTaxBuffer."Exempt Amount" + Amount
          ELSE
            SalesTaxBuffer."Taxable Amount" := SalesTaxBuffer."Taxable Amount" + Amount;
          SalesTaxBuffer.MODIFY;
        UNTIL NEXT = 0;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70005 ForNAV Detect Localization
{
  OBJECT-PROPERTIES
  {
    Date=20-07-17;
    Time=19:43:26;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE CheckLocalizationBasedOnTables@1(VAR ForNAVSetup@1000 : Record 70000);
    VAR
      AllObjWithCaption@1001 : Record 2000000058;
    BEGIN
      WITH AllObjWithCaption DO BEGIN
        SETRANGE("Object Type", "Object Type"::Table);
        SETRANGE("Object ID", 10000);
        IF NOT ISEMPTY THEN BEGIN
          ForNAVSetup.Localization := ForNAVSetup.Localization::"North America";
          EXIT;
        END;
        SETRANGE("Object Type", "Object Type"::Table);
        SETRANGE("Object ID", 11000, 49999);
        IF NOT ISEMPTY THEN BEGIN
          ForNAVSetup.Localization := ForNAVSetup.Localization::Other;
          EXIT;
        END;

        ForNAVSetup.Localization := ForNAVSetup.Localization::"World Wide";

      END;
    END;

    PROCEDURE ValidateCurrentLocalization@2(ForNAVSetup@1000 : Record 70000) : Boolean;
    VAR
      ForNAVSetupSetLocalization@1001 : Record 70000;
    BEGIN
      CheckLocalizationBasedOnTables(ForNAVSetupSetLocalization);
      EXIT(ForNAVSetupSetLocalization.Localization = ForNAVSetup.Localization);
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70006 ForNAV Read Watermarks
{
  OBJECT-PROPERTIES
  {
    Date=12-09-17;
    Time=11:59:17;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ReadFromFile@1(VAR ForNAVSetup@1004 : Record 70000;Which@1003 : Integer) : Boolean;
    VAR
      TempBlob@1002 : TEMPORARY Record 99008535;
      FileMgt@1001 : Codeunit 419;
      FileName@1000 : Text;
    BEGIN
      FileName := FileMgt.BLOBImport(TempBlob,'');

      WITH ForNAVSetup DO
        IF FileName <> '' THEN BEGIN
          CASE Which OF
            FIELDNO(Logo):
              BEGIN
                Logo := TempBlob.Blob;
                "Logo File Name" := GetFileNameFromFile(FileName);
              END;
            FIELDNO("Document Watermark"):
              BEGIN
               "Document Watermark" := TempBlob.Blob;
                "Document Watermark File Name" := GetFileNameFromFile(FileName);
              END;
            FIELDNO("List Report Watermark"):
              BEGIN
                "List Report Watermark" := TempBlob.Blob;
                "List Report Watermark File N." := GetFileNameFromFile(FileName);
              END;
          END;
          EXIT(TRUE);
        END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE GetFileNameFromFile@3(Value@1000 : Text) : Text;
    VAR
      LastPos@1001 : Integer;
      i@1002 : Integer;
    BEGIN
      WHILE i < STRLEN(Value) DO BEGIN
        i := i + 1;
        IF Value[i] = '\' THEN
          LastPos := i;
      END;

      EXIT(COPYSTR(Value, LastPos + 1));
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70007 ForNAV Get No. of Copies
{
  OBJECT-PROPERTIES
  {
    Date=20-12-17;
    Time=12:47:50;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetNoOfCopies@1000000001(Rec@1000000000 : Variant) : Integer;
    VAR
      RecRefLib@1000000003 : Codeunit 70090;
      TestValidDociFace@1000000002 : Codeunit 70080;
      RecRef@1000000001 : RecordRef;
    BEGIN
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      IF NOT TestValidDociFace.CheckValid(RecRef) THEN
        EXIT(0);

      EXIT(FindNoOfCopiesFromBillToCustomerNo(RecRef));
    END;

    LOCAL PROCEDURE FindNoOfCopiesFromBillToCustomerNo@1000000003(VAR RecRef@1000000000 : RecordRef) : Integer;
    VAR
      Customer@1000000002 : Record 18;
      Field@1000000001 : Record 2000000041;
      FldRef@1000000003 : FieldRef;
    BEGIN
      Field.SETRANGE(TableNo, RecRef.NUMBER);
      Field.SETRANGE(FieldName, 'Bill-to Customer No.');
      IF NOT Field.FINDFIRST THEN
        EXIT(0);

      FldRef := RecRef.FIELD(Field."No.");
      Customer.GET(FldRef.VALUE);
      EXIT(Customer."Invoice Copies");
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70008 ForNAV Check Temporary
{
  OBJECT-PROPERTIES
  {
    Date=12-12-17;
    Time=14:30:31;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE IsTemporary@1000000001(Rec@1000000001 : Variant;ThrowError@1000000000 : Boolean) : Boolean;
    VAR
      RecRef@1000000002 : RecordRef;
      RecordRefLibrary@1000000003 : Codeunit 70090;
      RecordShouldBeTempErr@1000000004 : TextConst 'ENU=The Record Variable (%1) must be temporary when callng this API.';
    BEGIN
      RecordRefLibrary.ConvertToRecRef(Rec, RecRef);
      IF RecRef.ISTEMPORARY THEN
        EXIT(FALSE);

      IF ThrowError THEN
        ERROR(RecordShouldBeTempErr, RecRef.NAME);

      EXIT(TRUE);
    END;

    BEGIN
    {
      We use this codeunit because ReportsForNAV is backwards compatible with NAV 2015. This version does not support ISTEMPORARY on record variables
    }
    END.
  }
}

OBJECT Codeunit 70009 ForNAV First Time Setup
{
  OBJECT-PROPERTIES
  {
    Date=12-09-17;
    Time=13:17:24;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            IF CheckIfSetupExists THEN
              EXIT;

            AskForDefault;
            RunWizardIfSetupDoesNotExist;
          END;

  }
  CODE
  {

    LOCAL PROCEDURE CheckIfSetupExists@2() : Boolean;
    VAR
      ForNAVSetup@1000 : Record 70000;
    BEGIN
      EXIT(ForNAVSetup.GET);
    END;

    LOCAL PROCEDURE AskForDefault@3();
    VAR
      SetDefaultsQst@1000 : TextConst 'ENU=Do you want to setup ForNAV with default values?';
      ForNAVSetup@1001 : Record 70000;
    BEGIN
      IF NOT CONFIRM(SetDefaultsQst, TRUE) THEN
        EXIT;

      ForNAVSetup.InitSetup;
      ForNAVSetup.CreateWebService;
      ForNAVSetup.ReplaceReportSelection(TRUE);
      COMMIT;
    END;

    LOCAL PROCEDURE RunWizardIfSetupDoesNotExist@4();
    VAR
      ForNAVSetup@1000 : Record 70000;
    BEGIN
      IF ForNAVSetup.GET THEN
        EXIT;

      PAGE.RUNMODAL(PAGE::"ForNAV Setup Wizard");

      IF ForNAVSetup.GET THEN
        COMMIT;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70019 ForNAV Notifications
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Codeunit,1,OnAfterFindPrinter,"",Skip,Skip)]
    LOCAL PROCEDURE OnFindPrinter@2(ReportID@1000 : Integer;VAR PrinterName@1001 : Text[250]);
    BEGIN
      ShowSetupNotification;
    END;

    LOCAL PROCEDURE ShowSetupNotification@1();
    VAR
      MyNotifications@1006 : Record 1518;
      ForNAVSetup@1001 : Record 70000;
      NotificationIDs@1004 : Codeunit 70022;
      MyNotification@1000 : Notification;
      ForNAVNotSetup@1002 : TextConst 'ENU=ForNAV is installed but not setup. Do you want to do this now?';
      Yes@1003 : TextConst 'ENU=Yes';
      NoAndDontAskAgain@1005 : TextConst 'ENU=No, and please don''t remind me again.';
    BEGIN
      IF ForNAVSetup.GET THEN
        EXIT;

      IF NOT MyNotifications.IsEnabled(NotificationIDs.SetupForNAV) THEN
        EXIT;

      MyNotification.ID := NotificationIDs.SetupForNAV;
      MyNotification.MESSAGE := ForNAVNotSetup;
      MyNotification.ADDACTION(Yes, CODEUNIT::"ForNAV Notification Actions", 'SetupForNAV');
      MyNotification.ADDACTION(NoAndDontAskAgain, CODEUNIT::"ForNAV Notification Actions", 'DisableSetup');
      MyNotification.SEND;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70020 ForNAV Notification Actions
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE SetupForNAV@2(VAR MyNotification@1000 : Notification);
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
    END;

    PROCEDURE DisableSetup@1(VAR MyNotification@1000 : Notification);
    VAR
      MyNotifications@1001 : Record 1518;
      NotificationID@1002 : GUID;
    BEGIN
      MyNotifications.LOCKTABLE;
      NotificationID := MyNotification.ID;
      IF MyNotifications.GET(USERID, NotificationID) THEN BEGIN
        MyNotifications.Enabled := FALSE;
        MyNotifications.MODIFY;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70021 ForNAV Initialize Notification
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Page,1518,OnInitializingNotificationWithDefaultState,"",Skip,Skip)]
    LOCAL PROCEDURE OnInitializingNotificationWithDefaultState@2();
    VAR
      MyNotifications@1000 : Record 1518;
      SetupForNAVTxt@1001 : TextConst 'ENU=Ask to setup ForNAV.';
      SetupForNAVDescriptionTxt@1002 : TextConst 'ENU=If you have ForNAV installed but don''t want to use it, switch off receiving the notification.';
      NotificationIDs@1003 : Codeunit 70022;
    BEGIN
      MyNotifications.InsertDefaultWithTableNum(NotificationIDs.SetupForNAV,
        SetupForNAVTxt,
        SetupForNAVDescriptionTxt,
        DATABASE::"ForNAV Setup");
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70022 ForNAV Notification IDs
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE SetupForNAV@2() : Text;
    BEGIN
      EXIT('cf8edf36-45c2-44c9-8367-cac5748bd597');
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70029 ForNAV Replace Report Sel.
{
  OBJECT-PROPERTIES
  {
    Date=20-07-17;
    Time=20:16:47;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            ReplaceSalesOrderConfirmation;
            ReplaceSalesInvoice;
            ReplaceSalesCreditMemo;
            ReplaceSalesShipment;
            ReplaceSalesQuote;
            ReplacePurchaseOrder;
            ReplacePurchaseInvoice;
            ReplacePurchaseQuote;
            ReplacePurchaseCreditMemo;
            //ReplaceReminder;
          END;

  }
  CODE
  {

    LOCAL PROCEDURE ReplaceSalesOrderConfirmation@1000000001();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Order");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Order";
        Sequence := '1';
        "Report ID" := FindReportID('Order Confirmation', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesInvoice@1000000000();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Invoice");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Invoice";
        Sequence := '1';
        "Report ID" := FindReportID('Sales Invoice', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesCreditMemo@1000000002();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Cr.Memo");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Cr.Memo";
        Sequence := '1';
        "Report ID" := FindReportID('Credit Memo', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesShipment@1000000009();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Shipment");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Shipment";
        Sequence := '1';
        "Report ID" := FindReportID('Sales Shipment', '');
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesQuote@1000000008();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Quote");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Quote";
        Sequence := '1';
        "Report ID" := FindReportID('Sales Quote', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseOrder@1000000005();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Order");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Order";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Order', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseQuote@1000000010();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Quote");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Quote";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Quote', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseInvoice@1000000003();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Invoice");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Invoice";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Invoice', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseCreditMemo@1000000007();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Cr.Memo");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Cr.Memo";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Cr. Memo', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceReminder@1000000006();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::Reminder);
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::Reminder;
        Sequence := '1';
        "Report ID" := FindReportID('Reminder', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE FindReportID@1000000004(ReportName@1000000001 : Text;Prefix@1000 : Text) : Integer;
    VAR
      AllObjWithCaption@1000000000 : Record 2000000058;
    BEGIN
      WITH AllObjWithCaption DO BEGIN
        SETRANGE("Object Type", "Object Type"::Report);
        SETRANGE("Object Name", 'ForNAV ' + Prefix +ReportName);
        FINDFIRST;
        EXIT("Object ID");
      END;
    END;

    LOCAL PROCEDURE GetPrefix@1() : Text;
    VAR
      ForNAVSetup@1000 : Record 70000;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."VAT Amount Specification" = ForNAVSetup."VAT Amount Specification"::"N/A. (Sales Tax)" THEN
        EXIT('Tax ');

      EXIT('VAT ');
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70080 ForNAV Test Valid Doc iFace
{
  OBJECT-PROPERTIES
  {
    Date=12-12-17;
    Time=12:26:24;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ThrowErrorIfNotValid@1000000000(VAR RecRef@1000000000 : RecordRef);
    VAR
      NotValidTableErr@1000000002 : TextConst 'ENU=This table (%1) is not supported for this function.';
    BEGIN
      IF NOT CheckValid(RecRef) THEN
        ERROR(NotValidTableErr, RecRef.CAPTION);
    END;

    PROCEDURE CheckValid@1000000001(VAR RecRef@1000000000 : RecordRef) : Boolean;
    BEGIN
      CASE RecRef.NUMBER OF
        DATABASE::"Sales Header":
          EXIT(TRUE);
        DATABASE::"Sales Shipment Header":
          EXIT(TRUE);
        DATABASE::"Sales Invoice Header":
          EXIT(TRUE);
        DATABASE::"Sales Cr.Memo Header":
          EXIT(TRUE);
        DATABASE::"Purchase Header":
          EXIT(TRUE);
        DATABASE::"Purch. Rcpt. Header":
          EXIT(TRUE);
        DATABASE::"Purch. Inv. Header":
          EXIT(TRUE);
        DATABASE::"Purch. Cr. Memo Hdr.":
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70090 ForNAV RecordRef Library
{
  OBJECT-PROPERTIES
  {
    Date=01-05-17;
    Time=12:00:00;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ConvertToRecRef@1000000002(VAR Rec@1000000000 : Variant;RecRef@1000000001 : RecordRef);
    VAR
      WrongDataTypeErr@1000000002 : TextConst 'ENU=Runtime Error: Wrong Datatype. Please contact your ForNAV reseller.';
    BEGIN
      CASE TRUE OF
        Rec.ISRECORDREF:
          RecRef := Rec;
        Rec.ISRECORD:
          RecRef.GETTABLE(Rec);
        ELSE
          ERROR(WrongDataTypeErr);
      END;
    END;

    PROCEDURE FindAndFilterieldNo@1000000003(VAR RecRef@1000000000 : RecordRef;VAR LineRec@1000000004 : RecordRef;VAR FldRef@1000000001 : FieldRef;Value@1000000005 : Text);
    VAR
      Field@1000000003 : Record 2000000041;
      DocumentNoField@1000000002 : FieldRef;
    BEGIN
      Field.SETRANGE(TableNo, RecRef.NUMBER);
      Field.SETRANGE(FieldName, Value);
      IF NOT Field.FINDFIRST THEN
        EXIT;

      DocumentNoField := RecRef.FIELD(Field."No.");

      Field.RESET;
      Field.SETRANGE(TableNo, RecRef.NUMBER + 1);
      Field.SETRANGE("No.", Field."No.");
      IF NOT Field.FINDFIRST THEN
        EXIT;

      FldRef := LineRec.FIELD(Field."No.");
      FldRef.SETRANGE(DocumentNoField.VALUE);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70206 ForNAV Trial Balance
{
  OBJECT-PROPERTIES
  {
    Date=02-02-18;
    Time=11:29:02;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetDataFromGLAccount@1000000000(VAR TrialBalance@1000000000 : Record 70206;VAR GLAccount@1000000001 : Record 15;VAR Args@1000000002 : Record 70205);
    VAR
      PriorFromDate@1000000004 : Date;
      PriorToDate@1000000003 : Date;
    BEGIN
      PriorFromDate := CALCDATE('<-1Y>',Args."From Date" + 1) - 1;
      PriorToDate := CALCDATE('<-1Y>',Args."To Date" + 1) - 1;

      WITH TrialBalance DO BEGIN
        GLAccount.SETRANGE("Date Filter",Args."From Date",Args."To Date");
        IF NOT Args."All Amounts in LCY" THEN BEGIN
          GLAccount.CALCFIELDS("Additional-Currency Net Change","Add.-Currency Balance at Date");
          "Net Change Actual" := GLAccount."Additional-Currency Net Change";
          "Balance at Date Actual" := GLAccount."Add.-Currency Balance at Date";
        END ELSE BEGIN
          GLAccount.CALCFIELDS("Net Change","Balance at Date");
          "Net Change Actual" := GLAccount."Net Change";
          "Balance at Date Actual" := GLAccount."Balance at Date";
        END;
        IF Args."Show by" = Args."Show by"::Budget THEN BEGIN
          GLAccount.CALCFIELDS("Budgeted Amount","Budget at Date");
          "Net Change Actual Last Year" := GLAccount."Budgeted Amount";
          "Balance at Date Act. Last Year" := GLAccount."Budget at Date";
        END ELSE BEGIN
          GLAccount.SETRANGE("Date Filter",PriorFromDate,PriorToDate);
          IF NOT Args."All Amounts in LCY" THEN BEGIN
            GLAccount.CALCFIELDS("Additional-Currency Net Change","Add.-Currency Balance at Date");
            "Net Change Actual Last Year" := GLAccount."Additional-Currency Net Change";
            "Balance at Date Act. Last Year" := GLAccount."Add.-Currency Balance at Date";
          END ELSE BEGIN
            GLAccount.CALCFIELDS("Net Change","Balance at Date");
            "Net Change Actual Last Year" := GLAccount."Net Change";
            "Balance at Date Act. Last Year" := GLAccount."Balance at Date";
          END;
        END;

        IF Args."Variance in Changes" OR Args."% Variance in Changes" THEN
          "Variance in Changes" := "Net Change Actual" - "Net Change Actual Last Year";
        IF Args."% Variance in Changes" AND ("Net Change Actual Last Year" <> 0) THEN
          "% Variance in Changes" := "Variance in Changes" / "Net Change Actual Last Year" * 100;
        IF Args."Variance in Balances" OR Args."% Variance in Balances" THEN
          "Variance in Balances"  := "Balance at Date Actual" - "Balance at Date Act. Last Year";
        IF Args."% Variance in Balances" AND ("Balance at Date Act. Last Year" <> 0) THEN
          "% Variance in Balances"  := "Variance in Balances"  / "Balance at Date Act. Last Year" * 100;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

      This codeunit is based on 10025 Paragraph Handling.
    }
    END.
  }
}

OBJECT Codeunit 70219 ForNAV Aging Calculation
{
  OBJECT-PROPERTIES
  {
    Date=06-12-17;
    Time=10:17:26;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetAging@1000000001(Rec@1000000000 : Variant;VAR AgingBuffer@1000000001 : Record 70220;VAR Args@1000000003 : Record 70219);
    VAR
      CustomerAging@1000000002 : Codeunit 70220;
      VendorAging@1000000004 : Codeunit 70221;
    BEGIN
      CASE GetAccountType(Rec) OF
        AgingBuffer."Account Type"::Customer:
          CustomerAging.GetAging(Rec, AgingBuffer, Args);
        AgingBuffer."Account Type"::Vendor:
          VendorAging.GetAging(Rec, AgingBuffer, Args);
      END;
    END;

    PROCEDURE GetAgingWithCurrency@1000000005(Rec@1000000000 : Variant;VAR AgingBuffer@1000000001 : Record 70220;VAR CurrAgingBuffer@1000000002 : Record 70220;VAR Args@1000000003 : Record 70219;VAR TempCurrency@1000000004 : TEMPORARY Record 4);
    VAR
      CustomerAging@1000000005 : Codeunit 70220;
      VendorAging@1000000006 : Codeunit 70221;
    BEGIN
      CASE GetAccountType(Rec) OF
        AgingBuffer."Account Type"::Customer:
          CustomerAging.GetAgingWithCurrency(Rec, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
        AgingBuffer."Account Type"::Vendor:
          VendorAging.GetAgingWithCurrency(Rec, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
      END;
    END;

    LOCAL PROCEDURE GetAccountType@1000000000(Rec@1000000001 : Variant) : Integer;
    VAR
      AgingBuffer@1000000004 : Record 70220;
      RecordRefLibrary@1000000002 : Codeunit 70090;
      UnsupportedTableErr@1000000000 : TextConst 'ENU=Unsupported Table';
      RecRef@1000000003 : RecordRef;
    BEGIN
      RecordRefLibrary.ConvertToRecRef(Rec, RecRef);
      CASE RecRef.NUMBER OF
        DATABASE::Customer:
          EXIT(AgingBuffer."Account Type"::Customer);
        DATABASE::Vendor:
          EXIT(AgingBuffer."Account Type"::Vendor);
        ELSE
          ERROR(UnsupportedTableErr);;
      END;
    END;

    PROCEDURE UpdateCurrencyTotals@7(VAR AgingBuffer@1000000002 : Record 70220;VAR CurrAgingBuffer@1000000001 : Record 70220;VAR TempCurrency@1000000000 : TEMPORARY Record 4);
    VAR
      i@1000 : Integer;
    BEGIN
      CurrAgingBuffer.RESET;
      CurrAgingBuffer.SETRANGE("Currency Code", AgingBuffer."Currency Code");
      IF NOT TempCurrency.GET(AgingBuffer."Currency Code") THEN BEGIN
        TempCurrency.Code := AgingBuffer."Currency Code";
        TempCurrency.INSERT;
        CurrAgingBuffer."Entry No." :=  TempCurrency.COUNT;
        CurrAgingBuffer."Currency Code" := AgingBuffer."Currency Code";
        CurrAgingBuffer.Amount := AgingBuffer.Amount;
        CurrAgingBuffer.Balance := AgingBuffer.Balance;
        CurrAgingBuffer."Amount 1" := AgingBuffer."Amount 1";
        CurrAgingBuffer."Amount 2" := AgingBuffer."Amount 2";
        CurrAgingBuffer."Amount 3" := AgingBuffer."Amount 3";
        CurrAgingBuffer."Amount 4" := AgingBuffer."Amount 4";
        CurrAgingBuffer."Amount 5" := AgingBuffer."Amount 5";
        CurrAgingBuffer.INSERT;
      END ELSE BEGIN
        CurrAgingBuffer.SETRANGE("Currency Code", AgingBuffer."Currency Code");
        CurrAgingBuffer.FINDFIRST;
        CurrAgingBuffer.Amount += AgingBuffer.Amount;
        CurrAgingBuffer.Balance += AgingBuffer.Balance;
        CurrAgingBuffer."Amount 1" += AgingBuffer."Amount 1";
        CurrAgingBuffer."Amount 2" += AgingBuffer."Amount 2";
        CurrAgingBuffer."Amount 3" += AgingBuffer."Amount 3";
        CurrAgingBuffer."Amount 4" += AgingBuffer."Amount 4";
        CurrAgingBuffer."Amount 5" += AgingBuffer."Amount 5";
        CurrAgingBuffer.MODIFY;
        CurrAgingBuffer.RESET;
      END;
    END;

    PROCEDURE GetCurrencyCode@1000000009(Value@1000000000 : Code[10]) : Code[10];
    VAR
      GLSetup@1000000001 : Record 98;
    BEGIN
      IF Value <> '' THEN
        EXIT(Value);

      GLSetup.GET;
      EXIT(GLSetup."LCY Code");
    END;

    PROCEDURE MoveValuesToPeriod@1000000006(VAR AgingBuffer@1000000000 : Record 70220;PeriodIndex@1000000001 : Integer);
    VAR
      Fld@1000000004 : Record 2000000041;
      RecRef@1000000002 : RecordRef;
      FldRef@1000000003 : FieldRef;
    BEGIN
      RecRef.GETTABLE(AgingBuffer);
      Fld.SETRANGE(TableNo, RecRef.NUMBER);
      Fld.SETRANGE(FieldName, 'Amount ' + FORMAT(PeriodIndex));
      Fld.FINDFIRST;
      FldRef := RecRef.FIELD(Fld."No.");

      FldRef.VALUE := AgingBuffer.Balance;

      Fld.SETRANGE(FieldName, 'Amount ' + FORMAT(PeriodIndex) + ' (LCY)');
      Fld.FINDFIRST;
      FldRef := RecRef.FIELD(Fld."No.");

      FldRef.VALUE := AgingBuffer."Balance (LCY)";

      RecRef.SETTABLE(AgingBuffer);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70220 ForNAV Customer Aging
{
  OBJECT-PROPERTIES
  {
    Date=22-01-18;
    Time=14:24:09;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      TempCustLedgEntry@1000000003 : TEMPORARY Record 21;

    PROCEDURE GetAging@1000000001(VAR Cust@1000000000 : Record 18;VAR AgingBuffer@1000000001 : Record 70220;VAR Args@1000000003 : Record 70219);
    VAR
      CurrAgingBuffer@1000000004 : TEMPORARY Record 70220;
      TempCurrency@1000000002 : TEMPORARY Record 4;
    BEGIN
      GetAgingWithCurrency(Cust, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
    END;

    PROCEDURE GetAgingWithCurrency@1000000005(VAR Cust@1000000000 : Record 18;VAR AgingBuffer@1000000001 : Record 70220;VAR CurrAgingBuffer@1000000002 : Record 70220;VAR Args@1000000003 : Record 70219;VAR TempCurrency@1000000004 : TEMPORARY Record 4);
    BEGIN
      ClearData(AgingBuffer);
      GetBasedOnDetailedEntry(Cust, Args);
      GetBasedOnOpenEntry(Cust, Args);
      CreateAgingBuffer(Cust, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
      AgingBuffer.SetCaptions(Args);
    END;

    LOCAL PROCEDURE GetBasedOnDetailedEntry@1000000002(VAR Cust@1000000002 : Record 18;VAR Args@1000000003 : Record 70219);
    VAR
      DetailedCustLedgEntry@1000000000 : Record 379;
      CustLedgEntry@1000000001 : Record 21;
    BEGIN
      WITH DetailedCustLedgEntry DO BEGIN
        SETCURRENTKEY("Customer No.", "Posting Date", "Entry Type", "Currency Code");
        SETRANGE("Customer No.", Cust."No.");
        SETRANGE("Entry Type", DetailedCustLedgEntry."Entry Type"::Application);
        SETRANGE("Posting Date", 0D, Args."Ending Date");
        SETFILTER("Posting Date", '%1..', Args."Ending Date" + 1);

        IF FINDSET THEN REPEAT
          IF CustLedgEntry.GET("Cust. Ledger Entry No.") THEN
            IF CustLedgEntry.Open THEN BEGIN
              CustLedgEntry.SETRANGE("Date Filter",0D, Args."Ending Date");
              CustLedgEntry.CALCFIELDS("Remaining Amount");
              IF CustLedgEntry."Remaining Amount" <> 0 THEN
                InsertTemp(CustLedgEntry);
          END;
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE GetBasedOnOpenEntry@1000000003(VAR Cust@1000000000 : Record 18;VAR Args@1000000002 : Record 70219);
    VAR
      CustLedgEntry@1000000001 : Record 21;
    BEGIN
      WITH CustLedgEntry DO BEGIN
        SETCURRENTKEY("Customer No.", Open, Positive, "Due Date", "Currency Code");
        SETRANGE("Customer No.", Cust."No.");
        SETRANGE(Open, TRUE);

        IF Args."Aging By" = Args."Aging By"::"Posting Date" THEN BEGIN
          SETRANGE("Posting Date", 0D, Args."Ending Date");
          SETRANGE("Date Filter", 0D, Args."Ending Date");
        END;

        IF FINDSET THEN REPEAT
        IF Args."Aging By" = Args."Aging By"::"Posting Date" THEN BEGIN
           CALCFIELDS("Remaining Amt. (LCY)");
           IF "Remaining Amt. (LCY)" <> 0 THEN
             InsertTemp(CustLedgEntry);
         END ELSE
           InsertTemp(CustLedgEntry);
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE CreateAgingBuffer@1000000015(VAR Cust@1000000002 : Record 18;VAR AgingBuffer@1000000001 : Record 70220;VAR CurrAgingBuffer@1000000000 : Record 70220;VAR Args@1000000003 : Record 70219;VAR TempCurrency@1000000006 : TEMPORARY Record 4);
    VAR
      DetailedCustLedgEntry@1000000004 : Record 379;
      AgingCalculation@1000000007 : Codeunit 70219;
      PeriodIndex@1000000005 : Integer;
    BEGIN
      WITH TempCustLedgEntry DO
        IF FINDSET THEN REPEAT
          AgingBuffer.INIT;
          AgingBuffer."Entry No." := "Entry No.";
          AgingBuffer."Account No." := "Customer No.";
          AgingBuffer.GetAccountName;
          AgingBuffer."Credit Limit (LCY)" := Cust."Credit Limit (LCY)";
          IF NOT Args."Print Amounts in LCY" THEN
            AgingBuffer."Currency Code" := AgingCalculation.GetCurrencyCode("Currency Code");
          AgingBuffer."Document No." := "Document No.";
          AgingBuffer."External Document No." := "External Document No.";
          AgingBuffer."Document Type" := "Document Type";
          AgingBuffer."Document Date" := "Document Date";
          AgingBuffer."Posting Date" := "Posting Date";
          AgingBuffer."Due Date" := "Due Date";

          DetailedCustLedgEntry.SETRANGE("Cust. Ledger Entry No.",TempCustLedgEntry."Entry No.");
          IF DetailedCustLedgEntry.FINDSET THEN REPEAT
            IF (DetailedCustLedgEntry."Entry Type" = DetailedCustLedgEntry."Entry Type"::"Initial Entry") AND
               (TempCustLedgEntry."Posting Date" > Args."Ending Date") AND (Args."Aging By" <> Args."Aging By"::"Posting Date")
            THEN BEGIN
              IF TempCustLedgEntry."Document Date" <= Args."Ending Date" THEN
                DetailedCustLedgEntry."Posting Date" :=  TempCustLedgEntry."Document Date"
              ELSE
                IF (TempCustLedgEntry."Due Date" <= Args."Ending Date") AND (Args."Aging By" = Args."Aging By"::"Due Date") THEN
                  DetailedCustLedgEntry."Posting Date" := TempCustLedgEntry."Due Date";
            END;
            IF (DetailedCustLedgEntry."Posting Date" <= Args."Ending Date") OR
               (TempCustLedgEntry.Open AND (Args."Aging By" = Args."Aging By"::"Due Date") AND (TempCustLedgEntry."Due Date" > Args."Ending Date") AND (TempCustLedgEntry."Posting Date" <= Args."Ending Date"))
            THEN BEGIN
              IF DetailedCustLedgEntry."Entry Type" IN
                 [DetailedCustLedgEntry."Entry Type"::"Initial Entry",
                  DetailedCustLedgEntry."Entry Type"::"Unrealized Loss",
                  DetailedCustLedgEntry."Entry Type"::"Unrealized Gain",
                  DetailedCustLedgEntry."Entry Type"::"Realized Loss",
                  DetailedCustLedgEntry."Entry Type"::"Realized Gain",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount (VAT Excl.)",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount (VAT Adjustment)",
                  DetailedCustLedgEntry."Entry Type"::"Payment Tolerance",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount Tolerance",
                  DetailedCustLedgEntry."Entry Type"::"Payment Tolerance (VAT Excl.)",
                  DetailedCustLedgEntry."Entry Type"::"Payment Tolerance (VAT Adjustment)",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount Tolerance (VAT Excl.)",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount Tolerance (VAT Adjustment)"]
              THEN BEGIN
                IF NOT Args."Print Amounts in LCY" THEN
                  AgingBuffer.Amount += DetailedCustLedgEntry.Amount
                ELSE
                  AgingBuffer.Amount += DetailedCustLedgEntry."Amount (LCY)";
                AgingBuffer."Amount (LCY)" += DetailedCustLedgEntry."Amount (LCY)";
              END;

              IF DetailedCustLedgEntry."Posting Date" <= Args."Ending Date" THEN BEGIN
                IF NOT Args."Print Amounts in LCY" THEN
                  AgingBuffer.Balance += DetailedCustLedgEntry.Amount
                ELSE
                  AgingBuffer.Balance += DetailedCustLedgEntry."Amount (LCY)";
                AgingBuffer."Balance (LCY)" += DetailedCustLedgEntry."Amount (LCY)";

              END;
            END;
          UNTIL DetailedCustLedgEntry.NEXT = 0;

          IF AgingBuffer.Balance <> 0 THEN BEGIN
            CASE Args."Aging By" OF
             Args."Aging By"::"Due Date":
               PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Due Date");
             Args."Aging By"::"Posting Date":
               PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Posting Date");
             Args."Aging By"::"Document Date":
               BEGIN
                 IF AgingBuffer."Document Date" > Args."Ending Date" THEN BEGIN
                   AgingBuffer.Balance := 0;
                   AgingBuffer."Balance (LCY)" := 0;
                   AgingBuffer."Document Date" := AgingBuffer."Posting Date";
                 END;
                 PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Document Date");
               END;
            END;

            AgingCalculation.MoveValuesToPeriod(AgingBuffer, PeriodIndex);

            AgingBuffer.INSERT;
            IF NOT Args."Print Amounts in LCY" THEN
              AgingCalculation.UpdateCurrencyTotals(AgingBuffer, CurrAgingBuffer, TempCurrency);
         END;
        UNTIL NEXT = 0;
    END;

    LOCAL PROCEDURE InsertTemp@1000000004(VAR CustLedgEntry@1000000000 : Record 21);
    BEGIN
      WITH TempCustLedgEntry DO BEGIN
        IF GET(CustLedgEntry."Entry No.") THEN
          EXIT;

        TempCustLedgEntry := CustLedgEntry;

        INSERT;
      END;
    END;

    LOCAL PROCEDURE ClearData@1000000000(VAR AgingBuffer@1000000001 : Record 70220);
    BEGIN
      AgingBuffer.RESET;
      AgingBuffer.DELETEALL;
      TempCustLedgEntry.RESET;
      TempCustLedgEntry.DELETEALL;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70221 ForNAV Vendor Aging
{
  OBJECT-PROPERTIES
  {
    Date=22-01-18;
    Time=14:24:21;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      TempVendorLedgerEntry@1000000003 : TEMPORARY Record 25;

    PROCEDURE GetAging@1000000001(VAR Vend@1000000000 : Record 23;VAR AgingBuffer@1000000001 : Record 70220;VAR Args@1000000003 : Record 70219);
    VAR
      CurrAgingBuffer@1000000004 : TEMPORARY Record 70220;
      TempCurrency@1000000002 : TEMPORARY Record 4;
    BEGIN
      GetAgingWithCurrency(Vend, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
    END;

    PROCEDURE GetAgingWithCurrency@1000000005(VAR Vend@1000000000 : Record 23;VAR AgingBuffer@1000000001 : Record 70220;VAR CurrAgingBuffer@1000000002 : Record 70220;VAR Args@1000000003 : Record 70219;VAR TempCurrency@1000000004 : TEMPORARY Record 4);
    BEGIN
      ClearData(AgingBuffer);
      GetBasedOnDetailedEntry(Vend, Args);
      GetBasedOnOpenEntry(Vend, Args);
      CreateAgingBuffer(Vend, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
      AgingBuffer.SetCaptions(Args);
    END;

    LOCAL PROCEDURE GetBasedOnDetailedEntry@1000000002(VAR Vend@1000000002 : Record 23;VAR Args@1000000003 : Record 70219);
    VAR
      DetailedVendorLedgEntry@1000000000 : Record 380;
      VendorLedgerEntry@1000000001 : Record 25;
    BEGIN
      WITH DetailedVendorLedgEntry DO BEGIN
        SETCURRENTKEY("Vendor No.", "Posting Date", "Entry Type", "Currency Code");
        SETRANGE("Vendor No.", Vend."No.");
        SETRANGE("Entry Type", DetailedVendorLedgEntry."Entry Type"::Application);
        SETRANGE("Posting Date", 0D, Args."Ending Date");
        SETFILTER("Posting Date", '%1..', Args."Ending Date" + 1);

        IF FINDSET THEN REPEAT
          IF VendorLedgerEntry.GET("Vendor Ledger Entry No.") THEN
            IF VendorLedgerEntry.Open THEN BEGIN
              VendorLedgerEntry.SETRANGE("Date Filter",0D, Args."Ending Date");
              VendorLedgerEntry.CALCFIELDS("Remaining Amount");
              IF VendorLedgerEntry."Remaining Amount" <> 0 THEN
                InsertTemp(VendorLedgerEntry);
          END;
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE GetBasedOnOpenEntry@1000000003(VAR Vend@1000000000 : Record 23;VAR Args@1000000002 : Record 70219);
    VAR
      VendorLedgerEntry@1000000001 : Record 25;
    BEGIN
      WITH VendorLedgerEntry DO BEGIN
        SETCURRENTKEY("Vendor No.", Open, Positive, "Due Date", "Currency Code");
        SETRANGE("Vendor No.", Vend."No.");
        SETRANGE(Open, TRUE);

        IF Args."Aging By" = Args."Aging By"::"Posting Date" THEN BEGIN
          SETRANGE("Posting Date", 0D, Args."Ending Date");
          SETRANGE("Date Filter", 0D, Args."Ending Date");
        END;

        IF FINDSET THEN REPEAT
        IF Args."Aging By" = Args."Aging By"::"Posting Date" THEN BEGIN
           CALCFIELDS("Remaining Amt. (LCY)");
           IF "Remaining Amt. (LCY)" <> 0 THEN
             InsertTemp(VendorLedgerEntry);
         END ELSE
           InsertTemp(VendorLedgerEntry);
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE CreateAgingBuffer@1000000015(VAR Vend@1000000002 : Record 23;VAR AgingBuffer@1000000001 : Record 70220;VAR CurrAgingBuffer@1000000000 : Record 70220;VAR Args@1000000003 : Record 70219;VAR TempCurrency@1000000006 : TEMPORARY Record 4);
    VAR
      DetailedVendorLedgEntry@1000000004 : Record 380;
      AgingCalculation@1000000007 : Codeunit 70219;
      PeriodIndex@1000000005 : Integer;
    BEGIN
      WITH TempVendorLedgerEntry DO
        IF FINDSET THEN REPEAT
          AgingBuffer.INIT;
          AgingBuffer."Entry No." := "Entry No.";
          AgingBuffer."Account Type" := AgingBuffer."Account Type"::Vendor;
          AgingBuffer."Account No." := "Vendor No.";
          AgingBuffer.GetAccountName;
      //    AgingBuffer."Customer Credit Limit (LCY)" := Vend."Credit Limit (LCY)";
          IF NOT Args."Print Amounts in LCY" THEN
            AgingBuffer."Currency Code" := AgingCalculation.GetCurrencyCode("Currency Code");
          AgingBuffer."Document No." := "Document No.";
          AgingBuffer."External Document No." := "External Document No.";
          AgingBuffer."Document Type" := "Document Type";
          AgingBuffer."Document Date" := "Document Date";
          AgingBuffer."Posting Date" := "Posting Date";
          AgingBuffer."Due Date" := "Due Date";

          DetailedVendorLedgEntry.SETRANGE("Vendor Ledger Entry No.",TempVendorLedgerEntry."Entry No.");
          IF DetailedVendorLedgEntry.FINDSET THEN REPEAT
            IF (DetailedVendorLedgEntry."Entry Type" = DetailedVendorLedgEntry."Entry Type"::"Initial Entry") AND
               (TempVendorLedgerEntry."Posting Date" > Args."Ending Date") AND (Args."Aging By" <> Args."Aging By"::"Posting Date")
            THEN BEGIN
              IF TempVendorLedgerEntry."Document Date" <= Args."Ending Date" THEN
                DetailedVendorLedgEntry."Posting Date" :=  TempVendorLedgerEntry."Document Date"
              ELSE
                IF (TempVendorLedgerEntry."Due Date" <= Args."Ending Date") AND (Args."Aging By" = Args."Aging By"::"Due Date") THEN
                  DetailedVendorLedgEntry."Posting Date" := TempVendorLedgerEntry."Due Date";
            END;
            IF (DetailedVendorLedgEntry."Posting Date" <= Args."Ending Date") OR
               (TempVendorLedgerEntry.Open AND (Args."Aging By" = Args."Aging By"::"Due Date") AND (TempVendorLedgerEntry."Due Date" > Args."Ending Date") AND (TempVendorLedgerEntry."Posting Date" <= Args."Ending Date"))
            THEN BEGIN
              IF DetailedVendorLedgEntry."Entry Type" IN
                 [DetailedVendorLedgEntry."Entry Type"::"Initial Entry",
                  DetailedVendorLedgEntry."Entry Type"::"Unrealized Loss",
                  DetailedVendorLedgEntry."Entry Type"::"Unrealized Gain",
                  DetailedVendorLedgEntry."Entry Type"::"Realized Loss",
                  DetailedVendorLedgEntry."Entry Type"::"Realized Gain",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount (VAT Excl.)",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount (VAT Adjustment)",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Tolerance",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount Tolerance",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Tolerance (VAT Excl.)",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Tolerance (VAT Adjustment)",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount Tolerance (VAT Excl.)",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount Tolerance (VAT Adjustment)"]
              THEN BEGIN
                IF NOT Args."Print Amounts in LCY" THEN
                  AgingBuffer.Amount += DetailedVendorLedgEntry.Amount
                ELSE
                  AgingBuffer.Amount += DetailedVendorLedgEntry."Amount (LCY)";
                AgingBuffer."Amount (LCY)" += DetailedVendorLedgEntry."Amount (LCY)";
              END;

              IF DetailedVendorLedgEntry."Posting Date" <= Args."Ending Date" THEN BEGIN
                IF NOT Args."Print Amounts in LCY" THEN
                  AgingBuffer.Balance += DetailedVendorLedgEntry.Amount
                ELSE
                  AgingBuffer.Balance += DetailedVendorLedgEntry."Amount (LCY)";
                AgingBuffer."Balance (LCY)" += DetailedVendorLedgEntry."Amount (LCY)";

              END;
            END;
          UNTIL DetailedVendorLedgEntry.NEXT = 0;

          IF AgingBuffer.Balance <> 0 THEN BEGIN
            CASE Args."Aging By" OF
             Args."Aging By"::"Due Date":
               PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Due Date");
             Args."Aging By"::"Posting Date":
               PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Posting Date");
             Args."Aging By"::"Document Date":
               BEGIN
                 IF AgingBuffer."Document Date" > Args."Ending Date" THEN BEGIN
                   AgingBuffer.Balance := 0;
                   AgingBuffer."Balance (LCY)" := 0;
                   AgingBuffer."Document Date" := AgingBuffer."Posting Date";
                 END;
                 PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Document Date");
               END;
            END;

            AgingCalculation.MoveValuesToPeriod(AgingBuffer, PeriodIndex);

            AgingBuffer.INSERT;
            IF NOT Args."Print Amounts in LCY" THEN
              AgingCalculation.UpdateCurrencyTotals(AgingBuffer, CurrAgingBuffer, TempCurrency);
         END;
        UNTIL NEXT = 0;
    END;

    LOCAL PROCEDURE InsertTemp@1000000004(VAR VendorLedgerEntry@1000000000 : Record 25);
    BEGIN
      WITH TempVendorLedgerEntry DO BEGIN
        IF GET(VendorLedgerEntry."Entry No.") THEN
          EXIT;

        TempVendorLedgerEntry := VendorLedgerEntry;

        INSERT;
      END;
    END;

    LOCAL PROCEDURE ClearData@1000000000(VAR AgingBuffer@1000000001 : Record 70220);
    BEGIN
      AgingBuffer.RESET;
      AgingBuffer.DELETEALL;
      TempVendorLedgerEntry.RESET;
      TempVendorLedgerEntry.DELETEALL;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT MenuSuite 1060 ForNAV
{
  OBJECT-PROPERTIES
  {
    Date=29-11-17;
    Time=11:25:33;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  MENUNODES
  {
    {                ;[{7FD6154D-F047-4A31-B857-0DA1E0BA97D8}] ;NextNodeID=[{E55ED739-BBB9-4063-AF58-225E99C5FE72}] }
    { MenuItem       ;[{E55ED739-BBB9-4063-AF58-225E99C5FE72}] ;Name=Document Sending Profiles;
                                                                CaptionML=[ENU=Document Sending Profiles;
                                                                           NLD=Verzendprofielen van documenten];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=359;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{379BBC3B-5EBB-4617-8419-8D76352F8337}] ;Name=Electronic Document Formats;
                                                                CaptionML=[ENU=Electronic Document Formats;
                                                                           NLD=Elektronische documentindelingen];
                                                                ApplicationArea=#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=363;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{8A3934DD-BE0A-4851-B8E0-50A64106B98A}] ;Name=Data Exchange Types;
                                                                CaptionML=[ENU=Data Exchange Types;
                                                                           NLD=Typen gegevensuitwisseling];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1213;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{0D3D0EB4-59D7-4D3E-95AC-49CD269C6C04}] ;Name=Data Migration Settings;
                                                                AccessByPermission=TableData 1806=R;
                                                                CaptionML=[ENU=Data Migration Settings;
                                                                           NLD=Instellingen van gegevensmigratie];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1807;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{00646221-3EEF-4883-8640-FECFD9BEC705}] ;Name=Report Configuration;
                                                                AccessByPermission=TableData 2000000196=IMD;
                                                                CaptionML=[ENU=Report Settings;
                                                                           NLD=Rapportinstellingen];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1560;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{A1E3A413-B0C4-4D20-8B1F-AFF7DFFDB43C}] ;Name=Setup and Help Resources;
                                                                CaptionML=[ENU=Setup and Help Resources;
                                                                           NLD=Instellings- en Help-resources];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1822;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    {                ;[{19A352FE-D90D-424E-B85F-CF3B8E98CF0E}] ;NextNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}] }
    { Menu           ;[{0691571E-EDD6-473D-A139-81B1E9B887F2}] ;Name=ForNAV;
                                                                CaptionML=ENU=ForNAV;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                Image=15;
                                                                IsShortcut=No;
                                                                Visible=Yes;
                                                                Enabled=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{E849D80C-A6A0-4A75-9313-4A9691856383}] }
    { MenuItem       ;[{CC9EF159-165D-4DCB-8A3B-05D408AB94F8}] ;Name=ForNAV Setup;
                                                                CaptionML=ENU=ForNAV Setup;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70000;
                                                                ParentNodeID=[{E849D80C-A6A0-4A75-9313-4A9691856383}];
                                                                Visible=Yes;
                                                                NextNodeID=[{C331F6D8-9B94-4792-89D9-CEDBB101436C}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{E849D80C-A6A0-4A75-9313-4A9691856383}] ;Name=Application Setup;
                                                                CaptionML=ENU=Application Setup;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}];
                                                                FirstChild=[{CC9EF159-165D-4DCB-8A3B-05D408AB94F8}] }
    { MenuItem       ;[{E6D918CF-B1F7-4171-A3E9-3C6E9B592EB1}] ;Name=Transformation Rules;
                                                                CaptionML=ENU=Transformation Rules;
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1237;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{C331F6D8-9B94-4792-89D9-CEDBB101436C}] ;Name=ForNAV Legal Cond. Translation;
                                                                CaptionML=ENU=ForNAV Legal Cond. Translation;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70001;
                                                                ParentNodeID=[{E849D80C-A6A0-4A75-9313-4A9691856383}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}] ;Name=Document Reports;
                                                                CaptionML=ENU=Document Reports;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                Visible=Yes;
                                                                NextNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                FirstChild=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}] }
    { MenuItem       ;[{62E72610-35DE-4B65-A0A8-4A4464FD467C}] ;Name=Sales Order Confirmation;
                                                                CaptionML=ENU=Sales Order Confirmation;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70000;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{D30D76B6-37A6-4333-B5F6-F6688007A102}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{596FD082-176B-47D1-B4BA-5DABB301A6C3}] ;Name=Sales;
                                                                CaptionML=ENU=Sales;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                FirstChild=[{62E72610-35DE-4B65-A0A8-4A4464FD467C}] }
    { MenuItem       ;[{D30D76B6-37A6-4333-B5F6-F6688007A102}] ;Name=Sales Invoice;
                                                                CaptionML=ENU=Sales Invoice;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70001;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{D689D68B-B7E6-44FA-A12E-412B7F969A7A}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{D689D68B-B7E6-44FA-A12E-412B7F969A7A}] ;Name=Sales Credit Memo;
                                                                CaptionML=ENU=Sales Credit Memo;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70002;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{1D3B52D4-9A4A-45D3-A4EA-4EBB5B792BBA}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{1D3B52D4-9A4A-45D3-A4EA-4EBB5B792BBA}] ;Name=Sales Shipment;
                                                                CaptionML=ENU=Sales Shipment;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70003;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{BB66C103-03B0-4D34-BAA5-44DE7EB35EB2}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{BB66C103-03B0-4D34-BAA5-44DE7EB35EB2}] ;Name=Sales Quote;
                                                                CaptionML=ENU=Sales Quote;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70004;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{420A2BFA-3FD3-4AD3-914D-DACF3DC2A358}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}] ;Name=Purchase;
                                                                CaptionML=ENU=Purchase;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{3C3B5DC6-21F5-4E37-8C08-8E5938133520}] }
    { MenuItem       ;[{3C3B5DC6-21F5-4E37-8C08-8E5938133520}] ;Name=Purchase Order;
                                                                CaptionML=ENU=Purchase Order;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70100;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{59F08D28-DEAC-4A3B-96E2-A6D597DDE1F6}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{59F08D28-DEAC-4A3B-96E2-A6D597DDE1F6}] ;Name=Purchase Invoice;
                                                                CaptionML=ENU=Purchase Invoice;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70101;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{4CC18C18-81F4-4235-ADCD-5168C7501B6E}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{4CC18C18-81F4-4235-ADCD-5168C7501B6E}] ;Name=Purchase Credit Memo;
                                                                CaptionML=ENU=Purchase Credit Memo;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70102;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F10C4BA6-49D1-41DC-834C-A7F72C44B7C5}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{F10C4BA6-49D1-41DC-834C-A7F72C44B7C5}] ;Name=Purchase Quote;
                                                                CaptionML=ENU=Purchase Quote;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70104;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}] ;Name=Reports;
                                                                CaptionML=ENU=Reports;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{BA687EE2-5570-4962-B8FF-C27DE3ABC6F3}] }
    { MenuItem       ;[{BA687EE2-5570-4962-B8FF-C27DE3ABC6F3}] ;Name=ForNAV Trial Balance;
                                                                CaptionML=ENU=ForNAV Trial Balance;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70206;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{80F41632-02B7-4B65-9469-B637CEA37A37}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{80F41632-02B7-4B65-9469-B637CEA37A37}] ;Name=ForNAV Customer/Item Statistics;
                                                                CaptionML=ENU=ForNAV Customer/Item Statistics;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70248;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{8EBA2FA7-A319-4BFA-8379-B9A253503879}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{8EBA2FA7-A319-4BFA-8379-B9A253503879}] ;Name=ForNav Salesperson-Commission;
                                                                CaptionML=ENU=ForNav Salesperson-Commission;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70215;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{3E0EA722-316D-4835-B87E-31E12BE27FF9}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{3E0EA722-316D-4835-B87E-31E12BE27FF9}] ;Name=ForNAV Aged Accounts Receivable;
                                                                CaptionML=ENU=ForNAV Aged Accounts Receivable;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70220;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F84E0725-FFC0-482E-A802-8C3F918E698E}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{F84E0725-FFC0-482E-A802-8C3F918E698E}] ;Name=ForNAV Aged Accounts Payable;
                                                                CaptionML=ENU=ForNAV Aged Accounts Payable;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70221;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{41CABE99-FB5D-4D56-853C-5D1F4736CD42}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{41CABE99-FB5D-4D56-853C-5D1F4736CD42}] ;Name=Debitor - top 10-liste;
                                                                CaptionML=[CSY=ForNAV Nejlep °ch 10 z†kazn°ku;
                                                                           DAN=ForNAV Debitor - top 10-liste;
                                                                           DEU=ForNAV Top 10 Liste (Debitoren);
                                                                           ENU=ForNAV Customer Top 10 List;
                                                                           FIN=ForNAV Asiakkaat - 10 pÑÑasiakasta;
                                                                           FRA=ForNAV Clients - Palmaräs;
                                                                           ISL=ForNAV Vi˜skiptama˜ur - 10 efstu;
                                                                           ITA=ForNAV Lista primi 10 clienti;
                                                                           NLD=ForNAV Klanten - Top 10;
                                                                           NOR=ForNAV Kunde - ti pÜ topp-liste;
                                                                           RUS=‡âäÜ°ï - ãÜ˜ÉÖò ÑÜ§òïàÖ;
                                                                           SVE=ForNAV Kunder, 10 i topp;
                                                                           DES=ForNAV Top 10 Liste (Debitoren);
                                                                           ENG=ForNAV Customer Top 10 List;
                                                                           FRB=ForNAV Clients - Palmaräs;
                                                                           ITS=ForNAV Lista primi 10 clienti;
                                                                           NLB=ForNAV Klanten - Top 10;
                                                                           DEA=ForNAV Top 10 Liste (Debitoren);
                                                                           ENA=ForNAV Customer Top 10 List;
                                                                           ESN=ForNAV Los 10 mejores clientes;
                                                                           FRS=ForNAV Clients - Palmaräs;
                                                                           ENZ=ForNAV Customer Top 10 List];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70201;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{45294869-9463-4CF8-B506-43F3CEDF442B}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{45294869-9463-4CF8-B506-43F3CEDF442B}] ;Name=Kreditor - top 10-liste;
                                                                CaptionML=[CSY=ForNAV Dodavatel - nejlep °ch 10;
                                                                           DAN=ForNAV Kreditor - top 10-liste;
                                                                           DEU=ForNAV HÑndler Top-10-Liste;
                                                                           ENU=ForNAV Vendor Top 10 List;
                                                                           FIN=ForNAV 10 pÑÑtoimittajaa;
                                                                           FRA=ForNAV Palmaräs fournisseurs;
                                                                           ISL=ForNAV 10 efstu l†nardrottnar;
                                                                           ITA=ForNAV Lista primi 10 fornitori;
                                                                           NLD=ForNAV Lijst top 10 leveranciers;
                                                                           NOR=ForNAV Leverand˚r - topp 10-liste;
                                                                           RUS=Áå§ïÖÉóäàä - ãÜ˜ÉÖò ÑÜ§òïàÖ;
                                                                           SVE=ForNAV 10 i topp leverantîrer;
                                                                           DES=ForNAV HÑndler Top-10-Liste;
                                                                           ENG=ForNAV Vendor Top 10 List;
                                                                           FRB=ForNAV Palmaräs fournisseurs;
                                                                           ITS=ForNAV Lista primi 10 fornitori;
                                                                           NLB=ForNAV Lijst top 10 leveranciers;
                                                                           DEA=ForNAV HÑndler Top-10-Liste;
                                                                           ENA=ForNAV Vendor Top 10 List;
                                                                           ESN=ForNAV Listado 10 mejores proveedores;
                                                                           FRS=ForNAV Palmaräs fournisseurs;
                                                                           ENZ=ForNAV Vendor Top 10 List];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70202;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{6FBB60D4-3684-4106-BEFF-237518F7236E}] ;Name=Data Migration Overview;
                                                                CaptionML=[ENU=Data Migration Overview;
                                                                           NLD=Overzicht van gegevensmigratie];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1799;
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{420A2BFA-3FD3-4AD3-914D-DACF3DC2A358}] ;Name=Customer Statement;
                                                                CaptionML=ENU=Customer Statement;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70250;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
  }
}
OBJECT Page 70000 ForNAV Setup
{
  OBJECT-PROPERTIES
  {
    Date=20-12-17;
    Time=17:44:41;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table70000;
    PageType=Card;
    OnOpenPage=BEGIN
                 InitSetup;
               END;

    OnAfterGetRecord=BEGIN
                       WrongLocalization := NOT ValidateCurrentLocalization;
                     END;

    ActionList=ACTIONS
    {
      { 1       ;    ;ActionContainer;
                      Name=ActionItems;
                      ActionContainerType=ActionItems }
      { 11      ;1   ;ActionGroup;
                      Name=Watermark }
      { 10      ;2   ;Action    ;
                      Name=DownloadWatermark;
                      CaptionML=ENU=Download Watermarks;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Link;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DownloadWatermarks;
                               END;
                                }
      { 8       ;1   ;ActionGroup;
                      Name=Delete Visuals }
      { 14      ;2   ;Action    ;
                      Name=DeleteDocWatermark;
                      CaptionML=ENU=Document Watermark;
                      Image=Delete;
                      OnAction=VAR
                                 AreYouSureQst@1000 : TextConst 'ENU=Are you sure you want to clear %1?';
                               BEGIN
                                 IF NOT CONFIRM(AreYouSureQst, FALSE, FIELDCAPTION("Document Watermark")) THEN
                                   EXIT;

                                 "Document Watermark File Name" := 'Click to import...';
                                 CLEAR("Document Watermark");
                                 MODIFY;
                               END;
                                }
      { 15      ;2   ;Action    ;
                      Name=DeleteListWatermark;
                      CaptionML=ENU=List Watermark;
                      Image=Delete;
                      OnAction=VAR
                                 AreYouSureQst@1000 : TextConst 'ENU=Are you sure you want to clear %1?';
                               BEGIN
                                 IF NOT CONFIRM(AreYouSureQst, FALSE, FIELDCAPTION("List Report Watermark")) THEN
                                   EXIT;

                                 "List Report Watermark File N." := 'Click to import...';
                                 CLEAR("List Report Watermark");
                                 MODIFY;
                               END;
                                }
      { 16      ;2   ;Action    ;
                      Name=DeleteLogo;
                      CaptionML=ENU=Logo;
                      Image=Delete;
                      OnAction=VAR
                                 AreYouSureQst@1000 : TextConst 'ENU=Are you sure you want to clear %1?';
                               BEGIN
                                 IF NOT CONFIRM(AreYouSureQst, FALSE, FIELDCAPTION(Logo)) THEN
                                   EXIT;

                                 "Logo File Name" := 'Click to import...';
                                 CLEAR(Logo);
                                 MODIFY;
                               END;
                                }
      { 12      ;1   ;ActionGroup;
                      Name=System }
      { 2       ;2   ;Action    ;
                      Name=ReplaceReports;
                      CaptionML=ENU=Replace Reportselection;
                      Image=SwitchCompanies;
                      OnAction=BEGIN
                                 ReplaceReportSelection(FALSE);
                               END;
                                }
      { 7       ;2   ;Action    ;
                      Name=CheckLocalization;
                      CaptionML=ENU=Check Localization;
                      Image=MapSetup;
                      OnAction=BEGIN
                                 CheckLocalizationBasedOnTables;
                                 MODIFY;
                               END;
                                }
      { 9       ;2   ;Action    ;
                      Name=CreateWebservice;
                      CaptionML=ENU=Create ForNAV Webservice;
                      Image=ServiceSetup;
                      OnAction=BEGIN
                                 CreateWebService;
                               END;
                                }
      { 13      ;1   ;ActionGroup;
                      Name=Template }
      { 1000000014;2 ;Action    ;
                      Name=DesignTemplatePortrait;
                      CaptionML=ENU=Design General Template (Portrait);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=UnitOfMeasure;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignTemplatePortrait;
                               END;
                                }
      { 21      ;2   ;Action    ;
                      Name=DesignTemplateLandscape;
                      CaptionML=ENU=Design General Template (Landscape);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=VATPostingSetup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignTemplateLandscape;
                               END;
                                }
      { 4       ;2   ;Action    ;
                      Name=DesignSalesTemplate;
                      CaptionML=ENU=Design Sales Template;
                      ToolTipML=ENU=Use this option to change the sales template, for example when you want to move the address or change the font.;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Design;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignSalesTemplate;
                               END;
                                }
      { 1000000009;2 ;Action    ;
                      Name=DesignPurchaseTemplate;
                      CaptionML=ENU=Design Purchase Template;
                      ToolTipML=ENU=Use this option to change the purchase template, for example when you want to move the address or change the font.;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=DesignCodeBehind;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignPurchaseTemplate;
                               END;
                                }
      { 1000000011;  ;ActionContainer;
                      Name=RelatedInformation;
                      ActionContainerType=RelatedInformation }
      { 1000000013;1 ;Action    ;
                      Name=Translations;
                      CaptionML=ENU=Translations;
                      ToolTipML=ENU=View or edit translated legal conditions. Translated legal conditions are automatically inserted on documents according to the language code.;
                      RunObject=Page 70001;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Translations;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                GroupType=Group }

    { 6   ;2   ;Field     ;
                SourceExpr=Localization;
                Style=Unfavorable;
                StyleExpr=WrongLocalization }

    { 1000000010;2;Field  ;
                SourceExpr="Use ForNAV Languages" }

    { 1000000012;2;Field  ;
                SourceExpr="Use Preprinted Paper" }

    { 1000000002;1;Group  ;
                Name=VAT/Sales Tax;
                GroupType=Group }

    { 1000000003;2;Field  ;
                SourceExpr="VAT Amount Specification" }

    { 1000000004;1;Group  ;
                Name=Document Texts;
                GroupType=Group }

    { 5   ;2   ;Field     ;
                SourceExpr="Payment Note";
                MultiLine=Yes }

    { 1000000005;2;Field  ;
                SourceExpr="Legal Conditions";
                MultiLine=Yes }

    { 17  ;1   ;Group     ;
                Name=Visuals;
                GroupType=Group }

    { 18  ;2   ;Field     ;
                CaptionML=ENU=Logo;
                SourceExpr="Logo File Name";
                OnDrillDown=VAR
                              TempBlob@1001 : Record 99008535;
                              FileManagement@1000 : Codeunit 419;
                            BEGIN
                              CALCFIELDS(Logo);
                              IF "Logo File Name" <> 'Click to import...' THEN BEGIN
                                TempBlob.Blob := Logo;
                                HYPERLINK(FileManagement.BLOBExport(TempBlob, "Logo File Name", FALSE));
                              END ELSE
                                ImportWatermarkFromClientFile(FIELDNO(Logo));
                              MODIFY;
                            END;
                             }

    { 19  ;2   ;Field     ;
                CaptionML=ENU=Document Watermark;
                SourceExpr="Document Watermark File Name";
                Editable=FALSE;
                OnDrillDown=VAR
                              TempBlob@1001 : Record 99008535;
                              FileManagement@1000 : Codeunit 419;
                            BEGIN
                              CALCFIELDS("Document Watermark");
                              IF "Document Watermark File Name" <> 'Click to import...' THEN BEGIN
                                TempBlob.Blob := "Document Watermark";
                                HYPERLINK(FileManagement.BLOBExport(TempBlob, "Document Watermark File Name", FALSE));
                              END ELSE
                                ImportWatermarkFromClientFile(FIELDNO("Document Watermark"));
                              MODIFY;
                            END;
                             }

    { 20  ;2   ;Field     ;
                CaptionML=ENU=List Report Watermark;
                SourceExpr="List Report Watermark File N.";
                OnDrillDown=VAR
                              TempBlob@1001 : Record 99008535;
                              FileManagement@1000 : Codeunit 419;
                            BEGIN
                              CALCFIELDS("List Report Watermark");
                              IF "List Report Watermark File N." <> 'Click to import...' THEN BEGIN
                                TempBlob.Blob := "List Report Watermark";
                                HYPERLINK(FileManagement.BLOBExport(TempBlob, "List Report Watermark File N.", FALSE));
                              END ELSE
                                ImportWatermarkFromClientFile(FIELDNO("List Report Watermark"));
                              MODIFY;
                            END;
                             }

    { 1000000006;0;Container;
                ContainerType=FactBoxArea }

    { 1000000007;1;Part   ;
                PartType=System;
                SystemPartID=MyNotes }

    { 1000000008;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

  }
  CODE
  {
    VAR
      WrongLocalization@1000 : Boolean INDATASET;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Page 70001 ForNAV Legal Cond. Translation
{
  OBJECT-PROPERTIES
  {
    Date=14-07-17;
    Time=10:56:09;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    SourceTable=Table70001;
    PageType=List;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr="Language Code" }

    { 1000000003;2;Field  ;
                SourceExpr="Legal Conditions" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Page 70005 ForNAV Setup Wizard
{
  OBJECT-PROPERTIES
  {
    Date=12-09-17;
    Time=13:48:49;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    SourceTable=Table70000;
    PageType=NavigatePage;
    SourceTableTemporary=Yes;
    OnInit=BEGIN
             LoadTopBanners;
           END;

    OnOpenPage=BEGIN
                 INIT;
                 IF ForNAVSetup.GET THEN BEGIN
                   TRANSFERFIELDS(ForNAVSetup);
                   WrongLocalization := NOT ValidateCurrentLocalization;
                 END ELSE BEGIN
                   CheckLocalizationBasedOnTables;
                   "Legal Conditions" := LegalConditionsTxt;
                   "Payment Note" := PaymentNoteTxt;
                   "VAT Amount Specification" := "VAT Amount Specification"::"Multiple Lines";
                   VALIDATE(Localization);
                 END;
                 INSERT;

                 Step := Step::Start;
                 EnableControls;
               END;

    ActionList=ACTIONS
    {
      { 19      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 18      ;1   ;Action    ;
                      Name=ActionBack;
                      CaptionML=ENU=Back;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=BackActionEnabled;
                      InFooterBar=Yes;
                      Image=PreviousRecord;
                      OnAction=BEGIN
                                 NextStep(TRUE);
                               END;
                                }
      { 16      ;1   ;Action    ;
                      Name=ActionNext;
                      CaptionML=ENU=Next;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NextActionEnabled;
                      InFooterBar=Yes;
                      Image=NextRecord;
                      OnAction=BEGIN
                                 NextStep(FALSE);
                               END;
                                }
      { 8       ;1   ;Action    ;
                      Name=ActionFinish;
                      CaptionML=ENU=Finish;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=FinishActionEnabled;
                      InFooterBar=Yes;
                      Image=Approve;
                      OnAction=BEGIN
                                 FinishAction;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 5   ;0   ;Container ;
                ContainerType=ContentArea }

    { 4   ;1   ;Group     ;
                Visible=TopBannerVisible AND NOT FinalStepVisible;
                Editable=FALSE;
                GroupType=Group }

    { 3   ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaRepositoryStandard.Image;
                Editable=FALSE;
                ShowCaption=No }

    { 2   ;1   ;Group     ;
                Visible=TopBannerVisible AND FinalStepVisible;
                Editable=FALSE;
                GroupType=Group }

    { 1   ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaRepositoryDone.Image;
                Editable=FALSE;
                ShowCaption=No }

    { 11  ;1   ;Group     ;
                Visible=FirstStepVisible;
                GroupType=Group }

    { 10  ;2   ;Group     ;
                CaptionML=ENU=Welcome to ForNAV Setup;
                Visible=FirstStepVisible;
                GroupType=Group }

    { 9   ;3   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU="The ForNAV report package contains several documents that are optimized to work with our designer. " }

    { 7   ;2   ;Group     ;
                CaptionML=ENU=Let's go!;
                GroupType=Group }

    { 6   ;3   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU=Choose Next so you can set up the ForNAV report package. }

    { 15  ;1   ;Group     ;
                Visible=FinalStepVisible;
                GroupType=Group }

    { 13  ;2   ;Group     ;
                CaptionML=ENU=That's it!;
                GroupType=Group }

    { 12  ;3   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU=To enable the ForNAV report package choose Finish. }

    { 24  ;1   ;Group     ;
                Visible=Step1Visible;
                GroupType=Group;
                InstructionalTextML=ENU=Select your localization... }

    { 25  ;2   ;Field     ;
                SourceExpr=Localization;
                OnValidate=BEGIN
                             WrongLocalization := NOT ValidateCurrentLocalization;
                           END;
                            }

    { 27  ;2   ;Group     ;
                Visible=WrongLocalization;
                GroupType=Group;
                InstructionalTextML=ENU=WARNING! This is not the localization we detected! }

    { 21  ;1   ;Group     ;
                Visible=Step2Visible;
                GroupType=Group;
                InstructionalTextML=ENU=Select your VAT printing preferences and legal clause. }

    { 22  ;2   ;Field     ;
                SourceExpr="VAT Amount Specification" }

    { 14  ;2   ;Field     ;
                SourceExpr="Payment Note" }

    { 23  ;2   ;Field     ;
                SourceExpr="Legal Conditions" }

    { 17  ;1   ;Group     ;
                Visible=Step3Visible;
                GroupType=Group;
                InstructionalTextML=ENU=Do you want to replace the current report selections with the ForNAV reports? }

    { 20  ;2   ;Field     ;
                Name=ReplaceReports;
                CaptionML=ENU=Replace Reports;
                SourceExpr=ReplaceReports }

    { 30  ;1   ;Group     ;
                Visible=Step3Visible;
                GroupType=Group;
                InstructionalTextML=ENU=Do you want to create the fields webservice? }

    { 29  ;2   ;Field     ;
                SourceExpr=CreateTheWebService }

    { 1000000001;1;Group  ;
                Visible=Step2Visible;
                GroupType=Group;
                InstructionalTextML=ENU=A watermark can make your reports look nicer. Do you want to import one? }

    { 1000000000;2;Field  ;
                Name=ImportWatermark;
                SourceExpr=WatermarkTxt;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              ImportWatermarkFromClientFile(FIELDNO("Document Watermark"));
                            END;

                ShowCaption=No }

    { 28  ;2   ;Field     ;
                Name=ImportWatermarkList;
                SourceExpr=WatermarkListTxt;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              ImportWatermarkFromClientFile(FIELDNO("List Report Watermark"));
                            END;

                ShowCaption=No }

    { 26  ;2   ;Field     ;
                Name=ImportCompanyLogo;
                SourceExpr=CompanyLogoTxt;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              ImportWatermarkFromClientFile(FIELDNO(Logo));
                            END;

                ShowCaption=No }

  }
  CODE
  {
    VAR
      MediaRepositoryStandard@1001 : Record 9400;
      MediaRepositoryDone@1000 : Record 9400;
      ForNAVSetup@1005 : Record 70000;
      TopBannerVisible@1003 : Boolean;
      FinalStepVisible@1002 : Boolean;
      FirstStepVisible@1004 : Boolean;
      FinishActionEnabled@1007 : Boolean;
      BackActionEnabled@1008 : Boolean;
      NextActionEnabled@1009 : Boolean;
      Step1Visible@1011 : Boolean;
      Step2Visible@1010 : Boolean;
      Step3Visible@1013 : Boolean;
      ReplaceReports@1012 : Boolean;
      CreateTheWebService@1019 : Boolean;
      WrongLocalization@1014 : Boolean INDATASET;
      Step@1006 : 'Start,Step1,Step2,Step3,Finish';
      WatermarkTxt@1000000000 : TextConst 'ENU=Click to import a watermark for document reports';
      WatermarkListTxt@1018 : TextConst 'ENU=Click to import a watermark for list reports';
      CompanyLogoTxt@1017 : TextConst 'ENU=Click to import a company logo';
      PaymentNoteTxt@1015 : TextConst 'ENU=- You can print a payment note here -';
      LegalConditionsTxt@1016 : TextConst 'ENU=- You can print your legal conditions here -';

    LOCAL PROCEDURE LoadTopBanners@40();
    BEGIN
      IF MediaRepositoryStandard.GET('AssistedSetup-NoText-400px.png',FORMAT(CURRENTCLIENTTYPE)) AND
         MediaRepositoryDone.GET('AssistedSetupDone-NoText-400px.png',FORMAT(CURRENTCLIENTTYPE))
      THEN
        TopBannerVisible := MediaRepositoryDone.Image.HASVALUE;
    END;

    LOCAL PROCEDURE EnableControls@2();
    BEGIN
      ResetControls;

      CASE Step OF
        Step::Start:
          ShowStartStep;
        Step::Step1:
          ShowStep1;
        Step::Step2:
          ShowStep2;
        Step::Step3:
          ShowStep3;
        Step::Finish:
          ShowFinishStep;
      END;
    END;

    LOCAL PROCEDURE ShowStartStep@24();
    BEGIN
      FirstStepVisible := TRUE;
      FinishActionEnabled := FALSE;
      BackActionEnabled := FALSE;
    END;

    LOCAL PROCEDURE ShowStep1@33();
    BEGIN
      Step1Visible := TRUE;
    END;

    LOCAL PROCEDURE ShowStep2@34();
    BEGIN
      Step2Visible := TRUE;
    END;

    LOCAL PROCEDURE ShowStep3@4();
    BEGIN
      Step3Visible := TRUE;
    END;

    LOCAL PROCEDURE ShowFinishStep@35();
    BEGIN
      FinalStepVisible := TRUE;
      NextActionEnabled := FALSE;
    END;

    LOCAL PROCEDURE ResetControls@1();
    BEGIN
      FinishActionEnabled := 1=1;
      BackActionEnabled := TRUE;
      NextActionEnabled := TRUE;

      FirstStepVisible := FALSE;
      Step1Visible := FALSE;
      Step2Visible := FALSE;
      Step3Visible := FALSE;
      FinalStepVisible := FALSE;
    END;

    LOCAL PROCEDURE NextStep@41(Backwards@1000 : Boolean);
    BEGIN
      IF Backwards THEN
        Step := Step - 1
      ELSE
        Step := Step + 1;

      EnableControls;
    END;

    LOCAL PROCEDURE FinishAction@12();
    BEGIN
      StoreForNAVSetup;
      CurrPage.CLOSE;
    END;

    LOCAL PROCEDURE StoreForNAVSetup@3();
    BEGIN
      IF NOT ForNAVSetup.GET THEN BEGIN
        ForNAVSetup.INIT;
        ForNAVSetup.INSERT;
      END;

      ForNAVSetup.TRANSFERFIELDS(Rec,FALSE);
      IF NOT ForNAVSetup.Logo.HASVALUE THEN
        ForNAVSetup.GetCompanyLogo;

      ForNAVSetup.MODIFY;
      IF ReplaceReports THEN
        ForNAVSetup.ReplaceReportSelection(TRUE);
      IF CreateTheWebService THEN
        CreateWebService;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Page 70006 ForNAV Fields Webservice
{
  OBJECT-PROPERTIES
  {
    Date=15-01-18;
    Time=09:16:03;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=FieldsEx;
    SourceTable=Table2000000041;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                CaptionML=ENU=TableNo;
                SourceExpr=TableNo }

    { 4   ;2   ;Field     ;
                CaptionML=ENU=No.;
                SourceExpr="No." }

    { 6   ;2   ;Field     ;
                CaptionML=ENU=TableName;
                SourceExpr=TableName }

    { 8   ;2   ;Field     ;
                CaptionML=ENU=FieldName;
                SourceExpr=FieldName }

    { 10  ;2   ;Field     ;
                CaptionML=ENU=Type;
                SourceExpr=Type }

    { 12  ;2   ;Field     ;
                CaptionML=ENU=Class;
                SourceExpr=Class }

    { 3   ;2   ;Field     ;
                SourceExpr=RelationTableNo }

    { 5   ;2   ;Field     ;
                SourceExpr=RelationFieldNo }

    { 7   ;2   ;Field     ;
                SourceExpr=OptionString }

  }
  CODE
  {

    BEGIN
    END.
  }
}

